<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 1</h2>
	<h5 id="">2015-03-03 8:09:32&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020152245224236/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;">1. 数学期望值, 平均值, mean<div><a target="_blank" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E6%9C%9F%E6%9C%9B%E5%80%BC"   >http://zh.wikipedia.org/wiki/%E6%9C%9F%E6%9C%9B%E5%80%BC</a></div><div>表示: E[X], 即X变量的平均值.</div><div><div><img title="一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   alt="一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/saOj9DB2ZhVChLg_460ORw==/6630302505605741977.png"   ></div></div><div>也用miu表示 :&nbsp;μ=E[X]</div><div>PostgreSQL中举例 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres=# select avg(c1) from (values(null),(1),(2)) as t(c1);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; avg &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >--------------------</font></div><div><font size="2"   >&nbsp;1.5000000000000000</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><div>以上为离散概率, 数学期望就是每个值乘以它的概率除以值的个数.</div><div>如果是连续概率的话, 要统计一个取值范围的区间概率, 统计一个区间的面积.</div><div><div><img title="用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   alt="用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img0.ph.126.net/aSVGQlYVWFCoVLxuBdyTvQ==/1139410705825773396.jpg"   ></div></div><div><br></div><div><wbr><div>2. 众数, mode</div><div><a target="_blank" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E4%BC%97%E6%95%B0_(%E6%95%B0%E5%AD%A6)"   >http://zh.wikipedia.org/wiki/%E4%BC%97%E6%95%B0_(%E6%95%B0%E5%AD%A6)</a></div><div>出现频率最高的值.</div><div><span style="line-height: 28px;"   >PostgreSQL中举例, 如果有多个同样频率的, 取第一个 :&nbsp;</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres=# select mode() WITHIN GROUP (ORDER BY c1) from (values(null),(1),(2),(1),(2),(3)) as t(c1);</font></div><div><font size="2"   >&nbsp;mode&nbsp;</font></div><div><font size="2"   >------</font></div><div><font size="2"   >&nbsp; &nbsp; 1</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >postgres=# select mode() WITHIN GROUP (ORDER BY c1 desc) from (values(null),(1),(2),(1),(2),(3)) as t(c1);</font></div><div><font size="2"   >&nbsp;mode&nbsp;</font></div><div><font size="2"   >------</font></div><div><font size="2"   >&nbsp; &nbsp; 2</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><div>其实在PostgreSQL统计信息中也用到了众数类似(延展)的概念, 即mcv, mce. 最频繁出现的值. 见<span style="line-height: 28px;"   >pg_stats.</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres=# \d pg_stats</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; View "pg_catalog.pg_stats"</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Column &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; Type &nbsp; | Modifiers&nbsp;</font></div><div><font size="2"   >------------------------+----------+-----------</font></div><div><font size="2"   >&nbsp;schemaname &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | name &nbsp; &nbsp; |&nbsp;</font></div><div><font size="2"   >&nbsp;tablename &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| name &nbsp; &nbsp; |&nbsp;</font></div><div><font size="2"   >&nbsp;attname &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| name &nbsp; &nbsp; |&nbsp;</font></div><div><font size="2"   >&nbsp;inherited &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| boolean &nbsp;|&nbsp;</font></div><div><font size="2"   >&nbsp;null_frac &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| real &nbsp; &nbsp; |&nbsp;</font></div><div><font size="2"   >&nbsp;avg_width &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| integer &nbsp;|&nbsp;数学期望</font></div><div><font size="2"   >&nbsp;n_distinct &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | real &nbsp; &nbsp; |&nbsp;</font></div><div><font size="2"   >&nbsp;most_common_vals &nbsp; &nbsp; &nbsp; | anyarray | &nbsp;众数类似</font></div><div><font size="2"   >&nbsp;most_common_freqs &nbsp; &nbsp; &nbsp;| real[] &nbsp; | &nbsp;众数概率</font></div><div><font size="2"   >&nbsp;histogram_bounds &nbsp; &nbsp; &nbsp; | anyarray |&nbsp;中位数类似</font></div><div><font size="2"   >&nbsp;correlation &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| real &nbsp; &nbsp; |&nbsp;相关度</font></div><div><font size="2"   >&nbsp;most_common_elems &nbsp; &nbsp; &nbsp;| anyarray | &nbsp;&nbsp;<span style="line-height: 28px;"   >众数类似</span></font></div><div><font size="2"   >&nbsp;most_common_elem_freqs | real[] &nbsp; | &nbsp;&nbsp;<span style="line-height: 28px;"   >众数概率</span></font></div><div><font size="2"   >&nbsp;elem_count_histogram &nbsp; | real[] &nbsp; |&nbsp;中位数类似</font></div><p></p></pre></div><div><br></div><div>3. 中位数,&nbsp;Median</div><div><a target="_blank" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E4%B8%AD%E4%BD%8D%E6%95%B8"   >http://zh.wikipedia.org/wiki/%E4%B8%AD%E4%BD%8D%E6%95%B8</a></div><div>取按数字大小顺序排好后的中间数字, 如果是偶数个, 则取两个值的平均值.</div><div>例如: 1,3,5,7,9的中位数为5.</div><div><span style="line-height: 28px;"   >例如: 1,3,5,7,9,10的中位数为(5+7)/2=6</span></div><div><span style="line-height: 28px;"   >中位数在PostgreSQL统计信息中也有类似的应用, 即柱状分布, 见</span><span style="line-height: 28px;"   >pg_stats.</span><span style="line-height: 28px;"   >histogram_bounds. 每个区间(bucket)的概率是相等的, 每个值的两边的bucket概率是相等的. 类似中位数的概念.</span></div><div><br></div><div>4. 方差,&nbsp;Variance</div><div><a target="_blank" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E6%96%B9%E5%B7%AE"   >http://zh.wikipedia.org/wiki/%E6%96%B9%E5%B7%AE</a></div><div>方差是各个数据分别与其平均数之差的平方的和的平均数，用字母D表示。在概率论和数理统计中，方差（Variance）用来度量随机变量和其数学期望（即均值）之间的偏离程度。在许多实际问题中，研究随机变量和均值之间的偏离程度有着重要意义。</div><div><div>设X为服从分布F的随机变量， 如果E[X]是随机变量X的期望值（平均数μ=E[X]）</div><div>随机变量X或者分布F的方差为</div><div>(总体方差) :&nbsp;</div><div><div><div><img title="一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   alt="一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img2.ph.126.net/sZiRtLEQ6rY40joAJDt1qQ==/6630185957373196592.png"   ></div></div>(样本方差) :&nbsp;</div></div><div><div>样本方差是依据所给样本对方差做出的一个无偏估计。</div><div>样本方差的计算公式以及表述符号为:&nbsp;</div><div><div><img title="一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   alt="一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/EWnKEoMzx3t8EY3sqQCwmA==/3359685322120710526.png"   ></div></div><div>其中：<img title="一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   alt="一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   src="http://img0.ph.126.net/6a4SHpxX15UrFAa-mZT4NQ==/3355181722493012082.png"   style="line-height: 28px; margin: 0px 10px 0px 0px;"   ><span style="line-height: 28px;"   >为样本均值 N为样本个数</span></div></div><div><span style="line-height: 28px;"   >PostgreSQL中举例 :&nbsp;</span></div><div><span style="line-height: 28px;"   >从计算方法来看.方差可以评估一组数字的离散度(如下).</span></div><div>总体方差.</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >postgres=# select var_pop(c1) from (values(1),(2),(3),(4),(5)) as t(c1);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; var_pop &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >--------------------</font></div><div><font size="2"   >&nbsp;2.0000000000000000</font></div><div><font size="2"   >(1 row)</font></div><div><div><font size="2"   >postgres=# select var_pop(c1) from (values(1),(2),(3),(4),(5),(1000)) as t(c1);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;var_pop &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >---------------------</font></div><div><font size="2"   >&nbsp;138058.472222222222</font></div><div><font size="2"   >(1 row)</font></div></div></div><div><div><font size="2"   >postgres=# select var_pop(c1) from (values(1000),(1001),(1003),(1004),(1005),(1000)) as t(c1);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; var_pop &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >--------------------</font></div><div><font size="2"   >&nbsp;3.8055555555555556</font></div><div><font size="2"   >(1 row)</font></div></div><p></p></pre></div><div>样本方差</div><div><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div><div style="line-height: 28px;"   ><font size="2"   >postgres=# select var_samp(c1) from (values(1),(2),(3),(4),(5)) as t(c1);</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp; &nbsp; var_samp &nbsp; &nbsp; &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >--------------------</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;2.5000000000000000</font></div><div style="line-height: 28px;"   ><font size="2"   >(1 row)</font></div></div><div><div><font size="2"   >postgres=# select var_samp(c1) from (values(1),(2),(3),(4),(5),(1000)) as t(c1);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; var_samp &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >---------------------</font></div><div><font size="2"   >&nbsp;165670.166666666667</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >postgres=# select var_samp(c1) from (values(1000),(1001),(1003),(1004),(1005),(1000)) as t(c1);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; var_samp &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >--------------------</font></div><div><font size="2"   >&nbsp;4.5666666666666667</font></div><div><font size="2"   >(1 row)</font></div></div><p></p></pre></div></div><div><br></div><div>5. 标准差,&nbsp;Standard Deviation, 对应方差的平方根. 也可用于评估离散度.</div><div>表示符号和方差一样, 但是符号上头没有代表平方的2.</div><div><a target="_blank" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E6%A8%99%E6%BA%96%E5%B7%AE"   >http://zh.wikipedia.org/wiki/%E6%A8%99%E6%BA%96%E5%B7%AE</a></div><div>标准差（Standard Deviation） ，中文环境中又常称均方差，但不同于均方误差（mean squared error，均方误差是各数据偏离真实值的距离平方的平均数，也即误差平方和的平均数，计算公式形式上接近方差，它的开方叫均方根误差，均方根误差才和标准差形式上接近），标准差是离均差平方和平均后的方根，用σ表示。标准差是方差的算术平方根。标准差能反映一个数据集的离散程度。平均数相同的，标准差未必相同。</div><div>标准差（Standard Deviation），在概率统计中最常使用作为统计分布程度（statistical dispersion）上的测量。标准差定义是总体各单位标准值与其平均数离差平方的算术平均数的平方根。它反映组内个体间的离散程度。</div><div><div>总体标准差</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >postgres=# select stddev_pop(c1) from (values(1000),(1001),(1003),(1004),(1005),(1000)) as t(c1);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;stddev_pop &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >--------------------</font></div><div><font size="2"   >&nbsp;1.9507833184532709</font></div><div><font size="2"   >(1 row)</font></div></div><div><div><font size="2"   >postgres=# select dsqrt(var_pop(c1)) from (values(1000),(1001),(1003),(1004),(1005),(1000)) as t(c1);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; dsqrt &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >------------------</font></div><div><font size="2"   >&nbsp;1.95078331845327</font></div><div><font size="2"   >(1 row)</font></div></div><p></p></pre></div></div><div>样本标准差</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres=# select stddev_samp(c1) from (values(1000),(1001),(1003),(1004),(1005),(1000)) as t(c1);</font></div><div><font size="2"   >&nbsp; &nbsp; stddev_samp &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >--------------------</font></div><div><font size="2"   >&nbsp;2.1369760566432809</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >postgres=# select dsqrt(var_samp(c1)) from (values(1000),(1001),(1003),(1004),(1005),(1000)) as t(c1);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; dsqrt &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >------------------</font></div><div><font size="2"   >&nbsp;2.13697605664328</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><div><br></div><div><div style="line-height: 28px;"   >6. 协方差,&nbsp;Covariance</div><div style="line-height: 28px;"   ><a target="_blank" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E5%8D%8F%E6%96%B9%E5%B7%AE"   >http://zh.wikipedia.org/wiki/%E5%8D%8F%E6%96%B9%E5%B7%AE</a></div><div style="line-height: 28px;"   >在概率论和统计学中，协方差用于衡量两个变量的总体误差(如果两组数据的误差一样, 那么和计算一组数据的方差得到的结果是一样的)。</div><div style="line-height: 28px;"   >而方差是协方差的一种特殊情况，即当两个变量是相同的情况。</div><div style="line-height: 28px;"   >注意这里提到方差是两个变量相等时的协方差, 一会我在PostgreSQL里面验证一下.</div><div style="line-height: 28px;"   ><div><img title="用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   alt="用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img2.ph.126.net/fQ0BFgJPhUzZ1BA76RUcVQ==/6608229809679926195.jpg"   ></div></div><div style="line-height: 28px;"   >在PostgreSQL中计算一组数据协方差的方法.</div></div><div style="line-height: 28px;"   >总体协方差</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >postgres=# select covar_pop(c1,c2) from (values(1,2),(2,3),(3,4),(4,5),(5,6),(1000,1001)) as t(c1,c2);</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp; covar_pop &nbsp; &nbsp;&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >------------------</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;138058.472222222</font></div><div style="line-height: 28px;"   ><font size="2"   >(1 row)</font></div><p></p></pre></div></div><div style="line-height: 28px;"   >样本协方差</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >postgres=# select covar_samp(c1,c2) from (values(1,2),(2,3),(3,4),(4,5),(5,6),(1000,1001)) as t(c1,c2);</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp; covar_samp &nbsp; &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >------------------</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;165670.166666667</font></div><div style="line-height: 28px;"   ><font size="2"   >(1 row)</font></div><p></p></pre></div></div><div style="line-height: 28px;"   ><span style="line-height: 28px;"   >在PostgreSQL中验证 : 方差是两个变量相等时的协方差</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres=# select var_pop(c1) from (values(1),(2),(3),(4),(5),(1000)) as t(c1);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;var_pop &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >---------------------</font></div><div><font size="2"   >&nbsp;138058.472222222222</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >postgres=# select covar_pop(c1,c1) from (values(1),(2),(3),(4),(5),(1000)) as t(c1);</font></div><div><font size="2"   >&nbsp; &nbsp; covar_pop &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >------------------</font></div><div><font size="2"   >&nbsp;138058.472222222</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><div><div>验证 :&nbsp;<span style="line-height: 28px;"   >(如果两组数据的误差一样, 那么和计算一组数据的方差得到的结果是一样的)。</span></div><div><span style="line-height: 28px;"   >如下两组数据, 1,2,3,4,5,1000; 2,3,4,5,6,1001; 他们各自的方差一样, 所以协方差也一样</span></div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >postgres=# select var_pop(c1) from (values(1,2),(2,3),(3,4),(4,5),(5,6),(1000,1001)) as t(c1,c2);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;var_pop &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >---------------------</font></div><div><font size="2"   >&nbsp;138058.472222222222</font></div><div><font size="2"   >(1 row)</font></div></div><div><div style="line-height: 28px;"   ><font size="2"   >postgres=# select var_pop(c2) from (values(1,2),(2,3),(3,4),(4,5),(5,6),(1000,1001)) as t(c1,c2);</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;var_pop &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >---------------------</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;138058.472222222222</font></div><div style="line-height: 28px;"   ><font size="2"   >(1 row)</font></div></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >postgres=# select covar_pop(c1,c2) from (values(1,2),(2,3),(3,4),(4,5),(5,6),(1000,1001)) as t(c1,c2);</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp; covar_pop &nbsp; &nbsp;&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >------------------</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;138058.472222222</font></div><div style="line-height: 28px;"   ><font size="2"   >(1 row)</font></div></div><p></p></pre></div></div><div><br></div><div>7. 相关性, 线性相关性,&nbsp;Correlation&nbsp;</div><div>表示两组数据的相关性, 相关值从0到1取值, 趋向1表示完全相关, 趋向0 表示完全不相关.</div><div><a target="_blank" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E7%9B%B8%E5%85%B3"   >http://zh.wikipedia.org/wiki/%E7%9B%B8%E5%85%B3</a></div><div><a target="_blank" rel="nofollow" href="http://baike.baidu.com/view/172091.htm"   >http://baike.baidu.com/view/172091.htm</a></div><div>相关表和相关图可反映两个变量之间的相互关系及其相关方向，但无法确切地表明两个变量之间相关的程度。于是，著名统计学家卡尔・皮尔逊设计了统计指标――相关系数(Correlation coefficient)。相关系数是用以反映变量之间相关关系密切程度的统计指标。相关系数是按积差方法计算，同样以两变量与各自平均值的离差为基础，通过两个离差相乘来反映两变量之间相关程度；着重研究线性的单相关系数。</div><div>在PostgreSQL中的统计信息中也有相关性的应用, 例如用于评估数据的物理存储和值的相关性, 方便优化器计算索引扫描的成本, 相关性越高, 越趋向索引, 因为离散块扫描会更少. 可以参考如下.</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201512810112541/"   >http://blog.163.com/digoal@126/blog/static/163877040201512810112541/</a></div><div>在PostgreSQL中计算两组数据的相关性.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres=# select corr(c1,c2) from (values(1,2),(2,3),(3,4),(4,5),(5,6),(1000,1001)) as t(c1,c2);</font></div><div><font size="2"   >&nbsp;corr&nbsp;</font></div><div><font size="2"   >------</font></div><div><font size="2"   >&nbsp; &nbsp; 1</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >postgres=# select corr(c1,c2) from (values(1,2),(2,3),(3,4),(4,5),(5,6),(1000,1)) as t(c1,c2);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; corr &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >--------------------</font></div><div><font size="2"   >&nbsp;-0.652023240836194</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><div>另外可看<span style="color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; line-height: 28px;"   >百度提到的例子 :&nbsp;</span></div><div style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   ><div style="line-height: 24px; margin: 15px 0px 5px; text-indent: 2em; font-family: arial, 宋体, sans-serif; font-size: 14px;"   >软件公司在全国有许多<a style="line-height: 24.5px; text-decoration: none; color: rgb(19, 110, 194);" target="_blank" rel="nofollow" href="http://baike.baidu.com/view/46500.htm"   >代理商</a>，为研究它的财务软件产品的广告投入与<a style="line-height: 24.5px; text-decoration: none; color: rgb(19, 110, 194);" target="_blank" rel="nofollow" href="http://baike.baidu.com/view/978270.htm"   >销售额</a>的关系，统计人员随机选择10家代理商进行观察，搜集到年广告投入费和月平均销售额的数据，并编制成<a style="line-height: 24.5px; text-decoration: none; color: rgb(19, 110, 194);" target="_blank" rel="nofollow" href="http://baike.baidu.com/view/4477555.htm"   >相关表</a>，见表1:</div><div style="line-height: 24px; margin: 15px 0px 5px; text-indent: 2em; font-family: arial, 宋体, sans-serif; font-size: 14px;"   ><b style="line-height: 24.5px;"   >表1　<a style="line-height: 24.5px; text-decoration: none; color: rgb(19, 110, 194);" target="_blank" rel="nofollow" href="http://baike.baidu.com/view/1987435.htm"   >广告费</a>与月平均销售额相关表　单位：万元</b></div><table style="line-height: 28px;"   ><tbody style="line-height: 28px;"   ><tr style="line-height: 28px;"   ><th style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 23px; border: 1px solid rgb(230, 230, 230); text-align: center; background-color: rgb(249, 249, 249);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >年广告费投入</div></th><th style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 23px; border: 1px solid rgb(230, 230, 230); text-align: center; background-color: rgb(249, 249, 249);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >月均销售额</div></th></tr><tr style="line-height: 28px;"   ><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >12.5　　15.3　　23.2　　26.4　　33.5　　34.4　　39.4　　45.2　　55.4　　60.9</div></td><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >21.2　　23.9　　32.9　　34.1　　42.5　　43.2　　49.0　　52.8　　59.4　　63.5</div></td></tr></table><div style="line-height: 24px; margin: 15px 0px 5px; text-indent: 2em; font-family: arial, 宋体, sans-serif; font-size: 14px;"   >参照表1，可计算相关系数如表2：</div><table style="line-height: 28px;"   ><tbody style="line-height: 28px;"   ><tr style="line-height: 28px;"   ><th style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 23px; border: 1px solid rgb(230, 230, 230); text-align: center; background-color: rgb(249, 249, 249);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >序号</div></th><th style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 23px; border: 1px solid rgb(230, 230, 230); text-align: center; background-color: rgb(249, 249, 249);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >广告投入(万元)<br style="line-height: 28px;"   >　　x</div></th><th style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 23px; border: 1px solid rgb(230, 230, 230); text-align: center; background-color: rgb(249, 249, 249);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >月均销售额(万元)<br style="line-height: 28px;"   >　　y</div></th><th style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 23px; border: 1px solid rgb(230, 230, 230); text-align: center; background-color: rgb(249, 249, 249);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   ><div style="line-height: 28px;"   ><img title="用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   alt="用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   style="line-height: 28px; height: auto;"   ></div></div></th><th style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 23px; border: 1px solid rgb(230, 230, 230); text-align: center; background-color: rgb(249, 249, 249);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   ><div style="line-height: 28px;"   ><img title="用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   alt="用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   style="line-height: 28px; height: auto;"   ></div></div></th><th style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 23px; border: 1px solid rgb(230, 230, 230); text-align: center; background-color: rgb(249, 249, 249);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   ><div style="line-height: 28px;"   ><img title="用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   alt="用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   style="line-height: 28px; height: auto;"   ></div></div></th></tr><tr style="line-height: 28px;"   ><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >1　　2　　3　　4　　5　　6　　7　　8　　9　　10</div></td><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >12.5　　15.3　　23.2　　26.4　　33.5　　34.4　　39.4　　45.2　　55.4　　60.9</div></td><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >21.2　　23.9　　32.9　　34.1　　42.5　　43.2　　49.0　　52.8　　59.4　　63.5</div></td><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >156.25　　234.09　　538.24　　696.96　　1122.25　　1183.36　　1552.36　　2043.04　　3069.16　　3708.81</div></td><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >449.44　　571.21　　1082.41　　1162.81　　1806.25　　1866.24　　2401.00　　2787.84　　3528.36　　4032.25</div></td><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >265.00　　365.67　　763.28　　900.24　　1423.75　　1486.08　　1930.60　　2386.56　　3290.76　　3867.15</div></td></tr><tr style="line-height: 28px;"   ><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >合计</div></td><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >346.2</div></td><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >422.5</div></td><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >14304.52</div></td><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >19687.81</div></td><td style="line-height: 22px; margin: 0px; padding: 2px 10px; height: 22px; border: 1px solid rgb(230, 230, 230);"   ><div style="line-height: 24px; color: rgb(51, 51, 51); margin: 0px;"   >16679.09</div></td></tr></table><ul style="line-height: 24px; margin-top: 0px; margin-bottom: 14px; margin-left: 2em; list-style: none; font-family: arial, 宋体, sans-serif; font-size: 14px;"   ><li style="line-height: 24.5px; margin: 0px; padding: 0px 0px 0px 14px; list-style-type: none; background-repeat: no-repeat;"   ><div style="line-height: 24px; margin: 0px;"   >=0.9942</div></li></ul><div style="line-height: 24px; margin: 15px 0px 5px; text-indent: 2em; font-family: arial, 宋体, sans-serif; font-size: 14px;"   >相关系数为0.9942，说明广告投入费与月平均销售额之间有高度的线性正相关关系。</div></div><div style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >相关性越高, 说明广告投入和销售额的关系越明显.</div><div style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >相关性是如何计算的呢? 实际上是 "协方差(x,y)除以(平方根(方差(x)*方差(y)))" .&nbsp;</div><div><div style="color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; line-height: 28px;"   ><img title="用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   alt="Postgresql attr correlation for values(logical order)  ctid (physcial order) - 德哥@Digoal - PostgreSQL research"   src="http://img0.ph.126.net/KrnexHxWvm3a86AuZN_nmg==/6630117787652273823.png"   style="line-height: 28px; height: auto; margin: 0px 10px 0px 0px;"   ></div><div><p></p><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres=# select corr(c1,c2) from (values(1,2),(2,3),(3,4),(4,5),(5,6),(1000,1)) as t(c1,c2);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; corr &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >--------------------</font></div><div><font size="2"   >&nbsp;-0.652023240836194</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >使用以上公式计算结果一致 :&nbsp;</font></div><div><font size="2"   >postgres=# select covar_pop(c1,c2)/dsqrt(var_pop(c1)*var_pop(c2)) from (values(1,2),(2,3),(3,4),(4,5),(5,6),(1000,1)) as t(c1,c2);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; ?column? &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >--------------------</font></div><div><font size="2"   >&nbsp;-0.652023240836194</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><p></p></div></div><div><br></div><div>[参考]</div><div>1. 百度百科</div><div>2. 百度词条</div><div>3. 维基百科</div></div><div>4.&nbsp;<a target="_blank" rel="nofollow" href="http://www.postgresql.org/docs/9.4/static/functions-aggregate.html"   >http://www.postgresql.org/docs/9.4/static/functions-aggregate.html</a></div><div>5. 用到的PostgreSQL聚合函数源码在此</div><div>&nbsp; &nbsp; src/backend/utils/adt/float.c</div><div>6. 更多玩法, 如果要在PostgreSQL中使用R语言或MADlib库, 请参考如下.</div><div><a target="_blank" rel="nofollow" href="http://www.joeconway.com/plr/"   >http://www.joeconway.com/plr/</a></div><div><a target="_blank" rel="nofollow" href="http://madlib.net/"   >http://madlib.net/</a></div><div><br></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="用PostgreSQL了解一些统计学术语以及计算方法和表示方法 - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>