<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Ubuntu NFS config</h2>
	<h5 id="">2013-03-24 22:25:40&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201322410101184/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>首先要安装nfs服务端软件包 :&nbsp;</div><pre class="prettyprint"   ><p><font size="2"   >root@digoal-desktop:/data02/iso# apt-get install nfs-kernel-server&nbsp;</font></p></pre><div><br></div><div>配置需要export的目录<br><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-desktop:/data01# mkdir -p /data02/nfs/share</font></div><div><font size="2"   >root@digoal-desktop:/data01# mkdir -p /data01/nfs/host1</font></div><p></p></pre></div><div><br></div><div>配置/etc/exports</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-desktop:/data01# vi /etc/exports</font></div><div><div><font size="2"   >/data02/nfs/share &nbsp; &nbsp; &nbsp; 192.168.2.0/24(rw,sync,no_root_squash)</font></div><div><font size="2"   >/data01/nfs/host1 &nbsp; &nbsp; &nbsp; 192.168.2.0/24(rw,sync,no_root_squash)</font></div></div><p></p></pre></div><div><br></div><div>启动nfs服务端</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-desktop:/data01# /etc/init.d/nfs-kernel-server start</font></div><div><div><font size="2"   >&nbsp;* Exporting directories for NFS kernel daemon...</font></div><div><font size="2"   >exportfs: /etc/exports [1]: Neither 'subtree_check' or 'no_subtree_check' specified for export "192.168.2.0/24:/data02/nfs/share".</font></div><div><font size="2"   >&nbsp; Assuming default behaviour ('no_subtree_check').</font></div><div><font size="2"   >&nbsp; NOTE: this default has changed since nfs-utils version 1.0.x</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >exportfs: /etc/exports [2]: Neither 'subtree_check' or 'no_subtree_check' specified for export "192.168.2.0/24:/data01/nfs/host1".</font></div><div><font size="2"   >&nbsp; Assuming default behaviour ('no_subtree_check').</font></div><div><font size="2"   >&nbsp; NOTE: this default has changed since nfs-utils version 1.0.x</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;...done.</font></div><div><font size="2"   >&nbsp;* Starting NFS kernel daemon</font></div><div><font size="2"   >&nbsp; &nbsp;...done.</font></div></div><p></p></pre></div><div><div><br></div><div># 配置自动启动服务, 已包含<span style="line-height: 22px;"   >nfs-kernel-server, 如下 :&nbsp;</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-desktop:/etc/rc5.d# pwd</font></div><div><font size="2"   >/etc/rc5.d</font></div><div><font size="2"   >root@digoal-desktop:/etc/rc5.d# ll</font></div><div><font size="2"   >total 20</font></div><div><font size="2"   >drwxr-xr-x &nbsp; 2 root root &nbsp;4096 Mar 24 22:03 ./</font></div><div><font size="2"   >drwxr-xr-x 134 root root 12288 Mar 24 22:10 ../</font></div><div><font size="2"   >-rw-r--r-- &nbsp; 1 root root &nbsp; 677 Jul 27 &nbsp;2012 README</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;17 Mar 24 19:34 S20ipmievd -&gt; ../init.d/ipmievd*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;20 Mar 24 18:32 S20kerneloops -&gt; ../init.d/kerneloops*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;27 Mar 24 22:03 S20nfs-kernel-server -&gt; ../init.d/nfs-kernel-server*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;27 Mar 24 18:32 S20speech-dispatcher -&gt; ../init.d/speech-dispatcher*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;17 Mar 24 21:46 S20sysstat -&gt; ../init.d/sysstat*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;18 Mar 24 19:34 S21openipmi -&gt; ../init.d/openipmi*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;20 Mar 24 18:32 S50pulseaudio -&gt; ../init.d/pulseaudio*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;15 Mar 24 18:32 S50rsync -&gt; ../init.d/rsync*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;15 Mar 24 18:32 S50saned -&gt; ../init.d/saned*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;19 Mar 24 18:32 S70dns-clean -&gt; ../init.d/dns-clean*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;18 Mar 24 18:32 S70pppd-dns -&gt; ../init.d/pppd-dns*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;14 Mar 24 11:27 S75sudo -&gt; ../init.d/sudo*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;22 Mar 24 18:32 S99acpi-support -&gt; ../init.d/acpi-support*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;21 Mar 24 18:32 S99grub-common -&gt; ../init.d/grub-common*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;18 Mar 24 18:32 S99ondemand -&gt; ../init.d/ondemand*</font></div><div><font size="2"   >lrwxrwxrwx &nbsp; 1 root root &nbsp; &nbsp;18 Mar 24 18:32 S99rc.local -&gt; ../init.d/rc.local*</font></div><p></p></pre></div><div><br></div><div># NFS客户端服务器, mount服务端export 的目录.</div><div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@digoal ~]# mkdir /data01</font></div><div><font size="2"   >[root@digoal ~]# mount -t nfs -o tcp 192.168.2.8:/data01/nfs/host1 /data01</font></div><div><font size="2"   >[root@digoal ~]# mkdir /data02</font></div><div><font size="2"   >[root@digoal ~]# mount -t nfs -o tcp 192.168.2.8:/data02/nfs/share /data02</font></div><div><font size="2"   >[root@digoal ~]# df -h</font></div><div><font size="2"   >Filesystem &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Size &nbsp;Used Avail Use% Mounted on</font></div><div><font size="2"   >/dev/vda1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;14G &nbsp;2.5G &nbsp; 11G &nbsp;20% /</font></div><div><font size="2"   >tmpfs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 249M &nbsp; &nbsp; 0 &nbsp;249M &nbsp; 0% /dev/shm</font></div><div><font size="2"   >192.168.2.8:/data01/nfs/host1</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 367G &nbsp;6.3G &nbsp;342G &nbsp; 2% /data01</font></div><div><font size="2"   >192.168.2.8:/data02/nfs/share</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;49G &nbsp; 16G &nbsp; 31G &nbsp;35% /data02</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >[root@digoal ~]# vi /etc/rc.local&nbsp;</font></div><div><div><font size="2"   ># add by digoal</font></div><div><font size="2"   >/bin/mount -t nfs -o tcp 192.168.2.8:/data01/nfs/host1 /data01</font></div><div><font size="2"   >/bin/mount -t nfs -o tcp 192.168.2.8:/data02/nfs/share /data02</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >[root@digoal data01]# useradd postgres</font></div><div><font size="2"   >[root@digoal data01]# mkdir pgdata</font></div><div><font size="2"   >[root@digoal data01]# chown postgres:postgres pgdata</font></div><div><font size="2"   >[root@digoal data01]# su - postgres</font></div><div><font size="2"   >[postgres@digoal ~]$ cd /data01/pgdata</font></div><div><font size="2"   >[postgres@digoal pgdata]$ touch nihao</font></div><div><font size="2"   >[postgres@digoal pgdata]$ rm nihao</font></div></div><p></p></pre></div><div><br></div><div>【参考】</div><div>1. ubuntu server guide.</div><wbr></div><div><br></div></div></div></div>
	</div>
</div>
</body>
</html>