<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL 9.3 regexp search use index scan attached in pg_trgm extension</h2>
	<h5 id="">2013-03-25 16:40:06&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020132254838733/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>pg_trgm是PostgreSQL的一个扩展插件, 可以用来做近似匹配的查询. 效率比模糊查询高很多. 有兴趣的朋友可以参考以下文章.</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201191882553803/"   >http://blog.163.com/digoal@126/blog/static/163877040201191882553803/</a></div><div>现在pg_trgm的作者在这个模块中加入了更强大的功能, 可以使规则表达式查询使用gin索引.</div><div>具体测试如下 :&nbsp;</div><div><br></div><div>1. 下载PostgreSQL</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >su - pgdev</font></div><div><font size="2"   >pgdev@db-172-16-3-150-&gt; wget --no-check-certificate https://github.com/postgres/postgres/archive/master.zip -O postgresql9.3.zip</font></div></div><div><font size="2"   >unzip&nbsp;<span style="line-height: 22px;"   >postgresql9.3.zip</span></font></div><p></p></pre></div><div><br></div><div>2. 下载补丁</div><div>去一下网站下载最新的补丁 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >http://www.postgresql.org/message-id/flat/5280.1364161844@sss.pgh.pa.us#5280.1364161844@sss.pgh.pa.us</font></div><div><font size="2"   >wget&nbsp;http://www.postgresql.org/message-id/attachment/28634/trgm-regexp-0.13.patch.gz</font></div><p></p></pre></div><div><br></div><div>3. 应用补丁</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >gunzip&nbsp;<span style="line-height: 22px;"   >trgm-regexp-0.13.patch.gz</span></font></div><div><font size="2"   ><span style="line-height: 22px;"   >mv&nbsp;</span>trgm-regexp-0.13.patch&nbsp;/home/pgdev/postgres-master</font></div><div><font size="2"   >cd&nbsp;<span style="line-height: 22px;"   >/home/pgdev/postgres-master</span></font></div><div><font size="2"   ><span style="line-height: 19px;"   >pgdev@db-172-16-3-150-&gt; patch -p1 &lt; trgm-regexp-0.13.patch <br>patching file contrib/pg_trgm/Makefile<br>patching file contrib/pg_trgm/expected/pg_trgm.out<br>patching file contrib/pg_trgm/pg_trgm--1.0--1.1.sql<br>patching file contrib/pg_trgm/pg_trgm--1.0.sql<br>patching file contrib/pg_trgm/pg_trgm--1.1.sql<br>patching file contrib/pg_trgm/pg_trgm.control<br>patching file contrib/pg_trgm/sql/pg_trgm.sql<br>patching file contrib/pg_trgm/trgm.h<br>patching file contrib/pg_trgm/trgm_gin.c<br>patching file contrib/pg_trgm/trgm_op.c<br>patching file contrib/pg_trgm/trgm_regexp.c<br>patching file doc/src/sgml/pgtrgm.sgml<br>patching file src/backend/regex/Makefile<br>patching file src/backend/regex/regextract.c<br>patching file src/backend/utils/adt/regexp.c<br>patching file src/backend/utils/adt/selfuncs.c<br>patching file src/include/mb/pg_wchar.h<br>patching file src/include/regex/regex.h<br>patching file src/include/regex/regextract.h<br>patching file src/include/regex/regguts.h</span></font></div><p></p></pre></div><div>如果没有报错则继续, 有报错的话需要手工修改一下reject的补丁文件.</div><div>当然, 当您看到此文的时候也许不需要打补丁了, 也许该补丁已经committed了.</div><div><br></div><div>4. 编译安装数据库软件</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pgdev@db-172-16-3-150-&gt; unzip postgresql9.3.zip</font></div><div><font size="2"   >pgdev@db-172-16-3-150-&gt; less .bash_profile</font></div><div><font size="2"   >export PS1="$USER@`/bin/hostname -s`-&gt; "</font></div><div><font size="2"   >export PGPORT=9300</font></div><div><font size="2"   >export PGUSER=postgres</font></div><div><font size="2"   >export PGDATA=/data06/pgdev/pg_root</font></div><div><font size="2"   >export LANG=en_US.utf8</font></div><div><font size="2"   >export PGHOME=/home/pgdev/pgsql9.3</font></div><div><font size="2"   >export PGHOST=127.0.0.1</font></div><div><font size="2"   >export PGDATABASE=digoal</font></div><div><font size="2"   >export LD_LIBRARY_PATH=/opt/uuid-1.6.2/lib:$PGHOME/lib:/lib64:/usr/lib64:/usr/local/lib64:/lib:/usr/lib:/usr/local/lib</font></div><div><font size="2"   >export DATE=`date +"%Y%m%d%H%M"`</font></div><div><font size="2"   >export PATH=$PGHOME/bin:$PATH:.</font></div><div><font size="2"   >export MANPATH=$PGHOME/share/man:$MANPATH</font></div><div><font size="2"   >alias rm='rm -i'</font></div><div><font size="2"   >alias ll='ls -lh'</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >su - root</font></div><div><font size="2"   >[root@db-172-16-3-150 ~]# . /home/pgdev/.bash_profile&nbsp;</font></div><div><font size="2"   >root@db-172-16-3-150-&gt; cd postgres-master/</font></div><div><font size="2"   >root@db-172-16-3-150-&gt; ./configure --prefix=/home/pgdev/pgsql9.3 --with-pgport=9300 --with-perl --with-python --with-tcl --with-openssl --with-pam --without-ldap --with-libxml --with-libxslt --enable-thread-safety --enable-cassert --with-wal-blocksize=16 --enable-debug &amp;&amp; gmake</font></div><div><font size="2"   >root@db-172-16-3-150-&gt; gmake install</font></div><div><font size="2"   >root@db-172-16-3-150-&gt; cd contrib/</font></div><div><font size="2"   >root@db-172-16-3-150-&gt; gmake install</font></div><p></p></pre></div><div><span style="line-height: 22px;"   >5. 初始化数据库</span></div><div><div style="line-height: 22px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 22px;"   ><font size="2"   >root@db-172-16-3-150-&gt; su - pgdev</font></div><div style="line-height: 22px;"   ><font size="2"   >pgdev@db-172-16-3-150-&gt; initdb -D $PGDATA --locale=C -E UTF8 -U postgres</font></div><div style="line-height: 22px;"   ><font size="2"   >pgdev@db-172-16-3-150-&gt; pg_ctl start</font></div><div style="line-height: 22px;"   ><font size="2"   >server starting</font></div><p></p></pre></div></div><div><span style="line-height: 22px;"   >6. 测试</span></div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >pgdev@db-172-16-3-150-&gt; psql</font></div><div><font size="2"   >psql (9.3devel)</font></div><div><font size="2"   >Type "help" for help.</font></div><div><font size="2"   ># 数据库编码以及collate如下</font></div><div><div style="line-height: 22px;"   ><font size="2"   >digoal=# \l</font></div><div style="line-height: 22px;"   ><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;List of databases</font></div><div style="line-height: 22px;"   ><font size="2"   >&nbsp; &nbsp;Name &nbsp; &nbsp;| &nbsp;Owner &nbsp; | Encoding | Collate | Ctype | &nbsp; Access privileges &nbsp;&nbsp;</font></div><div style="line-height: 22px;"   ><font size="2"   >-----------+----------+----------+---------+-------+-----------------------</font></div><div style="line-height: 22px;"   ><font size="2"   >&nbsp;digoal &nbsp; &nbsp;| postgres | UTF8 &nbsp; &nbsp; | C &nbsp; &nbsp; &nbsp; | C &nbsp; &nbsp; |&nbsp;</font></div><div style="line-height: 22px;"   ><font size="2"   >&nbsp;postgres &nbsp;| postgres | UTF8 &nbsp; &nbsp; | C &nbsp; &nbsp; &nbsp; | C &nbsp; &nbsp; |&nbsp;</font></div><div style="line-height: 22px;"   ><font size="2"   >&nbsp;template0 | postgres | UTF8 &nbsp; &nbsp; | C &nbsp; &nbsp; &nbsp; | C &nbsp; &nbsp; | =c/postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+</font></div><div style="line-height: 22px;"   ><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; | postgres=CTc/postgres</font></div><div style="line-height: 22px;"   ><font size="2"   >&nbsp;template1 | postgres | UTF8 &nbsp; &nbsp; | C &nbsp; &nbsp; &nbsp; | C &nbsp; &nbsp; | =c/postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+</font></div><div style="line-height: 22px;"   ><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; | postgres=CTc/postgres</font></div><div style="line-height: 22px;"   ><font size="2"   >(4 rows)</font></div></div><div style="line-height: 22px;"   ><font size="2"   ># 创建pg_trgm, extension&nbsp;</font></div><div><font size="2"   >digoal=# create extension pg_trgm;</font></div></div><div><font size="2"   ># 创建测试表</font></div><div><div><font size="2"   >digoal=# create table trgm_test(id int, info text, crt_time timestamp);</font></div><div><font size="2"   >CREATE TABLE</font></div><div><font size="2"   ># 插入测试数据</font></div><div><font size="2"   >digoal=# insert into trgm_test select generate_series(1,50000),md5(random()::text),clock_timestamp();</font></div><div><font size="2"   >INSERT 0 50000</font></div><div><font size="2"   ># 创建gin索引, 使用gin_trgm_ops class.</font></div><div><font size="2"   >digoal=# create index idx_trgm_test_1 on trgm_test using gin(info gin_trgm_ops);</font></div><div><font size="2"   >CREATE INDEX</font></div></div><div><font size="2"   ># 规则表达式查询, 走索引了, 需要20毫秒.</font></div><div><div><font size="2"   >digoal=# explain analyze select * from trgm_test where info ~ '01+[1-2]+[1-3]+[1-2]';</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;QUERY PLAN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >-----------------------------------------------------------------------------------------------------------------------------</font></div><div><font size="2"   >&nbsp;Bitmap Heap Scan on trgm_test &nbsp;(cost=352.04..370.55 rows=5 width=45) (actual time=20.239..20.443 rows=18 loops=1)</font></div><div><font size="2"   >&nbsp; &nbsp;Recheck Cond: (info ~ '01+[1-2]+[1-3]+[1-2]'::text)</font></div><div><font size="2"   >&nbsp; &nbsp;Rows Removed by Index Recheck: 22</font></div><div><font size="2"   >&nbsp; &nbsp;-&gt; &nbsp;Bitmap Index Scan on idx_trgm_test_1 &nbsp;(cost=0.00..352.04 rows=5 width=0) (actual time=20.192..20.192 rows=40 loops=1)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Index Cond: (info ~ '01+[1-2]+[1-3]+[1-2]'::text)</font></div><div><font size="2"   >&nbsp;Total runtime: 20.545 ms</font></div><div><font size="2"   >(6 rows)</font></div></div><div><font size="2"   ># 查询结果</font></div><div><div><font size="2"   >digoal=# select * from trgm_test where info ~ '01+[1-2]+[1-3]+[1-2]';</font></div><div><font size="2"   >&nbsp; id &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;crt_time &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >-------+----------------------------------+----------------------------</font></div><div><font size="2"   >&nbsp; 4369 | 91c64a176b01211b33726b7a4100d912 | 2013-03-25 16:25:09.837613</font></div><div><font size="2"   >&nbsp; 8465 | f94260123240be2554bba6798206c963 | 2013-03-25 16:25:09.867742</font></div><div><font size="2"   >&nbsp;11284 | ac56fed0da451bd051ec5c01211d08e7 | 2013-03-25 16:25:09.888348</font></div><div><font size="2"   >&nbsp;11300 | 61e3549df82ea901131d74b28294f59d | 2013-03-25 16:25:09.88846</font></div><div><font size="2"   >&nbsp;12202 | 75bbde63759ef6da01222e557d87cfdc | 2013-03-25 16:25:09.895056</font></div><div><font size="2"   >&nbsp;16881 | 7d691ca1dd540011220cf4029ea73c85 | 2013-03-25 16:25:09.937671</font></div><div><font size="2"   >&nbsp;19933 | e105501121e1398400002b7ff70a7369 | 2013-03-25 16:25:09.964563</font></div><div><font size="2"   >&nbsp;21462 | cfdaf07eefe414b1c01222bcc2c782bd | 2013-03-25 16:25:09.977906</font></div><div><font size="2"   >&nbsp;21792 | 461ca99f3bf733aa6e7deaf28901232d | 2013-03-25 16:25:09.98084</font></div><div><font size="2"   >&nbsp;24929 | f0f08af28201122dc5507e9b9b4ce791 | 2013-03-25 16:25:10.008475</font></div><div><font size="2"   >&nbsp;25644 | 8680bbd77ecfa27a0c740111285836ff | 2013-03-25 16:25:10.014714</font></div><div><font size="2"   >&nbsp;30171 | bb51e8a5cd3c27d337ec001132371790 | 2013-03-25 16:25:10.054527</font></div><div><font size="2"   >&nbsp;31430 | a4ecd84d2e5ad101211a1c408fdc05f2 | 2013-03-25 16:25:10.065567</font></div><div><font size="2"   >&nbsp;33981 | f21250cc9f0123105092e2a39fd9f574 | 2013-03-25 16:25:10.087895</font></div><div><font size="2"   >&nbsp;40919 | 61bd00112264a317202b71ba2a5e1d7b | 2013-03-25 16:25:10.142668</font></div><div><font size="2"   >&nbsp;42287 | 730121105a9390aa1ce7cdfeaf3dad4d | 2013-03-25 16:25:10.1527</font></div><div><font size="2"   >&nbsp;42994 | a7bc72101222da1e0ebfc45c7aa59321 | 2013-03-25 16:25:10.157871</font></div><div><font size="2"   >&nbsp;45679 | 034131800121261b2cbf2056d1d03a3d | 2013-03-25 16:25:10.177582</font></div><div><font size="2"   >(18 rows)</font></div></div><div><font size="2"   ># 删除索引</font></div><div><div><font size="2"   >digoal=# drop index idx_trgm_test_1 ;</font></div><div><font size="2"   >DROP INDEX</font></div></div><div><font size="2"   ># 全表扫描需要113毫秒</font></div><div><div><font size="2"   >digoal=# explain analyze select * from trgm_test where info ~ '01+[1-2]+[1-3]+[1-2]';</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; QUERY PLAN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >----------------------------------------------------------------------------------------------------------</font></div><div><font size="2"   >&nbsp;Seq Scan on trgm_test &nbsp;(cost=0.00..1093.00 rows=5 width=45) (actual time=9.887..113.151 rows=18 loops=1)</font></div><div><font size="2"   >&nbsp; &nbsp;Filter: (info ~ '01+[1-2]+[1-3]+[1-2]'::text)</font></div><div><font size="2"   >&nbsp; &nbsp;Rows Removed by Filter: 49982</font></div><div><font size="2"   >&nbsp;Total runtime: 113.189 ms</font></div><div><font size="2"   >(4 rows)</font></div><div><font size="2"   ># 查询结果一致</font></div><div><font size="2"   >digoal=# select * from trgm_test where info ~ '01+[1-2]+[1-3]+[1-2]';</font></div><div><font size="2"   >&nbsp; id &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;crt_time &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >-------+----------------------------------+----------------------------</font></div><div><font size="2"   >&nbsp; 4369 | 91c64a176b01211b33726b7a4100d912 | 2013-03-25 16:25:09.837613</font></div><div><font size="2"   >&nbsp; 8465 | f94260123240be2554bba6798206c963 | 2013-03-25 16:25:09.867742</font></div><div><font size="2"   >&nbsp;11284 | ac56fed0da451bd051ec5c01211d08e7 | 2013-03-25 16:25:09.888348</font></div><div><font size="2"   >&nbsp;11300 | 61e3549df82ea901131d74b28294f59d | 2013-03-25 16:25:09.88846</font></div><div><font size="2"   >&nbsp;12202 | 75bbde63759ef6da01222e557d87cfdc | 2013-03-25 16:25:09.895056</font></div><div><font size="2"   >&nbsp;16881 | 7d691ca1dd540011220cf4029ea73c85 | 2013-03-25 16:25:09.937671</font></div><div><font size="2"   >&nbsp;19933 | e105501121e1398400002b7ff70a7369 | 2013-03-25 16:25:09.964563</font></div><div><font size="2"   >&nbsp;21462 | cfdaf07eefe414b1c01222bcc2c782bd | 2013-03-25 16:25:09.977906</font></div><div><font size="2"   >&nbsp;21792 | 461ca99f3bf733aa6e7deaf28901232d | 2013-03-25 16:25:09.98084</font></div><div><font size="2"   >&nbsp;24929 | f0f08af28201122dc5507e9b9b4ce791 | 2013-03-25 16:25:10.008475</font></div><div><font size="2"   >&nbsp;25644 | 8680bbd77ecfa27a0c740111285836ff | 2013-03-25 16:25:10.014714</font></div><div><font size="2"   >&nbsp;30171 | bb51e8a5cd3c27d337ec001132371790 | 2013-03-25 16:25:10.054527</font></div><div><font size="2"   >&nbsp;31430 | a4ecd84d2e5ad101211a1c408fdc05f2 | 2013-03-25 16:25:10.065567</font></div><div><font size="2"   >&nbsp;33981 | f21250cc9f0123105092e2a39fd9f574 | 2013-03-25 16:25:10.087895</font></div><div><font size="2"   >&nbsp;40919 | 61bd00112264a317202b71ba2a5e1d7b | 2013-03-25 16:25:10.142668</font></div><div><font size="2"   >&nbsp;42287 | 730121105a9390aa1ce7cdfeaf3dad4d | 2013-03-25 16:25:10.1527</font></div><div><font size="2"   >&nbsp;42994 | a7bc72101222da1e0ebfc45c7aa59321 | 2013-03-25 16:25:10.157871</font></div><div><font size="2"   >&nbsp;45679 | 034131800121261b2cbf2056d1d03a3d | 2013-03-25 16:25:10.177582</font></div><div><font size="2"   >(18 rows)</font></div></div><p></p></pre></div><div><br></div><div>[注意]</div><div>1. 当前仅支持GIN索引, GIST索引的支持作者还在开发中.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >digoal=# create index idx_trgm_test_1 on trgm_test using gist(info gist_trgm_ops);</font></div><div><font size="2"   >CREATE INDEX</font></div><div><font size="2"   >digoal=# explain analyze select * from trgm_test where info ~ '01+[1-2]+[1-3]+[1-2]';</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; QUERY PLAN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >----------------------------------------------------------------------------------------------------------</font></div><div><font size="2"   >&nbsp;Seq Scan on trgm_test &nbsp;(cost=0.00..1093.00 rows=5 width=45) (actual time=9.852..113.573 rows=18 loops=1)</font></div><div><font size="2"   >&nbsp; &nbsp;Filter: (info ~ '01+[1-2]+[1-3]+[1-2]'::text)</font></div><div><font size="2"   >&nbsp; &nbsp;Rows Removed by Filter: 49982</font></div><div><font size="2"   >&nbsp;Total runtime: 113.613 ms</font></div><div><font size="2"   >(4 rows)</font></div><p></p></pre></div><div>2. 不是所有的字符集都支持, 以下字符集不在支持的行列. 所以本文的测试是在UTF-8下做的.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; While I've hardcoded some dirty solution. So</font></div><div><font size="2"   >&gt; PG_EUC_JP, PG_EUC_CN, PG_EUC_KR, PG_EUC_TW, PG_EUC_JIS_2004 are not</font></div><div><font size="2"   >&gt; supported yet.</font></div><p></p></pre></div><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 22px;" target="_blank" rel="nofollow" href="https://commitfest.postgresql.org/action/patch_view?id=1000"   >https://commitfest.postgresql.org/action/patch_view?id=1000</a></div><div>2.&nbsp;<a style="line-height: 22px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201191882553803/"   >http://blog.163.com/digoal@126/blog/static/163877040201191882553803/</a></div><div>3.&nbsp;<a style="line-height: 22px;" target="_blank" rel="nofollow" href="http://www.postgresql.org/docs/9.2/static/pgtrgm.html"   >http://www.postgresql.org/docs/9.2/static/pgtrgm.html</a></div></div>
	</div>
</div>
</body>
</html>