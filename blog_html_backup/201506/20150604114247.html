<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL zhparser & english parser, query, insert performance</h2>
	<h5 id="">2015-06-04 11:42:47&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020155495754979/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>本文主要测试一下PostgreSQL 中英文分词的性能，以及带索引的情况下的插入，查询性能。</div><div>测试环境：</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >CPU：Intel(R) Xeon(R) CPU &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X7460 &nbsp;@ 2.66GHz</font></div><div><font size="2"   >MEM：60G</font></div><div><font size="2"   >OS：CentOS 6.x x64</font></div><div><font size="2"   >PostgreSQL 9.4.1</font></div><p></p></pre></div><div>中文分词使用&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201422410175698/"   >http://blog.163.com/digoal@126/blog/static/163877040201422410175698/</a></div><div><br></div><div>性能数据汇总：</div><div><span style="line-height: 28px;"   >英语分词性能：~ 900万 words每秒 ( Intel(R) Xeon(R) CPU &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X7460 &nbsp;@ 2.66GHz )</span></div><div><span style="line-height: 28px;"   >中文分词性能：~ 400万 字每秒 ( Intel(R) Xeon(R) CPU &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X7460 &nbsp;@ 2.66GHz )</span></div><div><span style="line-height: 28px;"   >英文分词+插入性能：~ 666万 字每秒 ( Intel(R) Xeon(R) CPU &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X7460 &nbsp;@ 2.66GHz )</span></div><div><span style="line-height: 28px;"   >中文分词+插入性能：~ 290万 字每秒 ( Intel(R) Xeon(R) CPU &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X7460 &nbsp;@ 2.66GHz )</span></div><div>查询性能和查询条件，数据量都有关系，没有很好的评估标准，大多数查询可以在毫秒级返回。</div><div><span style="line-height: 28px;"   ><br></span></div><div>分词性能测试过程如下：</div><div>为了测试效果，首先要修改to_tsvector的函数稳定性，避免一次计算多次调用。</div><div>对稳定性不了解的话，介绍请参考我以前写的文章或视频。</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >digoal=&gt; \df+ to_tsvector</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List of functions</font></div><div><font size="2"   >&nbsp; &nbsp;Schema &nbsp; | &nbsp; &nbsp;Name &nbsp; &nbsp; | Result data type | Argument data types | &nbsp;Type &nbsp;| Security | Volatility | &nbsp;Owner &nbsp; | Language | &nbsp; Source</font></div><div><font size="2"   >&nbsp;code &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp;Description &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >------------+-------------+------------------+---------------------+--------+----------+------------+----------+----------+---------</font></div><div><font size="2"   >---------+-----------------------</font></div><div><font size="2"   >&nbsp;pg_catalog | to_tsvector | tsvector &nbsp; &nbsp; &nbsp; &nbsp; | regconfig, text &nbsp; &nbsp; | normal | invoker &nbsp;| immutable &nbsp;| postgres | internal | to_tsvec</font></div><div><font size="2"   >tor_byid | transform to tsvector</font></div><div><font size="2"   >&nbsp;pg_catalog | to_tsvector | tsvector &nbsp; &nbsp; &nbsp; &nbsp; | text &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| normal | invoker &nbsp;| stable &nbsp; &nbsp; | postgres | internal | to_tsvec</font></div><div><font size="2"   >tor &nbsp; &nbsp; &nbsp;| transform to tsvector</font></div><div><font size="2"   >(2 rows)</font></div></div><div><div><font size="2"   >digoal=# alter function to_tsvector(regconfig,text) stable;</font></div><div><font size="2"   >ALTER FUNCTION</font></div><div><font size="2"   >Time: 0.632 ms</font></div></div><p></p></pre></div><div><br></div><div>创建英语和中文的测试函数：</div><div>英文272个单词，中文包含291个字或单词.</div><div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >create or replace function f_testts_en() returns void as $$</font></div><div><font size="2"   >declare</font></div><div><font size="2"   >begin</font></div><div><font size="2"   >perform to_tsvector('english', 'Before you can use PostgreSQL you need to install it, of course. It is possible that PostgreSQL is already installed at your site, either because it was included in your operating system distribution or because the system administrator already installed it. If that is the case, you should obtain information from the operating system documentation or your system administrator about how to access PostgreSQL.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >If you are not sure whether PostgreSQL is already available or whether you can use it for your experimentation then you can install it yourself. Doing so is not hard and it can be a good exercise. PostgreSQL can be installed by any unprivileged user; no superuser (root) access is required.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >If you are installing PostgreSQL yourself, then refer to Chapter 15 for instructions on installation, and return to this guide when the installation is complete. Be sure to follow closely the section about setting up the appropriate environment variables.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >If your site administrator has not set things up in the default way, you might have some more work to do. For example, if the database server machine is a remote machine, you will need to set the PGHOST environment variable to the name of the database server machine. The environment variable PGPORT might also have to be set. The bottom line is this: if you try to start an application program and it complains that it cannot connect to the database, you should consult your site administrator or, if that is you, the documentation to make sure that your environment is properly set up. If you did not understand the preceding paragraph then read the next section.');</font></div><div><font size="2"   >return;</font></div><div><font size="2"   >end;</font></div><div><font size="2"   >$$ language plpgsql strict;</font></div><p></p></pre></div><div><br></div><div>分词结果：</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&nbsp;'15':126 'access':63,113 'administr':38,59,158,242 'alreadi':19,39,73 'also':209 'applic':225 'appropri':152 'avail':74 'bottom':21</font></div><div><font size="2"   >5 'cannot':232 'case':46 'chapter':125 'close':145 'complain':229 'complet':140 'connect':233 'consult':239 'cours':12 'databas':180</font></div><div><font size="2"   >,201,236 'default':166 'distribut':33 'document':55,249 'either':24 'environ':153,194,205,255 'exampl':177 'exercis':101 'experiment</font></div><div><font size="2"   >':83 'follow':144 'good':100 'guid':135 'hard':94 'includ':28 'inform':50 'instal':9,20,40,87,105,119,130,138 'instruct':128 'line':</font></div><div><font size="2"   >216 'machin':182,186,203 'make':251 'might':169,208 'name':198 'need':7,189 'next':271 'obtain':49 'oper':31,53 'paragraph':267 'pgh</font></div><div><font size="2"   >ost':193 'pgport':207 'possibl':15 'postgresql':5,17,64,71,102,120 'preced':266 'program':226 'proper':257 'read':269 'refer':123 'r</font></div><div><font size="2"   >emot':185 'requir':115 'return':132 'root':112 'section':147,272 'server':181,202 'set':149,161,191,213,258 'site':23,157,241 'start</font></div><div><font size="2"   >':223 'superus':111 'sure':69,142,252 'system':32,37,54,58 'thing':162 'tri':221 'understand':264 'unprivileg':108 'use':4,79 'user'</font></div><div><font size="2"   >:109 'variabl':154,195,206 'way':167 'whether':70,76 'work':173</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><div><br></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >create or replace function f_testts_zh() returns void as $$</font></div><div><font size="2"   >declare</font></div><div><span style="line-height: 28px;"   ><font size="2"   >begin</font></span></div><div><font size="2"   >perform to_tsvector('testzhcfg','</font></div><div><font size="2"   >&lt;PostgreSQL发展历程,社区介绍,资源介绍 2小时&gt;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&lt;PostgreSQL SQL基础 2天&gt;</font></div><div><font size="2"   >第一天</font></div><div><font size="2"   >&nbsp; PostgreSQL的安装, 架构基础介绍, 如何创建和访问数据库;</font></div><div><font size="2"   >&nbsp; SQL语言基础(创建表, 操作表数据, 表关联查询, 聚合查询);</font></div><div><font size="2"   >&nbsp; SQL高级应用(视图, 外键, 事务, 窗口函数, 继承);</font></div><div><font size="2"   >&nbsp; SQL语义结构介绍(关键字, 常量, 操作符, 特殊字符, 注释, 操作符的优先级);</font></div><div><font size="2"   >&nbsp; 值表达式介绍(列, 位置参数, 数组下标, field引用, 操作符调用, 函数调用, 聚合表达式, 窗口函数调用, 类型转换, collate表达式, 标量子查询, 数组构造器, 行构造器, 表达式逻辑运算规则);</font></div><div><font size="2"   >&nbsp; 函数调用用法介绍(位置参数调用, 命名参数调用, 混合调用);</font></div><div><font size="2"   >&nbsp; 数据定义(默认值, 约束, 系统列, 表结构和定义修改, 权限, schema, 继承, 分区, 外部数据);</font></div><div><font size="2"   >第二天</font></div><div><font size="2"   >&nbsp; 数据查询(from子句, where子句, group by having子句, 窗口子句, select子句, 结果集合操作, 排序, 限制, 位移, values子句, CET用法);</font></div><div><font size="2"   >&nbsp; 数据类型(数字, 货币, 字符, 字节, 时间, 布尔, 枚举, 几何, 网络, 比特, 文本搜索, UUID, XML, JSON, 数组, 复合类型, 范围类型, 对象类型, 伪类型);</font></div><div><font size="2"   >&nbsp; 函数与操作符(逻辑, 比较, 数学运算, 字符串, 字节流, 比特位, 样式匹配, 格式化, 时间, 枚举, 几何, 网络, 全文检索, XML, JSON, 序列, 条件, 数组, 范围, 聚合, 窗口, 子查询, 行与数组的比较, SRF函数, 系统信息函数, 系统管理函数, 触发器函数, 事件触发器函数);</font></div><div><font size="2"   >&nbsp; 类型转换;</font></div><div><font size="2"   >&nbsp; 索引用法;</font></div><div><font size="2"   >&nbsp; 全文检索用法;</font></div><div><font size="2"   >&nbsp; 并行控制;</font></div><div><font size="2"   >&nbsp; SQL性能优化;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&lt;PostgreSQL 数据库管理 3天&gt;</font></div><div><font size="2"   >第一天</font></div><div><font size="2"   >&nbsp; PostgreSQL源代码安装(源码结构介绍, 配置介绍, 自定义FLAG介绍, 内核参数优化, 安装);</font></div><div><font size="2"   >&nbsp; 数据库服务器配置(OS USER, 初始化集群, 启动数据库集群, 关闭数据库集群, 升级数据库软件, 防止欺骗, 数据封装方法, SSL, SSH隧道)</font></div><div><font size="2"   >&nbsp; 数据库集群进程结构介绍(postmaster, logger, checkpointer, writer, wal writer, autovacuum launcher, autovacuum worker, stats collector, backend, worker);</font></div><div><font size="2"   >&nbsp; 认证和连接(客户端认证方法介绍, 认证配置, 常用认证方法使用举例, 常见认证错误排错);</font></div><div><font size="2"   >&nbsp; pgAdmin III 使用介绍(安装, 使用, 调试函数, 维护数据);</font></div><div><font size="2"   >&nbsp; 数据库配置(guc.c, 参数优先级, 参数含义, 开发参数, guc隐含参数, 如何修改参数并使之生效, 如何查看当前参数值, 如何查看参数值的范围);</font></div><div><font size="2"   >&nbsp; 用户管理(创建角色, 角色权限管理, 角色membership管理, 角色成员权限管理);</font></div><div><font size="2"   >&nbsp; 数据库逻辑结构(cluster, database, schema, object, field, access privilege);</font></div><div><font size="2"   >&nbsp; 数据库物理结构(tablespace, datafile, segment, block, controlfile, xlog, archivelog);</font></div><div><font size="2"   >第二天</font></div><div><font size="2"   >&nbsp; 数据库管理(创建表空间, 创建数据库, 创建数据库模板, 数据库配置, 删除数据库, 跨数据库的数据访问);</font></div><div><font size="2"   >&nbsp; 基于角色的对象权限管理(表, 列, 序列, 数据库, 域, 外部数据, 函数, 语言, 大对象, schema, 表空间, 类型);</font></div><div><font size="2"   >&nbsp; 默认权限和继承权限(default privilege, inherit privilege);</font></div><div><font size="2"   >&nbsp; 数据库安全(认证, 网络, 数据存储, 密码, 注入, 欺骗);</font></div><div><font size="2"   >&nbsp; 数据库监控(状态监控, 趋势监控, 预警, 常用监控工具和插件nagios, zabbix, pg_statsinfo);</font></div><div><font size="2"   >&nbsp; 多版本并发控制和垃圾回收;</font></div><div><font size="2"   >&nbsp; 日常维护(垃圾回收, 数据重组, 索引维护, VM维护, 预防XID溢出, 日志维护);</font></div><div><font size="2"   >第三天</font></div><div><font size="2"   >&nbsp; 数据迁移(逻辑备份和还原, 增量数据迁移的方法, 异构数据迁移的方法(如oracle to postgresql));</font></div><div><font size="2"   >&nbsp; 如何打数据库补丁;</font></div><div><font size="2"   >&nbsp; 数据库版本升级(小版本升级方法, 大版本升级方法);</font></div><div><font size="2"   >&nbsp; 建模与Benchmark(如何根据业务形态建立数据库测试模型, 测试工具的使用, 根据测试模型和硬件标准输出benchmark);</font></div><div><font size="2"   >&nbsp; 数据库日志分析(错误代码介绍, 日志的筛选过滤, 日志的维护);</font></div><div><font size="2"   >&nbsp; 数据库审计(参数层面的审计开关, 定制化审计(如触发器结合HSTORE), 审计数据的维护手段);</font></div><div><font size="2"   >&nbsp; 本地化(字符集, collate, 编码转换, 如何防止乱码);</font></div><div><font size="2"   >&nbsp; 数据库性能分析(OS性能分析报表, SQL性能分析报表);</font></div><div><font size="2"   >&nbsp; 数据库巡检(如何定制巡检项, 指标, 如何分析巡检报告);');</font></div><div><span style="line-height: 28px;"   ><font size="2"   >return;</font></span></div><div><font size="2"   >end;</font></div><div><font size="2"   >$$ language plpgsql strict;</font></div><p></p></pre></div></div><div><br></div><div>分词结果：</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >'access':352 'archivelog':363 'autovacuum':271,273 'backend':277 'benchmark':486,500 'block':360 'by':123 'c':309 'cet':137 'checkp</font></div><div><font size="2"   >ointer':267 'cluster':347 'collate':75,530 'collector':276 'controlfile':361 'database':348 'datafile':358 'default':405 'field':63,</font></div><div><font size="2"   >351 'flag':230 'from':118 'group':122 'guc':308,316 'having':124 'hstore':523 'iii':297 'inherit':407 'json':154,181 'launcher':272&nbsp;</font></div><div><font size="2"   >'logger':266 'membership':338 'nagios':429 'object':350 'oracle':468 'os':239,537 'pg_statsinfo':431 'pgadmin':296 'postgresql':1,9,</font></div><div><font size="2"   >15,215,221,470 'postmaster':265 'privilege':353,406,408 'schema':112,349,397 'segment':359 'select':127 'sql':10,23,35,43,212,540 's</font></div><div><font size="2"   >rf':191 'ssh':258 'ssl':257 'stats':275 'tablespace':357 'to':469 'user':240 'uuid':152 'values':135 'vm':444 'wal':269 'where':120&nbsp;</font></div><div><font size="2"   >'worker':274,278 'writer':268,270 'xid':447 'xlog':362 'xml':153,180 'zabbix':430 '下标':62 '业务':487 '举例':291 '乱码':534 '事件':</font></div><div><font size="2"   >201 '事务':40 '二天':116,364 '介绍':5,7,19,46,57,91,226,228,231,264,284,299,506 '代码':505 '优先级':54,311 '优化':214,234 '位移':134</font></div><div><font size="2"   >&nbsp;'位置':59,92 '使':321 '使用':290,298,301,494 '信息':194 '修改':110,319 '值':55,103,325,328 '全文检索':179,208 '关联':31 '关键字':47</font></div><div><font size="2"   >&nbsp;'关闭':246 '内核':232 '几何':148,177 '函数':41,67,71,88,163,192,195,198,200,203,303,393 '分区':114 '分析':503,548 '列':58,106,388 '</font></div><div><font size="2"   >创建':20,25,332,367,370,372 '初始化':241 '删除':377 '匹配':173 '升级':249,476,479,483 '历程':3 '参数':60,93,96,233,310,312,315,318,3</font></div><div><font size="2"   >20,324,327,514 '发展':2 '含义':313 '启动':243 '命名':95 '回收':436,439 '垃圾':435,438 '域':391 '基础':11,18 '增量':458 '备份':456 '</font></div><div><font size="2"   >合':156 '大':395,481 '天':12,14,218,220,452 '如':467,520 '子句':119,121,125,126,128,136 '字':170 '字符':51,143 '字符串':169 '字符集'</font></div><div><font size="2"   >:529 '字节':144 '存储':414 '安全':410 '安装':16,223,235,300 '定义':101,109,229 '定制':518,545 '审计':513,516,519,524 '客户端':281 '</font></div><div><font size="2"   >码':415 '对象':160,384,396 '封装':255 '小':477 '小时':8 '层面':515 '巡检':544,546,549 '工具':427 '布尔':146 '常用':287,425 '常见':29</font></div><div><font size="2"   >2 '常量':48 '并发':433 '并行':210 '序列':182,389 '应用':37 '建模':485 '建立':489 '开关':517 '开发':314 '异':462 '引用':64 '形态':488</font></div><div><font size="2"   >&nbsp;'性能':213 '性能分析':536,538,541 '成员':341 '手段':527 '打':471 '报告':550 '报表':539,542 '指标':547 '排序':132 '排错':295 '控制':</font></div><div><font size="2"   >211,434 '插件':428 '搜索':151 '操作':27,131 '操作符':49,53,65,164 '数字':141 '数学':167 '数据':29,100,115,139,254,305,381,392,413,44</font></div><div><font size="2"   >0,453,459,464,525 '数据库':22,216,236,244,247,250,260,306,344,354,365,371,373,375,378,380,390,409,418,472,474,490,501,512,535,543 '</font></div><div><font size="2"   >据查询':117 '数组':61,80,155,184,189 '文本':150 '方法':256,283,289,461,466,480,484 '日志':449,502,507,510 '时间':145,175 '服务器':23</font></div><div><font size="2"   >7 '本地化':528 '权限':111,335,342,385,402,404 '条件':183 '构':463 '构造器':81,83 '枚举':147,176 '架构':17 '查看':323,326 '查询':32,3</font></div><div><font size="2"   >4,79,187 '标':77 '标准':498 '样式':172 '格式化':174 '模型':492,496 '模板':374 '欺骗':253,417 '比较':166,190 '注入':416 '注释':52 '测</font></div><div><font size="2"   >试':491,495 '测试工具':493 '混合':98 '源代码':222 '源码':224 '溢出':448 '版本':432,475,478,482 '物理':355 '特殊':50 '状态':420 '生效</font></div><div><font size="2"   >':322 '用户':330 '用法':90,138,207,209 '监控':419,421,423,426 '硬件':497 '社区':4 '空间':369,399 '第一':13,219 '第三':451 '筛选':508</font></div><div><font size="2"   >&nbsp;'管理':197,217,331,336,339,343,366,386 '类型':73,140,157,159,161,162,204,400 '系统':105,193,196 '索引':206,442 '约束':104 '结合':52</font></div><div><font size="2"   >2 '结构':45,108,225,263,346,356 '结果':129 '继承':42,113,403 '维护':304,437,443,445,450,511,526 '编码':531 '网络':149,178,412 '聚合'</font></div><div><font size="2"   >:33,69,186 '节流':171 '范围':158,185,329 '行':82,188 '补丁':473 '表':26,28,30,107,368,387,398 '表达式':56,70,76,84 '规则':87 '视图':</font></div><div><font size="2"   >38 '角色':333,334,337,340,383 '触发器':199,202,521 '认证':279,282,285,288,293,411 '访问':21,382 '语义':44 '语言':394 '语言基础':24 '</font></div><div><font size="2"   >调用':66,68,72,89,94,97,99 '调试':302 '货币':142 '资源':6 '趋势':422 '跨':379 '转换':74,205,532 '软件':251 '输出':499 '迁移':454,460</font></div><div><font size="2"   >,465 '过滤':509 '运算':86,168 '还原':457 '进程':262 '连接':280 '逻辑':85,165,345,455 '配置':227,238,286,307,376 '重组':441 '量子':78</font></div><div><font size="2"   >&nbsp;'错误':294,504 '键':39 '防止':252,533 '限制':133 '隐含':317 '隧道':259 '集合':130 '集群':242,245,248,261 '预警':424 '预防':446 '高</font></div><div><font size="2"   >':36 '默认':102,401</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><div><br></div><div>英文分词性能测试结果：</div><div><div>英语分词性能：~ 900万 words每秒 ( Intel(R) Xeon(R) CPU &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X7460 &nbsp;@ 2.66GHz )</div></div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >postgres@db-192-168-173-33-&gt; vi test.sql</font></div><div><font size="2"   >select f_testts_en();</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >postgres@db-192-168-173-33-&gt; pgbench -M prepared -n -f test.sql -P 5 -c 36 -j 36 -T 30000000</font></div><div><font size="2"   >progress: 5.0 s, 33072.6 tps, lat 1.083 ms stddev 0.371</font></div><div><font size="2"   >progress: 10.0 s, 33218.9 tps, lat 1.082 ms stddev 0.366</font></div><div><font size="2"   >progress: 15.0 s, 33213.4 tps, lat 1.083 ms stddev 0.365</font></div><div><font size="2"   >progress: 20.0 s, 33202.3 tps, lat 1.083 ms stddev 0.364</font></div><div><font size="2"   >progress: 25.0 s, 33204.5 tps, lat 1.083 ms stddev 0.364</font></div><div><font size="2"   >progress: 30.0 s, 33215.0 tps, lat 1.083 ms stddev 0.366</font></div><div><font size="2"   >progress: 35.0 s, 33220.8 tps, lat 1.082 ms stddev 0.367</font></div><div><font size="2"   >progress: 40.0 s, 33210.7 tps, lat 1.083 ms stddev 0.364</font></div><div><font size="2"   >progress: 45.0 s, 33220.4 tps, lat 1.082 ms stddev 0.365</font></div><div><font size="2"   >progress: 50.0 s, 33217.2 tps, lat 1.083 ms stddev 0.365</font></div><div><font size="2"   >progress: 55.0 s, 33231.6 tps, lat 1.082 ms stddev 0.367</font></div><div><font size="2"   >progress: 60.0 s, 33234.4 tps, lat 1.082 ms stddev 0.367</font></div><div><font size="2"   >progress: 65.0 s, 33232.7 tps, lat 1.082 ms stddev 0.367</font></div><div><font size="2"   >progress: 70.0 s, 33212.2 tps, lat 1.083 ms stddev 0.369</font></div><div><font size="2"   >progress: 75.0 s, 33232.4 tps, lat 1.082 ms stddev 0.367</font></div><div><font size="2"   >progress: 80.0 s, 33222.7 tps, lat 1.082 ms stddev 0.367</font></div><div><font size="2"   >progress: 85.0 s, 33221.1 tps, lat 1.082 ms stddev 0.365</font></div><div><font size="2"   >progress: 90.0 s, 33220.4 tps, lat 1.082 ms stddev 0.365</font></div><div><font size="2"   >progress: 95.0 s, 33213.6 tps, lat 1.083 ms stddev 0.364</font></div><div><font size="2"   >progress: 100.0 s, 33227.5 tps, lat 1.082 ms stddev 0.368</font></div><div><font size="2"   >progress: 105.0 s, 33230.8 tps, lat 1.082 ms stddev 0.366</font></div><div><font size="2"   >progress: 110.0 s, 33228.1 tps, lat 1.082 ms stddev 0.366</font></div></div><p></p></pre></div><div><br></div><div><div style="line-height: 28px;"   >中文分词性能测试结果：</div><div>中文分词性能：~ 400万 字每秒 ( Intel(R) Xeon(R) CPU &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X7460 &nbsp;@ 2.66GHz )</div><div><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >postgres@db-192-168-173-33-&gt; vi test.sql</font></div><div style="line-height: 28px;"   ><font size="2"   >select f_testts_zh();</font></div><div style="line-height: 28px;"   ><font size="2"   ><br></font></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >postgres@db-192-168-173-33-&gt; pgbench -M prepared -n -f test.sql -P 5 -c 36 -j 36 -T 30000000</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 5.0 s, 13874.6 tps, lat 2.582 ms stddev 0.892</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 10.0 s, 13947.0 tps, lat 2.580 ms stddev 0.875</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 15.0 s, 13949.0 tps, lat 2.580 ms stddev 0.874</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 20.0 s, 13950.1 tps, lat 2.579 ms stddev 0.871</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 25.0 s, 13951.1 tps, lat 2.579 ms stddev 0.876</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 30.0 s, 13950.6 tps, lat 2.579 ms stddev 0.873</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 35.0 s, 13950.5 tps, lat 2.579 ms stddev 0.877</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 40.0 s, 13951.8 tps, lat 2.579 ms stddev 0.876</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 45.0 s, 13953.2 tps, lat 2.579 ms stddev 0.878</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 50.0 s, 13949.9 tps, lat 2.579 ms stddev 0.876</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 55.0 s, 13947.4 tps, lat 2.580 ms stddev 0.875</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 60.0 s, 13947.8 tps, lat 2.580 ms stddev 0.877</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 65.0 s, 13948.4 tps, lat 2.580 ms stddev 0.877</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 70.0 s, 13952.1 tps, lat 2.579 ms stddev 0.878</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 75.0 s, 13948.1 tps, lat 2.580 ms stddev 0.877</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 80.0 s, 13950.3 tps, lat 2.579 ms stddev 0.875</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 85.0 s, 13951.3 tps, lat 2.579 ms stddev 0.875</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 90.0 s, 13950.9 tps, lat 2.579 ms stddev 0.879</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 95.0 s, 13949.6 tps, lat 2.579 ms stddev 0.876</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 100.0 s, 13950.1 tps, lat 2.579 ms stddev 0.876</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 105.0 s, 13951.9 tps, lat 2.579 ms stddev 0.874</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 110.0 s, 13950.7 tps, lat 2.579 ms stddev 0.878</font></div></div><p></p></pre></div><div style="line-height: 28px;"   ><br></div><div style="line-height: 28px;"   >分词+插入性能测试：</div><div style="line-height: 28px;"   >使用gist或gin索引，索引的适用场景和优化手段可以参考我以前写的文章。</div><div style="line-height: 28px;"   >(静态数据考虑GIN，动态数据考虑GIST，GIN可以通过增加WORK_MEM优化动态性能)。</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >digoal=&gt; create table test_ts(ts tsvector);</font></div><div><font size="2"   >CREATE TABLE</font></div><div><font size="2"   >digoal=&gt; create index idx_test_ts on test_ts using gist(ts);</font></div><div><font size="2"   >CREATE INDEX</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >create or replace function f_testts_en() returns void as $$</font></div><div><font size="2"   >declare</font></div><div><font size="2"   >begin</font></div><div><font size="2"   >insert into test_ts values (to_tsvector('Before you can use PostgreSQL you need to install it, of course. It is possible that PostgreSQL is already installed at your site, either because it was included in your operating system distribution or because the system administrator already installed it. If that is the case, you should obtain information from the operating system documentation or your system administrator about how to access PostgreSQL.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >If you are not sure whether PostgreSQL is already available or whether you can use it for your experimentation then you can install it yourself. Doing so is not hard and it can be a good exercise. PostgreSQL can be installed by any unprivileged user; no superuser (root) access is required.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >If you are installing PostgreSQL yourself, then refer to Chapter 15 for instructions on installation, and return to this guide when the installation is complete. Be sure to follow closely the section about setting up the appropriate environment variables.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >If your site administrator has not set things up in the default way, you might have some more work to do. For example, if the database server machine is a remote machine, you will need to set the PGHOST environment variable to the name of the database server machine. The environment variable PGPORT might also have to be set. The bottom line is this: if you try to start an application program and it complains that it cannot connect to the database, you should consult your site administrator or, if that is you, the documentation to make sure that your environment is properly set up. If you did not understand the preceding paragraph then read the next section.'));</font></div><div><font size="2"   >return;</font></div><div><font size="2"   >end;</font></div><div><font size="2"   >$$ language plpgsql strict;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >create or replace function f_testts_zh() returns void as $$</font></div><div><font size="2"   >declare</font></div><div><span style="line-height: 21px; font-size: small; font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, 宋体;"   >begin</span></div><div><font size="2"   >insert into test_ts values ( to_tsvector('testzhcfg','</font></div><div><font size="2"   >&lt;PostgreSQL发展历程,社区介绍,资源介绍 2小时&gt;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&lt;PostgreSQL SQL基础 2天&gt;</font></div><div><font size="2"   >第一天</font></div><div><font size="2"   >&nbsp; PostgreSQL的安装, 架构基础介绍, 如何创建和访问数据库;</font></div><div><font size="2"   >&nbsp; SQL语言基础(创建表, 操作表数据, 表关联查询, 聚合查询);</font></div><div><font size="2"   >&nbsp; SQL高级应用(视图, 外键, 事务, 窗口函数, 继承);</font></div><div><font size="2"   >&nbsp; SQL语义结构介绍(关键字, 常量, 操作符, 特殊字符, 注释, 操作符的优先级);</font></div><div><font size="2"   >&nbsp; 值表达式介绍(列, 位置参数, 数组下标, field引用, 操作符调用, 函数调用, 聚合表达式, 窗口函数调用, 类型转换, collate表达式, 标量子查询, 数组构造器, 行构造器, 表达式逻辑运算规则);</font></div><div><font size="2"   >&nbsp; 函数调用用法介绍(位置参数调用, 命名参数调用, 混合调用);</font></div><div><font size="2"   >&nbsp; 数据定义(默认值, 约束, 系统列, 表结构和定义修改, 权限, schema, 继承, 分区, 外部数据);</font></div><div><font size="2"   >第二天</font></div><div><font size="2"   >&nbsp; 数据查询(from子句, where子句, group by having子句, 窗口子句, select子句, 结果集合操作, 排序, 限制, 位移, values子句, CET用法);</font></div><div><font size="2"   >&nbsp; 数据类型(数字, 货币, 字符, 字节, 时间, 布尔, 枚举, 几何, 网络, 比特, 文本搜索, UUID, XML, JSON, 数组, 复合类型, 范围类型, 对象类型, 伪类型);</font></div><div><font size="2"   >&nbsp; 函数与操作符(逻辑, 比较, 数学运算, 字符串, 字节流, 比特位, 样式匹配, 格式化, 时间, 枚举, 几何, 网络, 全文检索, XML, JSON, 序列, 条件, 数组, 范围, 聚合, 窗口, 子查询, 行与数组的比较, SRF函数, 系统信息函数, 系统管理函数, 触发器函数, 事件触发器函数);</font></div><div><font size="2"   >&nbsp; 类型转换;</font></div><div><font size="2"   >&nbsp; 索引用法;</font></div><div><font size="2"   >&nbsp; 全文检索用法;</font></div><div><font size="2"   >&nbsp; 并行控制;</font></div><div><font size="2"   >&nbsp; SQL性能优化;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&lt;PostgreSQL 数据库管理 3天&gt;</font></div><div><font size="2"   >第一天</font></div><div><font size="2"   >&nbsp; PostgreSQL源代码安装(源码结构介绍, 配置介绍, 自定义FLAG介绍, 内核参数优化, 安装);</font></div><div><font size="2"   >&nbsp; 数据库服务器配置(OS USER, 初始化集群, 启动数据库集群, 关闭数据库集群, 升级数据库软件, 防止欺骗, 数据封装方法, SSL, SSH隧道)</font></div><div><font size="2"   >&nbsp; 数据库集群进程结构介绍(postmaster, logger, checkpointer, writer, wal writer, autovacuum launcher, autovacuum worker, stats collector, backend, worker);</font></div><div><font size="2"   >&nbsp; 认证和连接(客户端认证方法介绍, 认证配置, 常用认证方法使用举例, 常见认证错误排错);</font></div><div><font size="2"   >&nbsp; pgAdmin III 使用介绍(安装, 使用, 调试函数, 维护数据);</font></div><div><font size="2"   >&nbsp; 数据库配置(guc.c, 参数优先级, 参数含义, 开发参数, guc隐含参数, 如何修改参数并使之生效, 如何查看当前参数值, 如何查看参数值的范围);</font></div><div><font size="2"   >&nbsp; 用户管理(创建角色, 角色权限管理, 角色membership管理, 角色成员权限管理);</font></div><div><font size="2"   >&nbsp; 数据库逻辑结构(cluster, database, schema, object, field, access privilege);</font></div><div><font size="2"   >&nbsp; 数据库物理结构(tablespace, datafile, segment, block, controlfile, xlog, archivelog);</font></div><div><font size="2"   >第二天</font></div><div><font size="2"   >&nbsp; 数据库管理(创建表空间, 创建数据库, 创建数据库模板, 数据库配置, 删除数据库, 跨数据库的数据访问);</font></div><div><font size="2"   >&nbsp; 基于角色的对象权限管理(表, 列, 序列, 数据库, 域, 外部数据, 函数, 语言, 大对象, schema, 表空间, 类型);</font></div><div><font size="2"   >&nbsp; 默认权限和继承权限(default privilege, inherit privilege);</font></div><div><font size="2"   >&nbsp; 数据库安全(认证, 网络, 数据存储, 密码, 注入, 欺骗);</font></div><div><font size="2"   >&nbsp; 数据库监控(状态监控, 趋势监控, 预警, 常用监控工具和插件nagios, zabbix, pg_statsinfo);</font></div><div><font size="2"   >&nbsp; 多版本并发控制和垃圾回收;</font></div><div><font size="2"   >&nbsp; 日常维护(垃圾回收, 数据重组, 索引维护, VM维护, 预防XID溢出, 日志维护);</font></div><div><font size="2"   >第三天</font></div><div><font size="2"   >&nbsp; 数据迁移(逻辑备份和还原, 增量数据迁移的方法, 异构数据迁移的方法(如oracle to postgresql));</font></div><div><font size="2"   >&nbsp; 如何打数据库补丁;</font></div><div><font size="2"   >&nbsp; 数据库版本升级(小版本升级方法, 大版本升级方法);</font></div><div><font size="2"   >&nbsp; 建模与Benchmark(如何根据业务形态建立数据库测试模型, 测试工具的使用, 根据测试模型和硬件标准输出benchmark);</font></div><div><font size="2"   >&nbsp; 数据库日志分析(错误代码介绍, 日志的筛选过滤, 日志的维护);</font></div><div><font size="2"   >&nbsp; 数据库审计(参数层面的审计开关, 定制化审计(如触发器结合HSTORE), 审计数据的维护手段);</font></div><div><font size="2"   >&nbsp; 本地化(字符集, collate, 编码转换, 如何防止乱码);</font></div><div><font size="2"   >&nbsp; 数据库性能分析(OS性能分析报表, SQL性能分析报表);</font></div><div><font size="2"   >&nbsp; 数据库巡检(如何定制巡检项, 指标, 如何分析巡检报告);'));</font></div><div><font size="2"   >return;</font></div><div><font size="2"   >end;</font></div><div><font size="2"   >$$ language plpgsql strict;</font></div><p></p></pre></div><div style="line-height: 28px;"   ><br></div><div style="line-height: 28px;"   >英语分词+插入性能：</div><div style="line-height: 28px;"   ><span style="line-height: 28px;"   >英文分词+插入性能：~ 666万 字每秒 ( Intel(R) Xeon(R) CPU &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X7460 &nbsp;@ 2.66GHz )</span></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >postgres@db-192-168-173-33-&gt; pgbench -M prepared -n -f test.sql -P 5 -c 36 -j 36 -T 30000000</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 5.0 s, 24825.6 tps, lat 1.443 ms stddev 1.082</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 10.0 s, 24609.2 tps, lat 1.462 ms stddev 1.112</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 15.0 s, 24766.2 tps, lat 1.452 ms stddev 1.106</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 20.0 s, 24578.8 tps, lat 1.463 ms stddev 1.095</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 25.0 s, 24761.1 tps, lat 1.453 ms stddev 1.106</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 30.0 s, 24558.6 tps, lat 1.465 ms stddev 1.129</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 35.0 s, 22420.1 tps, lat 1.604 ms stddev 1.376</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 40.0 s, 25480.7 tps, lat 1.412 ms stddev 1.108</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 45.0 s, 25528.4 tps, lat 1.409 ms stddev 1.097</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 50.0 s, 25239.3 tps, lat 1.425 ms stddev 1.113</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 55.0 s, 25236.4 tps, lat 1.425 ms stddev 1.117</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 60.0 s, 25392.1 tps, lat 1.417 ms stddev 1.079</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 65.0 s, 25521.0 tps, lat 1.409 ms stddev 1.100</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 70.0 s, 25154.2 tps, lat 1.430 ms stddev 1.117</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 75.0 s, 25260.6 tps, lat 1.424 ms stddev 1.105</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 80.0 s, 25364.2 tps, lat 1.418 ms stddev 1.086</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 85.0 s, 25383.5 tps, lat 1.417 ms stddev 1.094</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 90.0 s, 25392.8 tps, lat 1.417 ms stddev 1.116</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 95.0 s, 25651.1 tps, lat 1.402 ms stddev 1.102</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 100.0 s, 25663.7 tps, lat 1.401 ms stddev 1.082</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 105.0 s, 24486.3 tps, lat 1.469 ms stddev 1.204</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 110.0 s, 22847.7 tps, lat 1.574 ms stddev 1.362</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 115.0 s, 24687.0 tps, lat 1.457 ms stddev 1.248</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 120.0 s, 25433.6 tps, lat 1.414 ms stddev 1.095</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 125.0 s, 25667.7 tps, lat 1.401 ms stddev 1.094</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 130.0 s, 25581.7 tps, lat 1.406 ms stddev 1.116</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 135.0 s, 25411.5 tps, lat 1.415 ms stddev 1.128</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 140.0 s, 25507.5 tps, lat 1.410 ms stddev 1.105</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 145.0 s, 25503.0 tps, lat 1.410 ms stddev 1.087</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 150.0 s, 25533.5 tps, lat 1.409 ms stddev 1.110</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 155.0 s, 25708.8 tps, lat 1.399 ms stddev 1.087</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 160.0 s, 25574.1 tps, lat 1.406 ms stddev 1.118</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 165.0 s, 25580.5 tps, lat 1.406 ms stddev 1.098</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 170.0 s, 25428.9 tps, lat 1.414 ms stddev 1.111</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 175.0 s, 25522.0 tps, lat 1.409 ms stddev 1.102</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 180.0 s, 23641.7 tps, lat 1.521 ms stddev 1.276</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 185.0 s, 23065.6 tps, lat 1.559 ms stddev 1.425</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 190.0 s, 24623.5 tps, lat 1.461 ms stddev 1.218</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 195.0 s, 25486.2 tps, lat 1.411 ms stddev 1.142</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 200.0 s, 25507.4 tps, lat 1.410 ms stddev 1.108</font></div><p></p></pre></div><div style="line-height: 28px;"   ><br></div></div><div style="line-height: 28px;"   >中文分词+插入性能：</div></div></div><div style="line-height: 28px;"   ><span style="line-height: 28px;"   >中文分词+插入性能：~ 290万 字每秒 ( Intel(R) Xeon(R) CPU &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X7460 &nbsp;@ 2.66GHz )</span></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >postgres@db-192-168-173-33-&gt; pgbench -M prepared -n -f test.sql -P 5 -c 36 -j 36 -T 30000000</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 5.0 s, 10934.3 tps, lat 3.277 ms stddev 2.349</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 10.0 s, 10855.9 tps, lat 3.315 ms stddev 2.359</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 15.0 s, 10828.8 tps, lat 3.323 ms stddev 2.426</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 20.0 s, 10849.6 tps, lat 3.316 ms stddev 2.361</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 25.0 s, 10909.1 tps, lat 3.299 ms stddev 2.320</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 30.0 s, 10855.7 tps, lat 3.315 ms stddev 2.388</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 35.0 s, 10857.4 tps, lat 3.315 ms stddev 2.367</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 40.0 s, 10799.4 tps, lat 3.332 ms stddev 2.503</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 45.0 s, 10962.9 tps, lat 3.283 ms stddev 2.390</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 50.0 s, 10843.2 tps, lat 3.319 ms stddev 2.466</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 55.0 s, 9665.7 tps, lat 3.723 ms stddev 3.115</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 60.0 s, 9950.5 tps, lat 3.618 ms stddev 2.918</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 65.0 s, 10822.1 tps, lat 3.324 ms stddev 2.470</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 70.0 s, 10764.6 tps, lat 3.343 ms stddev 2.517</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 75.0 s, 10887.8 tps, lat 3.306 ms stddev 2.481</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 80.0 s, 10897.6 tps, lat 3.303 ms stddev 2.474</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 85.0 s, 10814.6 tps, lat 3.328 ms stddev 2.458</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 90.0 s, 10805.0 tps, lat 3.330 ms stddev 2.552</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 95.0 s, 10921.5 tps, lat 3.296 ms stddev 2.422</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 100.0 s, 10820.0 tps, lat 3.326 ms stddev 2.518</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 105.0 s, 9833.8 tps, lat 3.659 ms stddev 3.212</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 110.0 s, 9609.7 tps, lat 3.744 ms stddev 3.084</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 115.0 s, 10159.1 tps, lat 3.543 ms stddev 2.917</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 120.0 s, 10849.9 tps, lat 3.316 ms stddev 2.520</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 125.0 s, 10820.0 tps, lat 3.327 ms stddev 2.505</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 130.0 s, 10828.0 tps, lat 3.323 ms stddev 2.549</font></div><div style="line-height: 28px;"   ><font size="2"   >progress: 135.0 s, 10819.1 tps, lat 3.326 ms stddev 2.536</font></div><p></p></pre></div></div><div style="line-height: 28px;"   ><br></div></div><div style="line-height: 28px;"   >查询性能：</div><div style="line-height: 28px;"   >查询性能视查询条件，数据内容而定。一般可以在毫秒级返回。当然还要关注实际查询条件和索引存储结构，有些查询组合可能使查询时间较长，因为需要扫描的数据链路更长。</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >digoal=&gt; explain analyze select * from test_ts where ts @@ tsquery '源代码' limit 1;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; QUERY PLAN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >------------------------------------------------------------------------------------------------------------------------------------</font></div><div><font size="2"   >------</font></div><div><font size="2"   >&nbsp;Limit &nbsp;(cost=0.41..0.85 rows=1 width=4426) (actual time=0.156..0.156 rows=1 loops=1)</font></div><div><font size="2"   >&nbsp; &nbsp;-&gt; &nbsp;Index Scan using idx_test_ts on test_ts &nbsp;(cost=0.41..1039026.29 rows=2371193 width=4426) (actual time=0.154..0.154 rows=1 loo</font></div><div><font size="2"   >ps=1)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Index Cond: (ts @@ '''源代码'''::tsquery)</font></div><div><font size="2"   >&nbsp;Planning time: 0.222 ms</font></div><div><font size="2"   >&nbsp;Execution time: 0.236 ms</font></div><div><font size="2"   >(5 rows)</font></div><div><font size="2"   >Time: 0.881 ms</font></div><p></p></pre></div><div style="line-height: 28px;"   ><br></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >digoal=&gt; explain analyze select * from test_ts where ts @@ tsquery '源代码 &amp; !集群' limit 1;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; QUERY PLAN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >--------------------------------------------------------------------------------------------------------------------------</font></div><div><font size="2"   >&nbsp;Limit &nbsp;(cost=178.00..180.01 rows=1 width=4426) (actual time=363.066..363.066 rows=0 loops=1)</font></div><div><font size="2"   >&nbsp; &nbsp;-&gt; &nbsp;Bitmap Heap Scan on test_ts &nbsp;(cost=178.00..180.01 rows=1 width=4426) (actual time=363.064..363.064 rows=0 loops=1)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Recheck Cond: (ts @@ '''源代码'' &amp; !''集群'''::tsquery)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt; &nbsp;Bitmap Index Scan on idx_1 &nbsp;(cost=0.00..178.00 rows=1 width=0) (actual time=363.061..363.061 rows=0 loops=1)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Index Cond: (ts @@ '''源代码'' &amp; !''集群'''::tsquery)</font></div><div><font size="2"   >&nbsp;Planning time: 0.167 ms</font></div><div><font size="2"   >&nbsp;Execution time: 363.105 ms</font></div><div><font size="2"   >(7 rows)</font></div><div><font size="2"   >Time: 363.683 ms</font></div><p></p></pre></div><div><br></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >digoal=&gt; explain analyze select * from test_ts where ts @@ tsquery '德哥' limit 1;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;QUERY PLAN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >----------------------------------------------------------------------------------------------------------------------------</font></div><div><font size="2"   >&nbsp;Limit &nbsp;(cost=181.88..183.68 rows=1 width=4426) (actual time=0.019..0.019 rows=0 loops=1)</font></div><div><font size="2"   >&nbsp; &nbsp;-&gt; &nbsp;Bitmap Heap Scan on test_ts &nbsp;(cost=181.88..21478.97 rows=11856 width=4426) (actual time=0.018..0.018 rows=0 loops=1)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Recheck Cond: (ts @@ '''德哥'''::tsquery)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt; &nbsp;Bitmap Index Scan on idx_1 &nbsp;(cost=0.00..178.92 rows=11856 width=0) (actual time=0.015..0.015 rows=0 loops=1)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Index Cond: (ts @@ '''德哥'''::tsquery)</font></div><div><font size="2"   >&nbsp;Planning time: 0.180 ms</font></div><div><font size="2"   >&nbsp;Execution time: 0.052 ms</font></div><div><font size="2"   >(7 rows)</font></div><div><font size="2"   >Time: 0.592 ms</font></div><p></p></pre></div><div><br></div><div style="line-height: 28px;"   >存储空间：</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >digoal=&gt; select count(*) from test_ts;</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; count &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >---------</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;2371193</font></div><div style="line-height: 28px;"   ><font size="2"   >(1 row)</font></div><div style="line-height: 28px;"   ><font size="2"   >约6.9亿中文字，分词后约6.4亿中英文词组。</font></div><div style="line-height: 28px;"   ><font size="2"   >分词占用10GB，索引占用5GB</font></div></div><div><div><font size="2"   >digoal=&gt; \dt+ test_ts</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List of relations</font></div><div><font size="2"   >&nbsp;Schema | &nbsp;Name &nbsp; | Type &nbsp;| Owner &nbsp;| Size &nbsp;| Description&nbsp;</font></div><div><font size="2"   >--------+---------+-------+--------+-------+-------------</font></div><div><font size="2"   >&nbsp;digoal | test_ts | table | digoal | 10 GB |&nbsp;</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >digoal=&gt; \di+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List of relations</font></div><div><font size="2"   >&nbsp;Schema | &nbsp; &nbsp;Name &nbsp; &nbsp; | Type &nbsp;| Owner &nbsp;| &nbsp;Table &nbsp;| &nbsp;Size &nbsp; | Description&nbsp;</font></div><div><font size="2"   >--------+-------------+-------+--------+---------+---------+-------------</font></div><div><font size="2"   >&nbsp;digoal | idx_test_ts | index | digoal | test_ts | 4959 MB |&nbsp;</font></div><div><span style="line-height: 28px;"   ><font size="2"   >(1 row)</font></span></div></div><p></p></pre></div></div><div><div><br></div></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201422410175698/"   >http://blog.163.com/digoal@126/blog/static/163877040201422410175698/</a></div><div>2.&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201552102814822/"   >http://blog.163.com/digoal@126/blog/static/163877040201552102814822/</a></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="PostgreSQL zhparser  english parser, query, insert performance - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>