<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">RHCS dual cluster name’s problem</h2>
	<h5 id="">2010-05-18 10:13:38&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402010418101338220/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><span class="Apple-style-span" style="font-family: Tahoma, Arial, Helvetica, sans-serif; line-height: normal; font-size: 12px; color: rgb(51, 68, 85);"><div class="post" id="post-507" style="margin-top: 0px; margin-right: 0px; margin-bottom: 20px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 10px; padding-left: 0px; position: relative; width: 640px;"><div class="entry" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 10px; padding-bottom: 0px; padding-left: 10px; font-size: 13px; overflow-x: hidden; overflow-y: hidden;"><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 18px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; line-height: 18px;">RHCS使用/etc/cluster/cluster.conf配置文件启动集群。</p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 18px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; line-height: 18px;">在头部有一类似如下格式的行：</p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 18px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; line-height: 18px;">&lt;cluster alias=”cluster_test” config_version=”12″ name=”cluster_test”&gt;</p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 18px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; line-height: 18px;">alias：集群别名</p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 18px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; line-height: 18px;">config_version：集群配置文件版本，集群套件依据版本好判断是否需要更新配置。更改配置后，这个号都会随之变大，以便集群下次启动时读取配置。否则的话读取的是被缓存的配置，不会去读这个配置文件。</p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 18px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; line-height: 18px;">name：集群名称</p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 18px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; line-height: 18px;">假如在同一个局域网出现了两个NAME相同的集群会怎么样？</p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 18px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; line-height: 18px;">在启动第二个集群时，已经在运行的集群会接收到第二个集群发出的启动请求。如果版本号比第一个集群的高，第一个集群可能会被解散。看一个message</p><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] entering GATHER state from 11.</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] Creating commit token because I am the rep.</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] Saving state aru 78 high seq received 78</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] Storing new sequence id for ring 9d4</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] entering COMMIT state.</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] entering RECOVERY state.</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] position [0] member $IP1:</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] previous ring seq 2512 rep&nbsp;$IP1</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] aru 78 high delivered 78 received flag 1</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] position [1] member&nbsp;$IP2:</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] previous ring seq 2512 rep&nbsp;$IP1</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] aru 78 high delivered 78 received flag 1</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;"><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] position [2] member&nbsp;$IPNEW:</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] previous ring seq 4 rep&nbsp;$IPNEW</div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">clurgmgrd[14374]: &lt;emerg&gt; #1: Quorum Dissolved</div></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;"><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [CMAN ] quorum lost, blocking activity</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [CMAN ] Node 1 conflict, remote config version id=9, local=6</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] entering GATHER state from 11.</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] Creating commit token because I am the rep.</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] Saving state aru 3 high seq received 3</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">openais[14319]: [TOTEM] Storing new sequence id for ring 9d8</div></div><div id="_mcePaste" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">切忌。</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;"></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px;">相关命令</div><font class="Apple-style-span" color="#FFFFFF" face="'liberation sans', 'Myriad ', 'Bitstream Vera Sans', 'Lucida Grande', 'Luxi Sans', 'Trebuchet MS', helvetica, verdana, arial, sans-serif"><span class="Apple-style-span" style="border-collapse: collapse; line-height: 25px; -webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; font-size: medium;"><b><span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-weight: normal; line-height: 15px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; font-size: 12px;"><div class="table-contents" style="line-height: 1.29em; padding-top: 0px;"><table summary="Command Line Tools" border="1" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: rgb(170, 170, 170); border-right-color: rgb(170, 170, 170); border-bottom-color: rgb(170, 170, 170); border-left-color: rgb(170, 170, 170); width: 659px; border-collapse: collapse;"><colgroup><col width="20%"><col width="20%"><col width="60%"></colgroup><thead><tr><th style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; text-align: left; background-color: rgb(153, 0, 0); padding-top: 0.3em; padding-right: 0.5em; padding-bottom: 0.3em; padding-left: 0.5em; color: white;">Command Line Tool</th><th style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; text-align: left; background-color: rgb(153, 0, 0); padding-top: 0.3em; padding-right: 0.5em; padding-bottom: 0.3em; padding-left: 0.5em; color: white;">Used With</th><th style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; text-align: left; background-color: rgb(153, 0, 0); padding-top: 0.3em; padding-right: 0.5em; padding-bottom: 0.3em; padding-left: 0.5em; color: white;">Purpose</th></tr></thead><tbody><tr><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;"><code class="command" style="font-family: 'liberation mono', 'bitstream vera mono', 'dejavu mono', monospace; white-space: nowrap; font-weight: bold;">ccs_tool</code>&nbsp;― Cluster Configuration System Tool</td><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;">Cluster Infrastructure</td><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;"><code class="command" style="font-family: 'liberation mono', 'bitstream vera mono', 'dejavu mono', monospace; white-space: nowrap; font-weight: bold;">ccs_tool</code>&nbsp;is a program for making online updates to the cluster configuration file. It provides the capability to create and modify cluster infrastructure components (for example, creating a cluster, adding and removing a node). For more information about this tool, refer to the ccs_tool(8) man page.</td></tr><tr><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;"><code class="command" style="font-family: 'liberation mono', 'bitstream vera mono', 'dejavu mono', monospace; white-space: nowrap; font-weight: bold;">cman_tool</code>&nbsp;― Cluster Management Tool</td><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;">Cluster Infrastructure</td><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;"><code class="command" style="font-family: 'liberation mono', 'bitstream vera mono', 'dejavu mono', monospace; white-space: nowrap; font-weight: bold;">cman_tool</code>&nbsp;is a program that manages the CMAN cluster manager. It provides the capability to join a cluster, leave a cluster, kill a node, or change the expected quorum votes of a node in a cluster. For more information about this tool, refer to the cman_tool(8) man page.</td></tr><tr><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;"><code class="command" style="font-family: 'liberation mono', 'bitstream vera mono', 'dejavu mono', monospace; white-space: nowrap; font-weight: bold;">fence_tool</code>&nbsp;― Fence Tool</td><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;">Cluster Infrastructure</td><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;"><code class="command" style="font-family: 'liberation mono', 'bitstream vera mono', 'dejavu mono', monospace; white-space: nowrap; font-weight: bold;">fence_tool</code>&nbsp;is a program used to join or leave the default fence domain. Specifically, it starts the fence daemon (<code class="command" style="font-family: 'liberation mono', 'bitstream vera mono', 'dejavu mono', monospace; white-space: nowrap; font-weight: bold;">fenced</code>) to join the domain and kills&nbsp;<code class="command" style="font-family: 'liberation mono', 'bitstream vera mono', 'dejavu mono', monospace; white-space: nowrap; font-weight: bold;">fenced</code>&nbsp;to leave the domain. For more information about this tool, refer to the fence_tool(8) man page.</td></tr><tr><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;"><code class="command" style="font-family: 'liberation mono', 'bitstream vera mono', 'dejavu mono', monospace; white-space: nowrap; font-weight: bold;">clustat</code>&nbsp;― Cluster Status Utility</td><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;">High-availability Service Management Components</td><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;">The&nbsp;<code class="command" style="font-family: 'liberation mono', 'bitstream vera mono', 'dejavu mono', monospace; white-space: nowrap; font-weight: bold;">clustat</code>&nbsp;command displays the status of the cluster. It shows membership information, quorum view, and the state of all configured user services. For more information about this tool, refer to the clustat(8) man page.</td></tr><tr><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;"><code class="command" style="font-family: 'liberation mono', 'bitstream vera mono', 'dejavu mono', monospace; white-space: nowrap; font-weight: bold;">clusvcadm</code>&nbsp;― Cluster User Service Administration Utility</td><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;">High-availability Service Management Components</td><td style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; vertical-align: top; padding-top: 0.15em; padding-right: 0.5em; padding-bottom: 0.15em; padding-left: 0.5em;">The&nbsp;<code class="command" style="font-family: 'liberation mono', 'bitstream vera mono', 'dejavu mono', monospace; white-space: nowrap; font-weight: bold;">clusvcadm</code>&nbsp;command allows you to enable, disable, relocate, and restart high-availability services in a cluster. For more information about this tool, refer to the clusvcadm(8) man page.</td></tr></tbody></table></div><h6 style="line-height: 1.29em; color: rgb(167, 0, 0); margin-top: 0em; margin-bottom: 0em; background-color: transparent; font-size: 1em;">Table&nbsp;1.1.&nbsp;Command Line Tools</h6><div><br></div></span></b></span></font></div></div><div class="post" id="post-505" style="margin-top: 0px; margin-right: 0px; margin-bottom: 20px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 10px; padding-left: 0px; position: relative; width: 640px;"></div></span></div>
	</div>
</div>
</body>
</html>