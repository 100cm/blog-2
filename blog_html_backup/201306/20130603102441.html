<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL hung case</h2>
	<h5 id="">2013-06-03 10:24:41&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020135384423934/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><span style="line-height: 22px;"   >1. OS :&nbsp;</span><br><div><div>2. /var/log/message :&nbsp;</div><div>3. LOAD :&nbsp;</div><div>4. PostgreSQL csvlog :&nbsp;</div><div>5. strace未做.</div><div><br></div><div><div style="line-height: 22px;"   >1. OS :&nbsp;</div><div>Red Hat Enterprise Linux Server release 5.5 (Tikanga)</div><div>2.6.18-194.el5 #1 SMP Tue Mar 16 21:52:39 EDT 2010 x86_64 x86_64 x86_64 GNU/Linux</div><div><br></div><div><div style="line-height: 22px;"   >2. /var/log/message :&nbsp;</div><div style="line-height: 22px;"   >task hung &gt;120秒, 涉及进程号 :&nbsp;</div><div><div>May 31 16:35:11 postgres:915</div><div>May 31 16:37:02 postgres:18159</div><div>May 31 16:39:11 postgres:915</div><div>May 31 16:41:37 postgres:916</div><div>May 31 16:45:39 postgres:917</div><div>May 31 16:49:22 postgres:918</div><div>May 31 16:52:15 postgres:972</div><div>May 31 16:55:47 postgres:21304</div><div>May 31 16:59:33 postgres:20706</div><div>May 31 17:01:38 postgres:19971</div></div><div>详细内容 :&nbsp;</div><div><div>May 31 16:35:11 db-xxx.xxx kernel: INFO: task postgres:915 blocked for more than 120 seconds.</div><div>May 31 16:35:20 db-xxx.xxx kernel: "echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs" disables this message.</div><div>May 31 16:35:29 db-xxx.xxx kernel: postgres &nbsp; &nbsp; &nbsp;D ffff810227072120 &nbsp; &nbsp; 0 &nbsp; 915 &nbsp; &nbsp;676 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 916 &nbsp; 677 (NOTLB)</div><div>May 31 16:35:33 db-xxx.xxx kernel: &nbsp;ffff8102bc463d88 0000000000000082 0001a548c08e672d 00000000000af397</div><div>May 31 16:35:43 db-xxx.xxx kernel: &nbsp;ffff8101f6819a48 0000000000000009 ffff8101f6819860 ffff81041fecc820</div><div>May 31 16:35:49 db-xxx.xxx kernel: &nbsp;0001a55ab4cbed65 0000000000000985 ffff8101f6819a48 0000000576ed6890</div><div>May 31 16:35:50 db-xxx.xxx kernel: Call Trace:</div><div>May 31 16:35:52 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88036d8a&gt;] :jbd:log_wait_commit+0xa3/0xf5</div><div>May 31 16:35:53 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 16:35:54 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8803178a&gt;] :jbd:journal_stop+0x1cf/0x1ff</div><div>May 31 16:35:58 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8002ff40&gt;] __writeback_single_inode+0x1e9/0x328</div><div>May 31 16:36:15 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800484d0&gt;] pagevec_lookup_tag+0x1a/0x21</div><div>May 31 16:36:21 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8004a66a&gt;] wait_on_page_writeback_range+0xd6/0x12e</div><div>May 31 16:36:30 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800f3d9d&gt;] sync_inode+0x24/0x33</div><div>May 31 16:36:42 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8804c36d&gt;] :ext3:ext3_sync_file+0xc9/0xdc</div><div>May 31 16:36:48 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005073a&gt;] do_fsync+0x52/0xa4</div><div>May 31 16:36:52 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800e1ce9&gt;] __do_fsync+0x23/0x36</div><div>May 31 16:36:57 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005e28d&gt;] tracesys+0xd5/0xe0</div><div>May 31 16:36:59 db-xxx.xxx kernel:&nbsp;</div><div>May 31 16:37:02 db-xxx.xxx kernel: INFO: task postgres:18159 blocked for more than 120 seconds.</div><div>May 31 16:37:06 db-xxx.xxx kernel: "echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs" disables this message.</div><div>May 31 16:37:09 db-xxx.xxx kernel: postgres &nbsp; &nbsp; &nbsp;D ffff810227072120 &nbsp; &nbsp; 0 18159 &nbsp; &nbsp;676 &nbsp; &nbsp; &nbsp; &nbsp; 18208 18149 (NOTLB)</div><div>May 31 16:37:11 db-xxx.xxx kernel: &nbsp;ffff81035b3e7d88 0000000000000082 ffff81035b3e7d98 ffffffff80063ff8</div><div>May 31 16:37:15 db-xxx.xxx kernel: &nbsp;0000000000001000 0000000000000008 ffff81025d50f7e0 ffff81041fecc820</div><div>May 31 16:37:22 db-xxx.xxx kernel: &nbsp;0001a55ab4da022a 0000000000000857 ffff81025d50f9c8 000000050000b23e</div><div>May 31 16:37:29 db-xxx.xxx kernel: Call Trace:</div><div>May 31 16:37:33 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80063ff8&gt;] thread_return+0x62/0xfe</div><div>May 31 16:37:38 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88036d8a&gt;] :jbd:log_wait_commit+0xa3/0xf5</div><div>May 31 16:37:45 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 16:37:49 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80098e91&gt;] process_timeout+0x0/0x5</div><div>May 31 16:37:51 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8803178a&gt;] :jbd:journal_stop+0x1cf/0x1ff</div><div>May 31 16:37:53 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8002ff40&gt;] __writeback_single_inode+0x1e9/0x328</div><div>May 31 16:37:53 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80067b88&gt;] do_page_fault+0x4fe/0x874</div><div>May 31 16:37:58 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800f3d9d&gt;] sync_inode+0x24/0x33</div><div>May 31 16:38:13 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8804c36d&gt;] :ext3:ext3_sync_file+0xc9/0xdc</div><div>May 31 16:38:23 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005073a&gt;] do_fsync+0x52/0xa4</div><div>May 31 16:38:35 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800e1ce9&gt;] __do_fsync+0x23/0x36</div><div>May 31 16:38:46 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005e28d&gt;] tracesys+0xd5/0xe0</div><div>May 31 16:38:55 db-xxx.xxx kernel:&nbsp;</div><div>May 31 16:39:11 db-xxx.xxx kernel: INFO: task postgres:915 blocked for more than 120 seconds.</div><div>May 31 16:39:25 db-xxx.xxx kernel: "echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs" disables this message.</div><div>May 31 16:39:36 db-xxx.xxx kernel: postgres &nbsp; &nbsp; &nbsp;D ffff81018667af78 &nbsp; &nbsp; 0 &nbsp; 915 &nbsp; &nbsp;676 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 916 &nbsp; 677 (NOTLB)</div><div>May 31 16:39:36 db-xxx.xxx kernel: &nbsp;ffff8102bc463d88 0000000000000082 ffff8102bc463d98 ffffffff80063ff8</div><div>May 31 16:39:51 db-xxx.xxx kernel: &nbsp;ffff8101f6819a48 0000000000000009 ffff8101f6819860 ffff81025d50f7e0</div><div>May 31 16:40:00 db-xxx.xxx kernel: &nbsp;0001a5817aa3b719 00000000000006d1 ffff8101f6819a48 00000005000004e5</div><div>May 31 16:40:17 db-xxx.xxx kernel: Call Trace:</div><div>May 31 16:40:38 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80063ff8&gt;] thread_return+0x62/0xfe</div><div>May 31 16:40:45 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88036d8a&gt;] :jbd:log_wait_commit+0xa3/0xf5</div><div>May 31 16:40:58 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 16:41:08 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8803178a&gt;] :jbd:journal_stop+0x1cf/0x1ff</div><div>May 31 16:41:22 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8002ff40&gt;] __writeback_single_inode+0x1e9/0x328</div><div>May 31 16:41:31 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800484d0&gt;] pagevec_lookup_tag+0x1a/0x21</div><div>May 31 16:41:31 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8004a66a&gt;] wait_on_page_writeback_range+0xd6/0x12e</div><div>May 31 16:41:31 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800f3d9d&gt;] sync_inode+0x24/0x33</div><div>May 31 16:41:31 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8804c36d&gt;] :ext3:ext3_sync_file+0xc9/0xdc</div><div>May 31 16:41:31 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005073a&gt;] do_fsync+0x52/0xa4</div><div>May 31 16:41:31 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800e1ce9&gt;] __do_fsync+0x23/0x36</div><div>May 31 16:41:32 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005e28d&gt;] tracesys+0xd5/0xe0</div><div>May 31 16:41:32 db-xxx.xxx kernel:&nbsp;</div><div>May 31 16:41:37 db-xxx.xxx kernel: INFO: task postgres:916 blocked for more than 120 seconds.</div><div>May 31 16:41:42 db-xxx.xxx kernel: "echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs" disables this message.</div><div>May 31 16:41:58 db-xxx.xxx kernel: postgres &nbsp; &nbsp; &nbsp;D ffff81021e7f6600 &nbsp; &nbsp; 0 &nbsp; 916 &nbsp; &nbsp;676 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 917 &nbsp; 915 (NOTLB)</div><div>May 31 16:42:13 db-xxx.xxx kernel: &nbsp;ffff81032593faa8 0000000000000082 ffff810105d5b538 0000000000000286</div><div>May 31 16:42:26 db-xxx.xxx kernel: &nbsp;ffff81032593fa28 000000000000000a ffff8103e65810c0 ffff810290158080</div><div>May 31 16:42:39 db-xxx.xxx kernel: &nbsp;0001a58a6429ef21 0000000000003616 ffff8103e65812a8 0000000600200200</div><div>May 31 16:42:47 db-xxx.xxx kernel: Call Trace:</div><div>May 31 16:43:04 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800cd378&gt;] zone_statistics+0x3e/0x6d</div><div>May 31 16:43:16 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032002&gt;] :jbd:start_this_handle+0x2e5/0x36c</div><div>May 31 16:43:26 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 16:43:35 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032152&gt;] :jbd:journal_start+0xc9/0x100</div><div>May 31 16:43:48 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88050347&gt;] :ext3:ext3_write_begin+0x9a/0x1cc</div><div>May 31 16:43:59 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000fd40&gt;] generic_file_buffered_write+0x14b/0x675</div><div>May 31 16:44:05 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff880317ae&gt;] :jbd:journal_stop+0x1f3/0x1ff</div><div>May 31 16:44:21 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80016641&gt;] __generic_file_aio_write_nolock+0x369/0x3b6</div><div>May 31 16:44:38 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff801209aa&gt;] sys_semtimedop+0x6e7/0x720</div><div>May 31 16:45:07 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80021763&gt;] generic_file_aio_write+0x65/0xc1</div><div>May 31 16:45:07 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8804c1b6&gt;] :ext3:ext3_file_write+0x16/0x91</div><div>May 31 16:45:24 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80018266&gt;] do_sync_write+0xc7/0x104</div><div>May 31 16:45:27 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000eab5&gt;] find_get_pages_tag+0x34/0x89</div><div>May 31 16:45:33 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 16:45:33 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80063ff8&gt;] thread_return+0x62/0xfe</div><div>May 31 16:45:34 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80016a49&gt;] vfs_write+0xce/0x174</div><div>May 31 16:45:36 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80017316&gt;] sys_write+0x45/0x6e</div><div>May 31 16:45:37 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005e28d&gt;] tracesys+0xd5/0xe0</div><div>May 31 16:45:38 db-xxx.xxx kernel:&nbsp;</div><div>May 31 16:45:39 db-xxx.xxx kernel: INFO: task postgres:917 blocked for more than 120 seconds.</div><div>May 31 16:45:39 db-xxx.xxx kernel: "echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs" disables this message.</div><div>May 31 16:45:40 db-xxx.xxx kernel: postgres &nbsp; &nbsp; &nbsp;D ffff810227072120 &nbsp; &nbsp; 0 &nbsp; 917 &nbsp; &nbsp;676 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 918 &nbsp; 916 (NOTLB)</div><div>May 31 16:45:41 db-xxx.xxx kernel: &nbsp;ffff81041b507b88 0000000000000086 ffff81023ae60380 ffffffff8022ff8d</div><div>May 31 16:45:46 db-xxx.xxx kernel: &nbsp;0000000000000000 000000000000000a ffff8102272730c0 ffff81041fecc820</div><div>May 31 16:45:52 db-xxx.xxx kernel: &nbsp;0001a5924a73a860 0000000000006aac ffff8102272732a8 0000000500000000</div><div>May 31 16:46:02 db-xxx.xxx kernel: Call Trace:</div><div>May 31 16:46:17 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8022ff8d&gt;] dev_hard_start_xmit+0x1b7/0x28a</div><div>May 31 16:46:36 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800322bb&gt;] ip_output+0x29a/0x2dd</div><div>May 31 16:46:51 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032002&gt;] :jbd:start_this_handle+0x2e5/0x36c</div><div>May 31 16:47:01 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 16:47:19 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032152&gt;] :jbd:journal_start+0xc9/0x100</div><div>May 31 16:47:26 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88050c72&gt;] :ext3:ext3_dirty_inode+0x28/0x7b</div><div>May 31 16:47:32 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80013c93&gt;] __mark_inode_dirty+0x29/0x16e</div><div>May 31 16:47:37 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000c44a&gt;] do_generic_mapping_read+0x342/0x354</div><div>May 31 16:47:50 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000d0fb&gt;] file_read_actor+0x0/0x159</div><div>May 31 16:48:03 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000c5a8&gt;] __generic_file_aio_read+0x14c/0x198</div><div>May 31 16:48:10 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80016dd4&gt;] generic_file_aio_read+0x34/0x39</div><div>May 31 16:48:20 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000ce24&gt;] do_sync_read+0xc7/0x104</div><div>May 31 16:48:35 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 16:48:47 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000df43&gt;] do_mmap_pgoff+0x431/0x7d7</div><div>May 31 16:48:47 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000e17e&gt;] do_mmap_pgoff+0x66c/0x7d7</div><div>May 31 16:48:57 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000b6b0&gt;] vfs_read+0xcb/0x171</div><div>May 31 16:49:06 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80011c01&gt;] sys_read+0x45/0x6e</div><div>May 31 16:49:06 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005e28d&gt;] tracesys+0xd5/0xe0</div><div>May 31 16:49:17 db-xxx.xxx kernel:&nbsp;</div><div>May 31 16:49:22 db-xxx.xxx kernel: INFO: task postgres:918 blocked for more than 120 seconds.</div><div>May 31 16:49:33 db-xxx.xxx kernel: "echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs" disables this message.</div><div>May 31 16:49:45 db-xxx.xxx kernel: postgres &nbsp; &nbsp; &nbsp;D ffff81021e7f6600 &nbsp; &nbsp; 0 &nbsp; 918 &nbsp; &nbsp;676 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 924 &nbsp; 917 (NOTLB)</div><div>May 31 16:49:50 db-xxx.xxx kernel: &nbsp;ffff81025f38dcd8 0000000000000086 0000000000000009 ffffffff8000b192</div><div>May 31 16:49:50 db-xxx.xxx kernel: &nbsp;0000000000000009 0000000000000009 ffff81021c66a7a0 ffff8101b13d57e0</div><div>May 31 16:49:51 db-xxx.xxx kernel: &nbsp;0001a589ed252ae3 0000000000347ea8 ffff81021c66a988 000000010454f400</div><div>May 31 16:49:51 db-xxx.xxx kernel: Call Trace:</div><div>May 31 16:49:51 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000b192&gt;] release_pages+0x14d/0x15a</div><div>May 31 16:49:51 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032002&gt;] :jbd:start_this_handle+0x2e5/0x36c</div><div>May 31 16:49:51 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 16:49:51 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032152&gt;] :jbd:journal_start+0xc9/0x100</div><div>May 31 16:49:52 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8804d5f2&gt;] :ext3:start_transaction+0x1c/0x48</div><div>May 31 16:50:02 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff880501d9&gt;] :ext3:ext3_delete_inode+0x0/0xd4</div><div>May 31 16:50:26 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88050208&gt;] :ext3:ext3_delete_inode+0x2f/0xd4</div><div>May 31 16:50:44 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff880501d9&gt;] :ext3:ext3_delete_inode+0x0/0xd4</div><div>May 31 16:51:03 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8002f6a6&gt;] generic_delete_inode+0xc6/0x143</div><div>May 31 16:51:13 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000d4b3&gt;] dput+0xf6/0x114</div><div>May 31 16:51:23 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80036f13&gt;] sys_renameat+0x18a/0x1eb</div><div>May 31 16:51:39 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000e4a1&gt;] free_pages_and_swap_cache+0x67/0x7e</div><div>May 31 16:51:50 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800b878c&gt;] audit_syscall_entry+0x180/0x1b3</div><div>May 31 16:51:50 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005e28d&gt;] tracesys+0xd5/0xe0</div><div>May 31 16:52:02 db-xxx.xxx kernel:&nbsp;</div><div>May 31 16:52:15 db-xxx.xxx kernel: INFO: task postgres:972 blocked for more than 120 seconds.</div><div>May 31 16:52:28 db-xxx.xxx kernel: "echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs" disables this message.</div><div>May 31 16:52:40 db-xxx.xxx kernel: postgres &nbsp; &nbsp; &nbsp;D ffff81022707a7a0 &nbsp; &nbsp; 0 &nbsp; 972 &nbsp; &nbsp;676 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 989 &nbsp; 960 (NOTLB)</div><div>May 31 16:52:54 db-xxx.xxx kernel: &nbsp;ffff81041bfcfaa8 0000000000000086 0000000000000000 0000000000000000</div><div>May 31 16:53:02 db-xxx.xxx kernel: &nbsp;0000000000000000 000000000000000a ffff81041e6580c0 ffff81022714c7a0</div><div>May 31 16:53:21 db-xxx.xxx kernel: &nbsp;0001a58f2d4d93ee 0000000000055ef9 ffff81041e6582a8 0000000736d40100</div><div>May 31 16:53:21 db-xxx.xxx kernel: Call Trace:</div><div>May 31 16:53:37 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800cd378&gt;] zone_statistics+0x3e/0x6d</div><div>May 31 16:53:37 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032002&gt;] :jbd:start_this_handle+0x2e5/0x36c</div><div>May 31 16:53:49 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 16:54:04 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032152&gt;] :jbd:journal_start+0xc9/0x100</div><div>May 31 16:54:17 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88050347&gt;] :ext3:ext3_write_begin+0x9a/0x1cc</div><div>May 31 16:54:47 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000fd40&gt;] generic_file_buffered_write+0x14b/0x675</div><div>May 31 16:54:53 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff880317ae&gt;] :jbd:journal_stop+0x1f3/0x1ff</div><div>May 31 16:55:07 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80016641&gt;] __generic_file_aio_write_nolock+0x369/0x3b6</div><div>May 31 16:55:23 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000e324&gt;] current_fs_time+0x3b/0x40</div><div>May 31 16:55:39 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80021763&gt;] generic_file_aio_write+0x65/0xc1</div><div>May 31 16:55:41 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8804c1b6&gt;] :ext3:ext3_file_write+0x16/0x91</div><div>May 31 16:55:42 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80018266&gt;] do_sync_write+0xc7/0x104</div><div>May 31 16:55:42 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80067b88&gt;] do_page_fault+0x4fe/0x874</div><div>May 31 16:55:43 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 16:55:43 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800274fb&gt;] do_filp_open+0x1c/0x38</div><div>May 31 16:55:43 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80016a49&gt;] vfs_write+0xce/0x174</div><div>May 31 16:55:43 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80017316&gt;] sys_write+0x45/0x6e</div><div>May 31 16:55:46 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005e28d&gt;] tracesys+0xd5/0xe0</div><div>May 31 16:55:46 db-xxx.xxx kernel:&nbsp;</div><div>May 31 16:55:47 db-xxx.xxx kernel: INFO: task postgres:21304 blocked for more than 120 seconds.</div><div>May 31 16:55:48 db-xxx.xxx kernel: "echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs" disables this message.</div><div>May 31 16:55:59 db-xxx.xxx kernel: postgres &nbsp; &nbsp; &nbsp;D ffff81021e7f6600 &nbsp; &nbsp; 0 21304 &nbsp; &nbsp;676 &nbsp; &nbsp; &nbsp; &nbsp; 24881 &nbsp;7368 (NOTLB)</div><div>May 31 16:56:06 db-xxx.xxx kernel: &nbsp;ffff81025277db88 0000000000000082 ffff8102460080c0 ffff8103d4d58780</div><div>May 31 16:56:17 db-xxx.xxx kernel: &nbsp;ffff8102460080c0 0000000000000009 ffff8102460080c0 ffff81024b0ac860</div><div>May 31 16:56:23 db-xxx.xxx kernel: &nbsp;0001a58d6411b200 0000000000002302 ffff8102460082a8 0000000780063ff8</div><div>May 31 16:56:52 db-xxx.xxx kernel: Call Trace:</div><div>May 31 16:57:09 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032002&gt;] :jbd:start_this_handle+0x2e5/0x36c</div><div>May 31 16:57:18 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 16:57:29 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032152&gt;] :jbd:journal_start+0xc9/0x100</div><div>May 31 16:57:39 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88050c72&gt;] :ext3:ext3_dirty_inode+0x28/0x7b</div><div>May 31 16:57:55 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80013c93&gt;] __mark_inode_dirty+0x29/0x16e</div><div>May 31 16:58:07 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000c44a&gt;] do_generic_mapping_read+0x342/0x354</div><div>May 31 16:58:23 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000d0fb&gt;] file_read_actor+0x0/0x159</div><div>May 31 16:58:35 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000c5a8&gt;] __generic_file_aio_read+0x14c/0x198</div><div>May 31 16:58:48 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80016dd4&gt;] generic_file_aio_read+0x34/0x39</div><div>May 31 16:59:05 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000ce24&gt;] do_sync_read+0xc7/0x104</div><div>May 31 16:59:21 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000e324&gt;] current_fs_time+0x3b/0x40</div><div>May 31 16:59:28 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8002b9a9&gt;] sys_recvfrom+0xd4/0x130</div><div>May 31 16:59:28 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 16:59:29 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800634b6&gt;] __sched_text_start+0xf6/0xbd6</div><div>May 31 16:59:29 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000b6b0&gt;] vfs_read+0xcb/0x171</div><div>May 31 16:59:29 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80011c01&gt;] sys_read+0x45/0x6e</div><div>May 31 16:59:32 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005e28d&gt;] tracesys+0xd5/0xe0</div><div>May 31 16:59:32 db-xxx.xxx kernel:&nbsp;</div><div>May 31 16:59:33 db-xxx.xxx kernel: INFO: task postgres:20706 blocked for more than 120 seconds.</div><div>May 31 16:59:33 db-xxx.xxx kernel: "echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs" disables this message.</div><div>May 31 16:59:36 db-xxx.xxx kernel: postgres &nbsp; &nbsp; &nbsp;D ffff81021e7f6600 &nbsp; &nbsp; 0 20706 &nbsp; &nbsp;676 &nbsp; &nbsp; &nbsp; &nbsp; 20710 20702 (NOTLB)</div><div>May 31 16:59:37 db-xxx.xxx kernel: &nbsp;ffff8102ffea1aa8 0000000000000086 000000054f79df8f ffffffff8022ff8d</div><div>May 31 16:59:38 db-xxx.xxx kernel: &nbsp;ffff81041f108000 000000000000000a ffff81026add10c0 ffff8102e9cf20c0</div><div>May 31 16:59:38 db-xxx.xxx kernel: &nbsp;0001a589f380b25e 0000000000078593 ffff81026add12a8 0000000771664800</div><div>May 31 16:59:38 db-xxx.xxx kernel: Call Trace:</div><div>May 31 16:59:38 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8022ff8d&gt;] dev_hard_start_xmit+0x1b7/0x28a</div><div>May 31 16:59:39 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800cd378&gt;] zone_statistics+0x3e/0x6d</div><div>May 31 16:59:48 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032002&gt;] :jbd:start_this_handle+0x2e5/0x36c</div><div>May 31 17:00:22 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 17:00:52 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032152&gt;] :jbd:journal_start+0xc9/0x100</div><div>May 31 17:00:56 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88050347&gt;] :ext3:ext3_write_begin+0x9a/0x1cc</div><div>May 31 17:00:57 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8000fd40&gt;] generic_file_buffered_write+0x14b/0x675</div><div>May 31 17:00:58 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff880317ae&gt;] :jbd:journal_stop+0x1f3/0x1ff</div><div>May 31 17:01:00 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80016641&gt;] __generic_file_aio_write_nolock+0x369/0x3b6</div><div>May 31 17:01:00 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80021763&gt;] generic_file_aio_write+0x65/0xc1</div><div>May 31 17:01:00 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8804c1b6&gt;] :ext3:ext3_file_write+0x16/0x91</div><div>May 31 17:01:00 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80018266&gt;] do_sync_write+0xc7/0x104</div><div>May 31 17:01:00 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8022678b&gt;] sock_from_file+0xf/0x60</div><div>May 31 17:01:01 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8002b9a9&gt;] sys_recvfrom+0xd4/0x130</div><div>May 31 17:01:17 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 17:01:35 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80019ebe&gt;] current_kernel_time+0x26/0x38</div><div>May 31 17:01:37 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80016a49&gt;] vfs_write+0xce/0x174</div><div>May 31 17:01:37 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80017316&gt;] sys_write+0x45/0x6e</div><div>May 31 17:01:37 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005e28d&gt;] tracesys+0xd5/0xe0</div><div>May 31 17:01:37 db-xxx.xxx kernel:&nbsp;</div><div>May 31 17:01:38 db-xxx.xxx kernel: INFO: task postgres:19971 blocked for more than 120 seconds.</div><div>May 31 17:01:38 db-xxx.xxx kernel: "echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs" disables this message.</div><div>May 31 17:01:38 db-xxx.xxx kernel: postgres &nbsp; &nbsp; &nbsp;D ffff81021e7f6600 &nbsp; &nbsp; 0 19971 &nbsp; &nbsp;676 &nbsp; &nbsp; &nbsp; &nbsp; 19972 20717 (NOTLB)</div><div>May 31 17:01:38 db-xxx.xxx kernel: &nbsp;ffff810242c5dbe8 0000000000000086 0000000000000001 ffffffff8001bf98</div><div>May 31 17:01:41 db-xxx.xxx kernel: &nbsp;ffff81028b0b19c0 000000000000000a ffff8103f7f4b7a0 ffff81023b3ec100</div><div>May 31 17:01:41 db-xxx.xxx kernel: &nbsp;0001a58c690dd582 0000000000044dbb ffff8103f7f4b988 000000078b0b19c0</div><div>May 31 17:01:42 db-xxx.xxx kernel: Call Trace:</div><div>May 31 17:01:42 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8001bf98&gt;] tcp_rcv_established+0x8bd/0x925</div><div>May 31 17:01:42 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8003b875&gt;] tcp_v4_do_rcv+0x2a/0x2fa</div><div>May 31 17:01:42 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80228f92&gt;] sk_wait_data+0xac/0xbf</div><div>May 31 17:01:42 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032002&gt;] :jbd:start_this_handle+0x2e5/0x36c</div><div>May 31 17:01:43 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 17:01:59 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88032152&gt;] :jbd:journal_start+0xc9/0x100</div><div>May 31 17:02:22 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff88050c72&gt;] :ext3:ext3_dirty_inode+0x28/0x7b</div><div>May 31 17:02:40 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80013c93&gt;] __mark_inode_dirty+0x29/0x16e</div><div>May 31 17:02:42 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80016562&gt;] __generic_file_aio_write_nolock+0x28a/0x3b6</div><div>May 31 17:02:42 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80021763&gt;] generic_file_aio_write+0x65/0xc1</div><div>May 31 17:02:43 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8804c1b6&gt;] :ext3:ext3_file_write+0x16/0x91</div><div>May 31 17:02:43 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80018266&gt;] do_sync_write+0xc7/0x104</div><div>May 31 17:02:43 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8002b9a9&gt;] sys_recvfrom+0xd4/0x130</div><div>May 31 17:02:43 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff800a1ba4&gt;] autoremove_wake_function+0x0/0x2e</div><div>May 31 17:02:44 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80016a49&gt;] vfs_write+0xce/0x174</div><div>May 31 17:02:44 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff80017316&gt;] sys_write+0x45/0x6e</div><div>May 31 17:02:46 db-xxx.xxx kernel: &nbsp;[&lt;ffffffff8005e28d&gt;] tracesys+0xd5/0xe0</div><div>May 31 17:02:46 db-xxx.xxx kernel:&nbsp;</div></div><div style="line-height: 22px;"   ><br></div><div style="line-height: 22px;"   >3. STAT :&nbsp;</div><div style="line-height: 22px;"   >sar -q</div><div>06:00:02 PM &nbsp; runq-sz &nbsp;plist-sz &nbsp; ldavg-1 &nbsp; ldavg-5 &nbsp;ldavg-15</div><div><div>04:30:01 PM &nbsp; &nbsp; &nbsp; &nbsp; 1 &nbsp; &nbsp; &nbsp; 679 &nbsp; &nbsp; &nbsp;4.50 &nbsp; &nbsp; &nbsp;4.69 &nbsp; &nbsp; &nbsp;4.89</div><div>04:40:19 PM &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; 930 &nbsp; &nbsp;360.01 &nbsp; &nbsp;203.95 &nbsp; &nbsp; 90.12</div><div>04:50:18 PM &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;1341 &nbsp; &nbsp;424.38 &nbsp; &nbsp;390.62 &nbsp; &nbsp;244.93</div><div>05:00:29 PM &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; 629 &nbsp; &nbsp;163.70 &nbsp; &nbsp;266.70 &nbsp; &nbsp;266.76</div><div>05:10:21 PM &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; 545 &nbsp; &nbsp;151.23 &nbsp; &nbsp;171.54 &nbsp; &nbsp;215.05</div><div>05:20:19 PM &nbsp; &nbsp; &nbsp; &nbsp;50 &nbsp; &nbsp; &nbsp; 638 &nbsp; &nbsp; 89.74 &nbsp; &nbsp;124.40 &nbsp; &nbsp;170.83</div><div>05:30:08 PM &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; 505 &nbsp; &nbsp; 85.16 &nbsp; &nbsp; 90.21 &nbsp; &nbsp;131.29</div><div>05:40:11 PM &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; 505 &nbsp; &nbsp; 87.55 &nbsp; &nbsp; 90.32 &nbsp; &nbsp;111.86</div><div>05:50:01 PM &nbsp; &nbsp; &nbsp; &nbsp; 1 &nbsp; &nbsp; &nbsp; 183 &nbsp; &nbsp; &nbsp;4.01 &nbsp; &nbsp; 36.36 &nbsp; &nbsp; 78.12</div></div><div><br></div><div>sar -b</div><div><div>04:20:01 PM &nbsp; &nbsp;505.29 &nbsp; &nbsp;310.97 &nbsp; &nbsp;194.32 &nbsp;30629.99 &nbsp;26180.39</div><div>04:30:01 PM &nbsp; &nbsp;503.24 &nbsp; &nbsp;301.42 &nbsp; &nbsp;201.82 &nbsp;29280.97 &nbsp;26050.53</div><div>04:40:19 PM &nbsp; 1423.54 &nbsp; &nbsp; 66.54 &nbsp; 1357.00 &nbsp; 2722.51 &nbsp;21954.34</div><div>04:50:18 PM &nbsp; 1586.79 &nbsp; &nbsp; &nbsp;5.16 &nbsp; 1581.63 &nbsp; &nbsp;128.76 &nbsp;19194.44</div><div>05:00:29 PM &nbsp; 1413.65 &nbsp; &nbsp; &nbsp;2.62 &nbsp; 1411.03 &nbsp; &nbsp; 58.10 &nbsp;15683.34</div><div>05:10:21 PM &nbsp; 1286.75 &nbsp; &nbsp; &nbsp;8.75 &nbsp; 1278.00 &nbsp; &nbsp;329.97 &nbsp;15370.59</div><div>05:20:19 PM &nbsp; 1330.03 &nbsp; &nbsp; 19.53 &nbsp; 1310.51 &nbsp; 1450.70 &nbsp;16408.34</div><div>05:30:08 PM &nbsp; 1275.22 &nbsp; &nbsp; &nbsp;4.95 &nbsp; 1270.28 &nbsp; &nbsp;289.15 &nbsp;14080.58</div><div>05:40:11 PM &nbsp; 1359.69 &nbsp; &nbsp; &nbsp;0.07 &nbsp; 1359.62 &nbsp; &nbsp; &nbsp;4.72 &nbsp;15609.15</div><div>05:50:01 PM &nbsp; &nbsp;924.40 &nbsp; &nbsp; 87.56 &nbsp; &nbsp;836.84 &nbsp;11463.61 &nbsp;21348.42</div><div>06:00:02 PM &nbsp; &nbsp;203.88 &nbsp; &nbsp; 83.46 &nbsp; &nbsp;120.43 &nbsp; 7030.39 &nbsp; 5903.88</div></div><div><br></div><div>sar -c</div><div><div>03:20:01 PM &nbsp; &nbsp; &nbsp;0.23</div><div>03:30:03 PM &nbsp; &nbsp; 11.39</div><div>03:40:02 PM &nbsp; &nbsp; 36.32</div><div>03:50:01 PM &nbsp; &nbsp; 36.44</div><div>04:00:01 PM &nbsp; &nbsp; 33.89</div><div>04:10:01 PM &nbsp; &nbsp; 30.26</div><div>04:20:01 PM &nbsp; &nbsp; 35.78</div><div>04:30:01 PM &nbsp; &nbsp; 34.99</div><div>04:40:19 PM &nbsp; &nbsp; 10.07</div><div>04:50:18 PM &nbsp; &nbsp; &nbsp;1.21</div><div>05:00:29 PM &nbsp; &nbsp; &nbsp;0.33</div><div>05:10:21 PM &nbsp; &nbsp; &nbsp;0.59</div><div>05:20:19 PM &nbsp; &nbsp; &nbsp;2.30</div><div>05:30:08 PM &nbsp; &nbsp; &nbsp;0.79</div><div>05:40:11 PM &nbsp; &nbsp; &nbsp;0.34</div><div>05:50:01 PM &nbsp; &nbsp; 16.07</div><div>06:00:02 PM &nbsp; &nbsp; &nbsp;4.37</div></div><div><br></div><div>sar -f</div><div><div>03:20:01 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; 17.44 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;1.43 &nbsp; &nbsp; 19.37 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 61.75</div><div>03:30:03 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; 16.12 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;2.69 &nbsp; &nbsp; 19.42 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 61.77</div><div>03:40:02 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;8.96 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;6.01 &nbsp; &nbsp; 17.24 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 67.80</div><div>03:50:01 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;8.56 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;5.96 &nbsp; &nbsp; 15.68 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 69.81</div><div>04:00:01 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;8.12 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;5.62 &nbsp; &nbsp; 16.45 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 69.81</div><div>04:10:01 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; 13.17 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;4.93 &nbsp; &nbsp; 17.36 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 64.53</div><div>04:20:01 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; 13.59 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;5.80 &nbsp; &nbsp; 16.49 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 64.12</div><div>04:30:01 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;8.09 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;5.83 &nbsp; &nbsp; 16.30 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 69.78</div><div>04:40:19 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;3.23 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 37.95 &nbsp; &nbsp; 28.69 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 30.13</div><div>04:50:18 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;0.29 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;0.83 &nbsp; &nbsp; 45.72 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 53.16</div><div>05:00:29 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;0.16 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;0.66 &nbsp; &nbsp; 25.89 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 73.29</div><div>05:10:21 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;0.49 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;1.07 &nbsp; &nbsp; 15.32 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 83.12</div><div>05:20:19 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;1.17 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 13.05 &nbsp; &nbsp; 22.89 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 62.89</div><div>05:30:08 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;0.61 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;4.39 &nbsp; &nbsp; 31.01 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 63.99</div><div>05:40:11 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;0.10 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;0.30 &nbsp; &nbsp; 16.26 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 83.34</div><div>05:50:01 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;2.33 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;2.85 &nbsp; &nbsp; 21.73 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 73.09</div><div>06:00:02 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;0.77 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;0.72 &nbsp; &nbsp; &nbsp;5.17 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 93.34</div><div>06:00:02 PM &nbsp; &nbsp; &nbsp; CPU &nbsp; &nbsp; %user &nbsp; &nbsp; %nice &nbsp; %system &nbsp; %iowait &nbsp; &nbsp;%steal &nbsp; &nbsp; %idle</div><div>06:10:01 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;7.90 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;0.90 &nbsp; &nbsp; 13.15 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 78.05</div><div>06:20:01 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;7.68 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;0.59 &nbsp; &nbsp; &nbsp;8.63 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 83.10</div><div>06:30:01 PM &nbsp; &nbsp; &nbsp; all &nbsp; &nbsp; &nbsp;2.81 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; &nbsp;0.49 &nbsp; &nbsp; &nbsp;8.64 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 88.06</div></div><div style="line-height: 22px;"   ><br></div><div style="line-height: 22px;"   >4. PostgreSQL csvlog :&nbsp;</div></div><div style="line-height: 22px;"   >被hung &gt; 120秒的PostgreSQL 进程在干什么?</div><div>2013-05-31 16:28:10.018 CST,,,915,,515e4339.393,32377,,2013-04-05 11:21:29 CST,,0,LOG,00000,"checkpoint starting: time",,,,,,,,,""</div><div>915是bgwriter进程.</div><div><br></div><div><div>2013-05-31 16:32:07.486 CST,,,18159,"",51a86007.46ef,1,"",2013-05-31 16:32:07 CST,,0,LOG,00000,"connection received: host=xxx port=35511",,,,,,,,,""</div><div>2013-05-31 16:32:07.556 CST,"xxx","postgres",18159,"xxx:35511",51a86007.46ef,2,"authentication",2013-05-31 16:32:07 CST,418/819705,0,LOG,00000,"connection authorized: user=xxx database=postgres",,,,,,,,,""</div><div>正在等待执行csvlog monitor, 如下.</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201312241028667/"   >http://blog.163.com/digoal@126/blog/static/163877040201312241028667/</a></div><div><br></div><div>2013-05-31 16:31:27.626 CST,,,917,,515e4339.395,3,,2013-04-05 11:21:29 CST,1/0,0,WARNING,01000,"pgstat wait timeout",,,,,,,,,""</div><div>2013-05-31 16:34:25.689 CST,,,917,,515e4339.395,4,,2013-04-05 11:21:29 CST,1/0,0,WARNING,01000,"pgstat wait timeout",,,,,,,,,""</div><div>2013-05-31 16:34:35.716 CST,,,917,,515e4339.395,5,,2013-04-05 11:21:29 CST,1/0,0,WARNING,01000,"pgstat wait timeout",,,,,,,,,""</div><div>2013-05-31 16:34:45.788 CST,,,917,,515e4339.395,6,,2013-04-05 11:21:29 CST,1/0,0,WARNING,01000,"pgstat wait timeout",,,,,,,,,""</div><div>2013-05-31 16:36:37.164 CST,,,917,,515e4339.395,7,,2013-04-05 11:21:29 CST,1/0,0,WARNING,01000,"pgstat wait timeout",,,,,,,,,""</div><div>2013-05-31 16:36:47.178 CST,,,917,,515e4339.395,8,,2013-04-05 11:21:29 CST,1/0,0,WARNING,01000,"pgstat wait timeout",,,,,,,,,""</div><div>2013-05-31 16:36:57.194 CST,,,917,,515e4339.395,9,,2013-04-05 11:21:29 CST,1/0,0,WARNING,01000,"pgstat wait timeout",,,,,,,,,""</div><div>917是stats collector process进程.</div><div><br></div><div>2013-05-31 16:55:46.693 CST,"xxx","xxx",972,"xxx.xxx.6.40:34720",515e433b.3cc,862,"INSERT",2013-04-05 11:21:31 CST,54/2689795,1641358131,LOG,00000,"duration: 840612.144 ms &nbsp;statement: INSERT INTO xxx (xxx) VALUES (xxx)",,,,,,,,,""</div><div><br></div><div>2013-05-31 16:41:39.754 CST,"xxx","xxx",21304,"xxx.xxx.6.253:56320",515eb0b2.5338,752,"INSERT",2013-04-05 19:08:34 CST,157/1012458,1641350121,LOG,00000,"duration: 298353.462 ms &nbsp;execute &lt;unnamed&gt;: insert into xxx(</div><div>被hung住的应该是下一条SQL, 只是还未打印出来, 客户端已经强行退出了.</div><div>2013-05-31 16:51:07.220 CST,"xxx","xxx",21304,"xxx.xxx.6.253:56320",515eb0b2.5338,753,"idle",2013-04-05 19:08:34 CST,157/0,0,LOG,08P01,"unexpected EOF on client connection",,,,,,,,,""</div><div><br></div><div>正在等待扩展heap表存储.</div><div>2013-05-31 17:01:02.195 CST,"xxx","xxx",19971,"xxx.xxx.6.40:53112",5162317c.4e03,864,"INSERT waiting",2013-04-08 10:54:52 CST,143/2890876,1641362432,LOG,00000,"process 19971 still waiting for ExclusiveLock on extension of relation 886049 of database 16644 after 1000.799 ms",,,,,,"INSERT INTO xxx (xxx) VALUES (xxx)",,,""</div><div><br></div><div>4. 连接 :&nbsp;</div><div>由于数据库响应速度下降, 程序不断发起新连接请求.</div><div><div>postgres@db-xxx-xxx-8-83-&gt; cat postgresql-2013-05-31_000000.csv |grep "connection authorized"|grep "2013-05-31 16:2"|awk -F "user=" '{print $2}'|awk '{print $1}'|sort|uniq -c</div><div>&nbsp; &nbsp; &nbsp; 1 u4</div><div>postgres@db-xxx-xxx-8-83-&gt; cat postgresql-2013-05-31_000000.csv |grep "connection authorized"|grep "2013-05-31 16:3"|awk -F "user=" '{print $2}'|awk '{print $1}'|sort|uniq -c</div><div>&nbsp; &nbsp; &nbsp;72 u1</div><div>&nbsp; &nbsp; &nbsp; 6 u2</div><div>&nbsp; &nbsp; &nbsp; 8 u3</div><div>&nbsp; &nbsp; 187 u4</div><div>&nbsp; &nbsp; &nbsp; 4 u5</div><div>&nbsp; &nbsp; &nbsp; 1 u6</div><div>postgres@db-xxx-xxx-8-83-&gt; cat postgresql-2013-05-31_000000.csv |grep "connection authorized"|grep "2013-05-31 16:4"|awk -F "user=" '{print $2}'|awk '{print $1}'|sort|uniq -c</div><div>&nbsp; &nbsp; &nbsp; 1 u1</div><div>&nbsp; &nbsp; 191 u2</div><div>&nbsp; &nbsp; 160 u3</div><div>&nbsp; &nbsp; 242 u4</div></div><div><br></div></div><div>[参考]</div></div></div><div>1.&nbsp;<a style="line-height: 22px;" href="http://blog.163.com/digoal@126/blog/static/1638770402013538332090/"   >http://blog.163.com/digoal@126/blog/static/1638770402013538332090/</a></div><div>2.&nbsp;<a style="line-height: 22px;" href="http://blog.163.com/digoal@126/blog/static/16387704020135383852715/"   >http://blog.163.com/digoal@126/blog/static/16387704020135383852715/</a></div>3. man strace<br><div>4.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://www.dedoimedo.com/computers/crash-analyze.html"   >http://www.dedoimedo.com/computers/crash-analyze.html</a></div></div>
	</div>
</div>
</body>
</html>