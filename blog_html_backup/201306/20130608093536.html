<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Install OCZ RevoDrive3X2 on Ubuntu 12.04 x64 with kernel 3.2.0-23-generic</h2>
	<h5 id="">2013-06-08 9:35:36&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020135885845309/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>默认情况下Ubuntu 带的mvsas驱动可以将OCZ RevoDrive3X2驱起来, 但是性能不怎么样, 并且一块240G的盘在系统中会被认成2块120G的盘.</div><div>详见如下文章 :&nbsp;</div><div><a href="http://blog.163.com/digoal@126/blog/static/163877040201331012913561/"   >http://blog.163.com/digoal@126/blog/static/163877040201331012913561/</a></div><div><br></div><div>实际上OCZ有Ubuntu下的驱动, 本文介绍一下如何安装这个驱动.</div><div>首先要下载驱动, 在OCZ网站上找到12.04对应的驱动,</div><div><a rel="nofollow" href="http://ocz.com/enterprise/download/drivers"   >http://ocz.com/enterprise/download/drivers</a></div><div><table style="padding: 0px; margin: 0px 0px 25px; border-collapse: collapse; border-spacing: 0px; width: 700px; font-size: 0.8em; background-color: rgb(242, 243, 244); color: rgb(91, 91, 91); line-height: normal;"   ><tbody style="padding: 0px; margin: 0px;"   ><tr style="padding: 0px; margin: 0px; background-color: rgb(226, 230, 232);"   ><td style="padding: 9px; margin: 0px; font-weight: bold; vertical-align: middle; border-right-width: 1px; border-right-style: solid; border-right-color: rgb(255, 255, 255); width: 190px;"   >Ubuntu 12.04 64-bit</td><td style="padding: 9px; margin: 0px; vertical-align: middle; text-align: center; border-right-width: 1px; border-right-style: solid; border-right-color: rgb(255, 255, 255);"   >3.7.6.3912</td><td style="padding: 9px; margin: 0px; vertical-align: middle; text-align: center; border-right-width: 1px; border-right-style: solid; border-right-color: rgb(255, 255, 255);"   >3.2.0-23-generic</td><td style="padding: 9px; margin: 0px; vertical-align: middle; text-align: center; border-right-width: 1px; border-right-style: solid; border-right-color: rgb(255, 255, 255);"   >Dec 19, 2012</td><td style="padding: 9px; margin: 0px; vertical-align: middle; text-align: center; border-right-width: 1px; border-right-style: solid; border-right-color: rgb(255, 255, 255);"   >No</td><td style="padding: 9px; margin: 0px; vertical-align: middle; text-align: center; border-right-style: none;"   ><a style="padding: 0px; margin: 0px; color: rgb(0, 84, 137); text-decoration: none; outline: 0px; border-bottom-style: none;" rel="nofollow" href="http://ocz.com/enterprise/download/drivers/OCZ_Ubuntu_12.04_64-bit_3.7.6.3912.tar.gz"   ><img title="Install OCZ RevoDrive3X2 on Ubuntu 12.04 x64 with kernel 3.2.0-23-generic - 德哥@Digoal - PostgreSQL"   alt="Install OCZ RevoDrive3X2 on Ubuntu 12.04 x64 with kernel 3.2.0-23-generic - 德哥@Digoal - PostgreSQL"   src="http://ocz.com/images/icon_download.png"   style="padding: 0px; margin: 0px 0px 3px; color: transparent; font-size: 0px; vertical-align: middle; max-width: 700px;"   >&nbsp;202KB</a></td></tr></table></div><div>注意它的内核版本是3.2.0-23-generic的. 操作系统为64位.</div><div>如果你用的是12.04 x64的版本, 但是内核版本对不上的话, 首先要加载这个内核.</div><div>检查当前版本.</div><div><pre class="prettyprint"   ><p><font size="2"   >uname -a</font></p></pre></div><div>如果不是<span style="line-height: 22px;"   >3.2.0-23-generic, 那么看一下/boot中有没有这个内核版本.</span></div><div><pre class="prettyprint"   ><p></p><div><span style="line-height: 22px;"   ><font size="2"   >cd /boot</font></span></div><div><span style="line-height: 22px;"   ><font size="2"   >ls -la</font></span></div><p></p></pre></div><div><span style="line-height: 22px;"   >如果在这个目录中没有对应的内核版本, 那么需要重新安装这个内核.</span></div><div><span style="line-height: 22px;"   >首先要查看内核包名称</span></div><div><pre class="prettyprint"   ><p></p><div><span style="line-height: 22px;"   ><font size="2"   >root@digoal-PowerEdge-R610:~# apt-cache search linux-image|grep generic</font></span></div><div><div><font size="2"   >linux-image-3.2.0-23-generic - Linux kernel image for version 3.2.0 on 64 bit x86 SMP</font></div></div><p></p></pre></div><div>包的名称为<span style="line-height: 22px;"   >linux-image-3.2.0-23-generic</span></div><div><span style="line-height: 22px;"   >然后安装这个包</span></div><pre class="prettyprint"   ><p></p><div><font size="2"   >apt-get install&nbsp;<span style="line-height: 22px;"   >linux-image-3.2.0-23-generic</span></font></div><div></div><p></p></pre><div><span style="line-height: 22px;"   >安装完后需要调整grub.cfg, 让系统以这个内核引导 :&nbsp;</span></div><div><span style="line-height: 22px;"   >vi /boot/grub/grub.cfg</span></div><div><span style="line-height: 22px;"   ><div><pre class="prettyprint"   ><p></p><div><font size="2"   >### BEGIN /etc/grub.d/00_header ###</font></div><div><font size="2"   >if [ -s $prefix/grubenv ]; then</font></div><div><font size="2"   >&nbsp; set have_grubenv=true</font></div><div><font size="2"   >&nbsp; load_env</font></div><div><font size="2"   >fi</font></div><div><font size="2"   >set default="2&gt;2"</font></div><p></p></pre></div><div>解释一下这里设置的2&gt;2, 第一个2表示第一级别菜单, 第二个2表示该主菜单中的子菜单.</div><div>以0开始编号.</div><div>对应的菜单如下 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >menuentry 'Ubuntu, with Linux 3.5.0-26-generic' --class ubuntu --class gnu-linux --class gnu --class os {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; recordfail</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; gfxmode $linux_gfx_mode</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod gzio</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod part_msdos</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod ext2</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; set root='(hd0,msdos1)'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; search --no-floppy --fs-uuid --set=root 8c78d733-7f2c-49b5-81c8-2ebf2af45979</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; linux &nbsp; /boot/vmlinuz-3.5.0-26-generic root=UUID=8c78d733-7f2c-49b5-81c8-2ebf2af45979 ro &nbsp; quiet splash $vt_handoff</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; initrd &nbsp;/boot/initrd.img-3.5.0-26-generic</font></div><div><font size="2"   >}</font></div><div><font size="2"   >menuentry 'Ubuntu, with Linux 3.5.0-26-generic (recovery mode)' --class ubuntu --class gnu-linux --class gnu --class os {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; recordfail</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod gzio</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod part_msdos</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod ext2</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; set root='(hd0,msdos1)'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; search --no-floppy --fs-uuid --set=root 8c78d733-7f2c-49b5-81c8-2ebf2af45979</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; echo &nbsp; &nbsp;'Loading Linux 3.5.0-26-generic ...'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; linux &nbsp; /boot/vmlinuz-3.5.0-26-generic root=UUID=8c78d733-7f2c-49b5-81c8-2ebf2af45979 ro recovery nomodeset&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; echo &nbsp; &nbsp;'Loading initial ramdisk ...'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; initrd &nbsp;/boot/initrd.img-3.5.0-26-generic</font></div><div><font size="2"   >}</font></div><div><font size="2"   ># 第一级=2的如下</font></div><div><font size="2"   >submenu "Previous Linux versions" {</font></div><div><font size="2"   >menuentry 'Ubuntu, with Linux 3.5.0-23-generic' --class ubuntu --class gnu-linux --class gnu --class os {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; recordfail</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; gfxmode $linux_gfx_mode</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod gzio</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod part_msdos</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod ext2</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; set root='(hd0,msdos1)'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; search --no-floppy --fs-uuid --set=root 8c78d733-7f2c-49b5-81c8-2ebf2af45979</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; linux &nbsp; /boot/vmlinuz-3.5.0-23-generic root=UUID=8c78d733-7f2c-49b5-81c8-2ebf2af45979 ro &nbsp; quiet splash $vt_handoff</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; initrd &nbsp;/boot/initrd.img-3.5.0-23-generic</font></div><div><font size="2"   >}</font></div><div><font size="2"   >menuentry 'Ubuntu, with Linux 3.5.0-23-generic (recovery mode)' --class ubuntu --class gnu-linux --class gnu --class os {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; recordfail</font></div></div><div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod gzio</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod part_msdos</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod ext2</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; set root='(hd0,msdos1)'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; search --no-floppy --fs-uuid --set=root 8c78d733-7f2c-49b5-81c8-2ebf2af45979</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; echo &nbsp; &nbsp;'Loading Linux 3.5.0-23-generic ...'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; linux &nbsp; /boot/vmlinuz-3.5.0-23-generic root=UUID=8c78d733-7f2c-49b5-81c8-2ebf2af45979 ro recovery nomodeset&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; echo &nbsp; &nbsp;'Loading initial ramdisk ...'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; initrd &nbsp;/boot/initrd.img-3.5.0-23-generic</font></div><div><font size="2"   >}</font></div><div><font size="2"   ># 第二级=2的如下 :&nbsp;</font></div><div><font size="2"   >menuentry 'Ubuntu, with Linux 3.2.0-23-generic' --class ubuntu --class gnu-linux --class gnu --class os {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; recordfail</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; gfxmode $linux_gfx_mode</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod gzio</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod part_msdos</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod ext2</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; set root='(hd0,msdos1)'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; search --no-floppy --fs-uuid --set=root 8c78d733-7f2c-49b5-81c8-2ebf2af45979</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; linux &nbsp; /boot/vmlinuz-3.2.0-23-generic root=UUID=8c78d733-7f2c-49b5-81c8-2ebf2af45979 ro &nbsp; quiet splash $vt_handoff</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; initrd &nbsp;/boot/initrd.img-3.2.0-23-generic</font></div><div><font size="2"   >}</font></div><div><font size="2"   >menuentry 'Ubuntu, with Linux 3.2.0-23-generic (recovery mode)' --class ubuntu --class gnu-linux --class gnu --class os {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; recordfail</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod gzio</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod part_msdos</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; insmod ext2</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; set root='(hd0,msdos1)'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; search --no-floppy --fs-uuid --set=root 8c78d733-7f2c-49b5-81c8-2ebf2af45979</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; echo &nbsp; &nbsp;'Loading Linux 3.2.0-23-generic ...'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; linux &nbsp; /boot/vmlinuz-3.2.0-23-generic root=UUID=8c78d733-7f2c-49b5-81c8-2ebf2af45979 ro recovery nomodeset&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; echo &nbsp; &nbsp;'Loading initial ramdisk ...'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; initrd &nbsp;/boot/initrd.img-3.2.0-23-generic</font></div><div><font size="2"   >}</font></div><div><font size="2"   >}</font></div></div><p></p></pre></div></span></div><div>在修改完/boot/grub/grub.cfg后重启操作系统.</div><div>重启完检查当前内核版本是否正确 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-PowerEdge-R610:/boot# uname -a</font></div><div><font size="2"   >Linux digoal-PowerEdge-R610 3.2.0-23-generic #36-Ubuntu SMP Tue Apr 10 20:39:51 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux</font></div><p></p></pre></div><div><br></div><div>接下来就可以下载对应的驱动了 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >wget&nbsp;http://ocz.com/enterprise/download/drivers/OCZ_Ubuntu_12.04_64-bit_3.7.6.3912.tar.gz</font></div><div></div><p></p></pre></div><div>解压并将其拷贝到对应的目录.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >tar -zxvf&nbsp;<span style="line-height: 22px;"   >OCZ_Ubuntu_12.04_64-bit_3.7.6.3912.tar.gz</span></font></div><div><font size="2"   >cp ocz10xx.ko /mnt/lib/modules/3.2.0-23-generic/kernel/drivers/scsi/mvsas/</font></div><p></p></pre></div><div>在确保没有其他盘用到mvsas驱动的前提下, 移除当前mvsas驱动. (使用lspci -k -vvvv|less 查看这个驱动是不是只有OCZ PCI-E在使用)</div><pre class="prettyprint"   ><p></p><div><font size="2"   >rmmod -f mvsas</font></div><div></div><p></p></pre><div><span style="line-height: 22px;"   >将mvsas加入黑名单</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >vi /etc/modprobe.d/blacklist.conf</font></div><div><font size="2"   >blacklist mvsas</font></div><p></p></pre></div><div>建立模块依赖列表</div><pre class="prettyprint"   ><p></p><div><font size="2"   >depmod -a</font></div><div></div><p></p></pre><div><span style="line-height: 22px;"   >查看</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-PowerEdge-R610:/boot# grep ocz /lib/modules/3.2.0-23-generic/modules.dep</font></div><div><font size="2"   >kernel/drivers/scsi/mvsas/ocz10xx.ko:</font></div><p></p></pre></div><div>插入ocz10xx模块</div><pre class="prettyprint"   ><p></p><div><font size="2"   >modprobe ocz10xx</font></div><div></div><p></p></pre><div><span style="line-height: 22px;"   >将ocz10xx加入initramfs</span></div><pre class="prettyprint"   ><p></p><div><font size="2"   >vi&nbsp;/etc/initramfs-tools/modules</font></div><div></div><p></p></pre><div><span style="line-height: 22px;"   >确保/etc/initramfs-tools/modules文件中有如下行</span></div><pre class="prettyprint"   ><p></p><div><font size="2"   >ocz10xx</font></div><div></div><p></p></pre><div><span style="line-height: 22px;"   >重建initramfs, 更新所有内核版本</span></div><pre class="prettyprint"   ><p></p><div><font size="2"   >update-initramfs -u -k all -v &gt; /tmp/output.txt</font></div><div></div><p></p></pre><div><span style="line-height: 22px;"   >重启操作系统.</span></div><div>重启后查看是否使用了ocz10xx驱动. 如下当前使用的是ocz10xx驱动, mvsas已经加入黑名单了.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-PowerEdge-R610:/boot# lspci -k -vvvv|grep ocz10xx</font></div><div><span style="line-height: 22px;"   ><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel driver in use: ocz10xx</font></span></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel modules: ocz10xx, mvsas</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel driver in use: ocz10xx</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel modules: ocz10xx, mvsas</font></div><p></p></pre></div><div><br></div><div>[其他]</div><div>1. 如果一切使用了mvsas, 由于磁盘被分割成了2块盘, 如果在使用mvsas时创建了pv, 会出现异常如下.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-PowerEdge-R610:/boot# pvs</font></div><div><font size="2"   >&nbsp; Couldn't find device with uuid nnedB0-oBoS-PZZ2-ZyVK-yyE5-T9dN-xcEz8C.</font></div><div><font size="2"   >&nbsp; Couldn't find device with uuid Od1c6B-i2Ow-HFM1-i7Wf-HtzK-9R22-2VHArf.</font></div><div><font size="2"   >&nbsp; PV &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VG &nbsp; &nbsp; &nbsp; Fmt &nbsp;Attr PSize &nbsp; PFree</font></div><div><font size="2"   >&nbsp; /dev/sdb &nbsp; &nbsp; &nbsp; vgdata01 lvm2 a- &nbsp; 185.75g &nbsp; &nbsp;0&nbsp;</font></div><div><font size="2"   >&nbsp; /dev/sdc &nbsp; &nbsp; &nbsp; vgdata01 lvm2 a- &nbsp; 476.37g &nbsp; &nbsp;0&nbsp;</font></div><div><font size="2"   >&nbsp; /dev/sdd &nbsp; &nbsp; &nbsp; vgdata01 lvm2 a- &nbsp; 111.79g &nbsp; &nbsp;0&nbsp;</font></div><div><font size="2"   >&nbsp; /dev/sde &nbsp; &nbsp; &nbsp; vgdata01 lvm2 a- &nbsp; 111.79g &nbsp; &nbsp;0&nbsp;</font></div><div><font size="2"   >&nbsp; unknown device vgdata01 lvm2 a- &nbsp; 111.79g &nbsp; &nbsp;0&nbsp;</font></div><div><font size="2"   >&nbsp; unknown device vgdata01 lvm2 a- &nbsp; 111.79g &nbsp; &nbsp;0&nbsp;</font></div><p></p></pre></div><div>修复方法 :&nbsp;</div><div>删除lvm cache文件.</div><div><pre class="prettyprint"   ><p></p><div><span style="line-height: 22px;"   ><font size="2"   >root@digoal-PowerEdge-R610:/boot# rm /etc/lvm/cache/.cache&nbsp;</font></span></div><div><font size="2"   >rm: remove regular file `/etc/lvm/cache/.cache'? y</font></div><p></p></pre></div><div>移除丢失的pv</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-PowerEdge-R610:/boot# vgreduce --removemissing vgdata01</font></div><div><font size="2"   >&nbsp; Couldn't find device with uuid nnedB0-oBoS-PZZ2-ZyVK-yyE5-T9dN-xcEz8C.</font></div><div><font size="2"   >&nbsp; Couldn't find device with uuid Od1c6B-i2Ow-HFM1-i7Wf-HtzK-9R22-2VHArf.</font></div><div><font size="2"   >&nbsp; Wrote out consistent volume group vgdata01</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:/boot# vgscan</font></div><div><font size="2"   >&nbsp; Reading all physical volumes. &nbsp;This may take a while...</font></div><div><font size="2"   >&nbsp; Found volume group "vgdata01" using metadata type lvm2</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:/boot# pvscan</font></div><div><font size="2"   >&nbsp; PV /dev/sdb &nbsp; VG vgdata01 &nbsp; lvm2 [185.75 GiB / 185.75 GiB free]</font></div><div><font size="2"   >&nbsp; PV /dev/sdc &nbsp; VG vgdata01 &nbsp; lvm2 [476.37 GiB / 476.37 GiB free]</font></div><div><font size="2"   >&nbsp; PV /dev/sdd &nbsp; VG vgdata01 &nbsp; lvm2 [111.79 GiB / 111.79 GiB free]</font></div><div><font size="2"   >&nbsp; PV /dev/sde &nbsp; VG vgdata01 &nbsp; lvm2 [111.79 GiB / 111.79 GiB free]</font></div><div><font size="2"   >&nbsp; Total: 4 [885.70 GiB] / in use: 4 [885.70 GiB] / in no VG: 0 [0 &nbsp; ]</font></div><p></p></pre></div><div>重建vg</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >root@digoal-PowerEdge-R610:/boot# vgremove vgdata01</font></div><div><font size="2"   >&nbsp; Volume group "vgdata01" successfully removed</font></div></div><div><div><font size="2"   >root@digoal-PowerEdge-R610:/boot# pvremove /dev/sdd</font></div><div><font size="2"   >&nbsp; Labels on physical volume "/dev/sdd" successfully wiped</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:/boot# pvremove /dev/sde</font></div><div><font size="2"   >&nbsp; Labels on physical volume "/dev/sde" successfully wiped</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:/boot# pvremove /dev/sdb</font></div><div><font size="2"   >&nbsp; Labels on physical volume "/dev/sdb" successfully wiped</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:/boot# pvremove /dev/sdc</font></div><div><font size="2"   >&nbsp; Labels on physical volume "/dev/sdc" successfully wiped</font></div></div><p></p></pre></div><div>移除pv后, 新建分区时注意使用1MB对齐 :&nbsp;</div><div><a href="http://blog.163.com/digoal@126/blog/static/16387704020135753630439/"   >http://blog.163.com/digoal@126/blog/static/16387704020135753630439/</a></div><div><br></div><div><span style="line-height: 22px;"   >[参考]</span></div><div>1.&nbsp;<a style="line-height: 22px;" href="http://blog.163.com/digoal@126/blog/static/16387704020135753630439/"   >http://blog.163.com/digoal@126/blog/static/16387704020135753630439/</a></div>2.&nbsp;<a rel="nofollow" href="http://www.serversaustralia.com.au/blog/revodrive3-x2-on-ubuntu-oh-yeah/"   >http://www.serversaustralia.com.au/blog/revodrive3-x2-on-ubuntu-oh-yeah/</a></div>
	</div>
</div>
</body>
</html>