<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">System.map file is a symbol table used by the kernel</h2>
	<h5 id="">2013-11-13 14:16:23&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402013101381844107/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>System.map文件中包含了符号以及对应的在内存中的地址表信息.</div><div>例如</div><div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-150 ~]# less /boot/System.map-$(uname -r)</font></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-150 ~]# uname -r</font></div><div style="line-height: 28px;"   ><font size="2"   >2.6.32-358.el6.x86_64</font></div><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-150 ~]# less /boot/System.map-2.6.32-358.el6.x86_64</font></div></div><div style="line-height: 28px;"   ><font size="2"   >0000000000000000 A VDSO32_PRELINK</font></div><div style="line-height: 28px;"   ><font size="2"   >0000000000000000 D __per_cpu_start</font></div><div style="line-height: 28px;"   ><font size="2"   >0000000000000000 D per_cpu__irq_stack_union</font></div><div style="line-height: 28px;"   ><font size="2"   >0000000000000000 A xen_irq_disable_direct_reloc</font></div><div style="line-height: 28px;"   ><font size="2"   >0000000000000000 A xen_save_fl_direct_reloc</font></div><div style="line-height: 28px;"   ><font size="2"   >0000000000000040 A VDSO32_vsyscall_eh_frame_size</font></div></div><div style="line-height: 28px;"   ><font size="2"   >... 略</font></div><p></p></pre></div></div></div><div style="line-height: 28px;"   >中间的字段代表符号类型信息, 第一个字段是内存地址, 第三个字段是符号名 :&nbsp;</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   >类型如下 :&nbsp;</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >Some of these types are:</font></div><div style="line-height: 28px;"   ><font size="2"   >A for absolute.</font></div><div style="line-height: 28px;"   ><font size="2"   >B or b for uninitialized data section (called BSS).</font></div><div style="line-height: 28px;"   ><font size="2"   >D or d for initialized data section.</font></div><div style="line-height: 28px;"   ><font size="2"   >G or g for initialized data section for small objects (global).</font></div><div style="line-height: 28px;"   ><font size="2"   >i for sections specific to DLLs.</font></div><div style="line-height: 28px;"   ><font size="2"   >N for debugging symbol.</font></div><div style="line-height: 28px;"   ><font size="2"   >p for stack unwind section.</font></div><div style="line-height: 28px;"   ><font size="2"   >R or r for read only data section.</font></div><div style="line-height: 28px;"   ><font size="2"   >S or s for uninitialzed data section for small objects.</font></div><div style="line-height: 28px;"   ><font size="2"   >T or t for text (code) section.</font></div><div style="line-height: 28px;"   ><font size="2"   >U for undefined.</font></div><div style="line-height: 28px;"   ><font size="2"   >V or v for weak object.</font></div><div style="line-height: 28px;"   ><font size="2"   >W or w for weak objects which have not been tagged so.</font></div><div style="line-height: 28px;"   ><font size="2"   >- for stabs symbol in an a.out object file.</font></div><div style="line-height: 28px;"   ><font size="2"   >? for 'symbol type unknown.'</font></div><p></p></pre></div></div></div><div style="line-height: 28px;"   ><br></div><div>在其他机器使用stap产生的ko文件时, 如果对方的System.map文件与主文件不一致, 则可能无法使用tapset中的symname()函数通过地址得到符号名.</div><div><a style="line-height: 28px;" href="http://blog.163.com/digoal@126/blog/static/163877040201391451459751/"   >http://blog.163.com/digoal@126/blog/static/163877040201391451459751/</a></div><div><br></div><div><span style="line-height: 28px;"   >System.map文件可以在以下两个位置找到.</span></div><div><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;/usr/src/kernels/`uname -r`/.config</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;<span style="line-height: 28px;"   >/lib/modules/</span><span style="line-height: 28px;"   >`uname -r`</span><span style="line-height: 28px;"   >/build/System.map</span></font></div></div><div><div><font size="2"   >[root@db-172-16-3-150 commands]# md5sum /lib/modules/2.6.32-358.el6.x86_64/build/System.map</font></div><div><font size="2"   >ef58493777cfca95c66aab2028d771a0 &nbsp;/lib/modules/2.6.32-358.el6.x86_64/build/System.map</font></div><div><font size="2"   >[root@db-172-16-3-150 commands]# md5sum /boot/System.map-2.6.32-358.el6.x86_64&nbsp;</font></div><div><font size="2"   >ef58493777cfca95c66aab2028d771a0 &nbsp;/boot/System.map-2.6.32-358.el6.x86_64</font></div></div><p></p></pre></div></div><div><br></div><div>符号表更多的信息可参考<a style="line-height: 28px;" rel="nofollow" href="http://en.wikipedia.org/wiki/Symbol_table"   >http://en.wikipedia.org/wiki/Symbol_table</a></div><div><br></div><div>[其他]</div><div>内核自动产生的make config,&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >/usr/src/kernels/2.6.32-358.el6.x86_64/.config</font></div><div><div><font size="2"   >#</font></div><div><font size="2"   ># Automatically generated make config: don't edit</font></div><div><font size="2"   ># Linux kernel version: 2.6.32-358.el6.x86_64</font></div><div><font size="2"   ># Fri Feb 22 00:26:01 2013</font></div><div><font size="2"   >#</font></div><div><font size="2"   >CONFIG_64BIT=y</font></div><div><font size="2"   ># CONFIG_X86_32 is not set</font></div><div><font size="2"   >CONFIG_X86_64=y</font></div><div><font size="2"   >CONFIG_X86=y</font></div><div><font size="2"   >CONFIG_OUTPUT_FORMAT="elf64-x86-64"</font></div><div><font size="2"   >CONFIG_ARCH_DEFCONFIG="arch/x86/configs/x86_64_defconfig"</font></div><div><font size="2"   >CONFIG_GENERIC_CMOS_UPDATE=y</font></div><div><font size="2"   >CONFIG_CLOCKSOURCE_WATCHDOG=y</font></div><div><font size="2"   >CONFIG_GENERIC_CLOCKEVENTS=y</font></div><div><font size="2"   >CONFIG_GENERIC_CLOCKEVENTS_BROADCAST=y</font></div><div><font size="2"   >CONFIG_LOCKDEP_SUPPORT=y</font></div><div><font size="2"   >CONFIG_STACKTRACE_SUPPORT=y</font></div><div><font size="2"   >CONFIG_HAVE_LATENCYTOP_SUPPORT=y</font></div><div><font size="2"   >CONFIG_MMU=y</font></div><div><font size="2"   >CONFIG_ZONE_DMA=y</font></div><div><font size="2"   >CONFIG_NEED_DMA_MAP_STATE=y</font></div></div><div><font size="2"   >...</font></div><p></p></pre></div><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" rel="nofollow" href="http://en.wikipedia.org/wiki/System.map"   >http://en.wikipedia.org/wiki/System.map</a></div><div>2.&nbsp;<a style="line-height: 28px;" rel="nofollow" href="http://en.wikipedia.org/wiki/Kernel_oops"   >http://en.wikipedia.org/wiki/Kernel_oops</a></div><div>3.&nbsp;<a style="line-height: 28px;" rel="nofollow" href="http://en.wikipedia.org/wiki/Kernel_panic"   >http://en.wikipedia.org/wiki/Kernel_panic</a></div><div>4.&nbsp;<a style="line-height: 28px;" rel="nofollow" href="https://sourceware.org/systemtap/SystemTap_Beginners_Guide/useful-systemtap-scripts.html"   >https://sourceware.org/systemtap/SystemTap_Beginners_Guide/useful-systemtap-scripts.html</a></div><div>5.&nbsp;<a style="line-height: 28px;" rel="nofollow" href="http://en.wikipedia.org/wiki/Symbol_table"   >http://en.wikipedia.org/wiki/Symbol_table</a></div><div>6.&nbsp;<a style="line-height: 28px;" rel="nofollow" href="https://sourceware.org/systemtap/tapsets/API-symname.html"   >https://sourceware.org/systemtap/tapsets/API-symname.html</a></div><div>7.&nbsp;/usr/src/kernels/`uname -r`/.config</div><div>8.&nbsp;<span style="line-height: 28px;"   >/lib/modules/</span><span style="line-height: 28px;"   >`uname -r`</span><span style="line-height: 28px;"   >/build/System.map</span></div></div>
	</div>
</div>
</body>
</html>