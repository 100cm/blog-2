<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL replication monitor</h2>
	<h5 id="">2011-05-11 17:35:21&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201141134748660/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;">PostgreSQL的 stream replication延迟一般来说受到以下几方面的影响 ：<wbr><div>1. primary 和 standby之间通讯的网络质量 .&nbsp;</div><div>2. primary 的 负载 .&nbsp;</div><div>3. standby 的 负载 .&nbsp;</div><div>4. standby的在查询事务长度以及配置参数 如 max_standby_archive_delay，max_standby_streaming_delay .&nbsp;</div><div><br></div><div>同步的情况可以从主节点和STANDBY节点的以下函数或统计视图获取:</div><div>primary :&nbsp;</div><div>pg_current_xlog_location()</div><div><span style="font-family: monospace; -webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px; line-height: normal; font-size: medium;"   >9.1版本增加的统计视图 : pg_stat_replication</span><br><br></div><div>standby :&nbsp;</div><div>pg_last_xlog_receive_location</div><div>pg_last_xlog_replay_location</div><div><br></div><div>1. 主节点和STANDBY节点之间网络质量问题的表象:</div><div><span style="font-family: monospace; line-height: normal; font-size: medium;"   >sent_location 和&nbsp;</span>pg_last_xlog_receive_location的差别比较大.</div><div><br></div><div>2.&nbsp;primary 的 负载压力比较大的表象:</div><div><span style="font-family: monospace; line-height: normal; font-size: medium;"   >pg_current_xlog_location 和&nbsp;</span><span style="font-family: monospace; line-height: normal; font-size: medium;"   >sent_location的差别比较大.</span></div><div><span style="font-family: monospace; line-height: normal; font-size: medium;"   ><br></span></div><div><span style="font-family: monospace; line-height: normal; font-size: medium;"   >3.</span>standby 的 负载压力比较大的表象 :&nbsp;</div><div>pg_last_xlog_receive_location 和&nbsp;pg_last_xlog_replay_location 的差别比较大。</div><div><br></div><div>4.&nbsp;standby的在查询事务长度以及配置参数 如 max_standby_archive_delay，max_standby_streaming_delay 配置过大或长事务且与APPLY的数据有冲突时的表象 :&nbsp;</div><div>pg_last_xlog_receive_location 和&nbsp;pg_last_xlog_replay_location 的差别比较大。</div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="PostgreSQL replication monitor - 德哥@Digoal - PostgreSQL"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>