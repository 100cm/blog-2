<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">A Ruby reference Example</h2>
	<h5 id="">2012-02-29 8:15:03&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020121298139205/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><font size="2"  >object_id在Ruby中通常用于判断两个对象是不是一个物理上的东西.</font><div><font size="2"  >object_id相同的对象可以理解为它们都指向了同一个值.</font></div><div><font size="2"  >例如,String类的对象 :&nbsp;</font></div><div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >s1 = %Q/Hello, I'm Digoal.Zhou/</font></div><div><font size="2"  >s2 = s1  # 把一个String对象赋值给另一个对象, 其实是一次reference赋值</font></div><div><font size="2"  >s3 = s1.clone()  # 使用clone()方法则不是reference操作, 而是重新创建了一个对象.</font></div><div><font size="2"  >puts(s1.class)</font></div><div><font size="2"  >puts(s2.class)</font></div><div><font size="2"  >puts("s1: #{s1}")</font></div><div><font size="2"  >puts("s2: #{s2}")</font></div><div><font size="2"  >puts(s1.object_id) # 看看这三个对象的object_id就知道了.</font></div><div><font size="2"  >puts(s2.object_id)</font></div><div><font size="2"  >puts(s3.object_id)</font></div><div><font size="2"  >s1.reverse!</font></div><div><font size="2"  >puts("s1: #{s1}")  # 修改s1 后 , s2其实也修改了, 因为它们执行同一个值.</font></div><div><font size="2"  >puts("s2: #{s2}")</font></div><div><font size="2"  >puts("s3: #{s3}")  # 显然s3是另一个对象, 修改s1,s2对它没反映.</font></div><div><font size="2"  >s2.capitalize!</font></div><div><font size="2"  >puts("s1: #{s1}")</font></div><div><font size="2"  >puts("s2: #{s2}")</font></div><div><font size="2"  >puts("s3: #{s3}")</font></div><div><font size="2"  >s1.reverse! &lt;&lt; '. What\'s your name?'</font></div><div><font size="2"  >puts("s1: #{s1}")</font></div><div><font size="2"  >puts("s2: #{s2}")</font></div><div><font size="2"  >puts("s3: #{s3}")</font></div><div><font size="2"  >s2[0,6] = 'DIG'  # 这是修改从0号index开始的6个字符.即"hello,"改为"DIG"<br>puts("s1: #{s1}")<br>puts("s2: #{s2}")<br>puts("s3: #{s3}")</font></div><div><font size="2"  >puts(s1.object_id)</font></div><div><font size="2"  >puts(s2.object_id)</font></div><div><font size="2"  >puts(s3.object_id)</font></div><div><font size="2"  ><br></font></div><p></p></pre></div><font size="2"  >执行结果 :&nbsp;<wbr></font></div><div><p></p><div><pre class="prettyprint"  ><p></p><div><font size="2"  >String</font></div><div><font size="2"  >String</font></div><div><font size="2"  >s1: Hello, I'm Digoal.Zhou</font></div><div><font size="2"  >s2: Hello, I'm Digoal.Zhou</font></div><div><font size="2"  >16581468</font></div><div><font size="2"  >16581468</font></div><div><font size="2"  >16581456</font></div><div><font size="2"  >s1: uohZ.laogiD m'I ,olleH</font></div><div><font size="2"  >s2: uohZ.laogiD m'I ,olleH</font></div><div><font size="2"  >s3: Hello, I'm Digoal.Zhou</font></div><div><font size="2"  >s1: Uohz.laogid m'i ,olleh</font></div><div><font size="2"  >s2: Uohz.laogid m'i ,olleh</font></div><div><font size="2"  >s3: Hello, I'm Digoal.Zhou</font></div><div><font size="2"  >s1: hello, i'm digoal.zhoU. What's your name?</font></div><div><font size="2"  >s2: hello, i'm digoal.zhoU. What's your name?</font></div><div><font size="2"  >s3: Hello, I'm Digoal.Zhou</font></div><div><font size="2"  >s1: DIG i'm digoal.zhoU. What's your name?<br>s2: DIG i'm digoal.zhoU. What's your name?<br>s3: Hello, I'm Digoal.Zhou</font></div><div><font size="2"  >16581468</font></div><div><font size="2"  >16581468</font></div><div><font size="2"  >16581456</font></div><p></p></pre></div><div><font size="2"  >例如, Array类的对象也一样 :&nbsp;</font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >a1 = Array.new([1,2,3,4,5])</font></div><div><font size="2"  >a2 = a1</font></div><div><font size="2"  >a3 = a1.clone()</font></div><div><font size="2"  >print("a1,#{a1}\n")</font></div><div><font size="2"  >print("a2,#{a2}\n")</font></div><div><font size="2"  >print("a3,#{a3}\n")</font></div><div><font size="2"  >puts(a1.object_id)</font></div><div><font size="2"  >puts(a2.object_id)</font></div><div><font size="2"  >puts(a3.object_id)</font></div><div><font size="2"  >a1[0] = "DIGOAL"</font></div><div><font size="2"  >print("a1,#{a1}\n")</font></div><div><font size="2"  >print("a2,#{a2}\n")</font></div><div><font size="2"  >print("a3,#{a3}\n")</font></div><div><font size="2"  >puts(a1.object_id)</font></div><div><font size="2"  >puts(a2.object_id)</font></div><div><font size="2"  >puts(a3.object_id)</font></div><p></p></pre></div><div><font size="2"  >执行结果 :&nbsp;</font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >a1,[1, 2, 3, 4, 5]</font></div><div><font size="2"  >a2,[1, 2, 3, 4, 5]</font></div><div><font size="2"  >a3,[1, 2, 3, 4, 5]</font></div><div><font size="2"  >15533280</font></div><div><font size="2"  >15533280</font></div><div><font size="2"  >15533256</font></div><div><font size="2"  >a1,["DIGOAL", 2, 3, 4, 5]</font></div><div><font size="2"  >a2,["DIGOAL", 2, 3, 4, 5]</font></div><div><font size="2"  >a3,[1, 2, 3, 4, 5]</font></div><div><font size="2"  >15533280</font></div><div><font size="2"  >15533280</font></div><div><font size="2"  >15533256</font></div><p></p></pre></div><div><font size="2"  >但是需要注意的是, 如果前面例子中的s1不是通过!方法或&lt;&lt;连接的,(也就是不修改s1本身) . 而是通过赋值一个字符串(哪怕相同的字符串)或其他对象的话.</font></div><div><font size="2"  >s1 的object_id将改变, 也就是说指向另一个值了, 但是s2还是指向原来的值. 我们来看个例子 :&nbsp;</font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >s1 = "Hello, I'm Digoal. What's your name?"</font></div><div><font size="2"  >s2 = s1</font></div><div><font size="2"  >puts(s1.object_id)</font></div><div><font size="2"  >puts(s2.object_id)</font></div><div><font size="2"  >s1 = "Hello, I'm Digoal. What's your name?"  # 虽然这里赋予了相同的值, 但是实际上是新产生了一个对象ID.</font></div><div><font size="2"  >puts(s1.object_id)</font></div><div><font size="2"  >puts(s2.object_id)</font></div><div><font size="2"  >s1 &lt;&lt; " Let's go."  # 所以对s1改变时, s2不会受到影响. 因为它们指向的不是一个值了.</font></div><div><font size="2"  >puts(s1)</font></div><div><font size="2"  >puts(s2)</font></div><p></p></pre></div><div><font size="2"  ><span style="line-height: 20px;"  >执行结果 :&nbsp;</span></font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >16121508</font></div><div><font size="2"  >16121508</font></div><div><font size="2"  >16121412</font></div><div><font size="2"  >16121508</font></div><div><font size="2"  >Hello, I'm Digoal. What's your name? Let's go.</font></div><div><font size="2"  >Hello, I'm Digoal. What's your name?</font></div><p></p></pre></div><p></p></div>但是对于Fixnum类的对象, 和Array,String类不太一样, 只要值相同, object_id就相同.<div><pre class="prettyprint"  ><p></p><div><font size="2"  >f1 = 10</font></div><div><font size="2"  >f2 = f1</font></div><div><font size="2"  >puts(f1.class)</font></div><div><font size="2"  >puts(f2.class)</font></div><div><font size="2"  >puts(f1.object_id)</font></div><div><font size="2"  >puts(f2.object_id)</font></div><div><font size="2"  >f1 = 10</font></div><div><font size="2"  >puts(f1.object_id)</font></div><div><font size="2"  >puts(f2.object_id)</font></div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><p></p><div><pre class="prettyprint"  ><p></p><div><font size="2"  >Fixnum</font></div><div><font size="2"  >Fixnum</font></div><div><font size="2"  >21</font></div><div><font size="2"  >21</font></div><div><font size="2"  >21</font></div><div><font size="2"  >21</font></div><p></p></pre></div><div><font size="2"  >注意仅限于Fixnum, 新赋予的Float值相同, object_id也不同 .</font></div><div><font size="2"  ><div><pre class="prettyprint"  ><p></p><div>f1 = 10.0</div><div>f2 = f1</div><div>puts(f1.class)</div><div>puts(f2.class)</div><div>puts(f1.object_id)</div><div>puts(f2.object_id)</div><div>f1 = 10.0</div><div>puts(f1.object_id)</div><div>puts(f2.object_id)</div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div>Float</div><div>Float</div><div>16354536</div><div>16354536</div><div>16354128</div><div>16354536</div><p></p></pre></div></font></div><div><font size="2"  ><span style="line-height: 20px;"  ><br></span></font></div><p></p></div></div>
	</div>
</div>
</body>
</html>