<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Ruby Study 4 : Array</h2>
	<h5 id="">2012-02-29 17:40:54&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201212914818672/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >Array class</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >1. introduce</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >Ruby的Array类和其他的不太一样, Ruby中允许一个Array对象中存储不同类型的元素. 例如 :&nbsp;</font></span></div><div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><pre class="prettyprint"  ><p></p><div><font size="2"  >class Myclass</font></div><div><font size="2"  >end</font></div><div><font size="2"  >my1 = Myclass.new</font></div><div><font size="2"  >a1 = Array.new([1,"Digoal",[1,2,3,4,5],4,my1])</font></div><div><font size="2"  >p a1</font></div><p></p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  ><font size="2"  >执行结果 :&nbsp;</font></div><div><pre class="prettyprint"  ><p><font size="2"  >[1, "Digoal", [1, 2, 3, 4, 5], 4, #&lt;Myclass:0x1e11250&gt;]</font></p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  ><font size="2"  >与String类类似, 也可以使用index来访问Array对象中的元素, index从0 开始 :&nbsp;</font></div></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><div><pre class="prettyprint"  ><p></p><div># 接上面的代码</div><div>puts(a1[0])</div><div>puts(a1[1])</div><p></p></pre></div><div>输出 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div>1</div><div>Digoal</div><p></p></pre></div></span></font></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  ><span style="line-height: 20px;"  >还可以把操作系统命令输出的结果存储到Array对象中, 如 :&nbsp;</span></font></div><div><pre class="prettyprint"  ><p><font size="2"  >a1 = %W/a b c d #{`dir`}/</font></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >还有一种更有意思的类叫Dir, 可以把指定文件夹下的文件和目录名转成Array对象.</span></font></div><div><font color="#333333"  size="2"  ><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  ><p style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  ></p><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  ><pre class="prettyprint"  ><p></p><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >#!/opt/ruby/bin/ruby</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >p(Dir.entries('/'))  # 这种用法是调用的class的singleton method, 我们可以通过Dir.singleton_methods来查看它有哪些singleton methods</div><div>print(Dir.singleton_methods)  # 结果为Symbol对象, 其中就有entries.</div><p></p></pre></div><p style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  ></p></div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p style="font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  >["home", "opt", "tmp", "net", "proc", "bin", "dev", "etc", "pgxc_gtm", ".autorelabel", "..", "pgdata", "lib", "mnt", "pgdata1919", "boot", "root", ".autofsck", "misc", "srv", "usr", "selinux", ".", "var", "lost+found", "hds2", "lib64", "sys", "sbin", "media", "hds1"]</p><p>[:open, :foreach, :entries, :chdir, :getwd, :pwd, :chroot, :mkdir, :rmdir, :delete, :unlink, :home, :glob, :[], :exist?, :exists?]</p></pre></div></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><br></span></font></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >2. create a new Array object</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >创建一个Array对象, 方法比较多 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >a1 = ['a','b',1,2]</font></div><div><font size="2"  >a2 = %W/a b c 1 2 3 4 5 #{1+2}/</font></div><div><font size="2"  >a3 = %w/a b c d e d f #{1+2}/</font></div><div><font size="2"  >a4 = Array.new([1,2,'a'])  </font></div><div><font size="2"  >a5 = Array.new(3,"abc")  # 创建含有3个元素的Array对象, 元素都是"abc"</font></div><div><font size="2"  >print(a1.class, a2.class, a3.class, a4.class, a5.class, "\n")  # 通过以上方法创建的都是Array 对象.</font></div><div><font size="2"  >p(a1)</font></div><div><font size="2"  >p(a2)</font></div><div><font size="2"  >p(a3)</font></div><div><font size="2"  >p(a4)</font></div><div><font size="2"  >p(a5)</font></div><p></p></pre></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >执行结果 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >ArrayArrayArrayArrayArray</font></div><div><font size="2"  >["a", "b", 1, 2]</font></div><div><font size="2"  >["a", "b", "c", "1", "2", "3", "4", "5", "3"]</font></div><div><font size="2"  >["a", "b", "c", "d", "e", "d", "f", "\#{1+2}"]</font></div><div><font size="2"  >[1, 2, "a"]</font></div><div><font size="2"  >["abc", "abc", "abc"]</font></div><p></p></pre></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  ><br></font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >3. nil</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >当访问一个Array类的index不存在这个元素时, 返回的是nil.</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >我们来看个例子 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >a1 = %W/a b c d/</font></div><div><font size="2"  >puts( a1[4].inspect )</font></div><div><font size="2"  >puts( a1[4].class )  # nil属于NilClass</font></div><div><font size="2"  >puts( a1[4] ) # 1.8中显示nil, 1.9中显示为空. 所以在1.9中可使用p 或inspect来显示nil.</font></div><div><font size="2"  >puts( a1[4].nil? )  # nil? 方法可以用来判断这个对象是否为nil.</font></div><p></p></pre></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >结果 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >nil</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  >NilClass</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><br></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  >true</font></div><p></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><br></span></font></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >4. multidimensional Arrays</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >多维Array, 有几种创建方法 :&nbsp;</span></font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >a1 = Array.new(2)</font></div><div><font size="2"  >a1[0] = [1,2,3,4]  # 赋予对应的index的值.</font></div><div><font size="2"  >a1[1] = [5,6,7,8]</font></div><div><font size="2"  >puts(a1.inspect)</font></div><p></p></pre></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >输出结果 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p><font size="2"  >[[1, 2, 3, 4], [5, 6, 7, 8]]</font></p></pre></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >还可以直接来创建 :&nbsp;</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  ><div><pre class="prettyprint"  ><p></p><div>a1 = [[1,2,3,4],</div><div>&nbsp; &nbsp; &nbsp; [5,6,7,8]]  # 换行是没有必要的, 这里这么写看起来比较舒服一点而已. 也可以写成 a1 = [ [1,2,3,4], [5,6,7,8] ]</div><p></p></pre></div><div>注意在使用Array.new创建Array对象时, 如果传入了初始值, 并且没有使用括弧的话, 必须在new后加上空格, 如下 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div>a1 = Array.new [1,2,3,4]</div><div>a2 = Array.new([1,2,3,4])</div><div>a3 = Array.new[1,2,3,4] &nbsp;# 这句的写法就有问题.</div><p></p></pre></div></font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  ><br></font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >5. Iterating over Array</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >前面几篇BLOG我已经讲过很多Iterating的例子, 比如说Range对象, 可以用在for 或者调用each方法等进行Iterat操作. Array同样适用.</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  ><div><pre class="prettyprint"  ><p></p><div>a1 = [1,2,3,4]</div><div>a1.each {</div><div>&nbsp; |x|</div><div>&nbsp; puts(x*x)</div><div>}</div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div>1</div><div>4</div><div>9</div><div>16</div><p></p></pre></div></font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >或者使用 for循环.</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><div><pre class="prettyprint"  ><p></p><div>a1 = [1,2,3,4]</div><div><span style="line-height: 20px;"  >for x in a1 do</span></div><div>&nbsp; puts(x*x)</div><div>end</div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div>1</div><div>4</div><div>9</div><div>16</div><p></p></pre></div></span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >当嵌套Array时, 可以传递多个变量给for循环.</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><div><pre class="prettyprint"  ><p></p><div>a1 = [ [1,2,3,4],</div><div>&nbsp; &nbsp; &nbsp; &nbsp;[5,6,7,8],</div><div>&nbsp; &nbsp; &nbsp; &nbsp;[9,10,11,12]</div><div>&nbsp; &nbsp; &nbsp;]</div><div><br></div><div>for (a,b,c,d) in a1 do</div><div>&nbsp; puts("a:#{a}, b:#{b}, c:#{c}, d:#{d}.")</div><div>end</div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div>a:1, b:2, c:3, d:4.</div><div>a:5, b:6, c:7, d:8.</div><div>a:9, b:10, c:11, d:12.</div><p></p></pre></div></font></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >还可以这样写 :&nbsp;</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><div><pre class="prettyprint"  ><p></p><div>a1 = [ [1,2,3,4],</div><div>&nbsp; &nbsp; &nbsp; &nbsp;[5,6,7,8],</div><div>&nbsp; &nbsp; &nbsp; &nbsp;[9,10,11,12]</div><div>&nbsp; &nbsp; &nbsp;]</div><div><br></div><div>for x in a1[0] do</div><div>&nbsp; puts(x)</div><div>end</div><div><br></div><div>puts(a1[0].class)  # 因为a1[0] 还是Array类对象.</div><p></p></pre></div><div style="line-height: 20px;"  >执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div>1</div><div>2</div><div>3</div><div>4</div><div>Array</div><p></p></pre></div><div style="line-height: 20px;"  ><br></div></font></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >6. Indexing into Array</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >在第一点里面已经讲过了index. 这里再展开一下, 看个例子 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >arr = ['h','e','l','l','o',' ','w','o','r','l','d']</font></div><div><font size="2"  >p( arr[0,5] )  # 从0开始, 取5个元素</font></div><div><font size="2"  >p( arr[-5,5 ] )  #  从-5开始取5个元素.</font></div><div><font size="2"  >p( arr[0..4] )  # 取0,1,2,3,4 元素</font></div><div><font size="2"  >p( arr[-5..-1] )  #　取-5,-4,-3,-2,-1 元素</font></div><p></p></pre></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >执行结果 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >["h", "e", "l", "l", "o"]</font></div><div><font size="2"  >["w", "o", "r", "l", "d"]</font></div><div><font size="2"  >["h", "e", "l", "l", "o"]</font></div><div><font size="2"  >["w", "o", "r", "l", "d"]</font></div><p></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >通过index新增或修改对应元素的值, 如果从后面写入了一个较大index的元素, 中间可能出现nil的值. 例如 :&nbsp;</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><div style="line-height: 20px;"  ><pre class="prettyprint"  ><p></p><div>a1 = [1,2,3,4,5]</div><div>a1[10] = "ok"  # 5,6,7,8,9 index 都将用nil填充</div><div>p a1</div><p></p></pre></div><div style="line-height: 20px;"  >结果 :&nbsp;</div><div><pre class="prettyprint"  ><p>[1, 2, 3, 4, 5, nil, nil, nil, nil, nil, "ok"]</p></pre></div></font></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >使用index对元素进行范围修改,</font></span></div><div><font size="2"  ><div><pre class="prettyprint"  ><p style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  ></p><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >a1 = [1,2,3,4,5]</div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >a1[0..2] = 1  # 注意这个不是要把0,1,2三个元素分别改成1. 而是三个元素变一个了.</div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >p a1</div><div><font color="#333333"  >p a1.length # 改完长度变3了.</font></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >a1[0,2] = 2,3   #这里是要把a1[0], a1[1]的值改成2 , 3 .也可以写成 <span style="line-height: 25px;"  >a1[0,2] = [2,3]</span></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >p a1</div><p style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  ></p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >执行结果 :&nbsp;</div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  ><pre class="prettyprint"  ><p></p><div>[1, 4, 5]</div><div>3</div><div>[2, 3, 5]</div><p></p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  ><br></div></font></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >7. Copy Array</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >与String类似, 拷贝Array和赋值是两码事. 需要分清楚.</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >a1 = %W/i am digoal/</font></div><div><font size="2"  >a2 = a1</font></div><div><font size="2"  >a3 = a1.clone()  #  这个是拷贝一个与a1值相同的array给a3. 所以object_id是和a1,a2不一样的.</font></div><div><font size="2"  >puts(a1.object_id)</font></div><div><font size="2"  >puts(a2.object_id)</font></div><div><font size="2"  >puts(a3.object_id)</font></div><p></p></pre></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >执行结果 :&nbsp;</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  ><div><pre class="prettyprint"  ><p></p><div>16286088</div><div>16286088</div><div>16286076</div><p></p></pre></div><div><br></div></font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >8. Testing Array for Equality</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >Array对象中有一个方法 &lt;=&gt; 用来比较两个Array.&nbsp;</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >结果 -1, 0, 1</span></font></div><div><font color="#333333"  size="2"  ><div><pre class="prettyprint"  ><p style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  ></p><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >a1 = %W/a b c d/</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >a2 = %W/a a a a a/</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >print(a1.methods.include?(:&lt;=&gt;),"\n")  # 判断是否存在&lt;=&gt;方法, 当然是true的.</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >puts(a1 &lt;=&gt; a2)  # 左边的array大于右边的, 默认是ASCII码, 逐个比较.</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >puts(a1.length &lt;=&gt; a2.length)  # 比较长度, 右边的大于左边的. 实际这个时候用的是Fixnum 的&lt;=&gt;方法. 而不是Array的&lt;=&gt;方法</div><div>a2 = a1<br>puts(a1 &lt;=&gt; a2)  # 左边等于右边, 返回0</div><div>puts(a1.length.class)  # 返回Fixnum</div><p style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  ></p></pre></div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >执行结果 :&nbsp;</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  ><pre class="prettyprint"  ><p></p><div>true</div><div>1</div><div>-1</div><div>0</div><div>Fixnum</div><p></p></pre></div></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >后面还会讲到, 一些Array之间进行比较的操作实际上调用的是&lt;=&gt;方法, 来判断大小的.</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >另外需要注意的是, &lt;=&gt;方法, 当两个进行比较的Array中的元素类型不一致时, 返回的是nil.</span></font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >p(["2",2,3] &lt;=&gt; ["1","2","3"])  # 这里虽然两个Array的后面两个元素类型不一致, 但是在第一个元素进行比较时已经知道大小了, 所以不会比较后两个元素.</font></div><div><font size="2"  >p(["1",2,3] &lt;=&gt; ["1","2","3"])  # 这里就不一样了因为第一个元素相等, 还需要比较第二个元素, 这时两个Array的第二个元素类型不一致, 返回nil</font></div><p></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >执行结果 :&nbsp;</span></font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >1</font></div><div><font size="2"  >nil</font></div><p></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><br></span></font></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >9. Sorting Arrays</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >Array元素排序, 值得注意的是, Array内的元素类型必须一致, 元素内不能包含nil.</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >否则会报错, 当然有办法解决 :&nbsp;</font></span></div><div><font size="2"  ><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  ><pre class="prettyprint"  ><p></p><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >a1 = ["a",1,2,3,nil,nil,4,5,6,"b"]</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >a1.sort</div><p></p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >报错 :&nbsp;</div><div><pre class="prettyprint"  ><p>comparison of String with nil failed (ArgumentError)</p></pre></div></font></div><div><font size="2"  ><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >类型不一致 : 报错</div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  ><pre class="prettyprint"  ><p></p><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >a1 = ["a",1,2,3]</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >a1.sort</div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  ># comparison of String with 2 failed</font></div><p></p></pre></div></font></div><div><font size="2"  ><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >解决办法, 给sort输入一个block , 这个块中有两个变量,a,b 分别代表Array中的连续的两个元素 :&nbsp;</div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  ><pre class="prettyprint"  ><p></p><div>a1 = ["a",1,2,3,nil,nil,"b"]</div><div>p a1.sort {</div><div>&nbsp; |a,b|</div><div>&nbsp; a.to_s &lt;=&gt; b.to_s</div><div>}</div><p></p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >结果 :&nbsp;</div><div><pre class="prettyprint"  ><p>[nil, nil, 1, 2, 3, "a", "b"]</p></pre></div></font></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  ><br></font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >10. Comparing Arrays</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >比较操作符为&gt; , &lt; , ==.</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >比较其实就是调用了&lt;=&gt;方法, 只是返回true, false, 而不是-1, 0, 1 .</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >&lt;=&gt; 方法来自Comparable模块.</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >但是使用比较操作符必须包含Comparable模块. 接下来例子 :&nbsp;</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><div><pre class="prettyprint"  ><p></p><div>a1 = [2,1,2,3,nil,nil,"b"]</div><div>a2 = [1,2,3,4,5,6,7,8,9,0]</div><div><br></div><div>a1 &gt; a2</div><p></p></pre></div><div>报错 :&nbsp;</div><div><pre class="prettyprint"  ><p>undefined method `&gt;' for [2, 1, 2, 3, nil, nil, "b"]:Array (NoMethodError)</p></pre></div></font></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >修正 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >include Comparable</font></div><div><font size="2"  >a1 = [2,1,2,3,nil,nil,"b"]</font></div><div><font size="2"  >a2 = [1,2,3,4,5,6,7,8,9,0]</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >puts(a1 &gt; a2)</font></div><p></p></pre></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >结果 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p><font size="2"  >true</font></p></pre></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >当然每次都要include Comparable很烦, 可以给Array增加这个, 或者写一个自己的Array类. 如下 :&nbsp;</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><div style="line-height: 20px;"  ><pre class="prettyprint"  ><p></p><div>class Array</div><div>include Comparable</div><div>end</div><div>a1 = [2,1,2,3,nil,nil,"b"]</div><div>a2 = [1,2,3,4,5,6,7,8,9,0]</div><div><br></div><div>puts(a1 &gt; a2)</div><p></p></pre></div><div style="line-height: 20px;"  >或者</div><div><pre class="prettyprint"  ><p></p><div>class Myarray &lt; Array</div><div>include Comparable</div><div>end</div><div>a1 = Myarray.new([2,1,2,3,nil,nil,"b"])</div><div>a2 = Myarray.new([1,2,3,4,5,6,7,8,9,0])</div><div><br></div><div>puts(a1 &gt; a2)</div><p></p></pre></div><div style="line-height: 20px;"  >另外, 如果你不想比较ASCII值, 而是想比较Array的长度的话, 还可以复写&lt;=&gt;方法.</div><div><pre class="prettyprint"  ><p></p><div><div>class Myarray &lt; Array</div><div>include Comparable</div><div>def &lt;=&gt; (anotherary)</div><div>&nbsp; self.length &lt;=&gt; anotherary.length</div><div>end</div><div>end</div><div>a1 = Myarray.new([2,1,2,3,nil,nil,"b"])</div><div>a2 = Myarray.new([1,2,3,4,5,6,7,8,9,0])</div><div><br></div><div>puts(a1 &gt; a2)</div></div><div>返回</div><div>false</div><p></p></pre></div></font></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >或者 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >class Array</font></div><div><font size="2"  >include Comparable</font></div><div><font size="2"  >def &lt;=&gt; (anotherary)</font></div><div><font size="2"  >&nbsp; self.length &lt;=&gt; anotherary.length</font></div><div><font size="2"  >end</font></div><div><font size="2"  >end</font></div><div><font size="2"  >a1 = [2,1,2,3,nil,nil,"b"]</font></div><div><font size="2"  >a2 = [1,2,3,4,5,6,7,8,9,0]</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >puts(a1 &gt; a2)</font></div><div><font size="2"  >返回</font></div><div><font size="2"  >false</font></div><p></p></pre></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  ><br></font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >11. Array Methods</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >举一些例子, 你可以用Array对象的methods方法看.&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >&amp; &nbsp; &nbsp; Returns common elements of two arrays, no duplicates</font></div><div><font size="2"  >+ &nbsp; &nbsp; Returns array concatenating two arrays</font></div><div><font size="2"  >- &nbsp; &nbsp; Returns array with items in second array removed from first</font></div><div><font size="2"  >&lt;&lt; &nbsp; &nbsp; &nbsp; Modifies first array by appending items from second array</font></div><div><font size="2"  >clear &nbsp; &nbsp;Modifies array by removing all elements</font></div><div><font size="2"  >compact &nbsp; &nbsp; &nbsp;Returns array with nil items removed</font></div><div><font size="2"  >compact! &nbsp; &nbsp; &nbsp;Modifies array by removing nil items</font></div><div><font size="2"  >delete( object ) &nbsp; &nbsp; Modifies array by deleting object</font></div><div><font size="2"  >delete_at( index ) &nbsp; &nbsp; Modifies array by deleting item at index</font></div><div><font size="2"  >flatten &nbsp; &nbsp; &nbsp; &nbsp; Unpacks nested array items and returns array</font></div><div><font size="2"  >flatten! &nbsp; &nbsp; &nbsp; &nbsp; Modifies array by unpacking nested array items</font></div><div><font size="2"  >length &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Returns number of elements in array</font></div><div><font size="2"  >reverse &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Returns array with elements in reverse order</font></div><div><font size="2"  >reverse! &nbsp; &nbsp; &nbsp; &nbsp; Modifies array by reversing element order</font></div><div><font size="2"  >sort &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Returns array sorted using &lt;=&gt;</font></div><div><font size="2"  >sort! &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Modifies array sorted using &lt;=&gt;</font></div><p></p></pre></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >例子 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >arr1 = [1,1,2,2,3,3]</font></div><div><font size="2"  >arr2 = [1,2,3,4,5,6,7,8,9]</font></div><div><font size="2"  >arr3 = ['h','e','l','l','o',' ',nil,'w','o','r','l','d']</font></div><div><font size="2"  >p(arr1&amp;arr2 ) &nbsp; &nbsp;#=&gt; [1, 2, 3]  有去重的效果</font></div><div><font size="2"  >p(arr1+arr2) &nbsp; &nbsp; &nbsp; &nbsp;#=&gt; [1, 1, 2, 2, 3, 3, 1, 2, 3, 4, 5, 6, 7, 8, 9]</font></div><div><font size="2"  >p(arr1-arr2) &nbsp; &nbsp; &nbsp; &nbsp;#=&gt; []  对排除在外的元素有去重的效果</font></div><div><font size="2"  >p(arr2-arr1) &nbsp; &nbsp; &nbsp; &nbsp;#=&gt; [4, 5, 6, 7, 8, 9]</font></div><div><font size="2"  >arr1&lt;&lt;arr2     # 会修改左边的对象的原始值</font></div><div><font size="2"  >p(arr1) &nbsp; &nbsp; &nbsp; &nbsp;#=&gt; [1, 1, 2, 2, 3, 3, [1, 2, 3, 4, 5, 6, 7, 8, 9]]  这里需要注意&lt;&lt; 加进来后是一个元素, 不是分解后的多个元素.</font></div><div><font size="2"  >arr1.clear    # 会修改左边的对象的原始值</font></div><div><font size="2"  >p(arr1) &nbsp; &nbsp; &nbsp; &nbsp;#=&gt;[]</font></div><p></p></pre></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  ><br></font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >12. Appending vs Concatenating</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >这里特别要讲一下append和concate .</font></span></div><div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >也就是 + 和 &lt;&lt;</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >+ 不改变原始值, &lt;&lt;改变原始值.</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >+ 是把右边的Array对象按元素一个个加进来,</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >&lt;&lt; 是把右边的Array当成一个元素加进来.</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><br></span></font></div><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >【参考】</font></span><div style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >The Book Of Ruby</font></div><div style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  >Ruby 1.9.3 API</font></div><wbr></div>
	</div>
</div>
</body>
</html>