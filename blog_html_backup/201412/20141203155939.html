<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">cgroup (Control Groups)</h2>
	<h5 id="">2014-12-03 15:59:39&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402014102653934376/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>在一个服务器上跑多个程序时, 就有可能出现资源争抢到情况, 有没有什么好的方法可以隔离不同进程对各种资源的使用呢?</div><div>CPU的资源比较好隔离, 例如调整CPU亲和就可以做到, 典型的应用是虚拟机.</div><div>IO资源的隔离有点困难, 一般的做法是将不同的数据放在不同的物理磁盘上.&nbsp;</div><div>内存的隔离也比较简单, 提前分配好就可以了.</div><div><br></div><div>但是以上方法太简单粗暴了, 例如内存不提前分配好的话, 怎样限制进程对内存的使用呢? 还有IO的话, 如果多个进程都用到了同样的块设备, 怎么限制单个进程的请求呢?</div><div>Cgroup很好的解决了这个问题, 在单台服务器提供多种服务的场景中很好用.</div><div><br></div><div>什么是cgroup?</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >Control Groups provide a mechanism for aggregating/partitioning sets of</font></div><div><font size="2"   >tasks, and all their future children, into hierarchical groups with</font></div><div><font size="2"   >specialized behaviour.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Definitions:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >A *cgroup* associates a set of tasks(PID) with a set of parameters for one</font></div><div><font size="2"   >or more subsystems.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >A *subsystem* is a module that makes use of the task grouping</font></div><div><font size="2"   >facilities provided by cgroups to treat groups of tasks in</font></div><div><font size="2"   >particular ways. A subsystem is typically a "resource controller" that</font></div><div><font size="2"   >schedules a resource or applies per-cgroup limits, but it may be</font></div><div><font size="2"   >anything that wants to act on a group of processes, e.g. a</font></div><div><font size="2"   >virtualization subsystem.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >A *hierarchy* is a set of cgroups arranged in a tree, such that</font></div><div><font size="2"   >every task in the system is in exactly one of the cgroups in the</font></div><div><font size="2"   >hierarchy, and a set of subsystems; each subsystem has system-specific</font></div><div><font size="2"   >state attached to each cgroup in the hierarchy. &nbsp;Each hierarchy has</font></div><div><font size="2"   >an instance of the cgroup virtual filesystem associated with it.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >At any one time there may be multiple active hierarchies of task</font></div><div><font size="2"   >cgroups. Each hierarchy is a partition of all tasks in the system.</font></div><p></p></pre></div><div><br></div><div>使用场景案例 :&nbsp;</div><div>一台大学里的服务器, 有多个用户使用, 如学生, 老师, 系统任务.</div><div>不同的用户分配不同的资源, 例如</div><div>CPU资源分配, 老师用CPU集合1, 学生用CPU集合2, 系统任务用所有CPU资源.</div><div>内存资源分配, 老师50%, 学生30%, 系统任务20%</div><div>磁盘IO,&nbsp;<span style="line-height: 28px;"   >老师50%, 学生30%, 系统任务20%</span></div><div><span style="line-height: 28px;"   >网络, 老师15%, 学生5%, 网络文件系统60%, 其他20%</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >As an example of a scenario (originally proposed by vatsa@in.ibm.com)</font></div><div><font size="2"   >that can benefit from multiple hierarchies, consider a large</font></div><div><font size="2"   >university server with various users - students, professors, system</font></div><div><font size="2"   >tasks etc. The resource planning for this server could be along the</font></div><div><font size="2"   >following lines:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;CPU : &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"Top cpuset"</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/ &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CPUSet1 &nbsp; &nbsp; &nbsp; &nbsp; CPUSet2</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Professors) &nbsp; &nbsp;(Students)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;In addition (system tasks) are attached to topcpuset (so</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;that they can run anywhere) with a limit of 20%</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;Memory : Professors (50%), Students (30%), system (20%)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;Disk : Professors (50%), Students (30%), system (20%)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;Network : WWW browsing (20%), Network File System (60%), others (20%)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/ \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Professors (15%) &nbsp;students (5%)</font></div><p></p></pre></div><div><br></div><div>CGROUP如何来控制资源的使用呢?</div><div>是创建好资源组, 然后将进程放到对应的资源组里面去.</div><div>例如上面的例子可以创建2个资源组: 老师, 学生.</div><div>老师和学生跑的进程放到对应的老师, 学生资源组, 系统进程放到顶级组.</div><div><br></div><div>以CentOS 7.x x64为例, 看看如何使用cgroup :&nbsp;</div><div>centos 7安装好后, 系统起来后, 已经挂载了cgroup, 所以不需要再次挂载.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@150 cgroup]# cat /proc/mounts&nbsp;</font></div><div><font size="2"   >tmpfs /sys/fs/cgroup tmpfs rw,nosuid,nodev,noexec,mode=755 0 0</font></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >cgroup /sys/fs/cgroup/systemd cgroup rw,nosuid,nodev,noexec,relatime,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd 0 0</font></div><div><span style="line-height: 28px;"   ><font size="2"   >cgroup /sys/fs/cgroup/cpuset cgroup rw,nosuid,nodev,noexec,relatime,cpuset 0 0</font></span></div><div><font size="2"   >cgroup /sys/fs/cgroup/cpu,cpuacct cgroup rw,nosuid,nodev,noexec,relatime,cpuacct,cpu 0 0</font></div><div><font size="2"   >cgroup /sys/fs/cgroup/memory cgroup rw,nosuid,nodev,noexec,relatime,memory 0 0</font></div><div><font size="2"   >cgroup /sys/fs/cgroup/devices cgroup rw,nosuid,nodev,noexec,relatime,devices 0 0</font></div><div><font size="2"   >cgroup /sys/fs/cgroup/freezer cgroup rw,nosuid,nodev,noexec,relatime,freezer 0 0</font></div><div><font size="2"   >cgroup /sys/fs/cgroup/net_cls cgroup rw,nosuid,nodev,noexec,relatime,net_cls 0 0</font></div><div><font size="2"   >cgroup /sys/fs/cgroup/blkio cgroup rw,nosuid,nodev,noexec,relatime,blkio 0 0</font></div><div><font size="2"   >cgroup /sys/fs/cgroup/perf_event cgroup rw,nosuid,nodev,noexec,relatime,perf_event 0 0</font></div><div><font size="2"   >cgroup /sys/fs/cgroup/hugetlb cgroup rw,nosuid,nodev,noexec,relatime,hugetlb 0 0</font></div></div><p></p></pre></div><div><br></div><div>自定义继承资源组, 建议使用这种做法.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >For example, the following sequence of commands will setup a cgroup</font></div><div><font size="2"   >named "Charlie", containing just CPUs 2 and 3, and Memory Node 1,</font></div><div><font size="2"   >and then start a subshell 'sh' in that cgroup:</font></div><div><span style="line-height: 28px;"   ><font size="2"   ># 如果没有挂载的话, 需要先挂载一次</font></span></div><div><font size="2"   >&nbsp; mount -t tmpfs cgroup_root /sys/fs/cgroup &nbsp; &nbsp;</font></div><div><font size="2"   >创建自定义资源组(cpuset组已经存在, 所以不需要创建)</font></div><div><font size="2"   >&nbsp; mkdir /sys/fs/cgroup/cpuset</font></div><div><font size="2"   >挂载资源组<span style="line-height: 28px;"   >(cpuset组已经存在, 所以不需要挂载)</span></font></div><div><font size="2"   >&nbsp; mount -t cgroup cpuset -o cpuset /sys/fs/cgroup/cpuset</font></div><div><font size="2"   >在cpuset组下面创建一个自定义组</font></div><div><font size="2"   >&nbsp; cd /sys/fs/cgroup/cpuset</font></div><div><font size="2"   >&nbsp; mkdir Charlie</font></div><div><font size="2"   >&nbsp; cd Charlie</font></div><div><font size="2"   >在自定义组中配置CPU和内存资源控制, 如CPU核亲和</font></div><div><font size="2"   >&nbsp; /bin/echo 2-3 &gt; cpuset.cpus</font></div><div><font size="2"   >&nbsp; /bin/echo 1 &gt; cpuset.mems</font></div><div><font size="2"   >将当前进程号放到这个组中. $$返回当前进程号</font></div><div><font size="2"   >&nbsp; /bin/echo $$ &gt; tasks</font></div><div><font size="2"   >&nbsp; sh</font></div><div><font size="2"   >&nbsp; # The subshell 'sh' is now running in cgroup Charlie</font></div><div><font size="2"   >&nbsp; # The next line should display '/Charlie'</font></div><div><font size="2"   >&nbsp; cat /proc/self/cgroup</font></div><p></p></pre></div><div><br></div><div>挂载顶级组 :&nbsp;</div><div>或混合顶级组(如CentOS 7默认已经挂载了名为cgroup的混合顶级组, 混合了cpuset, memory,blkio等) :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@150 ~]# cd /sys/fs/cgroup/</font></div><div><font size="2"   >[root@150 cgroup]# ll</font></div><div><font size="2"   >total 0</font></div><div><font size="2"   >drwxr-xr-x 2 root root 40 Nov 27 19:03 blkio</font></div><div><font size="2"   >lrwxrwxrwx 1 root root 11 Nov 27 19:03 cpu -&gt; cpu,cpuacct</font></div><div><font size="2"   >lrwxrwxrwx 1 root root 11 Nov 27 19:03 cpuacct -&gt; cpu,cpuacct</font></div><div><font size="2"   >drwxr-xr-x 2 root root 40 Nov 27 19:03 cpu,cpuacct</font></div><div><font size="2"   >drwxr-xr-x 2 root root 40 Nov 27 19:03 cpuset</font></div><div><font size="2"   >drwxr-xr-x 2 root root 40 Nov 27 19:03 devices</font></div><div><font size="2"   >drwxr-xr-x 2 root root 40 Nov 27 19:03 freezer</font></div><div><font size="2"   >drwxr-xr-x 2 root root 40 Nov 27 19:03 hugetlb</font></div><div><font size="2"   >drwxr-xr-x 2 root root 40 Nov 27 19:03 memory</font></div><div><font size="2"   >drwxr-xr-x 2 root root 40 Nov 27 19:03 net_cls</font></div><div><font size="2"   >drwxr-xr-x 2 root root 40 Nov 27 19:03 perf_event</font></div><div><font size="2"   >drwxr-xr-x 2 root root 40 Dec &nbsp;3 23:25 rg1</font></div><div><font size="2"   >drwxr-xr-x 4 root root &nbsp;0 Nov 27 19:03 systemd</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >[root@150 ~]# mount</font></div><div><div><font size="2"   >cgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)</font></div><div><font size="2"   >cgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpuacct,cpu)</font></div><div><font size="2"   >cgroup on /sys/fs/cgroup/memory type cgroup (rw,nosuid,nodev,noexec,relatime,memory)</font></div><div><font size="2"   >cgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices)</font></div><div><font size="2"   >cgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer)</font></div><div><font size="2"   >cgroup on /sys/fs/cgroup/net_cls type cgroup (rw,nosuid,nodev,noexec,relatime,net_cls)</font></div><div><font size="2"   >cgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio)</font></div></div><p></p></pre></div><div>如果没有自动挂载的话, 我们也可以手工挂载 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >As explained in section `1.2 Why are cgroups needed?' you should create</font></div><div><font size="2"   >different hierarchies of cgroups for each single resource or group of</font></div><div><font size="2"   >resources you want to control. Therefore, you should mount a tmpfs on</font></div><div><font size="2"   >/sys/fs/cgroup and create directories for each cgroup resource or resource</font></div><div><font size="2"   >group.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ># mount -t tmpfs cgroup_root /sys/fs/cgroup</font></div><div><font size="2"   ># mkdir /sys/fs/cgroup/rg1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >To mount a cgroup hierarchy with just the cpuset and memory</font></div><div><font size="2"   >subsystems, type:</font></div><div><font size="2"   ># 必须在没有初始化挂载时挂载, 如果系统已经挂载了这些组, 那么不建议重复挂载. (-o中指定的cpuset, memory如果已经挂载, 则不必重复挂载)</font></div><div><font size="2"   ># mount -t cgroup -o cpuset,memory hier1 /sys/fs/cgroup/rg1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >While remounting cgroups is currently supported, it is not recommend</font></div><div><font size="2"   >to use it. Remounting allows changing bound subsystems and</font></div><div><font size="2"   >release_agent. Rebinding is hardly useful as it only works when the</font></div><div><font size="2"   >hierarchy is empty and release_agent itself should be replaced with</font></div><div><font size="2"   >conventional fsnotify. The support for remounting will be removed in</font></div><div><font size="2"   >the future.</font></div><p></p></pre></div><div><br></div><div>以CentOS 7.x x64为例 , 系统自带的子系统类型如下 :&nbsp;</div><div><span style="line-height: 28px;"   >可以控制的资源包括CPU, 内存, IO, 大页等.</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@150 cgroup]# cd /sys/fs/cgroup/</font></div><div><font size="2"   >[root@150 cgroup]# ll</font></div><div><font size="2"   >total 0</font></div><div><font size="2"   >drwxr-xr-x 4 root root &nbsp;0 Nov 27 19:25 blkio</font></div><div><font size="2"   >lrwxrwxrwx 1 root root 11 Nov 27 19:03 cpu -&gt; cpu,cpuacct</font></div><div><font size="2"   >lrwxrwxrwx 1 root root 11 Nov 27 19:03 cpuacct -&gt; cpu,cpuacct</font></div><div><font size="2"   >drwxr-xr-x 4 root root &nbsp;0 Nov 27 19:25 cpu,cpuacct</font></div><div><font size="2"   >drwxr-xr-x 2 root root &nbsp;0 Nov 27 19:03 cpuset</font></div><div><font size="2"   >drwxr-xr-x 2 root root &nbsp;0 Nov 28 22:20 devices</font></div><div><font size="2"   >drwxr-xr-x 3 root root &nbsp;0 Nov 27 19:03 freezer</font></div><div><font size="2"   >drwxr-xr-x 2 root root &nbsp;0 Nov 27 19:03 hugetlb</font></div><div><font size="2"   >drwxr-xr-x 3 root root &nbsp;0 Nov 27 19:25 memory</font></div><div><font size="2"   >drwxr-xr-x 2 root root &nbsp;0 Nov 27 19:03 net_cls</font></div><div><font size="2"   >drwxr-xr-x 2 root root &nbsp;0 Nov 27 19:03 perf_event</font></div><div><span style="line-height: 28px;"   ><font size="2"   >drwxr-xr-x 4 root root &nbsp;0 Nov 27 19:03 systemd</font></span></div><p></p></pre></div><div>例如cpuset可以控制哪些资源呢?</div><div>如cpus</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@150 cgroup]# cat cpuset/cpuset.cpus</font></div><div><font size="2"   >0-7</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >[root@150 cgroup]# ll cpuset/</font></div><div><font size="2"   >total 0</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cgroup.clone_children</font></div><div><font size="2"   >--w--w--w- 1 root root 0 Nov 27 19:03 cgroup.event_control</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cgroup.procs</font></div><div><font size="2"   >-r--r--r-- 1 root root 0 Nov 27 19:03 cgroup.sane_behavior</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cpuset.cpu_exclusive</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cpuset.cpus</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cpuset.mem_exclusive</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cpuset.mem_hardwall</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cpuset.memory_migrate</font></div><div><font size="2"   >-r--r--r-- 1 root root 0 Nov 27 19:03 cpuset.memory_pressure</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cpuset.memory_pressure_enabled</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cpuset.memory_spread_page</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cpuset.memory_spread_slab</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cpuset.mems</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cpuset.sched_load_balance</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cpuset.sched_relax_domain_level</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 notify_on_release</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 release_agent</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 tasks</font></div></div><p></p></pre></div><div>例如memory可以控制哪些资源呢?</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@150 cgroup]# ll memory/</font></div><div><font size="2"   >total 0</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 cgroup.clone_children</font></div><div><font size="2"   >--w--w--w- &nbsp;1 root root 0 Nov 27 19:03 cgroup.event_control</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Dec &nbsp;3 23:30 cgroup.procs</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 cgroup.sane_behavior</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.failcnt</font></div><div><font size="2"   >--w------- &nbsp;1 root root 0 Nov 27 19:03 memory.force_empty</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.failcnt</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.limit_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.max_usage_in_bytes</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.slabinfo</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.tcp.failcnt</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.tcp.limit_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.tcp.max_usage_in_bytes</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.tcp.usage_in_bytes</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.usage_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.limit_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.max_usage_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.memsw.failcnt</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.memsw.limit_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.memsw.max_usage_in_bytes</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.memsw.usage_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.move_charge_at_immigrate</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.numa_stat</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.oom_control</font></div><div><font size="2"   >---------- &nbsp;1 root root 0 Nov 27 19:03 memory.pressure_level</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.soft_limit_in_bytes</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.stat</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.swappiness</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.usage_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.use_hierarchy</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 notify_on_release</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 release_agent</font></div><div><font size="2"   >drwxr-xr-x 10 root root 0 Nov 28 18:33 system.slice</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 tasks</font></div><p></p></pre></div><div>例如devices可以控制哪些资源呢?</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@150 cgroup]# ll devices/</font></div><div><font size="2"   >total 0</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cgroup.clone_children</font></div><div><font size="2"   >--w--w--w- 1 root root 0 Nov 27 19:03 cgroup.event_control</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Dec &nbsp;3 23:30 cgroup.procs</font></div><div><font size="2"   >-r--r--r-- 1 root root 0 Nov 27 19:03 cgroup.sane_behavior</font></div><div><font size="2"   >--w------- 1 root root 0 Nov 27 19:03 devices.allow</font></div><div><font size="2"   >--w------- 1 root root 0 Nov 27 19:03 devices.deny</font></div><div><font size="2"   >-r--r--r-- 1 root root 0 Nov 27 19:03 devices.list</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 notify_on_release</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 release_agent</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 tasks</font></div><p></p></pre></div><div>其他资源控制 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@150 cgroup]# ll net_cls/</font></div><div><font size="2"   >total 0</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cgroup.clone_children</font></div><div><font size="2"   >--w--w--w- 1 root root 0 Nov 27 19:03 cgroup.event_control</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cgroup.procs</font></div><div><font size="2"   >-r--r--r-- 1 root root 0 Nov 27 19:03 cgroup.sane_behavior</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 net_cls.classid</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 notify_on_release</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 release_agent</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 tasks</font></div><div><font size="2"   >[root@150 cgroup]# ll systemd/</font></div><div><font size="2"   >total 0</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 cgroup.clone_children</font></div><div><font size="2"   >--w--w--w- &nbsp;1 root root 0 Nov 27 19:03 cgroup.event_control</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 cgroup.procs</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 cgroup.sane_behavior</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 notify_on_release</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 release_agent</font></div><div><font size="2"   >drwxr-xr-x 85 root root 0 Dec &nbsp;3 22:10 system.slice</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 tasks</font></div><div><font size="2"   >drwxr-xr-x &nbsp;3 root root 0 Nov 27 19:03 user.slice</font></div><div><font size="2"   >[root@150 cgroup]# ll freezer/</font></div><div><font size="2"   >total 0</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 cgroup.clone_children</font></div><div><font size="2"   >--w--w--w- &nbsp;1 root root 0 Nov 27 19:03 cgroup.event_control</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 cgroup.procs</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 cgroup.sane_behavior</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 notify_on_release</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 release_agent</font></div><div><font size="2"   >drwxr-xr-x 10 root root 0 Nov 28 18:33 system.slice</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 tasks</font></div><div><font size="2"   >[root@150 cgroup]# ll hugetlb/</font></div><div><font size="2"   >total 0</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cgroup.clone_children</font></div><div><font size="2"   >--w--w--w- 1 root root 0 Nov 27 19:03 cgroup.event_control</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 cgroup.procs</font></div><div><font size="2"   >-r--r--r-- 1 root root 0 Nov 27 19:03 cgroup.sane_behavior</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 hugetlb.2MB.failcnt</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 hugetlb.2MB.limit_in_bytes</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 hugetlb.2MB.max_usage_in_bytes</font></div><div><font size="2"   >-r--r--r-- 1 root root 0 Nov 27 19:03 hugetlb.2MB.usage_in_bytes</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 notify_on_release</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 release_agent</font></div><div><font size="2"   >-rw-r--r-- 1 root root 0 Nov 27 19:03 tasks</font></div></div><div><div><font size="2"   >[root@150 cgroup]# ll blkio/</font></div><div><font size="2"   >total 0</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.io_merged</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.io_merged_recursive</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.io_queued</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.io_queued_recursive</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.io_service_bytes</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.io_service_bytes_recursive</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.io_serviced</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.io_serviced_recursive</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.io_service_time</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.io_service_time_recursive</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.io_wait_time</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.io_wait_time_recursive</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.leaf_weight</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.leaf_weight_device</font></div><div><font size="2"   >--w------- &nbsp;1 root root 0 Nov 27 19:03 blkio.reset_stats</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.sectors</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.sectors_recursive</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.throttle.io_service_bytes</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.throttle.io_serviced</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.throttle.read_bps_device</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.throttle.read_iops_device</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.throttle.write_bps_device</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.throttle.write_iops_device</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.time</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.time_recursive</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.weight</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 blkio.weight_device</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 cgroup.clone_children</font></div><div><font size="2"   >--w--w--w- &nbsp;1 root root 0 Nov 27 19:03 cgroup.event_control</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Dec &nbsp;3 22:30 cgroup.procs</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 cgroup.sane_behavior</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 notify_on_release</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 release_agent</font></div><div><font size="2"   >drwxr-xr-x 77 root root 0 Dec &nbsp;3 22:10 system.slice</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 tasks</font></div><div><font size="2"   >drwxr-xr-x &nbsp;2 root root 0 Nov 27 19:25 user.slice</font></div></div><p></p></pre></div><div><br></div><div>不建议重复挂载, 在没有自动挂载的情况下, 可以这么来挂载 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   ><span style="line-height: 21px;"   >[root@150 cgroup]# mount -t cgroup -o cpuset cgroup /sys/fs/cgroup/cpuset<br>[root@150 cgroup]# mount -t cgroup -o memory cgroup /sys/fs/cgroup/memory<br>[root@150 cgroup]# mount -t cgroup -o blkio cgroup /sys/fs/cgroup/blkio</span></font></div><div><font size="2"   ><span style="line-height: 21px;"   ><br></span></font></div><div><font size="2"   >cgroup on /sys/fs/cgroup/cpuset type cgroup (rw,relatime,cpuset)<br>cgroup on /sys/fs/cgroup/memory type cgroup (rw,relatime,memory)<br>cgroup on /sys/fs/cgroup/blkio type cgroup (rw,relatime,blkio)</font></div><p></p></pre></div><div>将一个资源组放进去是可以的</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   ><span style="line-height: 21px;"   ># 资源加入CGROUP.</span></font></div><div><font size="2"   >[root@150 cgroup]# cd /sys/fs/cgroup/cpuset</font></div><div><font size="2"   >[root@150 rg1]# ll</font></div><div><font size="2"   >total 0</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 cgroup.clone_children</font></div><div><font size="2"   >--w--w--w- &nbsp;1 root root 0 Nov 27 19:03 cgroup.event_control</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Dec &nbsp;3 23:20 cgroup.procs</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 cgroup.sane_behavior</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.failcnt</font></div><div><font size="2"   >--w------- &nbsp;1 root root 0 Nov 27 19:03 memory.force_empty</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.failcnt</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.limit_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.max_usage_in_bytes</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.slabinfo</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.tcp.failcnt</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.tcp.limit_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.tcp.max_usage_in_bytes</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.tcp.usage_in_bytes</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.kmem.usage_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.limit_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.max_usage_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.memsw.failcnt</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.memsw.limit_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.memsw.max_usage_in_bytes</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.memsw.usage_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.move_charge_at_immigrate</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.numa_stat</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.oom_control</font></div><div><font size="2"   >---------- &nbsp;1 root root 0 Nov 27 19:03 memory.pressure_level</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.soft_limit_in_bytes</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.stat</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.swappiness</font></div><div><font size="2"   >-r--r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.usage_in_bytes</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 memory.use_hierarchy</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 notify_on_release</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 release_agent</font></div><div><font size="2"   >drwxr-xr-x 10 root root 0 Nov 28 18:33 system.slice</font></div><div><font size="2"   >-rw-r--r-- &nbsp;1 root root 0 Nov 27 19:03 tasks</font></div><p></p></pre></div><div>将进程放到对应的资源组, 只需要将进程号添加到tasks文件即可.</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@150 cgroup]# cd /sys/fs/cgroup/cpuset/</font></div><div><font size="2"   >[root@150 cpuset]# less tasks&nbsp;</font></div><div><font size="2"   >1</font></div><div><font size="2"   >2</font></div><div><font size="2"   >3</font></div><div><font size="2"   >5</font></div><div><font size="2"   >7</font></div><div><font size="2"   >8</font></div><div><font size="2"   >9</font></div><div><font size="2"   >10</font></div><div><font size="2"   >11</font></div></div><div><font size="2"   >......</font></div><p></p></pre></div><div><br></div><div>卸载资源组, 因为挂载了多次, 所以需要卸载多次.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   ><span style="line-height: 21px;"   >[root@150 cgroup]# umount cgroup<br>[root@150 cgroup]# umount cgroup<br>[root@150 cgroup]# umount cgroup<br>[root@150 cgroup]# umount cgroup<br>umount: /sys/fs/cgroup/systemd: target is busy.<br>        (In some cases useful info about processes that use<br>         the device is found by lsof(8) or fuser(1))</span></font></div><p></p></pre></div><div>查看进程所在的资源组 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@150 cpuset]# cat /proc/1/cgroup&nbsp;</font></div><div><font size="2"   >10:hugetlb:/</font></div><div><font size="2"   >9:perf_event:/</font></div><div><font size="2"   >8:blkio:/</font></div><div><font size="2"   >7:net_cls:/</font></div><div><font size="2"   >6:freezer:/</font></div><div><font size="2"   >5:devices:/</font></div><div><font size="2"   >4:memory:/</font></div><div><font size="2"   >3:cpuacct,cpu:/</font></div><div><font size="2"   >2:cpuset:/</font></div><div><font size="2"   >1:name=systemd:/</font></div><p></p></pre></div><div>例如docker进程 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@150 cpuset]# ps -efw|grep docker</font></div><div><font size="2"   >root &nbsp; &nbsp; &nbsp; &nbsp;4661 &nbsp; &nbsp; &nbsp; 1 &nbsp;0 Nov27 ? &nbsp; &nbsp; &nbsp; &nbsp;00:02:45 /usr/bin/docker -d --selinux-enabled=false -g /data01/docker</font></div><div><font size="2"   >root &nbsp; &nbsp; &nbsp; 22830 &nbsp; 20836 &nbsp;0 23:55 pts/1 &nbsp; &nbsp;00:00:00 grep --color=auto docker</font></div><div><font size="2"   >[root@150 cpuset]# ps -efw|grep 4661</font></div><div><font size="2"   >root &nbsp; &nbsp; &nbsp; &nbsp;4661 &nbsp; &nbsp; &nbsp; 1 &nbsp;0 Nov27 ? &nbsp; &nbsp; &nbsp; &nbsp;00:02:45 /usr/bin/docker -d --selinux-enabled=false -g /data01/docker</font></div><div><font size="2"   >root &nbsp; &nbsp; &nbsp; 17299 &nbsp; &nbsp;4661 &nbsp;0 Nov28 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/sshd -D</font></div><div><font size="2"   >root &nbsp; &nbsp; &nbsp; 17325 &nbsp; &nbsp;4661 &nbsp;0 Nov28 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/sshd -D</font></div><div><font size="2"   >root &nbsp; &nbsp; &nbsp; 17351 &nbsp; &nbsp;4661 &nbsp;0 Nov28 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/sshd -D</font></div><div><font size="2"   >root &nbsp; &nbsp; &nbsp; 17377 &nbsp; &nbsp;4661 &nbsp;0 Nov28 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/sshd -D</font></div><div><font size="2"   >root &nbsp; &nbsp; &nbsp; 17403 &nbsp; &nbsp;4661 &nbsp;0 Nov28 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/sshd -D</font></div><div><font size="2"   >root &nbsp; &nbsp; &nbsp; 17429 &nbsp; &nbsp;4661 &nbsp;0 Nov28 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/sshd -D</font></div><div><font size="2"   >root &nbsp; &nbsp; &nbsp; 17456 &nbsp; &nbsp;4661 &nbsp;0 Nov28 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/sshd -D</font></div><div><font size="2"   >root &nbsp; &nbsp; &nbsp; 17485 &nbsp; &nbsp;4661 &nbsp;0 Nov28 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/sshd -D</font></div><div><font size="2"   >root &nbsp; &nbsp; &nbsp; 22832 &nbsp; 20836 &nbsp;0 23:55 pts/1 &nbsp; &nbsp;00:00:00 grep --color=auto 4661</font></div><div><font size="2"   >[root@150 cpuset]# cat /proc/17299/cgroup&nbsp;</font></div><div><font size="2"   >10:hugetlb:/</font></div><div><font size="2"   >9:perf_event:/</font></div><div><font size="2"   >8:blkio:/system.slice</font></div><div><font size="2"   >7:net_cls:/</font></div><div><font size="2"   >6:freezer:/system.slice/docker-59c41fc9560eb52b549de45d8996a34da2ea00f7711b40b757b0e035169ccd92.scope</font></div><div><font size="2"   >5:devices:/</font></div><div><font size="2"   >4:memory:/system.slice</font></div><div><font size="2"   >3:cpuacct,cpu:/system.slice</font></div><div><font size="2"   >2:cpuset:/</font></div><div><font size="2"   >1:name=systemd:/system.slice/docker-59c41fc9560eb52b549de45d8996a34da2ea00f7711b40b757b0e035169ccd92.scope</font></div><p></p></pre></div><div><br></div><div>[参考]</div><wbr>1.&nbsp;<a target="_blank" rel="nofollow" href="https://www.kernel.org/doc/Documentation/cgroups/"   >https://www.kernel.org/doc/Documentation/cgroups/</a><div>各种不同资源类型的控制详细使用请参考如下<br><div><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >Index of /doc/Documentation/cgroups</font></div><div style="line-height: 28px;"   ><font size="2"   >Name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Last modified &nbsp; &nbsp; &nbsp;Size &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >Parent Directory &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - &nbsp;&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >00-INDEX &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;01-Dec-2014 01:00 &nbsp;918 &nbsp;&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >blkio-controller.txt &nbsp; &nbsp;01-Dec-2014 01:00 &nbsp; 16K &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >cgroups.txt &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 01-Dec-2014 01:00 &nbsp; 26K &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >cpuacct.txt &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 01-Dec-2014 01:00 &nbsp;1.9K &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >cpusets.txt &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 01-Dec-2014 01:00 &nbsp; 36K &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >devices.txt &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 01-Dec-2014 01:00 &nbsp;4.3K &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >freezer-subsystem.txt &nbsp; 01-Dec-2014 01:00 &nbsp;4.8K &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >hugetlb.txt &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 01-Dec-2014 01:00 &nbsp;1.7K &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >memcg_test.txt &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;01-Dec-2014 01:00 &nbsp;8.3K &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >memory.txt &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;01-Dec-2014 01:00 &nbsp; 36K &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >net_cls.txt &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 01-Dec-2014 01:00 &nbsp;1.2K &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >net_prio.txt &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;01-Dec-2014 01:00 &nbsp;2.5K &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >resource_counter.txt &nbsp; &nbsp;01-Dec-2014 01:00 &nbsp;6.1K &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >unified-hierarchy.txt &nbsp; 01-Dec-2014 01:00 &nbsp; 16K &nbsp;</font></div><p></p></pre></div><div style="line-height: 28px;"   ><br></div><div><wbr>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="cgroup (Control Groups) - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a><br></div></div></div></div>
	</div>
</div>
</body>
</html>