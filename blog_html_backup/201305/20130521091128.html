<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL standard_conforming_strings and escape_string_warning</h2>
	<h5 id="">2013-05-21 9:11:28&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201342185210972/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >escape_string_warning (boolean)</font></div><div><font size="2"   >When on, a warning is issued if a backslash (\) appears in an ordinary string literal ('...' syntax) and standard_conforming_strings is off. The default is on.</font></div><div><font size="2"   >Applications that wish to use backslash as escape should be modified to use escape string syntax (E'...'), because the default behavior of ordinary strings is now to treat backslash as an ordinary character, per SQL standard. This variable can be enabled to help locate code that needs to be changed.</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >standard_conforming_strings (boolean)</font></div><div><font size="2"   >This controls whether ordinary string literals ('...') treat backslashes literally, as specified in the SQL standard. Beginning in PostgreSQL 9.1, the default is on (prior releases defaulted to off). Applications can check this parameter to determine how string literals will be processed. The presence of this parameter can also be taken as an indication that the escape string syntax (E'...') is supported. Escape string syntax (Section 4.1.2.2) should be used if an application desires backslashes to be treated as escape characters.</font></div></div><p></p></pre></div><div>注意这句话. 在SQL标准中, \作为普通字符使用.&nbsp;</div><div>the default behavior of ordinary strings is now to treat backslash as an ordinary character, per SQL standard.</div><div>所以<span style="line-height: 22px;"   >standard_conforming_strings=on时, &nbsp;\作为普通字符.&nbsp;</span></div><div><span style="line-height: 22px;"   >standard_conforming_strings=off时, &nbsp;\作为逃逸字符使用. 但是建议使用E''格式,&nbsp;</span>escape_string_warning 就是用来检测格式的配置.</div><div>[例子]</div><div>1.&nbsp;<span style="line-height: 22px;"   >standard_conforming_strings=on时, &nbsp;\作为普通字符.</span></div><div><span style="line-height: 22px;"   >&nbsp; &nbsp; 如果要将\作为逃逸字符, 必须使用E''格式.</span></div><div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >digoal=# \set VERBOSITY verbose</font></div><div><font size="2"   >digoal=# set standard_conforming_strings=on;</font></div><div><font size="2"   >SET</font></div><div><font size="2"   >digoal=# set escape_string_warning=on;</font></div><div><font size="2"   >SET</font></div><div><font size="2"   >digoal=# select '\nabc';</font></div><div><font size="2"   >&nbsp;?column?&nbsp;</font></div><div><font size="2"   >----------</font></div><div><font size="2"   >&nbsp;\nabc</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >digoal=# select E'\nabc';</font></div><div><font size="2"   >&nbsp;?column?&nbsp;</font></div><div><font size="2"   >----------</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+</font></div><div><font size="2"   >&nbsp;abc</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >digoal=# set standard_conforming_strings=on;</font></div><div><font size="2"   >SET</font></div><div><font size="2"   >digoal=# set escape_string_warning=off;</font></div><div><font size="2"   >SET</font></div><div><font size="2"   >digoal=# select '\nabc';</font></div><div><font size="2"   >&nbsp;?column?&nbsp;</font></div><div><font size="2"   >----------</font></div><div><font size="2"   >&nbsp;\nabc</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >digoal=# select E'\nabc';</font></div><div><font size="2"   >&nbsp;?column?&nbsp;</font></div><div><font size="2"   >----------</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+</font></div><div><font size="2"   >&nbsp;abc</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><div><div style="line-height: 22px;"   >2.&nbsp;<span style="line-height: 22px;"   >standard_conforming_strings=off时, &nbsp;\作为</span><span style="line-height: 22px;"   >逃逸字符</span><span style="line-height: 22px;"   >. 但是这么使用,&nbsp;</span><span style="line-height: 22px;"   >escape_string_warning=on时会提示警告.</span></div><div style="line-height: 22px;"   ><span style="line-height: 22px;"   >&nbsp; &nbsp; 使用E''格式这不会告警.</span></div></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >digoal=# set standard_conforming_strings=off;</font></div><div><font size="2"   >SET</font></div><div><font size="2"   >digoal=# set escape_string_warning=off;</font></div><div><font size="2"   >SET</font></div><div><font size="2"   >digoal=# select '\nabc';</font></div><div><font size="2"   >&nbsp;?column?&nbsp;</font></div><div><font size="2"   >----------</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+</font></div><div><font size="2"   >&nbsp;abc</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >digoal=# select E'\nabc';</font></div><div><font size="2"   >&nbsp;?column?&nbsp;</font></div><div><font size="2"   >----------</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+</font></div><div><font size="2"   >&nbsp;abc</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >digoal=# set standard_conforming_strings=off;</font></div><div><font size="2"   >SET</font></div><div><font size="2"   >digoal=# set escape_string_warning=on;</font></div><div><font size="2"   >SET</font></div><div><font size="2"   >digoal=# select '\nabc';</font></div><div><font size="2"   >WARNING: &nbsp;22P06: nonstandard use of escape in a string literal</font></div><div><font size="2"   >LINE 1: select '\nabc';</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;^</font></div><div><font size="2"   >HINT: &nbsp;Use the escape string syntax for escapes, e.g., E'\r\n'.</font></div><div><font size="2"   >LOCATION: &nbsp;check_escape_warning, scan.l:1458</font></div><div><font size="2"   >&nbsp;?column?&nbsp;</font></div><div><font size="2"   >----------</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+</font></div><div><font size="2"   >&nbsp;abc</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >digoal=# select E'\nabc';</font></div><div><font size="2"   >&nbsp;?column?&nbsp;</font></div><div><font size="2"   >----------</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+</font></div><div><font size="2"   >&nbsp;abc</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div></div><div><br></div><div><span style="line-height: 22px;"   >[参考]</span></div><wbr><div>1.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://www.postgresql.org/docs/9.3/static/runtime-config-compatible.html"   >http://www.postgresql.org/docs/9.3/static/runtime-config-compatible.html</a></div><div>2.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://www.postgresql.org/docs/9.3/static/sql-syntax-lexical.html#SQL-SYNTAX-STRINGS-ESCAPE"   >http://www.postgresql.org/docs/9.3/static/sql-syntax-lexical.html#SQL-SYNTAX-STRINGS-ESCAPE</a></div></div>
	</div>
</div>
</body>
</html>