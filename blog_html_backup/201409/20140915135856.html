<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">ganglia gweb customize views</h2>
	<h5 id="">2014-09-15 13:58:56&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402014815105622529/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>上一篇简单的将了一些gweb的聚合和比较视图.</div><div>那些视图都是临时创建的, gweb还支持配置自定义视图标签, 方便随时使用.</div><div>其实功能和gweb的聚合和比较视图类似, 只是把这些标签化了, 方便随时来使用.</div><div>创建视图的规则 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >Defining views using JSON</font></div><div><font size="2"   >Views &nbsp;are &nbsp;stored &nbsp;as &nbsp;JSON &nbsp;files &nbsp;in &nbsp;the &nbsp;conf_dir directory. &nbsp;The &nbsp;default &nbsp;for &nbsp;the</font></div><div><font size="2"   >conf_diris &nbsp;/var/lib/ganglia/conf. You can change that by specifying an alternate</font></div><div><font size="2"   >directory in conf.php:</font></div><div><font size="2"   >$conf['conf_dir'] = "/var/www/html/conf";</font></div><p></p></pre></div><div>首先要搞清楚配置文件放在哪里 :&nbsp;</div><div>当前的配置如下 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-221 etc]# cd /data01/web/ganglia-web/</font></div><div><font size="2"   >[root@db-172-16-3-221 ganglia-web]# less conf.php</font></div><div><div><font size="2"   ># Where to store web-based configuration</font></div><div><span style="line-height: 28px;"   ><font size="2"   >$conf['gweb_confdir'] = "/data01/web/ganglia-web";</font></span></div><div><font size="2"   >$conf['views_dir'] = $conf['gweb_confdir'] . '/conf';</font></div><div><font size="2"   >$conf['conf_dir'] = $conf['gweb_confdir'] . '/conf';</font></div></div><p></p></pre></div><div>所以视图的配置文件是存在<span style="line-height: 28px;"   >/data01/web/ganglia-web/conf目录下的.</span></div><div><span style="line-height: 28px;"   >然后搞清楚命名规则 :&nbsp;</span></div><div><span style="line-height: 28px;"   >文件名为view_?.json, ?表示视图名, 必须唯一.</span></div><div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >You can create or edit existing files. The filename for the view must start with</font></div><div><font size="2"   >view_and end with .json(as in, view_1.jsonor view_jira_servers.json). It must be</font></div><div><font size="2"   >unique. Here is an example definition of a view that will result with a view with</font></div><div><font size="2"   >three different graphs:</font></div><p></p></pre></div><div>配置文件样板 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >view_jira.json</font></div><div><font size="2"   >{</font></div><div><font size="2"   >&nbsp; "view_name":"jira", &nbsp; # 视图名称</font></div><div><font size="2"   >&nbsp; "items":[ &nbsp; &nbsp;# 视图里包含的东西, 配置为列表形式, 如下</font></div><div><font size="2"   >&nbsp; &nbsp; { "hostname":"web01.domain.com","graph":"cpu_report"}, &nbsp; &nbsp; # 图表1, 单台主机的单个graph. 在graph.d目录中定义具体内容</font></div><div><font size="2"   >&nbsp; &nbsp; { "hostname":"web02.domain.com","graph":"load_report"}, &nbsp; &nbsp;# 图表2<span style="line-height: 28px;"   >, 单台主机的单个graph. 在graph.d目录中定义具体内容</span></font></div><div><font size="2"   >&nbsp; &nbsp; { "hostname":"web03.domain.com","metric":"cpu_aidle"}, &nbsp; &nbsp;# 图表3<span style="line-height: 28px;"   >, 单台主机的单个metric</span></font></div><div><font size="2"   >&nbsp; &nbsp; { "aggregate_graph":"true", &nbsp; # 图表4, 聚合视图</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "host_regex":[ &nbsp; &nbsp; &nbsp;# 主机规则表达式列表</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; {"regex":"web[2-7]"},</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; {"regex":"web50"}</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; ],</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "metric_regex":[ &nbsp; &nbsp;# metric规则表达式列表</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; {"regex":"load_one"}</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; ],</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "graph_type":"stack", &nbsp; &nbsp;# 聚合视图的画图类型, line OR stack.&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "title":"Location Web Servers load" &nbsp; # 聚合视图的title</font></div><div><font size="2"   >&nbsp; &nbsp; },</font></div><div><font size="2"   >&nbsp; &nbsp; {....} &nbsp;&nbsp;<span style="line-height: 28px;"   ># 图表5, .....</span></font></div><div><font size="2"   >&nbsp; ], &nbsp;# 列表结束</font></div><div><font size="2"   >&nbsp; "view_type":"standard" &nbsp; # 视图类型</font></div><div><font size="2"   >}</font></div><p></p></pre></div></div><div>注意items里面的graph的配置位置在graph.d目录这里 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >/data01/web/ganglia-web/graph.d</font></div><div><div><font size="2"   >[root@db-172-16-3-221 graph.d]# ll</font></div><div><font size="2"   >total 80</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;578 Jan &nbsp;6 &nbsp;2014 apache_report.json</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;186 Jan &nbsp;6 &nbsp;2014 apache_response_report.json</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;426 Jan &nbsp;6 &nbsp;2014 cpu_report.json</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 9065 Jan &nbsp;6 &nbsp;2014 cpu_report.php</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;476 Jan &nbsp;6 &nbsp;2014 load_all_report.json</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;590 Jan &nbsp;6 &nbsp;2014 load_report.json</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;680 Jan &nbsp;6 &nbsp;2014 mem_report.json</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 8324 Aug &nbsp;4 03:04 mem_report.php</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 4973 Jan &nbsp;6 &nbsp;2014 metric.php</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;355 Jan &nbsp;6 &nbsp;2014 network_report.json</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 1616 Jan &nbsp;6 &nbsp;2014 nfs_v3_client_report.json</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;358 Jan &nbsp;6 &nbsp;2014 packet_report.json</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 6392 Jan &nbsp;6 &nbsp;2014 sample_report.php</font></div><div><font size="2"   >-rw-r--r-- 1 nobody 1000 3543 Jan &nbsp;6 &nbsp;2014 varnish_report.php</font></div></div><div><font size="2"   >举个例子 :&nbsp;</font></div><div><div><font size="2"   >[root@db-172-16-3-221 graph.d]# cat cpu_report.json&nbsp;</font></div><div><font size="2"   >{</font></div><div><font size="2"   >&nbsp; &nbsp;"report_name" : "cpu_report",</font></div><div><font size="2"   >&nbsp; &nbsp;"report_type" : "template",</font></div><div><font size="2"   >&nbsp; &nbsp;"title" : "CPU Report",</font></div><div><font size="2"   >&nbsp; &nbsp;"graphite" &nbsp;: "target=alias(HOST_CLUSTER.cpu_user.sum,'User')&amp;target=alias(HOST_CLUSTER.cpu_nice.sum%2C'Nice')&amp;target=alias(HOST_CLUSTER.cpu_system.sum,'System')&amp;target=alias(HOST_CLUSTER.cpu_wio.sum,'Wait')&amp;target=alias(HOST_CLUSTER.cpu_idle.sum%2C'Idle')&amp;areaMode=stacked&amp;max=100&amp;colorList=3333bb,ffea00,dd0000,ff8a60,e2e2f2"</font></div><div><font size="2"   >}</font></div><div><font size="2"   >[root@db-172-16-3-221 graph.d]# cat cpu_report.php</font></div><div><font size="2"   >&lt;?php</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* Pass in by reference! */</font></div><div><font size="2"   >function graph_cpu_report( &amp;$rrdtool_graph )&nbsp;</font></div><div><font size="2"   >{</font></div><div><font size="2"   >&nbsp; &nbsp; global $conf,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$context,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$range,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$rrd_dir,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$size;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if ($conf['strip_domainname']) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;$hostname = strip_domainname($GLOBALS['hostname']);</font></div><div><font size="2"   >&nbsp; &nbsp; } else {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;$hostname = $GLOBALS['hostname'];</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; $title = 'CPU';</font></div><div><font size="2"   >&nbsp; &nbsp; $rrdtool_graph['title'] = $title;</font></div><div><font size="2"   >&nbsp; &nbsp; $rrdtool_graph['upper-limit'] = '100';</font></div><div><font size="2"   >&nbsp; &nbsp; $rrdtool_graph['lower-limit'] = '0';</font></div><div><font size="2"   >&nbsp; &nbsp; $rrdtool_graph['vertical-label'] = 'Percent';</font></div><div><font size="2"   >&nbsp; &nbsp; $rrdtool_graph['height'] += ($size == 'medium') ? 28 : 0;</font></div><div><font size="2"   >&nbsp; &nbsp; $rrdtool_graph['extras'] = ($conf['graphreport_stats'] == true) ? ' --font LEGEND:7' : '';</font></div><div><font size="2"   >&nbsp; &nbsp; $rrdtool_graph['extras'] &nbsp;.= " --rigid";</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if ( $conf['graphreport_stats'] ) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $rrdtool_graph['height'] += ($size == 'medium') ? 16 : 0;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $rmspace = '\\g';</font></div><div><font size="2"   >&nbsp; &nbsp; } else {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $rmspace = '';</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; $series = '';</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; // RB: Perform some formatting/spacing magic.. tinkered to fit</font></div><div><font size="2"   >&nbsp; &nbsp; //</font></div><div><font size="2"   >&nbsp; &nbsp; $eol1 = '';</font></div><div><font size="2"   >&nbsp; &nbsp; $space1 = '';</font></div><div><font size="2"   >&nbsp; &nbsp; $space2 = '';</font></div><div><font size="2"   >&nbsp; &nbsp; if ($size == 'small') {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;$eol1 = '\\l';</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;$space1 = ' ';</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;$space2 = ' &nbsp; &nbsp; &nbsp; &nbsp; ';</font></div><div><font size="2"   >&nbsp; &nbsp; } else if ($size == 'medium' || $size == 'default') {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;$eol1 = '';</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;$space1 = ' ';</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;$space2 = '';</font></div><div><font size="2"   >&nbsp; &nbsp; } else if ($size == 'large') {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;$eol1 = '';</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;$space1 = ' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ';</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;$space2 = ' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ';</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; $cpu_nice_def = '';</font></div><div><font size="2"   >&nbsp; &nbsp; $cpu_nice_cdef = '';</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if (file_exists("$rrd_dir/cpu_nice.rrd")) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $cpu_nice_def = "DEF:'cpu_nice'='${rrd_dir}/cpu_nice.rrd':'sum':AVERAGE ";</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $cpu_nice_cdef = "CDEF:'ccpu_nice'=cpu_nice,num_nodes,/ ";</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if ($context != "host" ) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $series .= "DEF:'num_nodes'='${rrd_dir}/cpu_user.rrd':'num':AVERAGE ";</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; $series .= "DEF:'cpu_user'='${rrd_dir}/cpu_user.rrd':'sum':AVERAGE "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . $cpu_nice_def</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "DEF:'cpu_system'='${rrd_dir}/cpu_system.rrd':'sum':AVERAGE "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "DEF:'cpu_idle'='${rrd_dir}/cpu_idle.rrd':'sum':AVERAGE ";</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if (file_exists("$rrd_dir/cpu_wio.rrd")) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $series .= "DEF:'cpu_wio'='${rrd_dir}/cpu_wio.rrd':'sum':AVERAGE ";</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if (file_exists("$rrd_dir/cpu_steal.rrd")) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $series .= "DEF:'cpu_steal'='${rrd_dir}/cpu_steal.rrd':'sum':AVERAGE ";</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if (file_exists("$rrd_dir/cpu_sintr.rrd")) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $series .= "DEF:'cpu_sintr'='${rrd_dir}/cpu_sintr.rrd':'sum':AVERAGE ";</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if ($context != "host" ) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $series .= "CDEF:'ccpu_user'=cpu_user,num_nodes,/ "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . $cpu_nice_cdef</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "CDEF:'ccpu_system'=cpu_system,num_nodes,/ "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "CDEF:'ccpu_idle'=cpu_idle,num_nodes,/ ";</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; if (file_exists("$rrd_dir/cpu_wio.rrd")) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $series .= "CDEF:'ccpu_wio'=cpu_wio,num_nodes,/ ";</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; if (file_exists("$rrd_dir/cpu_sintr.rrd")) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $series .= "CDEF:'ccpu_sintr'=cpu_sintr,num_nodes,/ ";</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; if (file_exists("$rrd_dir/cpu_steal.rrd")) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $series .= "CDEF:'ccpu_steal'=cpu_steal,num_nodes,/ ";</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $plot_prefix ='ccpu';</font></div><div><font size="2"   >&nbsp; &nbsp; } else {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $plot_prefix ='cpu';</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; $series .= "AREA:'${plot_prefix}_user'#${conf['cpu_user_color']}:'User${rmspace}' ";</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if ( $conf['graphreport_stats'] ) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $series .= "CDEF:user_pos=${plot_prefix}_user,0,INF,LIMIT "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:user_last=user_pos,LAST "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:user_min=user_pos,MINIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:user_avg=user_pos,AVERAGE "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:user_max=user_pos,MAXIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'user_last':' &nbsp;${space1}Now\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'user_min':'${space1}Min\:%5.1lf%%${eol1}' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'user_avg':'${space2}Avg\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'user_max':'${space1}Max\:%5.1lf%%\\l' ";</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if (file_exists("$rrd_dir/cpu_nice.rrd")) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $series .= "STACK:'${plot_prefix}_nice'#${conf['cpu_nice_color']}:'Nice${rmspace}' ";</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; if ( $conf['graphreport_stats'] ) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $series .= "CDEF:nice_pos=${plot_prefix}_nice,0,INF,LIMIT "&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:nice_last=nice_pos,LAST "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:nice_min=nice_pos,MINIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:nice_avg=nice_pos,AVERAGE "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:nice_max=nice_pos,MAXIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'nice_last':' &nbsp;${space1}Now\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'nice_min':'${space1}Min\:%5.1lf%%${eol1}' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'nice_avg':'${space2}Avg\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'nice_max':'${space1}Max\:%5.1lf%%\\l' ";</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; $series .= "STACK:'${plot_prefix}_system'#${conf['cpu_system_color']}:'System${rmspace}' ";</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if ( $conf['graphreport_stats'] ) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $series .= "CDEF:system_pos=${plot_prefix}_system,0,INF,LIMIT "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:system_last=system_pos,LAST "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:system_min=system_pos,MINIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:system_avg=system_pos,AVERAGE "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:system_max=system_pos,MAXIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'system_last':'${space1}Now\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'system_min':'${space1}Min\:%5.1lf%%${eol1}' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'system_avg':'${space2}Avg\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'system_max':'${space1}Max\:%5.1lf%%\\l' ";</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if (file_exists("$rrd_dir/cpu_wio.rrd")) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $series .= "STACK:'${plot_prefix}_wio'#${conf['cpu_wio_color']}:'Wait${rmspace}' ";</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; if ( $conf['graphreport_stats'] ) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $series .= "CDEF:wio_pos=${plot_prefix}_wio,0,INF,LIMIT "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:wio_last=wio_pos,LAST "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:wio_min=wio_pos,MINIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:wio_avg=wio_pos,AVERAGE "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:wio_max=wio_pos,MAXIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'wio_last':' &nbsp;${space1}Now\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'wio_min':'${space1}Min\:%5.1lf%%${eol1}' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'wio_avg':'${space2}Avg\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'wio_max':'${space1}Max\:%5.1lf%%\\l' ";</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if (file_exists("$rrd_dir/cpu_steal.rrd")) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $series .= "STACK:'${plot_prefix}_steal'#${conf['cpu_steal_color']}:'Steal${rmspace}' ";</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; if ( $conf['graphreport_stats'] ) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $series .= "CDEF:steal_pos=${plot_prefix}_steal,0,INF,LIMIT "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:steal_last=steal_pos,LAST "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:steal_min=steal_pos,MINIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:steal_avg=steal_pos,AVERAGE "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:steal_max=steal_pos,MAXIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'steal_last':' &nbsp;${space1}Now\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'steal_min':'${space1}Min\:%5.1lf%%${eol1}' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'steal_avg':'${space2}Avg\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'steal_max':'${space1}Max\:%5.1lf%%\\l' ";</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if (file_exists("$rrd_dir/cpu_sintr.rrd")) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; $series .= "STACK:'${plot_prefix}_sintr'#${conf['cpu_sintr_color']}:'Sintr${rmspace}' ";</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; if ( $conf['graphreport_stats'] ) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $series .= "CDEF:sintr_pos=${plot_prefix}_sintr,0,INF,LIMIT "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:sintr_last=sintr_pos,LAST "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:sintr_min=sintr_pos,MINIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:sintr_avg=sintr_pos,AVERAGE "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:sintr_max=sintr_pos,MAXIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'sintr_last':' &nbsp;${space1}Now\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'sintr_min':'${space1}Min\:%5.1lf%%${eol1}' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'sintr_avg':'${space2}Avg\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'sintr_max':'${space1}Max\:%5.1lf%%\\l' ";</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; $series .= "STACK:'${plot_prefix}_idle'#${conf['cpu_idle_color']}:'Idle${rmspace}' ";</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; if ( $conf['graphreport_stats'] ) {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $series .= "CDEF:idle_pos=${plot_prefix}_idle,0,INF,LIMIT "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:idle_last=idle_pos,LAST "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:idle_min=idle_pos,MINIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:idle_avg=idle_pos,AVERAGE "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "VDEF:idle_max=idle_pos,MAXIMUM "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'idle_last':' &nbsp;${space1}Now\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'idle_min':'${space1}Min\:%5.1lf%%${eol1}' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'idle_avg':'${space2}Avg\:%5.1lf%%' "</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . "GPRINT:'idle_max':'${space1}Max\:%5.1lf%%\\l' ";</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; // If metrics like cpu_user and wio are not present we are likely not collecting them on this</font></div><div><font size="2"   >&nbsp; // host therefore we should not attempt to build anything and will likely end up with a broken</font></div><div><font size="2"   >&nbsp; // image. To avoid that we'll make an empty image</font></div><div><font size="2"   >&nbsp; if ( !file_exists("$rrd_dir/cpu_wio.rrd") &amp;&amp; !file_exists("$rrd_dir/cpu_user.rrd") )&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; $rrdtool_graph[ 'series' ] = 'HRULE:1#FFCC33:"No matching metrics detected"'; &nbsp;&nbsp;</font></div><div><font size="2"   >&nbsp; else</font></div><div><font size="2"   >&nbsp; &nbsp; $rrdtool_graph[ 'series' ] = $series;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; return $rrdtool_graph;</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >?&gt;</font></div></div><p></p></pre></div><div>自定义?_report.json可以参考</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201481535636763/"   >http://blog.163.com/digoal@126/blog/static/163877040201481535636763/</a></div><div><br></div><div>view配置对应的json文件内支持的语法如下 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >Key: Value</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >view_name: Name of the view, which must be unique.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >view_type: Standard or Regex. Regex view allows you to specify regex to match hosts.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >items: An array of hashes describing which metrics should be part of the view.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >hostname: Hostname of the host that we want metric/graph displayed.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >metric: Name of the metric, such as load_one.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >graph: Graph name, such as cpu_report or load_report. &nbsp;You can use metric or graph keys&nbsp;<span style="line-height: 28px;"   >but not both.</span></font></div><div><font size="2"   ><span style="line-height: 28px;"   ><br></span></font></div><div><font size="2"   >aggregate_graph: If this value exists and is set to true, the item defines an aggregate graph.&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This&nbsp;<span style="line-height: 28px;"   >item needs a hash of regular expressions and a description.</span></font></div><div><font size="2"   ><span style="line-height: 28px;"   ><br></span></font></div><div><font size="2"   >warning: (Optional) Adds a vertical yellow line to provide visual cue for a warning state.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >critical: (Optional) Adds a vertical red line to provide visual cue for a critical state.</font></div><p></p></pre></div><div><br></div><div>例子 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   ># cd /data01/web/ganglia-web/conf</font></div><div><font size="2"   >[root@db-172-16-3-221 conf]# ll</font></div><div><div><font size="2"   >-rw-r--r-- 1 nobody &nbsp; 1000 &nbsp; 58 Jan &nbsp;6 &nbsp;2014 view_default.json</font></div><div><font size="2"   >[root@db-172-16-3-221 conf]# cat view_default.json&nbsp;</font></div><div><font size="2"   >{"view_name":"default","items":[],"view_type":"standard"}</font></div></div><p></p></pre></div><div>view_default.json是一个没有列表的配置文件,&nbsp;</div><div><div><div><img title="ganglia gweb customize views - 德哥@Digoal - PostgreSQL research"   alt="ganglia gweb customize views - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/fF6yMlQ14JA2a8MKX8SRdA==/6608892815190088270.png"   ></div></div><div>我们修改一下它的配置 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >{</font></div><div><font size="2"   >&nbsp; "view_name":"default",</font></div><div><font size="2"   >&nbsp; "items":[</font></div><div><font size="2"   >&nbsp; &nbsp; { "aggregate_graph":"true",</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "host_regex":[</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; {"regex":".*"} &nbsp; # 因为我这里只有一台主机, 所以暂且这样吧</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; ],</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "metric_regex":[</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; {"regex":"^load.*"}</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; ],</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "graph_type":"line",</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "title":"Location Web Servers load"</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   >&nbsp; ],</font></div><div><font size="2"   >&nbsp; "view_type":"standard"</font></div><div><font size="2"   >}</font></div><p></p></pre></div><div>修改后, 立即生效.</div><div><img title="ganglia gweb customize views - 德哥@Digoal - PostgreSQL research"   alt="ganglia gweb customize views - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/MzAguzn8IvRA1YAYSG0EYg==/6608655320678487118.png"   ></div>例如再新增一个view_digoal.json</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-221 conf]# vi view_digoal.json&nbsp;</font></div><div><font size="2"   >{</font></div><div><font size="2"   >&nbsp; "view_name":"digoal",</font></div><div><font size="2"   >&nbsp; "items":[</font></div><div><font size="2"   >&nbsp; &nbsp; { "aggregate_graph":"true",</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "host_regex":[</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; {"regex":".*"}</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; ],</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "metric_regex":[</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; {"regex":"^cpu.*"}</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; ],</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "graph_type":"line",</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "title":"Cpu"</font></div><div><font size="2"   >&nbsp; &nbsp; },</font></div><div><font size="2"   >&nbsp; &nbsp; { "aggregate_graph":"true",</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "host_regex":[</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; {"regex":".*"}</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; ],</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "metric_regex":[</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; {"regex":"^mem.*"}</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; ],</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "graph_type":"line",</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; "title":"Mem"</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   >&nbsp; ],</font></div><div><font size="2"   >&nbsp; "view_type":"standard"</font></div><div><font size="2"   >}</font></div><p></p></pre></div><div><div><img title="ganglia gweb customize views - 德哥@Digoal - PostgreSQL research"   alt="ganglia gweb customize views - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/fyVhTWFx_yls2_mvPl3ofg==/6608222113098220279.png"   ></div></div><div>这里同样说明了gmond hostname和metric name的命名规则重要性.</div><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402014810227936/"   >http://blog.163.com/digoal@126/blog/static/1638770402014810227936/</a></div><div>2.&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402014815101836852/"   >http://blog.163.com/digoal@126/blog/static/1638770402014815101836852/</a></div><div>3.&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201481535636763/"   >http://blog.163.com/digoal@126/blog/static/163877040201481535636763/</a></div><div><br></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="ganglia gweb customize views - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>