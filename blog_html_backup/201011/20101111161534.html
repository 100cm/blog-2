<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Sequencial-Write-Throughput performance decrease because of an increase of CPU and process/thread in RHEL5</h2>
	<h5 id="">2010-11-11 16:15:34&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201010114139996/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;">- Description of problem:<br>As for RHEL5, the throughput of sequential-writing in multi-CPU and <br>multi-processing/multi-thread is more deteriorated than that of RHEL4U4<br>(when the number of processes is more than the number of CPU with 4CPU or more) .<br><br>Especially, the throughput of seq-W is bad in the following cases. <br>&nbsp; - For the HyperThreading is effective.<br>&nbsp;&nbsp;&nbsp; (The performance decrease of 70 - 80 % in RHEL5 8CPU [DL580G3 4CPU with HT<br>or DL380G4p 2CPU with DualCore &amp; HT]<br>&nbsp;&nbsp;&nbsp;&nbsp; compared with the case of RHEL4U4 8CPU [DL580G3 4CPU with HT or DL380G4p<br>2CPU with DualCore &amp; HT]<br>&nbsp;&nbsp;&nbsp;&nbsp; and RHEL5 1CPU [DL580G3 or DL380G4p].)<br>&nbsp; - For the disk through cciss driver.<br>&nbsp;&nbsp;&nbsp; (The performance decrease of 10 - 20 % in RHEL5 4CPU [DL580G3 4CPU or<br>DL380G4p 2CPU with DualCore]<br>&nbsp;&nbsp;&nbsp;&nbsp; compared with the case of RHEL5 4CPU [No-brand-machine 2CPU with DualCore,<br>SATA rev2.0 disk].)<br><br>- Verification Hardware:<br>&nbsp; - DL380G4p&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : CPU: Xeon&nbsp;&nbsp;&nbsp;&nbsp; 2.8Ghz [DualCore,<br>HyperThreading] x 2, Mem:&nbsp; 4GB, Disk: cciss Ultra320SCSI<br>&nbsp; - DL580G3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : CPU: XeonMP&nbsp;&nbsp; 3.0Ghz [HyperThreading]&nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; x 4, Mem: 12GB, Disk: cciss Ultra320SCSI<br>&nbsp; - No-brand-machine (SystemWorks) : CPU: Xeon5160 3,0Ghz [DualCore]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; x 2, Mem: 12GB, Disk: SATA rev2.0<br><br>- Version-Release number of selected component (if applicable):<br>&nbsp; - kernel-2.6.18-8.el5<br>&nbsp; - kernel-2.6.18-8.1.1.el5<br><br>- How reproducible:<br>By benchmark softwares such as tiobench and IOzone, it writes data sequentially<br>at the same time in the number of processes/threads more than the number of CPU<br>with 4CPU or more.<br><br>Steps to Reproduce:<br>tiobench の例: # ./tiotest -t {1 or 2 or 4 or 8 or 16} -f {50 or 100 or 200} -b<br>4096 -d /mnt/otherdisk <br>IOzone の例&nbsp; : # ./iozone -pM -t{1/2/4/8} -l{1/2/4/8} -u{1/2/4/8} -i0 -i1 -i2<br>-r4k -s{128m,256m,512m,1024m} -F /mnt/otherdisk/temp{1,2,3,4,5,6,7,8}<br><br>Actual results:<br>When the number of processes/threads exceeds it more than the number of CPU,<br>the performance is deteriorated.<br>Especially, the throughput of seq-W is bad in the following cases. <br>&nbsp; - For the HyperThreading is effective.<br>&nbsp; - For the disk through cciss driver (with 4CPU or more) .<br><br>* tiobench Result - Sequencial Write Throughput (MB/sec) - FileSize=200MB<br>+ DL380G4p <br>- RHEL4U4 (2.6.9-42.ELsmp)<br>----------------------------------------------------------------------------------<br>&nbsp;&nbsp; CPU | 1CPU&nbsp;&nbsp; | 2CPU&nbsp;&nbsp; | 4CPU (2CPU with DualCore) | 8CPU (4CPU with DC and HT)|<br>-------|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>Thread |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>----------------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp; 1 | 57.102 | 58.67&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 56.786 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 57.01&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp; 2 | 58.067 | 61.949 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 62.253 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 60.814 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 4 | 63.437 | 67.869 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 66.298 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 65.184 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 8 | 68.868 | 69.493 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70.449 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 63.629 |<br>&nbsp;&nbsp;&nbsp; 16 | 72.52&nbsp; | 72.455 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70.886 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 68.042 |<br>----------------------------------------------------------------------------------<br><br>- RHEL5 (2.6.18-8.1.1.el5)<br>----------------------------------------------------------------------------------<br>&nbsp;&nbsp; CPU | 1CPU&nbsp;&nbsp; | 2CPU&nbsp;&nbsp; | 4CPU (2CPU with DualCore) | 8CPU (4CPU with DC and HT)|<br>-------|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>Thread |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>----------------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp; 1 | 62.217 | 56.871 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 56.74&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 57.318 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 2 | 59.553 | 59.095 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 58.443 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 58.589 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 4 | 64.76&nbsp; | 61.921 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 59.687 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 57.429 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 8 | 65.976 | 64.146 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 58.11&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 13.221 |<br>&nbsp;&nbsp;&nbsp; 16 | 66.472 | 63.652 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 58.733 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 17.531 |<br>----------------------------------------------------------------------------------<br><br>- RHEL4U4 vs RHEL5 : ((RHEL5 / RHEL4U4) - 1)<br>----------------------------------------------------------------------------------<br>&nbsp;&nbsp; CPU | 1CPU&nbsp;&nbsp; | 2CPU&nbsp;&nbsp; | 4CPU (2CPU with DualCore) | 8CPU (4CPU with DC and HT)|<br>-------|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>Thread |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>----------------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp; 1 | 0.0895 |-0.0306 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -0.000810 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.005402|<br>&nbsp;&nbsp;&nbsp;&nbsp; 2 | 0.0255 |-0.0460 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -0.06120&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -0.03658 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 4 | 0.0208 |-0.0876 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -0.09971&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -0.1189&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp; 8 |-0.0419 |-0.0769 |deterioration--&gt; -0.1751&nbsp;&nbsp; |big deterioration -0.7922&nbsp; |<br>&nbsp;&nbsp;&nbsp; 16 |-0.0833 |-0.1214 |deterioration--&gt; -0.1714&nbsp;&nbsp; |because of HT? -&gt; -0.7423&nbsp; |<br>----------------------------------------------------------------------------------<br><br>+ DL580G3<br>- Quite the same result as DL380G4p came out from DL580G3. (Result of DL580G3 is<br>same as DL580G3.)<br><br><br>+ No-brand Machine (SystemWorks inc.)<br>- RHEL4U4 (2.6.9-42.ELsmp)<br>------------------------------------------------------<br>&nbsp;&nbsp; CPU | 1CPU&nbsp;&nbsp; | 2CPU&nbsp;&nbsp; | 4CPU (2CPU with DualCore) |<br>-------|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>Thread |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp; 1 | 55.77&nbsp; | 55.348 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 55.005 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 2 | 51.02&nbsp; | 52.744 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 51.962 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 4 | 51.336 | 50.487 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 49.67&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp; 8 | 51.254 | 49.034 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 49.31&nbsp; |<br>&nbsp;&nbsp;&nbsp; 16 | 50.9&nbsp;&nbsp; | 50.294 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 50.079 |<br>------------------------------------------------------<br><br>- RHEL5 (2.6.18-8.1.1.el5)<br>------------------------------------------------------<br>&nbsp;&nbsp; CPU | 1CPU&nbsp;&nbsp; | 2CPU&nbsp;&nbsp; | 4CPU (2CPU with DualCore) |<br>-------|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>Thread |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp; 1 | 55.32&nbsp; | 54.937 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 54.444 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 2 | 52.547 | 48.174 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 49.407 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 4 | 50.381 | 48.729 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 48.521 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 8 | 50.503 | 48.907 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 46.742 |<br>&nbsp;&nbsp;&nbsp; 16 | 50.958 | 48.057 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 48.18&nbsp; |<br>------------------------------------------------------<br><br>- RHEL4U4 vs RHEL5 : ((RHEL5 / RHEL4U4) - 1)<br>------------------------------------------------------<br>&nbsp;&nbsp; CPU | 1CPU&nbsp;&nbsp; | 2CPU&nbsp;&nbsp; | 4CPU (2CPU with DualCore) |<br>-------|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>Thread |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp; 1 |-0.00806|-0.00742|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -0.01019 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 2 | 0.0299 |-0.0866 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -0.04917 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 4 |-0.0186 |-0.0348 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -0.02313 |<br>&nbsp;&nbsp;&nbsp;&nbsp; 8 |-0.0146 |-0.00259|&nbsp; almost same --&gt; -0.05207 |<br>&nbsp;&nbsp;&nbsp; 16 | 0.00113|-0.0444 |&nbsp; almost same --&gt; -0.03792 |<br>------------------------------------------------------<br><br>Expected results:<br>RHEL5 becomes equal to RHEL4U4 or exceeds it, for sequential-writing in<br>multi-CPU and multi-process/thread.<br>Or, please tell me the reccommended value of kernel-parameter to avoid this problem.<br><br>回复2:<br><br><pre>I ran iozone on HP DL385 machine on both RHEL-4.4 and RHEL-5.4 (-pre)and see<br>RHEL4 overcomes RHEL5 in "readers", "re-readers" and "random writers" tests. In<br>all others tests RHEL5 beats RHEL4. When I've changed nr_requests from 128 to<br>8192, RHEL4 still overcomes RHEL5 in "readers" (10%) and "random writes" (30%)<br>tests. In all other tests RHEL5 is faster, up to 5x.</pre>后来被REDHAT关闭了这个CASE，不过nr_requests在R5的改变确实属实。  <pre>The has been closed due to long inactivity. And as per <a rel="nofollow" href="https://bugzilla.redhat.com/show_bug.cgi?id=237605#c2"  >回复2</a>, it's not the<br>subject to fix. Too way much changes between EL4 and EL5, where particular<br>slowdown can't be considered as regression.<br><br>Thanks!<br><br><br></pre></div>
	</div>
</div>
</body>
</html>