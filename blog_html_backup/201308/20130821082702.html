<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">modify citusdb's mongo_fdw extension to use mongo-c-driver-v0.8 support unix sock connect</h2>
	<h5 id="">2013-08-21 8:27:02&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020137218443650/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;">以前写过的一些PostgreSQL mongodb 外部表的相关文章, 有兴趣的朋友可以阅读如下 :&nbsp;<wbr><div><a href="http://blog.163.com/digoal@126/blog/static/16387704020137204136657/"   >http://blog.163.com/digoal@126/blog/static/16387704020137204136657/</a></div><div><a href="http://blog.163.com/digoal@126/blog/static/163877040201321984940903/"   >http://blog.163.com/digoal@126/blog/static/163877040201321984940903/</a></div><div>昨天在使用pgbench测试mongo_fdw时,发现一个bug, 只要是用到了prepared statement, 就会导致数据库crash.&nbsp;</div><div><a href="http://blog.163.com/digoal@126/blog/static/16387704020137204136657/"   >http://blog.163.com/digoal@126/blog/static/16387704020137204136657/</a></div><div>不得已使用-M simple来测试. 同时citusdb的mongo_fdw用的mongo c driver版本太老(0.6), 还不支持unix sock连接.</div><div>昨天晚上去github上下了一个最新的mongo c driver, 0.8的版本,&nbsp;</div><div><a rel="nofollow" href="https://github.com/mongodb/mongo-c-driver"   >https://github.com/mongodb/mongo-c-driver</a></div><div>这个版本的驱动很多接口函数都变了, 也支持unix sock连接. 稍微修改一下就可以和mongo_fdw搭配使用.&nbsp;</div><div>想玩一玩的朋友可以到我的github中下载, 省得自己修改了.</div><div><a rel="nofollow" href="https://github.com/digoal/mongo_fdw"   >https://github.com/digoal/mongo_fdw</a></div><div>接口函数手册</div><div><a rel="nofollow" href="http://api.mongodb.org/c/current/connections.html"   >http://api.mongodb.org/c/current/connections.html</a></div><div>通过unix sock连接时端口配置为-1, 例如</div><pre class="prettyprint"   ><p></p><div><font size="2"   >result = mongo_client( conn, "/tmp/mongodb-27017.sock", -1 );</font></div><div></div><p></p></pre><div><span style="line-height: 22px;"   >在数据库中的使用如下 :&nbsp;</span></div><div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pg92@db-172-16-3-33-&gt; psql</font></div><div><font size="2"   >psql (9.2.4)</font></div><div><font size="2"   >Type "help" for help.</font></div><div><font size="2"   >-- 使用tcp连接</font></div><div><font size="2"   >postgres=# select * from pg_foreign_server ;</font></div><div><font size="2"   >&nbsp; &nbsp;srvname &nbsp; &nbsp;| srvowner | srvfdw | srvtype | srvversion | srvacl | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;srvoptions &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >--------------+----------+--------+---------+------------+--------+-------------------------------</font></div><div><font size="2"   >&nbsp;mongo_server | &nbsp; &nbsp; &nbsp; 10 | &nbsp;32819 | &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp;| {address=127.0.0.1,port=5281}</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >postgres=# select * from f_mongo_test limit 1;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; id &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp;crt_time &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >--------------------------+--------+----------------------------------+---------------------</font></div><div><font size="2"   >&nbsp;521336df09405fb980ecd051 | 712193 | dcf472682b9322c56bcdc04b1f508fed | 2013-08-20 14:03:25</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><div>-- 修改为unix sock连接 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres=# alter server mongo_server options (set address '/tmp/mongodb-5281.sock');</font></div><div><font size="2"   >ALTER SERVER</font></div><div><font size="2"   >postgres=# alter server mongo_server options (set port '-1');</font></div><div><font size="2"   >ALTER SERVER</font></div><div><font size="2"   >postgres=# select * from f_mongo_test limit 1;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; id &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp;crt_time &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >--------------------------+--------+----------------------------------+---------------------</font></div><div><font size="2"   >&nbsp;521336df09405fb980ecd051 | 712193 | dcf472682b9322c56bcdc04b1f508fed | 2013-08-20 14:03:25</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >postgres=# select * from pg_foreign_server ;</font></div><div><font size="2"   >&nbsp; &nbsp;srvname &nbsp; &nbsp;| srvowner | srvfdw | srvtype | srvversion | srvacl | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;srvoptions &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >--------------+----------+--------+---------+------------+--------+------------------------------------------</font></div><div><font size="2"   >&nbsp;mongo_server | &nbsp; &nbsp; &nbsp; 10 | &nbsp;32819 | &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp;| {address=/tmp/mongodb-5281.sock,port=-1}</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div></div><div>使用unix sock后, 性能有一定的提升 :&nbsp;</div><div>使用unix sock连接的性能如下 :&nbsp;</div><div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pg94@db-172-16-3-33-&gt; pgbench -M simple -n -r -f ./test.sql -h 127.0.0.1 -p 1919 -U postgres -c 24 -j 24 -T 60 postgres</font></div><div><font size="2"   >transaction type: Custom query</font></div><div><font size="2"   >scaling factor: 1</font></div><div><font size="2"   >query mode: simple</font></div><div><font size="2"   >number of clients: 24</font></div><div><font size="2"   >number of threads: 24</font></div><div><font size="2"   >duration: 60 s</font></div><div><font size="2"   >number of transactions actually processed: 179540</font></div><div><font size="2"   >tps = 2991.697847 (including connections establishing)</font></div><div><font size="2"   >tps = 2992.742955 (excluding connections establishing)</font></div><div><font size="2"   >statement latencies in milliseconds:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 0.002464 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom id 1 5000000</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 8.013893 &nbsp; &nbsp; &nbsp; &nbsp;select 1 from f_mongo_test where id=:id;</font></div><div><font size="2"   >&nbsp; PID USER &nbsp; &nbsp; &nbsp;PR &nbsp;NI &nbsp;VIRT &nbsp;RES &nbsp;SHR S %CPU %MEM &nbsp; &nbsp;TIME+ &nbsp;COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp;3389 mongo &nbsp; &nbsp; 19 &nbsp; 0 3268m 839m 808m R 257.3 &nbsp;6.0 &nbsp;11:14.11 mongod -f ./mongod.conf</font></div><div><font size="2"   >16758 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5416 3644 S &nbsp;5.0 &nbsp;0.0 &nbsp; 0:00.57 postgres: postgres postgres 127.0.0.1(20747) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16614 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5420 3648 S &nbsp;4.3 &nbsp;0.0 &nbsp; 0:00.64 postgres: postgres postgres 127.0.0.1(20734) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16675 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5420 3648 S &nbsp;4.3 &nbsp;0.0 &nbsp; 0:00.62 postgres: postgres postgres 127.0.0.1(20744) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16767 pg92 &nbsp; &nbsp; &nbsp;16 &nbsp; 0 1222m 5416 3644 S &nbsp;4.3 &nbsp;0.0 &nbsp; 0:00.57 postgres: postgres postgres 127.0.0.1(20748) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16841 pg92 &nbsp; &nbsp; &nbsp;16 &nbsp; 0 1222m 5420 3648 S &nbsp;4.3 &nbsp;0.0 &nbsp; 0:00.57 postgres: postgres postgres 127.0.0.1(20749) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16604 pg92 &nbsp; &nbsp; &nbsp;16 &nbsp; 0 1222m 5420 3652 S &nbsp;4.0 &nbsp;0.0 &nbsp; 0:00.57 postgres: postgres postgres 127.0.0.1(20731) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16612 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5440 3668 S &nbsp;4.0 &nbsp;0.0 &nbsp; 0:00.59 postgres: postgres postgres 127.0.0.1(20732) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16613 pg92 &nbsp; &nbsp; &nbsp;16 &nbsp; 0 1222m 5416 3644 S &nbsp;4.0 &nbsp;0.0 &nbsp; 0:00.56 postgres: postgres postgres 127.0.0.1(20733) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16622 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5416 3644 R &nbsp;4.0 &nbsp;0.0 &nbsp; 0:00.59 postgres: postgres postgres 127.0.0.1(20737) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16639 pg92 &nbsp; &nbsp; &nbsp;16 &nbsp; 0 1222m 5428 3656 R &nbsp;4.0 &nbsp;0.0 &nbsp; 0:00.59 postgres: postgres postgres 127.0.0.1(20740) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16865 pg92 &nbsp; &nbsp; &nbsp;16 &nbsp; 0 1222m 5420 3648 S &nbsp;4.0 &nbsp;0.0 &nbsp; 0:00.55 postgres: postgres postgres 127.0.0.1(20750) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16890 pg92 &nbsp; &nbsp; &nbsp;16 &nbsp; 0 1222m 5420 3648 S &nbsp;4.0 &nbsp;0.0 &nbsp; 0:00.58 postgres: postgres postgres 127.0.0.1(20751) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16918 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5416 3644 S &nbsp;4.0 &nbsp;0.0 &nbsp; 0:00.58 postgres: postgres postgres 127.0.0.1(20752) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16980 pg92 &nbsp; &nbsp; &nbsp;16 &nbsp; 0 1222m 5416 3644 S &nbsp;4.0 &nbsp;0.0 &nbsp; 0:00.58 postgres: postgres postgres 127.0.0.1(20754) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16618 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5424 3652 S &nbsp;3.7 &nbsp;0.0 &nbsp; 0:00.58 postgres: postgres postgres 127.0.0.1(20735) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16627 pg92 &nbsp; &nbsp; &nbsp;16 &nbsp; 0 1222m 5420 3648 S &nbsp;3.7 &nbsp;0.0 &nbsp; 0:00.58 postgres: postgres postgres 127.0.0.1(20739) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16659 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5428 3656 S &nbsp;3.7 &nbsp;0.0 &nbsp; 0:00.56 postgres: postgres postgres 127.0.0.1(20742) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16663 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5416 3644 S &nbsp;3.7 &nbsp;0.0 &nbsp; 0:00.54 postgres: postgres postgres 127.0.0.1(20743) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16684 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5416 3644 S &nbsp;3.7 &nbsp;0.0 &nbsp; 0:00.58 postgres: postgres postgres 127.0.0.1(20745) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16720 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5420 3648 S &nbsp;3.7 &nbsp;0.0 &nbsp; 0:00.58 postgres: postgres postgres 127.0.0.1(20746) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16621 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5416 3644 S &nbsp;3.3 &nbsp;0.0 &nbsp; 0:00.61 postgres: postgres postgres 127.0.0.1(20736) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16657 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5420 3648 S &nbsp;3.3 &nbsp;0.0 &nbsp; 0:00.54 postgres: postgres postgres 127.0.0.1(20741) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16941 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5428 3656 S &nbsp;3.3 &nbsp;0.0 &nbsp; 0:00.58 postgres: postgres postgres 127.0.0.1(20753) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >16624 pg92 &nbsp; &nbsp; &nbsp;16 &nbsp; 0 1222m 5420 3648 S &nbsp;3.0 &nbsp;0.0 &nbsp; 0:00.54 postgres: postgres postgres 127.0.0.1(20738) SELECT</font></div><p></p></pre></div><div>使用tcp连接性能如下 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pg94@db-172-16-3-33-&gt; pgbench -M simple -n -r -f ./test.sql -h 127.0.0.1 -p 1919 -U postgres -c 24 -j 24 -T 60 postgres</font></div><div><font size="2"   >transaction type: Custom query</font></div><div><font size="2"   >scaling factor: 1</font></div><div><font size="2"   >query mode: simple</font></div><div><font size="2"   >number of clients: 24</font></div><div><font size="2"   >number of threads: 24</font></div><div><font size="2"   >duration: 60 s</font></div><div><font size="2"   >number of transactions actually processed: 151937</font></div><div><font size="2"   >tps = 2531.814483 (including connections establishing)</font></div><div><font size="2"   >tps = 2532.684212 (excluding connections establishing)</font></div><div><font size="2"   >statement latencies in milliseconds:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 0.002370 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom id 1 5000000</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 9.470604 &nbsp; &nbsp; &nbsp; &nbsp;select 1 from f_mongo_test where id=:id;</font></div><div><font size="2"   >&nbsp; PID USER &nbsp; &nbsp; &nbsp;PR &nbsp;NI &nbsp;VIRT &nbsp;RES &nbsp;SHR S %CPU %MEM &nbsp; &nbsp;TIME+ &nbsp;COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp;3389 mongo &nbsp; &nbsp; 25 &nbsp; 0 3268m 839m 808m R 247.8 &nbsp;6.0 &nbsp; 9:25.41 mongod -f ./mongod.conf</font></div><div><font size="2"   >11447 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5440 3676 S &nbsp;7.0 &nbsp;0.0 &nbsp; 0:01.33 postgres: postgres postgres 127.0.0.1(21935) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11448 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5436 3672 R &nbsp;6.6 &nbsp;0.0 &nbsp; 0:01.30 postgres: postgres postgres 127.0.0.1(21936) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11414 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5436 3672 S &nbsp;6.3 &nbsp;0.0 &nbsp; 0:01.29 postgres: postgres postgres 127.0.0.1(21928) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11475 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5448 3676 S &nbsp;6.3 &nbsp;0.0 &nbsp; 0:01.33 postgres: postgres postgres 127.0.0.1(21940) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11476 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5448 3676 R &nbsp;6.3 &nbsp;0.0 &nbsp; 0:01.29 postgres: postgres postgres 127.0.0.1(21941) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11499 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5444 3672 S &nbsp;6.3 &nbsp;0.0 &nbsp; 0:01.36 postgres: postgres postgres 127.0.0.1(21944) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11537 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5448 3676 S &nbsp;6.3 &nbsp;0.0 &nbsp; 0:01.28 postgres: postgres postgres 127.0.0.1(21947) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11415 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5604 3836 S &nbsp;6.0 &nbsp;0.0 &nbsp; 0:01.36 postgres: postgres postgres 127.0.0.1(21929) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11426 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5436 3672 S &nbsp;6.0 &nbsp;0.0 &nbsp; 0:01.32 postgres: postgres postgres 127.0.0.1(21934) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11465 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5444 3672 S &nbsp;6.0 &nbsp;0.0 &nbsp; 0:01.28 postgres: postgres postgres 127.0.0.1(21938) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11467 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5456 3684 S &nbsp;6.0 &nbsp;0.0 &nbsp; 0:01.34 postgres: postgres postgres 127.0.0.1(21939) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11518 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5448 3676 S &nbsp;6.0 &nbsp;0.0 &nbsp; 0:01.29 postgres: postgres postgres 127.0.0.1(21945) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11566 pg92 &nbsp; &nbsp; &nbsp;16 &nbsp; 0 1222m 5448 3676 S &nbsp;6.0 &nbsp;0.0 &nbsp; 0:01.32 postgres: postgres postgres 127.0.0.1(21948) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11588 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5444 3672 S &nbsp;6.0 &nbsp;0.0 &nbsp; 0:01.32 postgres: postgres postgres 127.0.0.1(21949) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11413 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5436 3672 S &nbsp;5.6 &nbsp;0.0 &nbsp; 0:01.33 postgres: postgres postgres 127.0.0.1(21927) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11416 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5448 3676 S &nbsp;5.6 &nbsp;0.0 &nbsp; 0:01.28 postgres: postgres postgres 127.0.0.1(21930) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11420 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5452 3680 S &nbsp;5.6 &nbsp;0.0 &nbsp; 0:01.26 postgres: postgres postgres 127.0.0.1(21931) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11424 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5444 3672 S &nbsp;5.6 &nbsp;0.0 &nbsp; 0:01.31 postgres: postgres postgres 127.0.0.1(21932) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11425 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5440 3676 S &nbsp;5.6 &nbsp;0.0 &nbsp; 0:01.24 postgres: postgres postgres 127.0.0.1(21933) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11456 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5448 3676 S &nbsp;5.6 &nbsp;0.0 &nbsp; 0:01.29 postgres: postgres postgres 127.0.0.1(21937) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11477 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5444 3672 S &nbsp;5.6 &nbsp;0.0 &nbsp; 0:01.29 postgres: postgres postgres 127.0.0.1(21942) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11498 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5448 3676 S &nbsp;5.6 &nbsp;0.0 &nbsp; 0:01.30 postgres: postgres postgres 127.0.0.1(21943) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11529 pg92 &nbsp; &nbsp; &nbsp;15 &nbsp; 0 1222m 5448 3676 S &nbsp;5.3 &nbsp;0.0 &nbsp; 0:01.27 postgres: postgres postgres 127.0.0.1(21946) SELECT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >11589 pg92 &nbsp; &nbsp; &nbsp;16 &nbsp; 0 1222m 5448 3676 S &nbsp;5.3 &nbsp;0.0 &nbsp; 0:01.27 postgres: postgres postgres 127.0.0.1(21950) SELECT</font></div><p></p></pre></div></div><div><br></div><div>[参考]</div><div><div style="line-height: 22px;"   >1.&nbsp;<a style="line-height: 22px;" href="http://blog.163.com/digoal@126/blog/static/16387704020137204136657/"   >http://blog.163.com/digoal@126/blog/static/16387704020137204136657/</a></div><div style="line-height: 22px;"   >2.&nbsp;<a style="line-height: 22px;" href="http://blog.163.com/digoal@126/blog/static/163877040201321984940903/"   >http://blog.163.com/digoal@126/blog/static/163877040201321984940903/</a></div></div><div>3.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="https://github.com/digoal/mongo_fdw"   >https://github.com/digoal/mongo_fdw</a></div><div>4.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://api.mongodb.org/c/current/connections.html"   >http://api.mongodb.org/c/current/connections.html</a></div><div>5.&nbsp;<a style="line-height: 22px;" target="_blank" rel="nofollow" href="http://blog.beyondfog.com/mongodb-how-to-benchmark-and-test-performance-using-mongo-perf/"   >http://blog.beyondfog.com/mongodb-how-to-benchmark-and-test-performance-using-mongo-perf/</a></div><div>6.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://api.mongodb.org/c/0.6/tutorial.html"   >http://api.mongodb.org/c/0.6/tutorial.html</a></div><div>7.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="https://github.com/algernon/libmongo-client"   >https://github.com/algernon/libmongo-client</a></div><div>8.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://algernon.github.io/libmongo-client/"   >http://algernon.github.io/libmongo-client/</a></div></div>
	</div>
</div>
</body>
</html>