<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL cann't startup because filesystem full</h2>
	<h5 id="">2015-01-07 15:16:28&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020150731628237/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;">数据库所在的文件系统满了, 导致数据库无法启动一例.<div>如果pg_xlog和数据库在同一个目录,(不是软链接)</div><div>可以通过删除不必要的pg_xlog文件来启动数据库.</div><div>例如 :&nbsp;</div><div>首先需要查看控制文件, 了解最后一次CHECKPOINT对应的文件.</div><div>除了这个文件以及以后的文件, 其他都可以删除.</div><div><div>pg_controldata&nbsp;</div><div>pg_control version number: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;937</div><div>Catalog version number: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 201306121</div><div>Database system identifier: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6098909297531158007</div><div>Database cluster state: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shut down</div><div>pg_control last modified: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Wed 07 Jan 2015 03:08:47 PM CST</div><div>Latest checkpoint location: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; D/49000028</div><div>Prior checkpoint location: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;D/481C59C8</div><div>Latest checkpoint's REDO location: &nbsp; &nbsp;D/49000028</div><div>Latest checkpoint's REDO WAL file: &nbsp; &nbsp;000000250000000D00000049</div><div>Latest checkpoint's TimeLineID: &nbsp; &nbsp; &nbsp; 37</div><div>Latest checkpoint's PrevTimeLineID: &nbsp; 37</div><div>Latest checkpoint's full_page_writes: on</div><div>Latest checkpoint's NextXID: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0/99926200</div><div>Latest checkpoint's NextOID: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;98337</div><div>Latest checkpoint's NextMultiXactId: &nbsp;1</div><div>Latest checkpoint's NextMultiOffset: &nbsp;0</div><div>Latest checkpoint's oldestXID: &nbsp; &nbsp; &nbsp; &nbsp;1674</div><div>Latest checkpoint's oldestXID's DB: &nbsp; 1</div><div>Latest checkpoint's oldestActiveXID: &nbsp;0</div><div>Latest checkpoint's oldestMultiXid: &nbsp; 1</div><div>Latest checkpoint's oldestMulti's DB: 1</div><div>Time of latest checkpoint: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Wed 07 Jan 2015 03:08:47 PM CST</div><div>Fake LSN counter for unlogged rels: &nbsp; 0/1</div><div>Minimum recovery ending location: &nbsp; &nbsp; 0/0</div><div>Min recovery ending loc's timeline: &nbsp; 0</div><div>Backup start location: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0/0</div><div>Backup end location: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0/0</div><div>End-of-backup record required: &nbsp; &nbsp; &nbsp; &nbsp;no</div><div>Current wal_level setting: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hot_standby</div><div>Current max_connections setting: &nbsp; &nbsp; &nbsp;100</div><div>Current max_prepared_xacts setting: &nbsp; 0</div><div>Current max_locks_per_xact setting: &nbsp; 64</div><div>Maximum data alignment: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8</div><div>Database block size: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8192</div><div>Blocks per segment of large relation: 131072</div><div>WAL block size: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16384</div><div>Bytes per WAL segment: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;16777216</div><div>Maximum length of identifiers: &nbsp; &nbsp; &nbsp; &nbsp;64</div><div>Maximum columns in an index: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;32</div><div>Maximum size of a TOAST chunk: &nbsp; &nbsp; &nbsp; &nbsp;1996</div><div>Date/time type storage: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 64-bit integers</div><div>Float4 argument passing: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;by value</div><div>Float8 argument passing: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;by value</div><div>Data page checksum version: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</div></div><div><br></div><div>查看pg_xlog, 按修改时间排序</div><div><div>ll -rt</div><div>total 1.1G</div><div>-rwx------ 1 postgres postgres 1001 Jan &nbsp;4 15:21 00000018.history</div><div>-rwx------ 1 postgres postgres 1.1K Jan &nbsp;4 15:46 00000019.history</div><div>-rwx------ 1 postgres postgres 1.1K Jan &nbsp;4 16:05 0000001A.history</div><div>-rwx------ 1 postgres postgres 1.2K Jan &nbsp;4 17:06 0000001B.history</div><div>-rwx------ 1 postgres postgres 1.2K Jan &nbsp;5 10:33 0000001C.history</div><div>-rwx------ 1 postgres postgres 1.2K Jan &nbsp;5 10:37 0000001D.history</div><div>-rwx------ 1 postgres postgres 1.3K Jan &nbsp;5 10:41 0000001E.history</div><div>-rwx------ 1 postgres postgres 1.3K Jan &nbsp;5 10:44 0000001F.history</div><div>-rwx------ 1 postgres postgres 1.4K Jan &nbsp;5 16:08 00000020.history</div><div>-rwx------ 1 postgres postgres 1.4K Jan &nbsp;5 16:11 00000021.history</div><div>-rwx------ 1 postgres postgres 1.5K Jan &nbsp;6 16:02 00000022.history</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;6 16:02 000000240000000D0000005D</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;6 16:02 000000240000000D00000049</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;6 16:02 000000240000000D00000083</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;6 16:02 000000240000000D00000081</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;6 16:02 000000240000000D0000004A</div><div>-rwx------ 1 postgres postgres 1.5K Jan &nbsp;7 12:54 00000023.history</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D0000004B</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D00000062</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D00000058</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D0000004D</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D00000060</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D0000005C</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D00000056</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D00000053</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000250000000D0000004D</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D0000005B</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D00000051</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000250000000D0000004A</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D00000057</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D00000054</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000250000000D0000004E</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D00000052</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D00000048</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D0000005E</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D00000055</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D0000005F</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D00000059</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D0000005A</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D0000004F</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:29 000000240000000D0000004E</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000061</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000050</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D0000004C</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000067</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000065</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000064</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D0000007B</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000075</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D0000007C</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000076</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D0000006D</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000072</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D0000006F</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000074</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D0000006B</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000071</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000073</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D0000007A</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000077</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D0000007F</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000078</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000069</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000080</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D0000007E</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000066</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D0000006C</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000063</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000070</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D0000007D</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000068</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D00000079</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:30 000000240000000D0000006E</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:31 000000240000000D0000006A</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:31 000000240000000D00000082</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:34 000000240000000D00000084</div><div>-rwx------ 1 postgres postgres 1.5K Jan &nbsp;7 13:36 00000024.history</div><div>-rw------- 1 postgres postgres 1.6K Jan &nbsp;7 13:37 00000025.history</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:39 000000250000000D0000004B</div><div>-rw------- 1 postgres postgres &nbsp;16M Jan &nbsp;7 13:39 000000250000000D0000004C</div><div>-rw------- 1 postgres postgres &nbsp;316 Jan &nbsp;7 13:39 000000250000000D00000047.00000028.backup</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 15:08 000000250000000D00000048</div><div>drwx------ 2 postgres postgres &nbsp;20K Jan &nbsp;7 15:08 archive_status</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 15:08 000000250000000D00000049</div></div><div><span style="line-height: 28px;"   >检查点对应的文件为000000250000000D00000049, 而这个文件是最后一个被修改的文件, 如果有其他的话, 其他的也要保留.</span></div><div>把其他文件删掉即可.</div><div><div>postgres@db-192-168-173-42-&gt; mkdir test</div><div>postgres@db-192-168-173-42-&gt; mv archive_status/ 000000250000000D00000049 test</div><div>postgres@db-192-168-173-42-&gt; rm -f *</div><div>rm: cannot remove `test': Is a directory</div><div>postgres@db-192-168-173-42-&gt; ll</div><div>total 4.0K</div><div>drwxrwxr-x 3 postgres postgres 4.0K Jan &nbsp;7 15:10 test</div><div>postgres@db-192-168-173-42-&gt; mv test/* ./</div><div>postgres@db-192-168-173-42-&gt; ll</div><div>total 17M</div><div>-rwx------ 1 postgres postgres &nbsp;16M Jan &nbsp;7 15:08 000000250000000D00000049</div><div>drwx------ 2 postgres postgres &nbsp;20K Jan &nbsp;7 15:08 archive_status</div><div>drwxrwxr-x 2 postgres postgres 4.0K Jan &nbsp;7 15:10 test</div><div>启动数据库</div><div>postgres@db-192-168-173-42-&gt; pg_ctl start</div><div>server starting</div><div>postgres@db-192-168-173-42-&gt; LOG: &nbsp;00000: redirecting log output to logging collector process</div><div>HINT: &nbsp;Future log output will appear in directory "pg_log".</div><div>LOCATION: &nbsp;SysLogger_Start, syslogger.c:649</div></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="PostgreSQL cannt startup because filesystem full - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>