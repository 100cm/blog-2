<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">oVirt VM (CentOS) template & clone</h2>
	<h5 id="">2014-08-11 10:55:28&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402014711103531313/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><br></div><div><h2 style="margin: 10px 0px; font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-weight: normal; line-height: 40px; color: rgb(85, 87, 83); text-rendering: optimizelegibility; font-size: 24px; padding-top: 1em;"   ><span id="Using_Templates"   >Using Templates</span></h2><p style="margin-top: 0px; color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >Now that you know how to create a virtual machine, you can save its settings into a template. This template will retain the original virtual machine's configurations, including virtual disk and network interface settings, operating systems and applications. You can use this template to rapidly create replicas of the original virtual machine.</p><h3 style="margin: 10px 0px; font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-weight: normal; line-height: 20px; color: rgb(85, 87, 83); text-rendering: optimizelegibility; font-size: 18px; padding-top: 1em;"   ><span id="Create_a_Fedora_Template"   >Create a Fedora Template</span></h3><p style="margin-top: 0px; color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >To make a Fedora virtual machine template, use the virtual machine you created in Section 4.1.1, “Create a Fedora Virtual Machine” as a basis. Before it can be used, it has to be sealed. This ensures that machine-specific settings are not propagated through the template.</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><span style="font-weight: 600;"   >To prepare a Fedora virtual machine for use as a template</span></p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px;"   ><span style="font-weight: 600;"   >连接到一个已经存在的虚拟机, 需要配置一下, 然后关机才能作为模板使用. 例如touch一个重新配置文件, 删除ssh host key.</span></p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >1. Connect to the Fedora virtual machine to be used as a template. Flag the system for re-configuration by running the following command as root:</p><pre style="padding: 8px 10px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(238, 238, 238); border-top-left-radius: 6px; border-top-right-radius: 6px; border-bottom-right-radius: 6px; border-bottom-left-radius: 6px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; word-break: break-all; word-wrap: break-word; white-space: pre-wrap; border: none; background: rgb(136, 136, 136);"   >   # touch /.unconfigured
</pre><p style="margin-top: 0px; color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >2. Remove ssh host keys. Run:</p><pre style="padding: 8px 10px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(238, 238, 238); border-top-left-radius: 6px; border-top-right-radius: 6px; border-bottom-right-radius: 6px; border-bottom-left-radius: 6px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; word-break: break-all; word-wrap: break-word; white-space: pre-wrap; border: none; background: rgb(136, 136, 136);"   >   # rm -rf /etc/ssh/ssh_host_*
</pre><p style="margin-top: 0px; color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >3. Shut down the virtual machine. Run:</p><pre style="padding: 8px 10px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(238, 238, 238); border-top-left-radius: 6px; border-top-right-radius: 6px; border-bottom-right-radius: 6px; border-bottom-left-radius: 6px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; word-break: break-all; word-wrap: break-word; white-space: pre-wrap; border: none; background: rgb(136, 136, 136);"   >   # poweroff
</pre><p style="margin-top: 0px; color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >4. The virtual machine has now been sealed, and is ready to be used as a template for Linux virtual machines.</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><span style="font-weight: 600;"   >关闭虚拟机后, 创建模板</span></p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><span style="font-weight: 600;"   >To create a template from a Fedora virtual machine</span></p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >1. In the administration portal, click the Virtual Machines tab. Select the sealed Red Hat Enterprise Linux 6 virtual machine. Ensure that it has a status of Down.</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >2. Click Make Template. The New Virtual Machine Template displays.</p><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><div><div style="width: 587px;"   ><div><img title="oVirt VM (CentOS) template  clone - 德哥@Digoal - PostgreSQL research"   alt="oVirt VM (CentOS) template  clone - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img2.ph.126.net/-Un7N-OcKb7fNdHaViGuEw==/6608214416516711447.png"   ></div>&nbsp;<br><div>Figure 15. Make new virtual machine template</div></div></div></div><dl style="margin-bottom: 20px; color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><dd style="line-height: 20px; margin-left: 1.6em; margin-right: 0px;"   >Enter information into the following fields:</dd></dl><dl style="margin-bottom: 20px; color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><dd style="line-height: 20px; margin-left: 1.6em; margin-right: 0px;"   ><ul style="margin-top: 0.3em; margin-bottom: 0px; margin-left: 0px;"   ><li style="line-height: 20px; margin-top: 0px;"   >Name: Name of the new template</li><li style="line-height: 20px; margin-top: 0px;"   >Description: Description of the new template</li><li style="line-height: 20px; margin-top: 0px;"   >Host Cluster: The Host Cluster for the virtual machines using this template.</li><li style="line-height: 20px; margin-top: 0px;"   >Make Private: If you tick this checkbox, the template will only be available to the template's creator and the administrative user. Nobody else can use this template unless they are given permissions by the existing permitted users.</li></ul></dd></dl><p style="margin-top: 0px; color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >3. Click OK. The virtual machine displays a status of "Image Locked" while the template is being created. The template is created and added to the Templates tab. During this time, the action buttons for the template remain disabled. Once created, the action buttons are enabled and the template is ready for use.</p><h3 style="margin: 10px 0px; font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-weight: normal; line-height: 20px; color: rgb(85, 87, 83); text-rendering: optimizelegibility; font-size: 18px; padding-top: 1em;"   ><span id="Clone_a_Red_Hat_Enterprise_Linux_Virtual_Machine"   >Clone a Red Hat Enterprise Linux Virtual Machine</span></h3><p style="margin-top: 0px; color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >In the previous section, you created a Fedora template complete with pre-configured storage, networking and operating system settings. Now, you will use this template to deploy a pre-installed virtual machine.</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><span style="font-weight: 600;"   >To clone a Fedora virtual machine from a template</span></p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><span style="font-weight: 600;"   >新建虚拟机, 选择基于模板.</span></p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >1. Navigate to the Tree pane and click Expand All. Click the VMs icon under the Default cluster. On the Virtual Machines tab, click New Server.</p><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><div><div style="width: 662px;"   ><div><img title="oVirt VM (CentOS) template  clone - 德哥@Digoal - PostgreSQL research"   alt="oVirt VM (CentOS) template  clone - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img0.ph.126.net/n3icd7ATMppCVTshnWUrGA==/6608453010538808202.png"   ></div>&nbsp;<br><div>Figure 16. Create virtual machine based on Linux template</div></div></div></div><p style="margin-top: 0px; color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p><dl style="margin-bottom: 20px; color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><dd style="line-height: 20px; margin-left: 1.6em; margin-right: 0px;"   ><ul style="margin-top: 0.3em; margin-bottom: 0px; margin-left: 0px;"   ><li style="line-height: 20px; margin-top: 0px;"   >On the General tab, select the existing Linux template from the Based on Template list.</li><li style="line-height: 20px; margin-top: 0px;"   >Enter a suitable Name and appropriate Description, then accept the default values inherited from the template in the rest of the fields. You can change them if needed.</li><li style="line-height: 20px; margin-top: 0px;"   >Click the Resource Allocation tab. On the Provisioning field, click the drop down menu and select the Clone option.</li><li style="line-height: 20px; margin-top: 0px;"   >注意使用Clone选项.</li></ul></dd></dl><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><div><div style="width: 574px;"   ><div><img title="oVirt VM (CentOS) template  clone - 德哥@Digoal - PostgreSQL research"   alt="oVirt VM (CentOS) template  clone - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img2.ph.126.net/-GmI9fznYIujyPX9iumWmg==/6597874609170050030.png"   ></div>&nbsp;<br><div>Figure 17. Set the provisioning to Clone</div></div></div></div><p style="margin-top: 0px; color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >2. Retain all other default settings and click OK to create the virtual machine. The virtual machine displays in the Virtual Machines list.</p></div><div><br></div><div>[参考]</div><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Virtualization/3.4/html/Administration_Guide/chap-Templates.html"   >https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Virtualization/3.4/html/Administration_Guide/chap-Templates.html</a></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="oVirt VM (CentOS) template  clone - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>