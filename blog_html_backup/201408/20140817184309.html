<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">MonetDB 1.6 billion(384GB) JOIN 2.4 billion(576GB) 60 columns-random-data wide-table</h2>
	<h5 id="">2014-08-17 18:43:09&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020147178394247/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>前面简单的对比了一下PostgreSQL和MonetDB宽表的导入, 查询, 关联方面的性能.</div><div>有兴趣的朋友可以参考 :&nbsp;</div><div>MonetDB vs PostgreSQL 2, width table with random data</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402014714104326879/"   >http://blog.163.com/digoal@126/blog/static/1638770402014714104326879/</a></div><div>MonetDB bulk load performance &amp; fixed length type performance &amp; JOIN performance</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402014715113449394/"   >http://blog.163.com/digoal@126/blog/static/1638770402014715113449394/</a></div><div>PostgreSQL fixed length wide-table VS MonetDB</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201471593653444/"   >http://blog.163.com/digoal@126/blog/static/163877040201471593653444/</a></div><div>PostgreSQL cstore_fdw column-ORI table VS MonetDB (with fixed-length width table)</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201471691955155/"   >http://blog.163.com/digoal@126/blog/static/163877040201471691955155/</a></div><div>以上测试基于60个字符串以及INT类型宽表的测试, 单表5000万记录(单表约147GB), 最多关联17个表(约2.5TB)的查询.&nbsp;</div><div>我们已经了解到MonetDB适合定长存储, 效率比变长的字符串要高很多.&nbsp;</div><div>接下来将要测试一下更大的表(指单列超过内存大小)的查询和关联查询.&nbsp;</div><div>查询主要测试<span style="line-height: 28px;"   >and和or的查询, 这种查询一般用在标签场景, 例如按条件筛选商品等.</span></div><div><br></div><div>测试表 :&nbsp;</div><div>宽表单表16亿(384GB)和24亿(576GB)的表关联的查询.&nbsp;</div><div>以及窄表单表364亿(单列存储超过内存大小)的查询性能.&nbsp;</div><div><br></div><div>以下为宽表查询的几个测试:&nbsp;</div><div>表的数据量和容量如下 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >sql&gt;select count(*) from bt1;</font></div><div><font size="2"   >+------------+</font></div><div><font size="2"   >| L1 &nbsp; &nbsp; &nbsp; &nbsp; |</font></div><div><font size="2"   >+============+</font></div><div><font size="2"   >| 2400000000 |</font></div><div><font size="2"   >+------------+</font></div><div><font size="2"   >1 tuple (8.203ms)</font></div><div><font size="2"   >sql&gt;select count(*) from bt2;</font></div><div><font size="2"   >+------------+</font></div><div><font size="2"   >| L1 &nbsp; &nbsp; &nbsp; &nbsp; |</font></div><div><font size="2"   >+============+</font></div><div><font size="2"   >| 1600000000 |</font></div><div><font size="2"   >+------------+</font></div><div><font size="2"   >1 tuple (9.380ms)</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >sql&gt;select "schema","table",sum(columnsize)/1024/1024/1024.0||'GB' from storage group by "schema","table" order by sum(columnsize) desc;</font></div><div><div><font size="2"   >+--------+-------------------+-----------+</font></div><div><font size="2"   >| schema | table &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | L2 &nbsp; &nbsp; &nbsp; &nbsp;|</font></div><div><font size="2"   >+========+===================+===========+</font></div><div><font size="2"   >| sys &nbsp; &nbsp;| bt1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 536.441GB |</font></div><div><font size="2"   >| sys &nbsp; &nbsp;| bt2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 357.626GB |</font></div><div><font size="2"   >| sys &nbsp; &nbsp;| bt5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 135.599GB |</font></div><div><font size="2"   >| sys &nbsp; &nbsp;| bt4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 84.750GB &nbsp;|</font></div><div><font size="2"   >| sys &nbsp; &nbsp;| bt3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 50.849GB &nbsp;|</font></div></div><p></p></pre></div><div><div><span style="line-height: 28px;"   ><br></span></div><div><span style="line-height: 28px;"   >and和or的效率差别比较大. or的列越多, 查询越慢.</span></div></div><div><span style="line-height: 28px;"   >and查询, 不够多少个条件, 性能都比较平稳, 因为2个条件就已经可以毙掉所有的结果了.</span></div><div><span style="line-height: 28px;"   >and和or的查询一般用在标签场景, 例如按条件搜索商品等.</span></div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; 48 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (12.9s)</font></div><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; 48 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (5.5s) -- 第二次不需要从磁盘读取.</font></div></div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (12.7s) &nbsp;-- c2列需要从磁盘读取</font></div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (13.3s) &nbsp;<span style="line-height: 28px;"   >-- 不需要把所有的数据载入内存, 因为只需要C1+C2个列的数据就可以得出所有都是false的结论了, 多余的列都不需要判断.</span></font></div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (12.8s)&nbsp;</font></div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (13.7s)&nbsp;</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1 and c6=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (15.3s)</font></div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1 and c6=1 and c7=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   ><span style="line-height: 28px;"   >1 tuple (5.4s)</span><span style="line-height: 28px;"   >&nbsp;</span></font></div></div><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1 and c6=1 and c7=1 and c8=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (16.8s)</font></div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1 and c6=1 and c7=1 and c8=1 and c9=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (17.7s)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1 and c6=1 and c7=1 and c8=1 and c9=1 and c10=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (14.2s)</font></div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1 and c6=1 and c7=1 and c8=1 and c9=1 and c10=1 and c11=1;&nbsp;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (15.1s)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1 and c6=1 and c7=1 and c8=1 and c9=1 and c10=1 and c11=1 and c12=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (17.4s)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1 and c6=1 and c7=1 and c8=1 and c9=1 and c10=1 and c11=1 and c12=1 and c13=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (18.0s)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1 and c6=1 and c7=1 and c8=1 and c9=1 and c10=1 and c11=1 and c12=1 and c13=1 and c14=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (23.1s)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1 and c6=1 and c7=1 and c8=1 and c9=1 and c10=1 and c11=1 and c12=1 and c13=1 and c14=1 and c15=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (20.4s)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1 and c6=1 and c7=1 and c8=1 and c9=1 and c10=1 and c11=1 and c12=1 and c13=1 and c14=1 and c15=1 and c16=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (20.2s)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 and c2=1 and c3=1 and c4=1 and c5=1 and c6=1 and c7=1 and c8=1 and c9=1 and c10=1 and c11=1 and c12=1 and c13=1 and c14=1 and c15=1 and c16=1 and c17=1 and c18=1 and c19=1 and c20=1 and c21=1 and c22=1 and c23=1 and c24=1 and c25=1 and c26=1 and c27=1 and c28=1 and c29=1 and c30=1 and c31=1 and c32=1 and c33=1 and c34=1 and c35=1 and c36=1 and c37=1 and c38=1 and c39=1 and c40=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (15.2s) &nbsp;</font></div></div><p></p></pre></div><div><br></div><div>or的查询因为每列都要判断, 所以在本例and得出为0的情况下, 判断的字段越多, and和or的性能差别就越大.</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 or c2=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp;240 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (49.6s)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 or c2=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp;240 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (17.3s)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from bt1 where c1=1 or c2=1 or c3=1 or c4=1 or c5=1 or c6=1 or c7=1 or c8=1 or c9=1 or c10=1 or c11=1 or c12=1 or c13=1 or c14=1 or c15=1 or c16=1 or c17=1 or c18=1 or c19=1 or c20=1 or c21=1 or c22=1 or c23=1 or c24=1 or c25=1 or c26=1 or c27=1 or c28=1 or c29=1 or c30=1 or c31=1 or c32=1 or c33=1 or c34=1 or c35=1 or c36=1 or c37=1 or c38=1 or c39=1 or c40=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| 2160 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (33m 5s)</font></div></div><p></p></pre></div><div>大表JOIN (536GB JOIN 358GB)</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >sql&gt;select count(bt1.c1) from bt1 join bt2 on (bt1.c1=bt2.c2 and bt1.c2=bt2.c3 and bt1.c3=bt2.c4 and bt1.c5&lt;10000);</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (15m 27s)</font></div><p></p></pre></div><div><br></div><div>接下来是窄表的测试, 用到3个表, 分别存放过百亿的数据.</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >sql&gt;\d bt3</font></div><div><font size="2"   >CREATE TABLE "sys"."bt3" (</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; "id" INTEGER</font></div><div><font size="2"   >);</font></div><div><font size="2"   >sql&gt;</font></div><div><font size="2"   >sql&gt;\d bt4</font></div><div><font size="2"   >CREATE TABLE "sys"."bt4" (</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; "id" INTEGER</font></div><div><font size="2"   >);</font></div><div><font size="2"   >sql&gt;</font></div><div><font size="2"   >sql&gt;\d bt5</font></div><div><font size="2"   >CREATE TABLE "sys"."bt5" (</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; "id" INTEGER</font></div><div><font size="2"   >);</font></div></div><div><font size="2"   ><br></font></div><div><div style="line-height: 28px;"   ><font size="2"   >sql&gt;select * from storage where "table"='bt5';   -- 147GB</font></div><div style="line-height: 28px;"   ><font size="2"   >+--------+-------+--------+------+----------+-------------+-----------+--------------+----------+---------+--------+</font></div><div style="line-height: 28px;"   ><font size="2"   >| schema | table | column | type | location | count &nbsp; &nbsp; &nbsp; | typewidth | columnsize &nbsp; | heapsize | indices | sorted |</font></div><div style="line-height: 28px;"   ><font size="2"   >+========+=======+========+======+==========+=============+===========+==============+==========+=========+========+</font></div><div style="line-height: 28px;"   ><font size="2"   >| sys &nbsp; &nbsp;| bt5 &nbsp; | id &nbsp; &nbsp; | int &nbsp;| 22/2242 &nbsp;| 36400000000 | &nbsp; &nbsp; &nbsp; &nbsp; 4 | 145600000000 | &nbsp; &nbsp; &nbsp; &nbsp;0 | &nbsp; &nbsp; &nbsp; 0 | false &nbsp;|</font></div><div style="line-height: 28px;"   ><font size="2"   >+--------+-------+--------+------+----------+-------------+-----------+--------------+----------+---------+--------+</font></div><div style="line-height: 28px;"   ><font size="2"   >1 tuple (12.695ms)</font></div><div style="line-height: 28px;"   ><font size="2"   >sql&gt;select * from storage where "table"='bt4';   -- 91GB</font></div><div style="line-height: 28px;"   ><font size="2"   >+--------+-------+--------+------+----------+-------------+-----------+-------------+----------+---------+--------+</font></div><div style="line-height: 28px;"   ><font size="2"   >| schema | table | column | type | location | count &nbsp; &nbsp; &nbsp; | typewidth | columnsize &nbsp;| heapsize | indices | sorted |</font></div><div style="line-height: 28px;"   ><font size="2"   >+========+=======+========+======+==========+=============+===========+=============+==========+=========+========+</font></div><div style="line-height: 28px;"   ><font size="2"   >| sys &nbsp; &nbsp;| bt4 &nbsp; | id &nbsp; &nbsp; | int &nbsp;| 41/4115 &nbsp;| 22750000000 | &nbsp; &nbsp; &nbsp; &nbsp; 4 | 91000000000 | &nbsp; &nbsp; &nbsp; &nbsp;0 | &nbsp; &nbsp; &nbsp; 0 | false &nbsp;|</font></div><div style="line-height: 28px;"   ><font size="2"   >+--------+-------+--------+------+----------+-------------+-----------+-------------+----------+---------+--------+</font></div><div style="line-height: 28px;"   ><font size="2"   >1 tuple (5.738ms)</font></div><div style="line-height: 28px;"   ><font size="2"   >sql&gt;select * from storage where "table"='bt3';   -- 56GB</font></div><div style="line-height: 28px;"   ><font size="2"   >+--------+-------+--------+------+-------------+-------------+-----------+-------------+----------+---------+--------+</font></div><div style="line-height: 28px;"   ><font size="2"   >| schema | table | column | type | location &nbsp; &nbsp;| count &nbsp; &nbsp; &nbsp; | typewidth | columnsize &nbsp;| heapsize | indices | sorted |</font></div><div style="line-height: 28px;"   ><font size="2"   >+========+=======+========+======+=============+=============+===========+=============+==========+=========+========+</font></div><div style="line-height: 28px;"   ><font size="2"   >| sys &nbsp; &nbsp;| bt3 &nbsp; | id &nbsp; &nbsp; | int &nbsp;| 02/25/22500 | 13650000000 | &nbsp; &nbsp; &nbsp; &nbsp; 4 | 54600000000 | &nbsp; &nbsp; &nbsp; &nbsp;0 | &nbsp; &nbsp; &nbsp; 0 | false &nbsp;|</font></div><div style="line-height: 28px;"   ><font size="2"   >+--------+-------+--------+------+-------------+-------------+-----------+-------------+----------+---------+--------+</font></div><div style="line-height: 28px;"   ><font size="2"   >1 tuple (6.381ms)</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >sql&gt;select count(*) from bt3;</font></div><div><font size="2"   >+-------------+</font></div><div><font size="2"   >| L1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</font></div><div><font size="2"   >+=============+</font></div><div><font size="2"   >| 13650000000 |</font></div><div><font size="2"   >+-------------+</font></div><div><font size="2"   >1 tuple (56.279ms)</font></div><div><font size="2"   >sql&gt;select count(*) from bt4;</font></div><div><font size="2"   >+-------------+</font></div><div><font size="2"   >| L1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</font></div><div><font size="2"   >+=============+</font></div><div><font size="2"   >| 22750000000 |</font></div><div><font size="2"   >+-------------+</font></div><div><font size="2"   >1 tuple (52.546ms)</font></div><div><font size="2"   >sql&gt;select count(*) from bt5;</font></div><div><font size="2"   >+-------------+</font></div><div><font size="2"   >| L1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</font></div><div><font size="2"   >+=============+</font></div><div><font size="2"   >| 36400000000 |</font></div><div><font size="2"   >+-------------+</font></div><div><font size="2"   >1 tuple (55.480ms)</font></div></div><p></p></pre></div><div><span style="line-height: 28px;"   >364亿插入性能 :&nbsp;</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >sql&gt;insert into bt5 select * from bt4 union all select * from bt3;</font></div><div><font size="2"   >36400000000 affected row (17m 54s)</font></div><p></p></pre></div><div>查询性能</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >sql&gt;select count(*) from bt3 where id=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp;273 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (50.3s)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from bt5 where id=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp;728 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (5m 47s)</font></div></div><p></p></pre></div><div><br></div><div>关联性能 (147GB JOIN 537GB)</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >sql&gt;select count(bt5.id) from bt5 join bt1 on (bt5.id=bt1.c2 and bt5.id=bt1.c3 and bt5.id&lt;100) ;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (43m 25s)</font></div><p></p></pre></div><div><br></div>[参考]<wbr><div><div style="line-height: 28px;"   >1. MonetDB vs PostgreSQL 2, width table with random data</div><div style="line-height: 28px;"   ><a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402014714104326879/"   >http://blog.163.com/digoal@126/blog/static/1638770402014714104326879/</a></div><div style="line-height: 28px;"   >2. MonetDB bulk load performance &amp; fixed length type performance &amp; JOIN performance</div><div style="line-height: 28px;"   ><a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402014715113449394/"   >http://blog.163.com/digoal@126/blog/static/1638770402014715113449394/</a></div><div style="line-height: 28px;"   >3. PostgreSQL fixed length wide-table VS MonetDB</div><div style="line-height: 28px;"   ><a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201471593653444/"   >http://blog.163.com/digoal@126/blog/static/163877040201471593653444/</a></div><div style="line-height: 28px;"   >4. PostgreSQL cstore_fdw column-ORI table VS MonetDB (with fixed-length width table)</div><div style="line-height: 28px;"   ><a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201471691955155/"   >http://blog.163.com/digoal@126/blog/static/163877040201471691955155/</a></div></div><div style="line-height: 28px;"   ><br></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="MonetDB 1.6 billion(384GB) JOIN 2.4 billion(576GB) 60 columns-random-data wide-table - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>