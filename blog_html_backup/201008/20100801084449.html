<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">using smartctl , hdparm command get hardisk info in linux environment</h2>
	<h5 id="">2010-08-01 8:44:49&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020107184449692/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;">昨天在京东上买了个显示器和一个WD的硬盘。<div>来简单的检测一下硬盘的状态，</div><div>首先要用到的是hdparm，这个命令的作用是设置或获取硬盘参数。</div><div><div>hdparm &nbsp;provides &nbsp;a &nbsp;command &nbsp;line &nbsp;interface &nbsp;to various hard disk ioctls supported by the stock Linux ATA/IDE&nbsp;device driver subsystem. &nbsp;</div><div>Some options may work correctly only with the latest kernels. &nbsp;For best results, compile hdparm with the include files from the latest kernel source code.</div></div><div>这里要用到的是如下参数：</div><div><div>&nbsp;&nbsp; &nbsp;-i &nbsp; &nbsp; Display the identification info that was obtained from the drive at boot time, if available. &nbsp;This is &nbsp;a</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;feature &nbsp;of &nbsp;modern IDE drives, and may not be supported by older devices. &nbsp;The data returned may or may</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;not be current, depending on activity since booting the system. &nbsp;However, the &nbsp;current &nbsp;multiple &nbsp;sector</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mode &nbsp;count is always shown. &nbsp;For a more detailed interpretation of the identification info, refer to AT</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Attachment Interface for Disk Drives (ANSI ASC X3T9.2 working draft, revision 4a, April 19/93).</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; -I &nbsp; &nbsp; Request identification info directly from the drive, which is displayed in a new &nbsp;expanded &nbsp;format &nbsp;with</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;considerably more detail than with the older -i flag</div></div><div><div>[root@digoal win_c]# hdparm -I /dev/sda</div><div><br></div><div>/dev/sda:</div><div><br></div><div>ATA device, with non-removable media</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Model Number: &nbsp; &nbsp; &nbsp; WDC WD5000AADS-00S9B0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Serial Number: &nbsp; &nbsp; &nbsp;WD-WCAV94074040</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Firmware Revision: &nbsp;01.00A01</div><div>Transport: Serial, SATA 1.0a, SATA II Extensions, SATA Rev 2.5</div><div>Standards:</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Supported: 8 7 6 5&nbsp;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Likely used: 8</div><div>Configuration:</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Logical &nbsp; &nbsp; &nbsp; &nbsp; max &nbsp; &nbsp; current</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;cylinders &nbsp; &nbsp; &nbsp; 16383 &nbsp; 16383</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;heads &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16 &nbsp; &nbsp; &nbsp;16</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;sectors/track &nbsp; 63 &nbsp; &nbsp; &nbsp;63</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;--</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;CHS current addressable sectors: &nbsp; 16514064</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;LBA &nbsp; &nbsp;user addressable sectors: &nbsp;268435455</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;LBA48 &nbsp;user addressable sectors: &nbsp;976773168</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;device size with M = 1024*1024: &nbsp; &nbsp; &nbsp;476940 MBytes</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;device size with M = 1000*1000: &nbsp; &nbsp; &nbsp;500107 MBytes (500 GB)</div><div>Capabilities:</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;LBA, IORDY(can be disabled)</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Queue depth: 32</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Standby timer values: spec'd by Standard, with device specific minimum</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;R/W multiple sector transfer: Max = 16 &nbsp;Current = 16</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Recommended acoustic management value: 128, current value: 254</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;DMA: mdma0 mdma1 mdma2 udma0 udma1 udma2 udma3 udma4 udma5 *udma6&nbsp;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Cycle time: min=120ns recommended=120ns</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;PIO: pio0 pio1 pio2 pio3 pio4&nbsp;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Cycle time: no flow control=120ns &nbsp;IORDY flow control=120ns</div><div>Commands/features:</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Enabled Supported:</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;SMART feature set</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Security Mode feature set</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;Power Management feature set</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;Write cache</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;Look-ahead</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;Host Protected Area feature set</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;WRITE_BUFFER command</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;READ_BUFFER command</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;NOP cmd</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;DOWNLOAD_MICROCODE</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Power-Up In Standby feature set</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;SET_FEATURES required to spinup after power up</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SET_MAX security extension</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Automatic Acoustic Management feature set</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;48-bit Address feature set</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;Device Configuration Overlay feature set</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;Mandatory FLUSH_CACHE</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;FLUSH_CACHE_EXT</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;SMART error logging</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;SMART self-test</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;General Purpose Logging feature set</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;64-bit World wide name</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;WRITE_UNCORRECTABLE command</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;{READ,WRITE}_DMA_EXT_GPL commands</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;Segmented DOWNLOAD_MICROCODE</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;SATA-I signaling speed (1.5Gb/s)</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;SATA-II signaling speed (3.0Gb/s)</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;Native Command Queueing (NCQ)</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;Host-initiated interface power management</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;Phy event counters</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;unknown 76[12]</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DMA Setup Auto-Activate optimization</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp;Software settings preservation</div><div>Security:&nbsp;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Master password revision code = 65534</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;supported</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;not &nbsp; &nbsp; enabled</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;not &nbsp; &nbsp; locked</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;frozen</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;not &nbsp; &nbsp; expired: security count</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;supported: enhanced erase</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;110min for SECURITY ERASE UNIT. 110min for ENHANCED SECURITY ERASE UNIT.</div><div>Checksum: correct</div><div>[root@digoal win_c]# hdparm -i /dev/sda</div><div><br></div><div>/dev/sda:</div><div><br></div><div>&nbsp;Model=WDC WD5000AADS-00S9B0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; , FwRev=01.00A01, SerialNo= &nbsp; &nbsp; WD-WCAV94074040</div><div>&nbsp;Config={ HardSect NotMFM HdSw&gt;15uSec SpinMotCtl Fixed DTR&gt;5Mbs FmtGapReq }</div><div>&nbsp;RawCHS=16383/16/63, TrkSize=0, SectSize=0, ECCbytes=50</div><div>&nbsp;BuffType=unknown, BuffSize=32767kB, MaxMultSect=16, MultSect=?16?</div><div>&nbsp;CurCHS=16383/16/63, CurSects=16514064, LBA=yes, LBAsects=268435455</div><div>&nbsp;IORDY=on/off, tPIO={min:120,w/IORDY:120}, tDMA={min:120,rec:120}</div><div>&nbsp;PIO modes: &nbsp;pio0 pio3 pio4&nbsp;</div><div>&nbsp;DMA modes: &nbsp;mdma0 mdma1 mdma2&nbsp;</div><div>&nbsp;UDMA modes: udma0 udma1 udma2&nbsp;</div><div>&nbsp;AdvancedPM=no WriteCache=enabled</div><div>&nbsp;Drive conforms to: Unspecified: &nbsp;ATA/ATAPI-1 ATA/ATAPI-2 ATA/ATAPI-3 ATA/ATAPI-4 ATA/ATAPI-5 ATA/ATAPI-6 ATA/ATAPI-7</div><div><br></div><div>&nbsp;* signifies the current active mode</div></div><div><br></div><div>另外一个要用到的工具是smartctl</div><div><div>DESCRIPTION</div><div>&nbsp;&nbsp; &nbsp; &nbsp; smartctl &nbsp;controls &nbsp;the Self-Monitoring, Analysis and Reporting Technology (SMART) system built into many ATA-3</div><div>&nbsp;&nbsp; &nbsp; &nbsp; and later ATA, IDE and SCSI-3 hard drives. The purpose of SMART is to monitor the reliability of the hard drive</div><div>&nbsp;&nbsp; &nbsp; &nbsp; and &nbsp;predict drive failures, and to carry out different types of drive self-tests. &nbsp;This version of smartctl is</div><div>&nbsp;&nbsp; &nbsp; &nbsp; compatible with ATA/ATAPI-7 and earlier standards (see REFERENCES below)</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; smartctl is a command line utility designed to perform SMART tasks such as printing &nbsp;the &nbsp;SMART &nbsp;self-test &nbsp;and</div><div>&nbsp;&nbsp; &nbsp; &nbsp; error logs, enabling and disabling SMART automatic testing, and initiating device self-tests. Note: if the user</div><div>&nbsp;&nbsp; &nbsp; &nbsp; issues a SMART command that is (apparently) not implemented by the device, smartctl will print a &nbsp;warning &nbsp;mes-</div><div>&nbsp;&nbsp; &nbsp; &nbsp; sage &nbsp;but &nbsp;issue the command anyway (see the -T, --tolerance option below). &nbsp;This should not cause problems: on</div><div>&nbsp;&nbsp; &nbsp; &nbsp; most devices, unimplemented SMART commands issued to a drive are ignored and/or return an error.</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; smartctl also provides support for polling TapeAlert messages from SCSI tape drives and changers.</div></div><div><br></div><div><div>[root@digoal win_c]# smartctl -a /dev/sda</div><div>smartctl version 5.38 [x86_64-redhat-linux-gnu] Copyright (C) 2002-8 Bruce Allen</div><div>Home page is http://smartmontools.sourceforge.net/</div><div><br></div><div>=== START OF INFORMATION SECTION ===</div><div>Device Model: &nbsp; &nbsp; WDC WD5000AADS-00S9B0</div><div>Serial Number: &nbsp; &nbsp;WD-WCAV94074040</div><div>Firmware Version: 01.00A01</div><div>User Capacity: &nbsp; &nbsp;500,107,862,016 bytes</div><div>Device is: &nbsp; &nbsp; &nbsp; &nbsp;Not in smartctl database [for details use: -P showall]</div><div>ATA Version is: &nbsp; 8</div><div>ATA Standard is: &nbsp;Exact ATA specification draft version not indicated</div><div>Local Time is: &nbsp; &nbsp;Sun Aug &nbsp;1 08:50:35 2010 CST</div><div>SMART support is: Available - device has SMART capability.</div><div>SMART support is: Enabled</div><div><br></div><div>=== START OF READ SMART DATA SECTION ===</div><div>SMART overall-health self-assessment test result: PASSED</div><div><br></div><div>General SMART Values:</div><div>Offline data collection status: &nbsp;(0x80) Offline data collection activity</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;was never started.</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Auto Offline Data Collection: Enabled.</div><div>Self-test execution status: &nbsp; &nbsp; &nbsp;( &nbsp; 0) The previous self-test routine completed</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;without error or no self-test has ever&nbsp;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;been run.</div><div>Total time to complete Offline&nbsp;</div><div>data collection: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (10800) seconds.</div><div>Offline data collection</div><div>capabilities: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(0x7b) SMART execute Offline immediate.</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Auto Offline data collection on/off support.</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Suspend Offline collection upon new</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;command.</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Offline surface scan supported.</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Self-test supported.</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Conveyance Self-test supported.</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Selective Self-test supported.</div><div>SMART capabilities: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(0x0003) Saves SMART data before entering</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;power-saving mode.</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Supports SMART auto save timer.</div><div>Error logging capability: &nbsp; &nbsp; &nbsp; &nbsp;(0x01) Error logging supported.</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;General Purpose Logging supported.</div><div>Short self-test routine&nbsp;</div><div>recommended polling time: &nbsp; &nbsp; &nbsp; &nbsp;( &nbsp; 2) minutes.</div><div>Extended self-test routine</div><div>recommended polling time: &nbsp; &nbsp; &nbsp; &nbsp;( 127) minutes.</div><div>Conveyance self-test routine</div><div>recommended polling time: &nbsp; &nbsp; &nbsp; &nbsp;( &nbsp; 5) minutes.</div><div>SCT capabilities: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(0x303f) SCT Status supported.</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SCT Feature Control supported.</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SCT Data Table supported.</div><div><br></div><div>SMART Attributes Data Structure revision number: 16</div><div>Vendor Specific SMART Attributes with Thresholds:</div><div>ID# ATTRIBUTE_NAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FLAG &nbsp; &nbsp; VALUE WORST THRESH TYPE &nbsp; &nbsp; &nbsp;UPDATED &nbsp;WHEN_FAILED RAW_VALUE</div><div>&nbsp;&nbsp;1 Raw_Read_Error_Rate &nbsp; &nbsp; 0x002f &nbsp; 100 &nbsp; 253 &nbsp; 051 &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>&nbsp;&nbsp;3 Spin_Up_Time &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x0027 &nbsp; 145 &nbsp; 145 &nbsp; 021 &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 3716</div><div>&nbsp;&nbsp;4 Start_Stop_Count &nbsp; &nbsp; &nbsp; &nbsp;0x0032 &nbsp; 100 &nbsp; 100 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 10</div><div>&nbsp;&nbsp;5 Reallocated_Sector_Ct &nbsp; 0x0033 &nbsp; 200 &nbsp; 200 &nbsp; 140 &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>&nbsp;&nbsp;7 Seek_Error_Rate &nbsp; &nbsp; &nbsp; &nbsp; 0x002e &nbsp; 100 &nbsp; 253 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>&nbsp;&nbsp;9 Power_On_Hours &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x0032 &nbsp; 100 &nbsp; 100 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>&nbsp;10 Spin_Retry_Count &nbsp; &nbsp; &nbsp; &nbsp;0x0032 &nbsp; 100 &nbsp; 253 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>&nbsp;11 Calibration_Retry_Count 0x0032 &nbsp; 100 &nbsp; 253 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>&nbsp;12 Power_Cycle_Count &nbsp; &nbsp; &nbsp; 0x0032 &nbsp; 100 &nbsp; 100 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 8</div><div>192 Power-Off_Retract_Count 0x0032 &nbsp; 200 &nbsp; 200 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 7</div><div>193 Load_Cycle_Count &nbsp; &nbsp; &nbsp; &nbsp;0x0032 &nbsp; 200 &nbsp; 200 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 9</div><div>194 Temperature_Celsius &nbsp; &nbsp; 0x0022 &nbsp; 102 &nbsp; 102 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 41</div><div>196 Reallocated_Event_Count 0x0032 &nbsp; 200 &nbsp; 200 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>197 Current_Pending_Sector &nbsp;0x0032 &nbsp; 200 &nbsp; 200 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>198 Offline_Uncorrectable &nbsp; 0x0030 &nbsp; 100 &nbsp; 253 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; 0</div><div>199 UDMA_CRC_Error_Count &nbsp; &nbsp;0x0032 &nbsp; 200 &nbsp; 253 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>200 Multi_Zone_Error_Rate &nbsp; 0x0008 &nbsp; 100 &nbsp; 253 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; 0</div><div><br></div><div>SMART Error Log Version: 1</div><div>No Errors Logged</div><div><br></div><div>SMART Self-test log structure revision number 1</div><div>No self-tests have been logged. &nbsp;[To run self-tests, use: smartctl -t]</div><div><br></div><div><br></div><div>SMART Selective self-test log data structure revision number 1</div><div>&nbsp;SPAN &nbsp;MIN_LBA &nbsp;MAX_LBA &nbsp;CURRENT_TEST_STATUS</div><div>&nbsp;&nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp;Not_testing</div><div>&nbsp;&nbsp; &nbsp;2 &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp;Not_testing</div><div>&nbsp;&nbsp; &nbsp;3 &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp;Not_testing</div><div>&nbsp;&nbsp; &nbsp;4 &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp;Not_testing</div><div>&nbsp;&nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp;Not_testing</div><div>Selective self-test flags (0x0):</div><div>&nbsp;&nbsp;After scanning selected spans, do NOT read-scan remainder of disk.</div><div>If Selective self-test is pending on power-up, resume after 0 minute delay.</div></div><div><br></div><div>下面是另外一位兄弟写的smartctl的用法，更加详细。</div><div><div>1.1 什么是Smartmontools？</div><div><br></div><div>Smartmontools是一种硬盘检测工具，通过控制和管理硬盘的SMART（Self Monitoring Analysis and Reporting Technology，自动检测分析及报告技术）技术来实现的，SMART技术可以对硬盘的磁头单元、盘片电机驱动系统、硬盘内部电路以及盘片表面介质材料等进行监测，当SMART监测并分析出硬盘可能出现问题时会及时向用户报警以避免计算机数据受损失。SMART技术必须在主板支持的前提下才能发生作用，而且 SMART技术也不能保证能预报所有可能发生的硬盘故障。SMART(SFF-8035i) 是硬盘生产商们建立的一个工业标准，这个标准就是在硬盘上保存一个跟执行情况，可靠程度，读找错误率等属性的表格。所有属性都有一个1byte(大小范围1-253)的标准化值，还包含另一个1byte的关键阶段值，如果属性表格内某个数据接近小于或达到关键阶段值，表明硬盘工作不正常了。</div><div><br></div><div>2.1 Smartmontools的使用</div><div><br></div><div>1、启动监控进程</div><div><br></div><div># /etc/init.d/smartd start</div><div>启动 smartd： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[ &nbsp;确定 &nbsp;]</div><div>2、检查硬盘是否支持SMART 1993年以后出厂的硬盘基本上都支持SMART技术，使用如下命令可以来查看：</div><div><br></div><div># smartctl -i /dev/hdb</div><div>smartctl version 5.33 [i686-turbo-linux-gnu] Copyright (C) 2002-4 Bruce Allen</div><div>Home page is http://smartmontools.sourceforge.net/</div><div><br></div><div>=== START OF INFORMATION SECTION ===</div><div>Device Model: &nbsp; &nbsp; ST3160212A</div><div>Serial Number: &nbsp; &nbsp;5LS2EDKN</div><div>Firmware Version: 3.AAE</div><div>User Capacity: &nbsp; &nbsp;160,041,885,696 bytes</div><div>Device is: &nbsp; &nbsp; &nbsp; &nbsp;Not in smartctl database [for details use: -P showall]</div><div>ATA Version is: &nbsp; 7</div><div>ATA Standard is: &nbsp;Exact ATA specification draft version not indicated</div><div>Local Time is: &nbsp; &nbsp;Mon Sep 17 02:13:37 2007 CST</div><div>SMART support is: Available - device has SMART capability.</div><div>SMART support is: Enabled</div><div>在上面的信息可以看到，该硬盘是支持SMART技术，且当前是开启的。如果SMART support is: Disabled表示SMART未启用，执行如下命令，启动SMART：</div><div><br></div><div>smartctl --smart=on --offlineauto=on --saveauto=on /dev/hdb</div><div>3、检查硬盘健康状态</div><div><br></div><div># smartctl -H /dev/hdb</div><div>smartctl version 5.33 [i686-turbo-linux-gnu] Copyright (C) 2002-4 Bruce Allen</div><div>Home page is http://smartmontools.sourceforge.net/</div><div><br></div><div>=== START OF READ SMART DATA SECTION ===</div><div>SMART overall-health self-assessment test result: PASSED</div><div>请注意result后边的结果：PASSED，这表示硬盘健康状态良好，如果这里显示Failure，那么最好立刻给服务器更换硬盘。SMART只能报告磁盘已经不再健康，但是报警后还能继续运行多久是不确定的，通常，SMART报警参数是有预留的，磁盘报警后，不会当场坏掉，一般能坚持一段时间，有的硬盘SMART报警后还继续跑了好几年，有的硬盘SMART报错后几天就坏了，千万不要存在侥幸心理。执行如下命令可以看到详细的参数：</div><div><br></div><div># smartctl -A /dev/hdb</div><div>smartctl version 5.33 [i686-turbo-linux-gnu] Copyright (C) 2002-4 Bruce Allen</div><div>Home page is http://smartmontools.sourceforge.net/</div><div><br></div><div>=== START OF READ SMART DATA SECTION ===</div><div>SMART Attributes Data Structure revision number: 10</div><div>Vendor Specific SMART Attributes with Thresholds:</div><div>ID# ATTRIBUTE_NAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FLAG &nbsp; &nbsp; VALUE WORST THRESH TYPE &nbsp; &nbsp; &nbsp;UPDATED &nbsp;WHEN_FAILED RAW_VALUE</div><div>&nbsp;&nbsp;1 Raw_Read_Error_Rate &nbsp; &nbsp; 0x000f &nbsp; 114 &nbsp; 100 &nbsp; 006 &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 81812244</div><div>&nbsp;&nbsp;3 Spin_Up_Time &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x0003 &nbsp; 100 &nbsp; 099 &nbsp; 000 &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>&nbsp;&nbsp;4 Start_Stop_Count &nbsp; &nbsp; &nbsp; &nbsp;0x0032 &nbsp; 100 &nbsp; 100 &nbsp; 020 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 257</div><div>&nbsp;&nbsp;5 Reallocated_Sector_Ct &nbsp; 0x0033 &nbsp; 100 &nbsp; 100 &nbsp; 036 &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>&nbsp;&nbsp;7 Seek_Error_Rate &nbsp; &nbsp; &nbsp; &nbsp; 0x000f &nbsp; 078 &nbsp; 060 &nbsp; 030 &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 64781708</div><div>&nbsp;&nbsp;9 Power_On_Hours &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x0032 &nbsp; 096 &nbsp; 096 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 4365</div><div>&nbsp;10 Spin_Retry_Count &nbsp; &nbsp; &nbsp; &nbsp;0x0013 &nbsp; 100 &nbsp; 100 &nbsp; 097 &nbsp; &nbsp;Pre-fail &nbsp;Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>&nbsp;12 Power_Cycle_Count &nbsp; &nbsp; &nbsp; 0x0032 &nbsp; 100 &nbsp; 100 &nbsp; 020 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 276</div><div>187 Unknown_Attribute &nbsp; &nbsp; &nbsp; 0x0032 &nbsp; 100 &nbsp; 100 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>189 Unknown_Attribute &nbsp; &nbsp; &nbsp; 0x003a &nbsp; 100 &nbsp; 100 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>190 Unknown_Attribute &nbsp; &nbsp; &nbsp; 0x0022 &nbsp; 058 &nbsp; 053 &nbsp; 045 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 773324842</div><div>194 Temperature_Celsius &nbsp; &nbsp; 0x0022 &nbsp; 042 &nbsp; 047 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 42 (Lifetime Min/Max 0/21)</div><div>195 Hardware_ECC_Recovered &nbsp;0x001a &nbsp; 052 &nbsp; 048 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 1562815</div><div>197 Current_Pending_Sector &nbsp;0x0012 &nbsp; 100 &nbsp; 100 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>198 Offline_Uncorrectable &nbsp; 0x0010 &nbsp; 100 &nbsp; 100 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; 0</div><div>199 UDMA_CRC_Error_Count &nbsp; &nbsp;0x003e &nbsp; 200 &nbsp; 200 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>200 Multi_Zone_Error_Rate &nbsp; 0x0000 &nbsp; 100 &nbsp; 253 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Offline &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; 0</div><div>202 TA_Increase_Count &nbsp; &nbsp; &nbsp; 0x0032 &nbsp; 100 &nbsp; 253 &nbsp; 000 &nbsp; &nbsp;Old_age &nbsp; Always &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; 0</div><div>FLAG是标记，标准数值(VALUE)应当小于或等於关键值(THRESH)。WHEN_FAILED 代表错误信息，上面显示的WHEN_FAILED纵行是空行，说明硬盘没有故障。如果WHEN_FAILED显示数字，表明硬盘磁道可能有比较大的坏道。</div><div><br></div><div>4、对硬盘进行检测 手工对硬盘进行测试的方法有以下四种：</div><div><br></div><div>smartctl -t short &lt;device&gt; &nbsp; &nbsp;后台检测硬盘，消耗时间短</div><div>smartctl -t long &lt;device&gt; &nbsp; &nbsp; &nbsp;后台检测硬盘，消耗时间长</div><div>smartctl -C -t short &lt;device&gt; 前台检测硬盘，消耗时间短</div><div>smartctl -C -t long &lt;device&gt; &nbsp;前台检测硬盘，消耗时间长</div><div>例如，在后台对硬盘进行详细的检查，命令如下：</div><div><br></div><div># smartctl -t long /dev/hdb</div><div>smartctl version 5.33 [i686-turbo-linux-gnu] Copyright (C) 2002-4 Bruce Allen</div><div>Home page is http://smartmontools.sourceforge.net/</div><div><br></div><div>=== START OF OFFLINE IMMEDIATE AND SELF-TEST SECTION ===</div><div>Sending command: "Execute SMART Extended self-test routine immediately in off-line mode".</div><div>Drive command "Execute SMART Extended self-test routine immediately in off-line mode" successful.</div><div>Testing has begun.</div><div>Please wait 54 minutes for test to complete.</div><div>Test will complete after Mon Sep 17 03:53:32 2007</div><div><br></div><div>Use smartctl -X to abort test.</div><div>上面的信息显示54分钟后将完成检查，同时可以使用 smartctl -X 终止检查。终止硬盘检查命令的使用方法是：</div><div><br></div><div># smartctl -X /dev/hdb</div><div>smartctl version 5.33 [i686-turbo-linux-gnu] Copyright (C) 2002-4 Bruce Allen</div><div>Home page is http://smartmontools.sourceforge.net/</div><div><br></div><div>=== START OF OFFLINE IMMEDIATE AND SELF-TEST SECTION ===</div><div>Sending command: "Abort SMART off-line mode self-test routine".</div><div>Self-testing aborted!</div><div>5、查看硬盘日志 使用“smartctl -l logtype &lt;device&gt;”可以查看硬盘的日志，日志又分为多种类型，如selftest、error等等。例如查看硬盘检测的日志，如下：</div><div><br></div><div># smartctl -l selftest /dev/hdb</div><div>smartctl version 5.33 [i686-turbo-linux-gnu] Copyright (C) 2002-4 Bruce Allen</div><div>Home page is http://smartmontools.sourceforge.net/</div><div><br></div><div>=== START OF READ SMART DATA SECTION ===</div><div>SMART Self-test log structure revision number 1</div><div>Num &nbsp;Test_Description &nbsp; &nbsp;Status &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Remaining &nbsp;LifeTime(hours) &nbsp;LBA_of_first_error</div><div># 1 &nbsp;Extended offline &nbsp; &nbsp;Aborted by host &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 90% &nbsp; &nbsp; &nbsp;4365 &nbsp; &nbsp; &nbsp; &nbsp; -</div><div># 2 &nbsp;Extended offline &nbsp; &nbsp;Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp;4247 &nbsp; &nbsp; &nbsp; &nbsp; -</div><div># 3 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Aborted by host &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 30% &nbsp; &nbsp; &nbsp;4246 &nbsp; &nbsp; &nbsp; &nbsp; -</div><div># 4 &nbsp;Short offline &nbsp; &nbsp; &nbsp; Aborted by host &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10% &nbsp; &nbsp; &nbsp;4246 &nbsp; &nbsp; &nbsp; &nbsp; -</div><div># 5 &nbsp;Extended offline &nbsp; &nbsp;Completed without error &nbsp; &nbsp; &nbsp; 00% &nbsp; &nbsp; &nbsp;4229 &nbsp; &nbsp; &nbsp; &nbsp; -</div><div>查看硬盘错误日志：</div><div><br></div><div># smartctl -l error /dev/hdb</div><div>smartctl version 5.33 [i686-turbo-linux-gnu] Copyright (C) 2002-4 Bruce Allen</div><div>Home page is http://smartmontools.sourceforge.net/</div><div><br></div><div>=== START OF READ SMART DATA SECTION ===</div><div>SMART Error Log Version: 1</div><div>No Errors Logged</div></div></div>
	</div>
</div>
</body>
</html>