<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL Inspection Template DOC</h2>
	<h5 id="">2014-03-05 14:38:42&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402014252816497/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>作为一名数据库管理员, 周期性的对管理的数据库进行健康检查是很有必要的.</div><div>那么PostgreSQL数据库要检查一些什么东西呢?</div><div>本文提供了一份PostgreSQL数据库健康检查的模板, 包括每项检查的结果建议项目, 大家可以参阅一下.</div><div>WORD文档见附件.</div><div>把要检查的内容做成一个脚本来输出会省不少时间.</div><div><br></div><div>2014-03-13 新增巡检项, 不体现在网页中, 请查看附件 :&nbsp;</div><div>1. 用户是否存在明文密码, 用户密码过期时间, 查看pg_shadow.</div><div>2. disable的触发器, 查看pg_trigger.</div><div>3. enable的触发器, 查看pg_trigger.</div><div>4. 用户,数据库级别的配置, 查看pg_db_role_setting.</div><div>5. 数据库权限以及表空间的权限, 查看pg_database和pg_tablespace</div><div>6. 表空间对应的文件系统的剩余空间,</div><div>7. 表空间对应的块设备的IO利用率. (sar -d)</div><div>8. 未使用绑定变量的SQL检查, 防止SQL注入, 建议全部使用绑定变量. 检查依据exec_simple_query函数均未使用绑定变量.</div><div><br></div><div>2014-03-21 修订</div><div><div>1. 系统硬件信息收集 cpu, mem , 大页</div><div>2. 大表:连接到各个库进行查询大于10GB的表以及年龄, 加个年龄限制10亿</div><div>3. 索引数超过4的表, 加个统计信息update,insert,delete计数限制.</div><div>4. 长事务, 加上事务时长显示.</div><div>5. 备库和主库配置文件的md5值对比.</div><div>6. 垃圾数据, 加一个行数限制.</div><div>7. 逻辑错误和建议的内容, 添加报错对应的SQL语句.</div></div><div><br></div><div>健康检查和类似pg_statsinfo这样的插件类似, 其实这些插件也可以来做同样的事情, 只是它们还不够完美, 有些数据并没有输出.&nbsp;</div><div>例如数据库的年龄, 未使用的索引, 序列等.</div><div>健康检查和日常的监控程序也不一样, 日常监控有些东西也不方便做, 健康检查可以认为是一个比较全面的数据库体检.</div><div>参看 :&nbsp;</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402014251114135/"   >http://blog.163.com/digoal@126/blog/static/1638770402014251114135/</a></div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201425020982/"   >http://blog.163.com/digoal@126/blog/static/163877040201425020982/</a></div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201412763135184/"   >http://blog.163.com/digoal@126/blog/static/163877040201412763135184/</a></div><div><br></div><div><br></div><div><span style="font-size: 20pt;"   >PostgreSQL </span><span lang="ZH-CN"   style="font-size: 20pt; font-family: 宋体;"   >数据库巡检报告模板</span></div><div>

<p align="right"   style="text-align:right;"   ><span style="line-height:107%;font-size: 10.0pt;"   >ver 0.1</span></p>

<p align="right"   style="text-align:right;"   ><span style="line-height:107%;font-size: 10.0pt;"   >digoal.zhou</span></p>

<p><span style="line-height:107%;font-size:10.0pt;"   >&nbsp;</span></p>

<h1><br></h1></div></div>
	</div>
</div>
</body>
</html>