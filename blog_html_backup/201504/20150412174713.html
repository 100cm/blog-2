<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">使用MASS库 ginv() 计算任意矩阵的广义逆 (Moore-Penrose)</h2>
	<h5 id="">2015-04-12 17:47:13&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402015312111655238/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>前面讲了矩阵的逆, 例如矩阵A的逆用<span style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >A</span><font size="2"   style="line-height: 22.75px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >ˉ</font><font style="line-height: 42px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   size="5"   >1</font><font style="line-height: 42px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   size="3"   >表示, 使用solve(A)可与计算A的逆.</font></div><div><font style="line-height: 42px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   size="3"   >并且满足</font><span style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >A %*%&nbsp;</span><font size="2"   style="line-height: 22.75px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >Aˉ</font><font size="5"   style="line-height: 42px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >1&nbsp;</font><span style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >==&nbsp;</span><font size="2"   style="line-height: 22.75px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >Aˉ</font><font size="5"   style="line-height: 42px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >1</font><font style="line-height: 42px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >&nbsp;%*% A</font><font style="line-height: 42px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >&nbsp;&nbsp;== &nbsp;</font><span style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >diag(min(ncol(A), nrow(A))) &nbsp;== &nbsp;</span><span style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >Identity matrix</span></div><div><span style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >如下 :&nbsp;</span></div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402015312105227107/"   >http://blog.163.com/digoal@126/blog/static/1638770402015312105227107/</a></div><div><br></div><div>并非所有的矩阵都有逆, 但是所有的矩阵都可有广义逆.</div><div>如果<span style="line-height: 28px;"   >广义逆</span>满足下列条件,&nbsp;<span style="line-height: 28px;"   >n×m矩阵A+是矩阵A的Moore-Penrose逆:</span></div><div><span style="line-height: 28px;"   >用A+表示A的广义逆. 那么必须满足(后两个是对称性) :&nbsp;</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >AA+A=A</font></div><div><font size="2"   >A+AA+=A+</font></div><div><font size="2"   >(AA+)T=AA+</font></div><div><font size="2"   >(A+A)T=A+A</font></div><p></p></pre></div><div><span style="line-height: 28px;"   ><br></span></div><div><div>R中MASS包中的ginv()函数可以计算矩阵的Moore-Penrose逆. 例如:</div><div><pre class="prettyprint"   ><p></p><div><span style="line-height: 28px;"   ><font size="2"   >&gt; A=matrix(1:12,nrow=3,ncol=4)</font></span></div><div><font size="2"   >&gt; A</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;1 &nbsp; &nbsp;4 &nbsp; &nbsp;7 &nbsp; 10</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;2 &nbsp; &nbsp;5 &nbsp; &nbsp;8 &nbsp; 11</font></div><div><font size="2"   >[3,] &nbsp; &nbsp;3 &nbsp; &nbsp;6 &nbsp; &nbsp;9 &nbsp; 12</font></div><p></p></pre></div></div><div>使用solve只能计算正方矩阵的逆.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; solve(A)</font></div><div><font size="2"   >Error in solve.default(A) : 'a' (3 x 4) must be square</font></div><p></p></pre></div><div>需要用到MASS的ginv函数.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; library(MASS)</font></div><div><font size="2"   >&gt; ginv(A)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[,1] &nbsp; &nbsp; &nbsp; &nbsp;[,2] &nbsp; &nbsp; &nbsp; &nbsp;[,3]</font></div><div><font size="2"   >[1,] -0.483333333 -0.03333333 &nbsp;0.41666667</font></div><div><font size="2"   >[2,] -0.244444444 -0.01111111 &nbsp;0.22222222</font></div><div><font size="2"   >[3,] -0.005555556 &nbsp;0.01111111 &nbsp;0.02777778</font></div><div><font size="2"   >[4,] &nbsp;0.233333333 &nbsp;0.03333333 -0.16666667</font></div><p></p></pre></div><div>验证 :</div><div><span style="line-height: 28px;"   >1. a %*% A %*% a =&nbsp;</span><span style="line-height: 28px;"   >a</span></div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >&gt; a %*% A %*% a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[,1] &nbsp; &nbsp; &nbsp; &nbsp;[,2] &nbsp; &nbsp; &nbsp; &nbsp;[,3]</font></div><div><font size="2"   >[1,] -0.483333333 -0.03333333 &nbsp;0.41666667</font></div><div><font size="2"   >[2,] -0.244444444 -0.01111111 &nbsp;0.22222222</font></div><div><font size="2"   >[3,] -0.005555556 &nbsp;0.01111111 &nbsp;0.02777778</font></div><div><font size="2"   >[4,] &nbsp;0.233333333 &nbsp;0.03333333 -0.16666667</font></div><div><font size="2"   >&gt; a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[,1] &nbsp; &nbsp; &nbsp; &nbsp;[,2] &nbsp; &nbsp; &nbsp; &nbsp;[,3]</font></div><div><font size="2"   >[1,] -0.483333333 -0.03333333 &nbsp;0.41666667</font></div><div><font size="2"   >[2,] -0.244444444 -0.01111111 &nbsp;0.22222222</font></div><div><font size="2"   >[3,] -0.005555556 &nbsp;0.01111111 &nbsp;0.02777778</font></div><div><font size="2"   >[4,] &nbsp;0.233333333 &nbsp;0.03333333 -0.16666667</font></div></div><div><font size="2"   >精度问题, 不能直接划等号</font></div><div><div><font size="2"   >&gt; (a %*% A %*% a) == a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; [,1] &nbsp;[,2] &nbsp;[,3]</font></div><div><font size="2"   >[1,] FALSE FALSE FALSE</font></div><div><font size="2"   >[2,] FALSE FALSE FALSE</font></div><div><font size="2"   >[3,] FALSE FALSE FALSE</font></div><div><font size="2"   >[4,] FALSE FALSE FALSE</font></div></div><p></p></pre></div><div><br></div><div>2.&nbsp;<span style="line-height: 28px;"   >A %*% a %*% A =&nbsp;</span><span style="line-height: 28px;"   >A</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; A %*% a %*% A</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;1 &nbsp; &nbsp;4 &nbsp; &nbsp;7 &nbsp; 10</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;2 &nbsp; &nbsp;5 &nbsp; &nbsp;8 &nbsp; 11</font></div><div><font size="2"   >[3,] &nbsp; &nbsp;3 &nbsp; &nbsp;6 &nbsp; &nbsp;9 &nbsp; 12</font></div><div><div><font size="2"   >&gt; A</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;1 &nbsp; &nbsp;4 &nbsp; &nbsp;7 &nbsp; 10</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;2 &nbsp; &nbsp;5 &nbsp; &nbsp;8 &nbsp; 11</font></div><div><font size="2"   >[3,] &nbsp; &nbsp;3 &nbsp; &nbsp;6 &nbsp; &nbsp;9 &nbsp; 12</font></div></div><div><span style="line-height: 28px;"   ><font size="2"   >精度问题, 不能直接划等号</font></span></div><div><font size="2"   >&gt; (A %*% a %*% A) &nbsp;== &nbsp;A</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; [,1] &nbsp;[,2] &nbsp;[,3] &nbsp;[,4]</font></div><div><font size="2"   >[1,] FALSE FALSE FALSE FALSE</font></div><div><font size="2"   >[2,] FALSE FALSE FALSE FALSE</font></div><div><font size="2"   >[3,] FALSE FALSE FALSE FALSE</font></div><p></p></pre></div><div><br></div><div><span style="line-height: 28px;"   >3.&nbsp;</span>验证对称性</div><div><span style="line-height: 28px;"   >A %*% a ==&nbsp;</span><span style="line-height: 28px;"   >t(A %*% a)</span></div><div><span style="line-height: 28px;"   >a %*% A ==&nbsp;</span><span style="line-height: 28px;"   >t(a %*% A)</span></div><div><span style="line-height: 28px;"   ><br></span></div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >&gt; A %*% a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[,1] &nbsp; &nbsp; &nbsp;[,2] &nbsp; &nbsp; &nbsp; [,3]</font></div><div><font size="2"   >[1,] &nbsp;0.8333333 0.3333333 -0.1666667</font></div><div><font size="2"   >[2,] &nbsp;0.3333333 0.3333333 &nbsp;0.3333333</font></div><div><font size="2"   >[3,] -0.1666667 0.3333333 &nbsp;0.8333333</font></div><div><font size="2"   >&gt; t(A %*% a)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[,1] &nbsp; &nbsp; &nbsp;[,2] &nbsp; &nbsp; &nbsp; [,3]</font></div><div><font size="2"   >[1,] &nbsp;0.8333333 0.3333333 -0.1666667</font></div><div><font size="2"   >[2,] &nbsp;0.3333333 0.3333333 &nbsp;0.3333333</font></div><div><font size="2"   >[3,] -0.1666667 0.3333333 &nbsp;0.8333333</font></div><div><span style="line-height: 28px;"   ><font size="2"   >精度问题, 不能直接划等号</font></span></div><div><font size="2"   >&gt; t(A %*% a) == A %*% a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; [,1] &nbsp;[,2] &nbsp;[,3]</font></div><div><font size="2"   >[1,] &nbsp;TRUE FALSE FALSE</font></div><div><font size="2"   >[2,] FALSE &nbsp;TRUE &nbsp;TRUE</font></div><div><font size="2"   >[3,] FALSE &nbsp;TRUE &nbsp;TRUE</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >&gt; t(a %*% A)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp;0.7 &nbsp;0.4 &nbsp;0.1 -0.2</font></div><div><font size="2"   >[2,] &nbsp;0.4 &nbsp;0.3 &nbsp;0.2 &nbsp;0.1</font></div><div><font size="2"   >[3,] &nbsp;0.1 &nbsp;0.2 &nbsp;0.3 &nbsp;0.4</font></div><div><font size="2"   >[4,] -0.2 &nbsp;0.1 &nbsp;0.4 &nbsp;0.7</font></div><div><font size="2"   >&gt; a %*% A</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp;0.7 &nbsp;0.4 &nbsp;0.1 -0.2</font></div><div><font size="2"   >[2,] &nbsp;0.4 &nbsp;0.3 &nbsp;0.2 &nbsp;0.1</font></div><div><font size="2"   >[3,] &nbsp;0.1 &nbsp;0.2 &nbsp;0.3 &nbsp;0.4</font></div><div><font size="2"   >[4,] -0.2 &nbsp;0.1 &nbsp;0.4 &nbsp;0.7</font></div></div><div><span style="line-height: 28px;"   ><font size="2"   >精度问题, 不能直接划等号</font></span></div><div><div><font size="2"   >&gt; t(a %*% A) == a %*% A</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; [,1] &nbsp;[,2] &nbsp;[,3] &nbsp;[,4]</font></div><div><font size="2"   >[1,] &nbsp;TRUE FALSE FALSE FALSE</font></div><div><font size="2"   >[2,] FALSE &nbsp;TRUE &nbsp;TRUE FALSE</font></div><div><font size="2"   >[3,] FALSE &nbsp;TRUE &nbsp;TRUE FALSE</font></div><div><font size="2"   >[4,] FALSE FALSE FALSE &nbsp;TRUE</font></div></div><p></p></pre></div><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://en.wikipedia.org/wiki/Moore%E2%80%93Penrose_pseudoinverse"   >http://en.wikipedia.org/wiki/Moore%E2%80%93Penrose_pseudoinverse</a></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="使用MASS库 ginv() 计算任意矩阵的广义逆 (Moore-Penrose) - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>