<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">The outer product of the arrays, 矩阵外积, or 矩阵特定外函数</h2>
	<h5 id="">2015-04-10 10:45:27&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402015310102223719/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>矩阵外积使用%o%运算符计算.</div><div>得到结果为维度相加的数组.</div><div>例如 :&nbsp;</div><div>一个2维矩阵和一个3维数组计算外积, 将得到一个5维数组.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; x &lt;- matrix(1:10, 2, 5)</font></div><div><font size="2"   >&gt; y &lt;- array(1:64, dim=c(4,4,4))</font></div><div><font size="2"   >&gt; x</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4] [,5]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;1 &nbsp; &nbsp;3 &nbsp; &nbsp;5 &nbsp; &nbsp;7 &nbsp; &nbsp;9</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;2 &nbsp; &nbsp;4 &nbsp; &nbsp;6 &nbsp; &nbsp;8 &nbsp; 10</font></div><div><font size="2"   >&gt; y</font></div><div><font size="2"   >, , 1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;1 &nbsp; &nbsp;5 &nbsp; &nbsp;9 &nbsp; 13</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;2 &nbsp; &nbsp;6 &nbsp; 10 &nbsp; 14</font></div><div><font size="2"   >[3,] &nbsp; &nbsp;3 &nbsp; &nbsp;7 &nbsp; 11 &nbsp; 15</font></div><div><font size="2"   >[4,] &nbsp; &nbsp;4 &nbsp; &nbsp;8 &nbsp; 12 &nbsp; 16</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >, , 2</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 17 &nbsp; 21 &nbsp; 25 &nbsp; 29</font></div><div><font size="2"   >[2,] &nbsp; 18 &nbsp; 22 &nbsp; 26 &nbsp; 30</font></div><div><font size="2"   >[3,] &nbsp; 19 &nbsp; 23 &nbsp; 27 &nbsp; 31</font></div><div><font size="2"   >[4,] &nbsp; 20 &nbsp; 24 &nbsp; 28 &nbsp; 32</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >, , 3</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 33 &nbsp; 37 &nbsp; 41 &nbsp; 45</font></div><div><font size="2"   >[2,] &nbsp; 34 &nbsp; 38 &nbsp; 42 &nbsp; 46</font></div><div><font size="2"   >[3,] &nbsp; 35 &nbsp; 39 &nbsp; 43 &nbsp; 47</font></div><div><font size="2"   >[4,] &nbsp; 36 &nbsp; 40 &nbsp; 44 &nbsp; 48</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >, , 4</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 49 &nbsp; 53 &nbsp; 57 &nbsp; 61</font></div><div><font size="2"   >[2,] &nbsp; 50 &nbsp; 54 &nbsp; 58 &nbsp; 62</font></div><div><font size="2"   >[3,] &nbsp; 51 &nbsp; 55 &nbsp; 59 &nbsp; 63</font></div><div><font size="2"   >[4,] &nbsp; 52 &nbsp; 56 &nbsp; 60 &nbsp; 64</font></div><p></p></pre></div><div>计算外积 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >&gt; x %o% y</font></div><div><font size="2"   >, , 1, 1, 1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4] [,5]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;1 &nbsp; &nbsp;3 &nbsp; &nbsp;5 &nbsp; &nbsp;7 &nbsp; &nbsp;9</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;2 &nbsp; &nbsp;4 &nbsp; &nbsp;6 &nbsp; &nbsp;8 &nbsp; 10</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >, , 2, 1, 1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4] [,5]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;2 &nbsp; &nbsp;6 &nbsp; 10 &nbsp; 14 &nbsp; 18</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;4 &nbsp; &nbsp;8 &nbsp; 12 &nbsp; 16 &nbsp; 20</font></div></div><div><font size="2"   >....</font></div><p></p></pre></div><div>结果略.</div><div>外积计算结果的维度和类型 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; dim(x %o% y)</font></div><div><font size="2"   >[1] 2 5 4 4 4</font></div><div><font size="2"   >&gt; class(x %o% y)</font></div><div><font size="2"   >[1] "array"</font></div><p></p></pre></div><div>我们看到一个(2,5)的矩阵和一个(4,4,4)的数组计算外积得到了一个(2,5,4,4,4)的数组.</div><div><br></div><div>下面来看一下外积是怎么计算的, 使用小一点的矩阵.</div><div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; x &lt;- matrix(1:4, 2, 2)</font></div><div><font size="2"   >&gt; y &lt;- matrix(10:13, 1, 4)</font></div><div><font size="2"   >&gt; x</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;1 &nbsp; &nbsp;3</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;2 &nbsp; &nbsp;4</font></div><div><font size="2"   >&gt; y</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 10 &nbsp; 11 &nbsp; 12 &nbsp; 13</font></div><p></p></pre></div><div>使用x %o% y计算外积, 相当于y的每个元素和x相乘.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; x %o% y</font></div><div><font size="2"   >y的第1个元素(1,1)乘以x</font></div><div><font size="2"   >, , 1, 1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2]</font></div><div><font size="2"   >[1,] &nbsp; 10 &nbsp; 30</font></div><div><font size="2"   >[2,] &nbsp; 20 &nbsp; 40</font></div><div><font size="2"   ><span style="line-height: 28px;"   >y的第2个元素</span><span style="line-height: 28px;"   >(1,2)</span><span style="line-height: 28px;"   >乘以x</span></font></div><div><font size="2"   >, , 1, 2</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2]</font></div><div><font size="2"   >[1,] &nbsp; 11 &nbsp; 33</font></div><div><font size="2"   >[2,] &nbsp; 22 &nbsp; 44</font></div><div><font size="2"   ><span style="line-height: 28px;"   >y的第3个元素</span><span style="line-height: 28px;"   >(1,3)</span><span style="line-height: 28px;"   >乘以x</span></font></div><div><font size="2"   >, , 1, 3</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2]</font></div><div><font size="2"   >[1,] &nbsp; 12 &nbsp; 36</font></div><div><font size="2"   >[2,] &nbsp; 24 &nbsp; 48</font></div><div><font size="2"   ><span style="line-height: 28px;"   >y的第4个元素</span><span style="line-height: 28px;"   >(1,4)</span><span style="line-height: 28px;"   >乘以x</span></font></div><div><font size="2"   >, , 1, 4</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2]</font></div><div><font size="2"   >[1,] &nbsp; 13 &nbsp; 39</font></div><div><font size="2"   >[2,] &nbsp; 26 &nbsp; 52</font></div><p></p></pre></div></div><div><br></div><div>反过来写&nbsp;y %o% x</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   ><span style="line-height: 28px;"   >x的第1个元素</span><span style="line-height: 28px;"   >(1,1)</span><span style="line-height: 28px;"   >乘以y</span></font></div><div><font size="2"   >&gt; y %o% x</font></div><div><font size="2"   >, , 1, 1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 10 &nbsp; 11 &nbsp; 12 &nbsp; 13</font></div><div><font size="2"   ><span style="line-height: 28px;"   >x的第2个元素</span><span style="line-height: 28px;"   >(2,1)</span><span style="line-height: 28px;"   >乘以y</span></font></div><div><font size="2"   >, , 2, 1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 20 &nbsp; 22 &nbsp; 24 &nbsp; 26</font></div><div><font size="2"   ><span style="line-height: 28px;"   >x的第3个元素</span><span style="line-height: 28px;"   >(1,2)</span><span style="line-height: 28px;"   >乘以y</span></font></div><div><font size="2"   >, , 1, 2</font></div><div><span style="line-height: 28px;"   ><font size="2"   ><br></font></span></div><div><span style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></span></div><div><font size="2"   >[1,] &nbsp; 30 &nbsp; 33 &nbsp; 36 &nbsp; 39</font></div><div><font size="2"   ><span style="line-height: 28px;"   >x的第4个元素</span><span style="line-height: 28px;"   >(2,2)</span><span style="line-height: 28px;"   >乘以y</span></font></div><div><font size="2"   >, , 2, 2</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 40 &nbsp; 44 &nbsp; 48 &nbsp; 52</font></div><p></p></pre></div><div><br></div><div>%o%实际是outer函数的一种特殊用法. 即FUN为乘法.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&nbsp; &nbsp; &nbsp;outer(X, Y, FUN = "*", ...)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;X %o% Y</font></div><p></p></pre></div><div>例如</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; outer(y,x,FUN="*")</font></div><div><font size="2"   >, , 1, 1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 10 &nbsp; 11 &nbsp; 12 &nbsp; 13</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >, , 2, 1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 20 &nbsp; 22 &nbsp; 24 &nbsp; 26</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >, , 1, 2</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 30 &nbsp; 33 &nbsp; 36 &nbsp; 39</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >, , 2, 2</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 40 &nbsp; 44 &nbsp; 48 &nbsp; 52</font></div><p></p></pre></div><div><br></div><div>如果我们把FUN换成加法, 结果如下 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; outer(y,x,FUN="+")</font></div><div><font size="2"   >, , 1, 1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 11 &nbsp; 12 &nbsp; 13 &nbsp; 14</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >, , 2, 1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 12 &nbsp; 13 &nbsp; 14 &nbsp; 15</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >, , 1, 2</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 13 &nbsp; 14 &nbsp; 15 &nbsp; 16</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >, , 2, 2</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 14 &nbsp; 15 &nbsp; 16 &nbsp; 17</font></div><p></p></pre></div><div><br></div><div>FUN还可以使用自定义函数, 以及函数支持传入参数等.</div><div><br></div><div>[参考]</div>1. help(outer)<wbr><div>2. help("%o%")</div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="The outer product of the arrays, 矩阵外积, or 矩阵特定外函数 - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>