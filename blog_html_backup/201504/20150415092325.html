<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">使用coplot()绘制多元图</h2>
	<h5 id="">2015-04-15 9:23:25&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201531453834219/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>本文讲解coplot的使用, 这个函数可以用于绘制多元图, 例如按省份调查身高和体重.</div><div>省份是factor, z</div><div>身高是x</div><div>体重是y</div><div>对应用法 coplot(y ~ x | z)</div><div>数据例如 :&nbsp;</div><div>z &lt;- factor(rep('浙江', 6),&nbsp;<span style="line-height: 28px;"   >rep('江西', 6),&nbsp;</span><span style="line-height: 28px;"   >rep('北京', 6),&nbsp;</span><span style="line-height: 28px;"   >rep('广州', 5)</span><span style="line-height: 28px;"   >&nbsp;)</span></div><div><span style="line-height: 28px;"   >表示浙江,江西,北京有6组数据, 广州有5组数据. 一共23组数据</span></div><div><span style="line-height: 28px;"   >对应数据为</span></div><div><span style="line-height: 28px;"   >y &lt;- c(55, 65, 73, 63, 58, 66, ...........)</span></div><div><span style="line-height: 28px;"   >x &lt;- c(160, 165, 170, 171, 158, 167, ......)</span></div><div><span style="line-height: 28px;"   >xy的前6个point对应浙江的数据, xy的接下来的6个point对应江西的采样数据, 以此类推.</span></div><div><span style="line-height: 28px;"   >绘制4幅图.</span></div><div><br></div><div>测试 :&nbsp;</div><div>绘制三幅图. 每幅图对应的点数和factor对应的level内的元素个数一致.</div><div><span style="line-height: 28px;"   >每幅图的点数, 对应factor的每个段的元素个数, 这里是abc各3,5,2个点.</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; set.seed(1 ); x &lt;- sample(c(1:50),10)</font></div><div><font size="2"   >&gt; set.seed(2); y &lt;- sample(c(1:50),10)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&gt; f &lt;- as.factor(c(rep('a',3),rep('b',5),rep('c',2)))</font></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >&gt; x</font></div><div><font size="2"   >&nbsp;[1] 14 19 28 43 10 41 42 29 27 &nbsp;3</font></div><div><font size="2"   >&gt; y</font></div><div><font size="2"   >&nbsp;[1] 10 35 28 &nbsp;8 44 43 &nbsp;6 36 20 23</font></div></div><div><div><font size="2"   >&gt; f</font></div><div><font size="2"   >&nbsp;[1] a a a b b b b b c c</font></div><div><font size="2"   >Levels: a b c</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >&gt; coplot(y ~ x | f)</font></div><p></p></pre></div><div><div><img title="使用coplot()绘制多元图 - 德哥@Digoal - PostgreSQL research"   alt="使用coplot()绘制多元图 - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/sElLH2L7NMOWYEkEAdBiIg==/2441795422983050812.png"   ></div>图的顺序:</div><div>&nbsp;y是因变量, 把上图顺时针旋转90度后, 数据分段描述顺序为 左上, 左下, 右上.&nbsp;</div><div>&nbsp;如果不旋转来看就是从下往上, 从左往右.</div><div>因此 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><span style="font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, 宋体; line-height: 28px; white-space: normal;"   ><font size="2"   >下左图对应数据 :&nbsp;</font></span></div><div><font size="2"   >a,a,a</font></div><div><font size="2"   >10,14; 35,19; 28,28;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >下右对应数据 :&nbsp;</font></div><div><font size="2"   >b,b,b,b,b</font></div><div><font size="2"   >8,43; 44,10; 43,41; 6,42; 36,29;</font></div><div><font size="2"   ><br></font></div><div><span style="line-height: 28px;"   ><font size="2"   >上左对应数据 :&nbsp;</font></span></div><div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >c,c</font></div><div style="line-height: 28px;"   ><font size="2"   >20,27; 23,3;</font></div></div></div><p></p></pre></div><div><br></div><div>当factor有4个水平(level)时, 绘制4幅图 :&nbsp;</div><div>每幅图的点数, 对应factor的每个段的元素个数, 这里是abcd各3,5,1,1个.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; f &lt;- as.factor(c(rep('a',3),rep('b',5),rep('c',1),rep('d',1)))</font></div><div><div><font size="2"   >&gt; f</font></div><div><font size="2"   >&nbsp;[1] a a a b b b b b c d</font></div><div><font size="2"   >Levels: a b c d</font></div></div><div><font size="2"   >&gt; coplot(y ~ x | f)</font></div><p></p></pre></div><div><div><img title="使用coplot()绘制多元图 - 德哥@Digoal - PostgreSQL research"   alt="使用coplot()绘制多元图 - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img2.ph.126.net/l6C-mjnRo8Trk0fhm-HK0Q==/6630837967769054930.png"   ></div><div style="line-height: 28px;"   >图的顺序:</div><div style="line-height: 28px;"   >&nbsp;y是因变量, 把上图顺时针旋转90度后, 数据描述顺序为 左上, 左下, 右上, 右下.&nbsp;</div></div><div><br></div><div>如果f是一个向量的话, coplot对这个向量自动分段, 然后绘制x,y的二元图.</div><div>按照每个分段内的元素个数, 提取对应个数的xy数据点.</div><div><br></div><div>例如 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >&gt; x &lt;- 1:12</font></div><div><font size="2"   >&gt; y &lt;- 100:111</font></div></div><div><font size="2"   >&gt; z &lt;- 300:311</font></div><div><div><font size="2"   >&gt; x</font></div><div><font size="2"   >&nbsp;[1] &nbsp;1 &nbsp;2 &nbsp;3 &nbsp;4 &nbsp;5 &nbsp;6 &nbsp;7 &nbsp;8 &nbsp;9 10 11 12</font></div><div><font size="2"   >&gt; y</font></div><div><font size="2"   >&nbsp;[1] 100 101 102 103 104 105 106 107 108 109 110 111</font></div><div><font size="2"   >&gt; z</font></div><div><font size="2"   >&nbsp;[1] 300 301 302 303 304 305 306 307 308 309 310 311</font></div></div><div><font size="2"   >&gt; coplot(y ~ x | z)</font></div><p></p></pre></div><div>自动将z分成6段, 注意分段有重叠部分, 从z分段来看包含几个点.</div><div>第1段包含3个值, 300,301,302, 对应xy的第1,2,3组值.</div><div>第2段包含<span style="line-height: 28px;"   >3个值,</span><span style="line-height: 28px;"   >&nbsp;302,303,304</span><span style="line-height: 28px;"   >, 对应xy的</span><span style="line-height: 28px;"   >第3,4,5组值.</span></div><div><span style="line-height: 28px;"   >第3段包含</span><span style="line-height: 28px;"   >4个值,</span><span style="line-height: 28px;"   >&nbsp;303,304,305,306</span><span style="line-height: 28px;"   >, 对应xy的</span><span style="line-height: 28px;"   >第4,5,6,7组值.</span></div><div><span style="line-height: 28px;"   >第4段包含</span><span style="line-height: 28px;"   >4个值,</span><span style="line-height: 28px;"   >&nbsp;305,306,307,308</span><span style="line-height: 28px;"   >, 对应xy的</span><span style="line-height: 28px;"   >第6,7,8,9组值.</span></div><div><span style="line-height: 28px;"   >第5段包含</span><span style="line-height: 28px;"   >3个值,</span><span style="line-height: 28px;"   >&nbsp;307,308,309</span><span style="line-height: 28px;"   >, 对应xy的</span><span style="line-height: 28px;"   >第8,9,10组值.</span></div><div><span style="line-height: 28px;"   >第6段包含</span><span style="line-height: 28px;"   >3个值,</span><span style="line-height: 28px;"   >&nbsp;309,310,311</span><span style="line-height: 28px;"   >, 对应xy的</span><span style="line-height: 28px;"   >第10,11,12组值.</span></div><div><div><img title="使用coplot()绘制多元图 - 德哥@Digoal - PostgreSQL research"   alt="使用coplot()绘制多元图 - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img2.ph.126.net/NYIO_8ElDp8SxQUvBIY52w==/2804616667962935459.png"   ></div></div><div><div><br></div><div>相对pairs()函数只能显示双向关系，coplot()函数能<span style="line-height: 28px;"   >够说明三向甚至四向关系，它特别于适合观察当</span><span style="line-height: 28px;"   >给定其他预测变量时，反应变量如何根据一个预</span><span style="line-height: 28px;"   >测变量变化。</span></div></div><div><br></div><div><div>## 单个条件变量的条件图</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >&gt; mtcars$wt</font></div><div><font size="2"   >&nbsp;[1] 2.620 2.875 2.320 3.215 3.440 3.460 3.570 3.190 3.150 3.440 3.440 4.070</font></div><div><font size="2"   >[13] 3.730 3.780 5.250 5.424 5.345 2.200 1.615 1.835 2.465 3.520 3.435 3.840</font></div><div><font size="2"   >[25] 3.845 1.935 2.140 1.513 3.170 2.770 3.570 2.780</font></div><div><font size="2"   >&gt; mtcars$mpg</font></div><div><font size="2"   >&nbsp;[1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2 10.4</font></div><div><font size="2"   >[16] 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4 15.8 19.7</font></div><div><font size="2"   >[31] 15.0 21.4</font></div><div><font size="2"   >&gt; as.factor(mtcars$cyl)</font></div><div><font size="2"   >&nbsp;[1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4</font></div><div><font size="2"   >Levels: 4 6 8</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >coplot(mtcars$wt ~ mtcars$mpg |&nbsp;<span style="line-height: 28px;"   >as.factor(mtcars$cyl), main="", xlab="", ylab="",&nbsp;</span><span style="line-height: 28px;"   >pch=19)</span></font></div><p></p></pre></div></div><div><div><img title="使用coplot()绘制多元图 - 德哥@Digoal - PostgreSQL research"   alt="使用coplot()绘制多元图 - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/rrF_f7dokq24H9KFW_-MZQ==/3836785407643694584.png"   ></div></div><div><br></div><div><div>## 两个条件变量的条件图</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >&gt; as.factor(mtcars$vs)</font></div><div><font size="2"   >&nbsp;[1] 0 0 1 1 0 1 0 1 1 1 1 0 0 0 0 0 0 1 1 1 1 0 0 0 0 1 0 1 0 0 0 1</font></div><div><font size="2"   >Levels: 0 1</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >coplot(mtcars$wt ~ mtcars$mpg |&nbsp;<span style="line-height: 28px;"   >as.factor(mtcars$cyl) * as.factor(mtcars$vs),&nbsp;</span><span style="line-height: 28px;"   >main="", xlab="", ylab="", pch=19)</span></font></div><p></p></pre></div></div><div><div><img title="使用coplot()绘制多元图 - 德哥@Digoal - PostgreSQL research"   alt="使用coplot()绘制多元图 - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/JM-NEGJzvIBSZeWJLSKyeg==/659495870451023095.png"   ></div></div><div><br></div><div>[参考]</div><div>1. help(coplot)</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >coplot &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;package:graphics &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; R Documentation</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Conditioning Plots</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Description:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;This function produces two variants of the *co*nditioning plots</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;discussed in the reference below.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Usage:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;coplot(formula, data, given.values, panel = points, rows, columns,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; show.given = TRUE, col = par("fg"), pch = par("pch"),</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bar.bg = c(num = gray(0.8), fac = gray(0.95)),</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xlab = c(x.name, paste("Given :", a.name)),</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ylab = c(y.name, paste("Given :", b.name)),</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; subscripts = FALSE,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; axlabels = function(f) abbreviate(levels(f)),</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; number = 6, overlap = 0.5, xlim, ylim, ...)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;co.intervals(x, number = 6, overlap = 0.5)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >Arguments:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp;formula: a formula describing the form of conditioning plot. &nbsp;A</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; formula of the form ‘y ~ x | a’ indicates that plots of ‘y’</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; versus ‘x’ should be produced conditional on the variable</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ‘a’. &nbsp;A formula of the form ‘y ~ x| a * b’ indicates that</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; plots of ‘y’ versus ‘x’ should be produced conditional on the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; two variables ‘a’ and ‘b’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; All three or four variables may be either numeric or factors.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; When ‘x’ or ‘y’ are factors, the result is almost as if</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ‘as.numeric()’ was applied, whereas for factor ‘a’ or ‘b’,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the conditioning (and its graphics if ‘show.given’ is true)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; are adapted.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; data: a data frame containing values for any variables in the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; formula. &nbsp;By default the environment where ‘coplot’ was</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; called from is used.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >given.values: a value or list of two values which determine how the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditioning on ‘a’ and ‘b’ is to take place.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; When there is no ‘b’ (i.e., conditioning only on ‘a’),</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usually this is a matrix with two columns each row of which</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gives an interval, to be conditioned on, but is can also be a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; single vector of numbers or a set of factor levels (if the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; variable being conditioned on is a factor). In this case (no</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ‘b’), the result of ‘co.intervals’ can be used directly as</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ‘given.values’ argument.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;panel: a ‘function(x, y, col, pch, ...)’ which gives the action to</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; be carried out in each panel of the display. &nbsp;The default is</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ‘points’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; rows: the panels of the plot are laid out in a ‘rows’ by ‘columns’</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array. &nbsp;‘rows’ gives the number of rows in the array.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp;columns: the number of columns in the panel layout array.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >show.given: logical (possibly of length 2 for 2 conditioning</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; variables): should conditioning plots be shown for the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; corresponding conditioning variables (default ‘TRUE’).</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;col: a vector of colors to be used to plot the points. &nbsp;If too</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; short, the values are recycled.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;pch: a vector of plotting symbols or characters. &nbsp;If too short,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the values are recycled.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; bar.bg: a named vector with components ‘"num"’ and ‘"fac"’ giving the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background colors for the (shingle) bars, for *num*eric and</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *fac*tor conditioning variables respectively.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; xlab: character; labels to use for the x axis and the first</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditioning variable. &nbsp;If only one label is given, it is</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; used for the x axis and the default label is used for the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditioning variable.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; ylab: character; labels to use for the y axis and any second</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditioning variable.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >subscripts: logical: if true the panel function is given an additional</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (third) argument ‘subscripts’ giving the subscripts of the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data passed to that panel.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >axlabels: function for creating axis (tick) labels when x or y are</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; factors.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; number: integer; the number of conditioning intervals, for a and b,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; possibly of length 2. &nbsp;It is only used if the corresponding</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditioning variable is not a ‘factor’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp;overlap: numeric &lt; 1; the fraction of overlap of the conditioning</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; variables, possibly of length 2 for x and y direction. &nbsp;When</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; overlap &lt; 0, there will be _gaps_ between the data slices.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; xlim: the range for the x axis.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; ylim: the range for the y axis.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;...: additional arguments to the panel function.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;x: a numeric vector.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Details:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;In the case of a single conditioning variable ‘a’, when both</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘rows’ and ‘columns’ are unspecified, a ‘close to square’ layout</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;is chosen with ‘columns &gt;= rows’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;In the case of multiple ‘rows’, the _order_ of the panel plots is</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;from the bottom and from the left (corresponding to increasing</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘a’, typically).</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;A panel function should not attempt to start a new plot, but just</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;plot within a given coordinate system: thus ‘plot’ and ‘boxplot’</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;are not panel functions.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;The rendering of arguments ‘xlab’ and ‘ylab’ is not controlled by</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘par’ arguments ‘cex.lab’ and ‘font.lab’ even though they are</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;plotted by ‘mtext’ rather than ‘title’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Value:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘co.intervals(., number, .)’ returns a (‘number’ x 2) ‘matrix’,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;say ‘ci’, where ‘ci[k,]’ is the ‘range’ of ‘x’ values for the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘k’-th interval.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >References:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Chambers, J. M. (1992) _Data for models._ Chapter 3 of</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;_Statistical Models in S_ eds J. M. Chambers and T. J. Hastie,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Wadsworth &amp; Brooks/Cole.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Cleveland, W. S. (1993) _Visualizing Data._ New Jersey: Summit</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Press.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >See Also:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘pairs’, ‘panel.smooth’, ‘points’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Examples:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;## Tonga Trench Earthquakes</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;coplot(lat ~ long | depth, data = quakes)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;given.depth &lt;- co.intervals(quakes$depth, number = 4, overlap = .1)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;coplot(lat ~ long | depth, data = quakes, given.v = given.depth, rows = 1)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;## Conditioning on 2 variables:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;ll.dm &lt;- lat ~ long | depth * mag</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;coplot(ll.dm, data = quakes)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;coplot(ll.dm, data = quakes, number = c(4, 7), show.given = c(TRUE, FALSE))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;coplot(ll.dm, data = quakes, number = c(3, 7),</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; overlap = c(-.5, .1)) # negative overlap DROPS values</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;## given two factors</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Index &lt;- seq(length = nrow(warpbreaks)) # to get nicer default labels</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;coplot(breaks ~ Index | wool * tension, data = warpbreaks,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; show.given = 0:1)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;coplot(breaks ~ Index | wool * tension, data = warpbreaks,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; col = "red", bg = "pink", pch = 21,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bar.bg = c(fac = "light blue"))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;## Example with empty panels:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;with(data.frame(state.x77), {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;coplot(Life.Exp ~ Income | Illiteracy * state.region, number = 3,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; panel = function(x, y, ...) panel.smooth(x, y, span = .8, ...))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;## y ~ factor -- not really sensible, but 'show off':</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;coplot(Life.Exp ~ state.region | Income * state.division,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; panel = panel.smooth)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;})</font></div><p></p></pre></div><div><br></div><wbr>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="使用coplot()绘制多元图 - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>