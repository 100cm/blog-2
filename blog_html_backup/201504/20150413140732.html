<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">backsolve & fowardsolve 解特殊方程 (上三角或下三角系数为0的方程)</h2>
	<h5 id="">2015-04-13 14:07:32&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201531314741512/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>我们知道用solve可以解y %*% x == b的方程</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201531311282613/"   >http://blog.163.com/digoal@126/blog/static/163877040201531311282613/</a></div><div><br></div><wbr><div>本文要讲的是一种特殊方程的另一种解法, 这种方程的特点是系数矩阵呈现上三角或下三角特征.</div><div>这种方程可以使用backsolve&amp;fowardsolve函数来解.</div><div>函数参数 :　</div><div><div>&gt; args(backsolve)</div><div>function (r, x, k = ncol(r), upper.tri = TRUE, transpose = FALSE)</div><div>&gt; args(forwardsolve)</div><div>function (l, x, k = ncol(l), upper.tri = FALSE, transpose = FALSE)</div><div>其中：r或者l为n×n维三角矩阵，x为n×1维向量(计算乘积时自动转换为矩阵)，对给定不同的upper.tri和transpose的值，方程的形式不同 .&nbsp;</div><div>这两个函数用法一致, 只是<span style="line-height: 28px;"   >upper.tri参数的</span><span style="line-height: 28px;"   >默认值不一样. 如果它们参数一致, 得到的结果是一致的.</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&nbsp; &nbsp; &nbsp;backsolve(r, x, k = ncol(r), upper.tri = TRUE,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transpose = FALSE)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;forwardsolve(l, x, k = ncol(l), upper.tri = FALSE,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transpose = FALSE)</font></div><p></p></pre></div><div><span style="line-height: 28px;"   >对于函数backsolve()而言，</span></div><div>例如：</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; A=matrix(1:9,3,3)</font></div><div><font size="2"   >&gt; A</font></div><div><font size="2"   >&nbsp; [,1] [,2] [,3]</font></div><div><font size="2"   >[1,] &nbsp; 1 &nbsp; 4 &nbsp; 7</font></div><div><font size="2"   >[2,] &nbsp; 2 &nbsp; 5 &nbsp; 8</font></div><div><font size="2"   >[3,] &nbsp; 3 &nbsp; 6 &nbsp; 9</font></div><div><font size="2"   >&gt; x=c(1,2,3)</font></div><div><font size="2"   >&gt; x</font></div><div><font size="2"   >[1] 1 2 3</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&gt; B=A</font></div><div><div><font size="2"   >&gt; upper.tri(B)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; [,1] &nbsp;[,2] &nbsp;[,3]</font></div><div><font size="2"   >[1,] FALSE &nbsp;TRUE &nbsp;TRUE</font></div><div><font size="2"   >[2,] FALSE FALSE &nbsp;TRUE</font></div><div><font size="2"   >[3,] FALSE FALSE FALSE</font></div></div><div><font size="2"   >&gt; B[upper.tri(B)]=0 &nbsp; # 使用upper.tri将上三角设置为0</font></div><div><font size="2"   >&gt; B</font></div><div><font size="2"   >&nbsp; [,1] [,2] [,3]</font></div><div><font size="2"   >[1,] &nbsp; 1 &nbsp; 0 &nbsp; 0</font></div><div><font size="2"   >[2,] &nbsp; 2 &nbsp; 5 &nbsp; 0</font></div><div><font size="2"   >[3,] &nbsp; 3 &nbsp; 6 &nbsp; 9</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&gt; C=A</font></div><div><div><font size="2"   >&gt; lower.tri(C)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; [,1] &nbsp;[,2] &nbsp;[,3]</font></div><div><font size="2"   >[1,] FALSE FALSE FALSE</font></div><div><font size="2"   >[2,] &nbsp;TRUE FALSE FALSE</font></div><div><font size="2"   >[3,] &nbsp;TRUE &nbsp;TRUE FALSE</font></div></div><div><font size="2"   >&gt; C[lower.tri(C)]=0<span style="line-height: 28px;"   >&nbsp;</span><span style="line-height: 28px;"   >&nbsp; # 使用lower.tri将下三角设置为0</span></font></div><div><font size="2"   >&gt; C</font></div><div><font size="2"   >&nbsp; [,1] [,2] [,3]</font></div><div><font size="2"   >[1,] &nbsp; 1 &nbsp; 4 &nbsp; 7</font></div><div><font size="2"   >[2,] &nbsp; 0 &nbsp; 5 &nbsp; 8</font></div><div><font size="2"   >[3,] &nbsp; 0 &nbsp; 0 &nbsp; 9</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&gt; backsolve(A,x,upper.tri=T,transpose=T) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 参数<span style="line-height: 28px;"   >upper.tri=T表示保留上三角, &nbsp; 即下三角为0</span></font></div><div><font size="2"   >[1] 1.00000000 -0.40000000 -0.08888889 &nbsp; &nbsp; &nbsp; &nbsp; # &nbsp;<span style="line-height: 28px;"   >transpose=T &nbsp;表示对"执行</span><span style="line-height: 28px;"   >上三角值保留后的值"</span><span style="line-height: 28px;"   >进行行列转换</span></font></div><div><font size="2"   >结果和<span style="line-height: 28px;"   >solve(t(C),x)一致.</span></font></div><div><font size="2"   >&gt; solve(t(C),x)</font></div><div><font size="2"   >[1] 1.00000000 -0.40000000 -0.08888889</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&gt; backsolve(A,x,upper.tri=T,transpose=F) &nbsp; &nbsp; &nbsp; &nbsp;<span style="line-height: 28px;"   ># 参数</span><span style="line-height: 28px;"   >upper.tri=T表示</span><span style="line-height: 28px;"   >保留上三角</span><span style="line-height: 28px;"   >, &nbsp; 即下三角为0</span></font></div><div><font size="2"   >[1] -0.8000000 -0.1333333 0.3333333 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span style="line-height: 28px;"   ># &nbsp;</span><span style="line-height: 28px;"   >transpose=F &nbsp;表示对"执行</span><span style="line-height: 28px;"   >上三角值保留后的值"不</span><span style="line-height: 28px;"   >进行行列转换</span></font></div><div><font size="2"   ><span style="line-height: 28px;"   >结果和</span><span style="line-height: 28px;"   >solve(C,x)一致.</span></font></div><div><font size="2"   >&gt; solve(C,x)</font></div><div><font size="2"   >[1] -0.8000000 -0.1333333 0.3333333</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&gt; backsolve(A,x,upper.tri=F,transpose=T) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="line-height: 28px;"   ># 参数</span><span style="line-height: 28px;"   >upper.tri=F表示不</span><span style="line-height: 28px;"   >保留上三角</span><span style="line-height: 28px;"   >, &nbsp; 即上三角为0</span></font></div><div><font size="2"   >[1] 1.111307e-17 2.220446e-17 3.333333e-01</font></div><div><font size="2"   >&gt; solve(t(B),x)</font></div><div><font size="2"   >[1] 1.110223e-17 2.220446e-17 3.333333e-01</font></div><div><font size="2"   >&gt; backsolve(A,x,upper.tri=F,transpose=F)<span style="line-height: 28px;"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="line-height: 28px;"   ># 参数</span><span style="line-height: 28px;"   >upper.tri=F表示不</span><span style="line-height: 28px;"   >保留上三角</span><span style="line-height: 28px;"   >, &nbsp; 即上三角为0</span></font></div><div><font size="2"   >[1] 1 0 0</font></div><div><font size="2"   >&gt; solve(B,x)</font></div><div><font size="2"   >[1] 1.000000e+00 -1.540744e-33 -1.850372e-17</font></div><p></p></pre></div><div><br></div><div><br></div><div>对于函数forwardsolve()而言，当传入参数与backsolve()一致时, 结果一致.</div><div>例如：</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&nbsp; &gt; A</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; [,1] [,2] [,3]</font></div><div><font size="2"   >[1,] &nbsp; 1 &nbsp; 4 &nbsp; 7</font></div><div><font size="2"   >[2,] &nbsp; 2 &nbsp; 5 &nbsp; 8</font></div><div><font size="2"   >[3,] &nbsp; 3 &nbsp; 6 &nbsp; 9</font></div><div><font size="2"   >&gt; B</font></div><div><font size="2"   >&nbsp; [,1] [,2] [,3]</font></div><div><font size="2"   >[1,] &nbsp; 1 &nbsp; 0 &nbsp; 0</font></div><div><font size="2"   >[2,] &nbsp; 2 &nbsp; 5 &nbsp; 0</font></div><div><font size="2"   >[3,] &nbsp; 3 &nbsp; 6 &nbsp; 9</font></div><div><font size="2"   >&gt; C</font></div><div><font size="2"   >&nbsp; [,1] [,2] [,3]</font></div><div><font size="2"   >[1,] &nbsp; 1 &nbsp; 4 &nbsp; 7</font></div><div><font size="2"   >[2,] &nbsp; 0 &nbsp; 5 &nbsp; 8</font></div><div><font size="2"   >[3,] &nbsp; 0 &nbsp; 0 &nbsp; 9</font></div><div><font size="2"   >&gt; x</font></div><div><font size="2"   >[1] 1 2 3</font></div><div><font size="2"   >&gt; forwardsolve(A,x,upper.tri=T,transpose=T)</font></div><div><font size="2"   >[1] 1.00000000 -0.40000000 -0.08888889</font></div><div><font size="2"   >&gt; solve(t(C),x)</font></div><div><font size="2"   >[1] 1.00000000 -0.40000000 -0.08888889</font></div><div><font size="2"   >&gt; forwardsolve(A,x,upper.tri=T,transpose=F)</font></div><div><font size="2"   >[1] -0.8000000 -0.1333333 0.3333333</font></div><div><font size="2"   >&gt; solve(C,x)</font></div><div><font size="2"   >[1] -0.8000000 -0.1333333 0.3333333</font></div><div><font size="2"   >&gt; forwardsolve(A,x,upper.tri=F,transpose=T)</font></div><div><font size="2"   >[1] 1.111307e-17 2.220446e-17 3.333333e-01</font></div><div><font size="2"   >&gt; solve(t(B),x)</font></div><div><font size="2"   >[1] 1.110223e-17 2.220446e-17 3.333333e-01</font></div><div><font size="2"   >&gt; forwardsolve(A,x,upper.tri=F,transpose=F)</font></div><div><font size="2"   >[1] 1 0 0</font></div><div><font size="2"   >&gt; solve(B,x)</font></div><div><font size="2"   >[1] 1.000000e+00 -1.540744e-33 -1.850372e-17</font></div><p></p></pre></div></div><div><br></div><div><br></div>[参考]<wbr><div>1.&nbsp;&gt; help(backsolve)</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >backsolve &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; package:base &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; R Documentation</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Solve an Upper or Lower Triangular System</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Description:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Solves a triangular system of linear equations.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Usage:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; backsolve(r, x, k = ncol(r), upper.tri = TRUE,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transpose = FALSE)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;forwardsolve(l, x, k = ncol(l), upper.tri = FALSE,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transpose = FALSE)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >Arguments:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; r, l: an upper (or lower) triangular matrix giving the coefficients</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for the system to be solved. &nbsp;Values below (above) the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; diagonal are ignored.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;x: a matrix whose columns give the right-hand sides for the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; equations.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;k: The number of columns of ‘r’ and rows of ‘x’ to use.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >upper.tri: logical; if ‘TRUE’ (default), the _upper_ _tri_angular part</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of ‘r’ is used. &nbsp;Otherwise, the lower one.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >transpose: logical; if ‘TRUE’, solve r' * y = x for y, i.e., ‘t(r) %*%</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y == x’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Details:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Solves a system of linear equations where the coefficient matrix</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;is upper (or ‘right’, ‘R’) or lower (‘left’, ‘L’) triangular.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘x &lt;- backsolve (R, b)’ solves R x = b, and</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘x &lt;- forwardsolve(L, b)’ solves L x = b, respectively.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;The ‘r’/‘l’ must have at least ‘k’ rows and columns, and ‘x’ must</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;have at least ‘k’ rows.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;This is a wrapper for the level-3 BLAS routine ‘dtrsm’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Value:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;The solution of the triangular system. &nbsp;The result will be a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;vector if ‘x’ is a vector and a matrix if ‘x’ is a matrix.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >References:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) _The New S</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Language_. &nbsp;Wadsworth &amp; Brooks/Cole.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Dongarra, J. J., Bunch, J. R., Moler, C. B. and Stewart, G. W.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;(1978) _LINPACK Users Guide_. &nbsp;Philadelphia: SIAM Publications.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >See Also:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘chol’, ‘qr’, ‘solve’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Examples:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;## upper triangular matrix 'r':</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;r &lt;- rbind(c(1,2,3),</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c(0,1,1),</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c(0,0,2))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;( y &lt;- backsolve(r, x &lt;- c(8,4,2)) ) # -1 3 1</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;r %*% y # == x = (8,4,2)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;backsolve(r, x, transpose = TRUE) # 8 -12 -5</font></div><p></p></pre></div>
<div><br></div><a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="backsolve  fowardsolve 解特殊方程 (上三角或下三角系数为0的方程) - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>