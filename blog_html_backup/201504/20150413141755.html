<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">as.vector 矩阵向量化</h2>
	<h5 id="">2015-04-13 14:17:55&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201531321411880/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><div>将矩阵向量化有时候是必要的。矩阵的向量化可以通过as.vector()来实现：</div><div><pre class="prettyprint"   ><div><font size="2"   >&gt; A</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;1 &nbsp; &nbsp;4 &nbsp; &nbsp;7 &nbsp; 10</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;2 &nbsp; &nbsp;5 &nbsp; &nbsp;8 &nbsp; 11</font></div><div><font size="2"   >[3,] &nbsp; &nbsp;3 &nbsp; &nbsp;6 &nbsp; &nbsp;9 &nbsp; 12</font></div><p></p></pre></div><div><br></div><div>将矩阵元素向量化, 注意是逐列转换的：</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; as.vector(A)</font></div><div><font size="2"   >&nbsp;[1] &nbsp;1 &nbsp;2 &nbsp;3 &nbsp;4 &nbsp;5 &nbsp;6 &nbsp;7 &nbsp;8 &nbsp;9 10 11 12</font></div><p></p></pre></div><div>如果要逐行转换, 可以使用t转换一下 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; as.vector(t(A))</font></div><div><font size="2"   >&nbsp;[1] &nbsp;1 &nbsp;4 &nbsp;7 10 &nbsp;2 &nbsp;5 &nbsp;8 11 &nbsp;3 &nbsp;6 &nbsp;9 12</font></div><p></p></pre></div><div><br></div><div>将矩阵的方阵部分元素向量化：</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >&gt; dim(A)</font></div><div><font size="2"   >[1] 3 4</font></div><div><font size="2"   >&gt; ncol(A)</font></div><div><font size="2"   >[1] 4</font></div><div><font size="2"   >&gt; nrow(A)</font></div><div><font size="2"   >[1] 3</font></div></div><div><div><font size="2"   >&gt; A[1:min(dim(A)),1:min(dim(A))]</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;1 &nbsp; &nbsp;4 &nbsp; &nbsp;7</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;2 &nbsp; &nbsp;5 &nbsp; &nbsp;8</font></div><div><font size="2"   >[3,] &nbsp; &nbsp;3 &nbsp; &nbsp;6 &nbsp; &nbsp;9</font></div></div><div><font size="2"   >&gt; as.vector(A[1:min(dim(A)),1:min(dim(A))])</font></div><div><font size="2"   >[1] 1 2 3 4 5 6 7 8 9</font></div><p></p></pre></div></div><div><br></div><div>[参考]</div><div>1. &gt; help(as.vector)</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >vector &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;package:base &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; R Documentation</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Vectors</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Description:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘vector’ produces a vector of the given length and mode.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘as.vector’, a generic, attempts to coerce its argument into a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;vector of mode ‘mode’ (the default is to coerce to whichever</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;vector mode is most convenient): if the result is atomic all</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;attributes are removed.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘is.vector’ returns ‘TRUE’ if ‘x’ is a vector of the specified</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;mode having no attributes _other than names_. &nbsp;It returns ‘FALSE’</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;otherwise.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Usage:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;vector(mode = "logical", length = 0)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;as.vector(x, mode = "any")</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;is.vector(x, mode = "any")</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >Arguments:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; mode: character string naming an atomic mode or ‘"list"’ or</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ‘"expression"’ or (except for ‘vector’) ‘"any"’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; length: a non-negative integer specifying the desired length. &nbsp;For a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; long vector, i.e., ‘length &gt; .Machine$integer.max’, it has to</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; be of type ‘"double"’. &nbsp;Supplying an argument of length other</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; than one is an error.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;x: an R object.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Details:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;The atomic modes are ‘"logical"’, ‘"integer"’, ‘"numeric"’</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;(synonym ‘"double"’), ‘"complex"’, ‘"character"’ and ‘"raw"’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;If ‘mode = "any"’, ‘is.vector’ may return ‘TRUE’ for the atomic</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;modes, ‘list’ and ‘expression’. &nbsp;For any ‘mode’, it will return</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘FALSE’ if ‘x’ has any attributes except names. &nbsp;(This is</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;incompatible with S.) &nbsp;On the other hand, ‘as.vector’ removes</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;_all_ attributes including names for results of atomic mode (but</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;not those of mode ‘"list"’ nor ‘"expression"’).</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Note that factors are _not_ vectors; ‘is.vector’ returns ‘FALSE’</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;and ‘as.vector’ converts a factor to a character vector for ‘mode</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;= "any"’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Value:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;For ‘vector’, a vector of the given length and mode. &nbsp;Logical</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;vector elements are initialized to ‘FALSE’, numeric vector</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;elements to ‘0’, character vector elements to ‘""’, raw vector</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;elements to ‘nul’ bytes and list/expression elements to ‘NULL’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;For ‘as.vector’, a vector (atomic or of type list or expression).</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;All attributes are removed from the result if it is of an atomic</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;mode, but not in general for a list result. &nbsp;The default method</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;handles 24 input types and 12 values of ‘type’: the details of</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;most coercions are undocumented and subject to change.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;For ‘is.vector’, ‘TRUE’ or ‘FALSE’. &nbsp;‘is.vector(x, mode =</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;"numeric")’ can be true for vectors of types ‘"integer"’ or</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘"double"’ whereas ‘is.vector(x, mode = "double")’ can only be</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;true for those of type ‘"double"’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Methods for 'as.vector()':</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Writers of methods for ‘as.vector’ need to take care to follow the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;conventions of the default method. &nbsp;In particular</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; ? Argument ‘mode’ can be ‘"any"’, any of the atomic modes,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ‘"list"’, ‘"expression"’, ‘"symbol"’, ‘"pairlist"’ or one of</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the aliases ‘"double"’ and ‘"name"’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; ? The return value should be of the appropriate mode. &nbsp;For</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ‘mode = "any"’ this means an atomic vector or list.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; ? Attributes should be treated appropriately: in particular</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; when the result is an atomic vector there should be no</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; attributes, not even names.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; ? ‘is.vector(as.vector(x, m), m)’ should be true for any mode</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ‘m’, including the default ‘"any"’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Note:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘as.vector’ and ‘is.vector’ are quite distinct from the meaning of</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;the formal class ‘"vector"’ in the ‘methods’ package, and hence</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘as(x, "vector")’ and ‘is(x, "vector")’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Note that ‘as.vector(x)’ is not necessarily a null operation if</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘is.vector(x)’ is true: any names will be removed from an atomic</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;vector.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Non-vector ‘mode’s ‘"symbol"’ (synonym ‘"name"’) and ‘"pairlist"’</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;are accepted but have long been undocumented: they are used to</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;implement ‘as.name’ and ‘as.pairlist’, and those functions should</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;preferably be used directly. &nbsp;None of the description here applies</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;to those ‘mode’s: see the help for the preferred forms.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >References:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) _The New S</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Language_. &nbsp;Wadsworth &amp; Brooks/Cole.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >See Also:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘c’, ‘is.numeric’, ‘is.list’, etc.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Examples:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;df &lt;- data.frame(x = 1:3, y = 5:7)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;## Error:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;try(as.vector(data.frame(x = 1:3, y = 5:7), mode = "numeric"))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;x &lt;- c(a = 1, b = 2)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;is.vector(x)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;as.vector(x)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;all.equal(x, as.vector(x)) ## FALSE</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;###-- All the following are TRUE:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;is.list(df)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;! is.vector(df)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;! is.vector(df, mode = "list")</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;is.vector(list(), mode = "list")</font></div><p></p></pre></div><wbr>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="as.vector 矩阵向量化 - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>