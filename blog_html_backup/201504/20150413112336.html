<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">使用qr()对矩阵QR分解</h2>
	<h5 id="">2015-04-13 11:23:36&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402015313111252824/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><b style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px;"   >QR分解法</b><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px;"   >是三种将</span><a title="&#30697;&#38453;&#20998;&#35299;" style="text-decoration: none; color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3"   >矩阵分解</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px;"   >的方式之一。这种方式，把</span><a title="&#30697;&#38453;" style="text-decoration: none; color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E7%9F%A9%E9%98%B5"   >矩阵</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px;"   >分解成一个</span><a title="&#21322;&#27491;&#20132;&#30697;&#38453;&#65288;&#39029;&#38754;&#19981;&#23384;&#22312;&#65289;" style="text-decoration: none; color: rgb(165, 88, 88); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;" class="new" rel="nofollow" href="http://zh.wikipedia.org/w/index.php?title=%E5%8D%8A%E6%AD%A3%E4%BA%A4%E7%9F%A9%E9%98%B5&amp;action=edit&amp;redlink=1"   >半正交矩阵</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px;"   >与一个</span><a title="&#19978;&#19977;&#35282;&#30697;&#38453;" style="text-decoration: none; color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;" class="mw-redirect" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E4%B8%8A%E4%B8%89%E8%A7%92%E7%9F%A9%E9%98%B5"   >上三角矩阵</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px;"   >的积。QR分解经常用来解</span><a title="&#32447;&#24615;&#26368;&#23567;&#20108;&#20056;&#27861;" style="text-decoration: none; color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;" class="mw-redirect" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E7%BA%BF%E6%80%A7%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95"   >线性最小二乘法</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px;"   >问题。QR分解也是特定</span><a title="&#29305;&#24449;&#20540;&#31639;&#27861;&#65288;&#39029;&#38754;&#19981;&#23384;&#22312;&#65289;" style="text-decoration: none; color: rgb(165, 88, 88); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;" class="new" rel="nofollow" href="http://zh.wikipedia.org/w/index.php?title=%E7%89%B9%E5%BE%81%E5%80%BC%E7%AE%97%E6%B3%95&amp;action=edit&amp;redlink=1"   >特征值算法</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px;"   >即</span><a title="QR&#31639;&#27861;&#65288;&#39029;&#38754;&#19981;&#23384;&#22312;&#65289;" style="text-decoration: none; color: rgb(165, 88, 88); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;" class="new" rel="nofollow" href="http://zh.wikipedia.org/w/index.php?title=QR%E7%AE%97%E6%B3%95&amp;action=edit&amp;redlink=1"   >QR算法</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.3999996185303px;"   >的基础。</span></div><div><div><br></div><div>A为m×n矩阵可以进行QR分解，A=QR，其中：Q'Q＝I，在R中可以用函数qr()进行QR分解，例如：</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; A=matrix(1:16,4,4)</font></div><div><font size="2"   >&gt; qr(A)</font></div><div><font size="2"   >$qr</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; [,1] &nbsp; &nbsp; [,2] &nbsp; &nbsp; &nbsp; [,3] &nbsp; &nbsp; &nbsp; [,4]</font></div><div><font size="2"   >[1,] -5.4772256 -12.7801930 -2.008316e+01 -2.738613e+01</font></div><div><font size="2"   >[2,] 0.3651484 -3.2659863 -6.531973e+00 -9.797959e+00</font></div><div><font size="2"   >[3,] 0.5477226 -0.3781696 2.641083e-15 2.056562e-15</font></div><div><font size="2"   >[4,] 0.7302967 -0.9124744 8.583032e-01 -2.111449e-16</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >$rank</font></div><div><font size="2"   >[1] 2</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >$qraux</font></div><div><font size="2"   >[1] 1.182574e+00 1.156135e+00 1.513143e+00 2.111449e-16</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >$pivot</font></div><div><font size="2"   >[1] 1 2 3 4</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >attr(,"class")</font></div><div><font size="2"   >[1] "qr"</font></div><p></p></pre></div><div><br></div><div>rank项返回矩阵的秩，qr项包含了矩阵Q和R的信息，要得到矩阵Q和R，可以用函数qr.Q()和qr.R()作用qr()的返回结果，</div><div>例如：</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; qr.R(qr(A))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; [,1] &nbsp; &nbsp; [,2] &nbsp; &nbsp; &nbsp; [,3] &nbsp; &nbsp; &nbsp; [,4]</font></div><div><font size="2"   >[1,] -5.477226 -12.780193 -2.008316e+01 -2.738613e+01</font></div><div><font size="2"   >[2,] 0.000000 -3.265986 -6.531973e+00 -9.797959e+00</font></div><div><font size="2"   >[3,] 0.000000 &nbsp; 0.000000 2.641083e-15 2.056562e-15</font></div><div><font size="2"   >[4,] 0.000000 &nbsp; 0.000000 0.000000e+00 -2.111449e-16</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&gt; qr.Q(qr(A))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; [,1] &nbsp; &nbsp; &nbsp; [,2] &nbsp; &nbsp; [,3] &nbsp; &nbsp; [,4]</font></div><div><font size="2"   >[1,] -0.1825742 -8.164966e-01 -0.4000874 -0.37407225</font></div><div><font size="2"   >[2,] -0.3651484 -4.082483e-01 0.2546329 0.79697056</font></div><div><font size="2"   >[3,] -0.5477226 -8.131516e-19 0.6909965 -0.47172438</font></div><div><font size="2"   >[4,] -0.7302967 4.082483e-01 -0.5455419 0.04882607</font></div><p></p></pre></div><div><br></div><div>验证 :&nbsp;</div><div><span style="line-height: 28px;"   >A=QR</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; qr.Q(qr(A))%*%qr.R(qr(A))</font></div><div><font size="2"   >&nbsp; [,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 1 &nbsp; 5 &nbsp; 9 &nbsp; 13</font></div><div><font size="2"   >[2,] &nbsp; 2 &nbsp; 6 &nbsp; 10 &nbsp; 14</font></div><div><font size="2"   >[3,] &nbsp; 3 &nbsp; 7 &nbsp; 11 &nbsp; 15</font></div><div><font size="2"   >[4,] &nbsp; 4 &nbsp; 8 &nbsp; 12 &nbsp; 16</font></div><p></p></pre></div><div><br></div><div>验证<span style="line-height: 28px;"   >Q'Q＝I</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; t(qr.Q(qr(A)))%*%qr.Q(qr(A))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; [,1] &nbsp; &nbsp; &nbsp; [,2] &nbsp; &nbsp; &nbsp; [,3] &nbsp; &nbsp; &nbsp; [,4]</font></div><div><font size="2"   >[1,] 1.000000e+00 -1.457168e-16 -6.760001e-17 -7.659550e-17</font></div><div><font size="2"   >[2,] -1.457168e-16 1.000000e+00 -4.269046e-17 7.011739e-17</font></div><div><font size="2"   >[3,] -6.760001e-17 -4.269046e-17 1.000000e+00 -1.596437e-16</font></div><div><font size="2"   >[4,] -7.659550e-17 7.011739e-17 -1.596437e-16 1.000000e+00</font></div><div><div><font size="2"   >&gt; round(t(qr.Q(qr(A)))%*%qr.Q(qr(A)))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;1 &nbsp; &nbsp;0 &nbsp; &nbsp;0 &nbsp; &nbsp;0</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;0 &nbsp; &nbsp;1 &nbsp; &nbsp;0 &nbsp; &nbsp;0</font></div><div><font size="2"   >[3,] &nbsp; &nbsp;0 &nbsp; &nbsp;0 &nbsp; &nbsp;1 &nbsp; &nbsp;0</font></div><div><font size="2"   >[4,] &nbsp; &nbsp;0 &nbsp; &nbsp;0 &nbsp; &nbsp;0 &nbsp; &nbsp;1</font></div></div><p></p></pre></div><div><br></div><div><span style="line-height: 28px;"   >qr.X(qr(A))也可以得到A</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; qr.X(qr(A))</font></div><div><font size="2"   >&nbsp; [,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] &nbsp; 1 &nbsp; 5 &nbsp; 9 &nbsp; 13</font></div><div><font size="2"   >[2,] &nbsp; 2 &nbsp; 6 &nbsp; 10 &nbsp; 14</font></div><div><font size="2"   >[3,] &nbsp; 3 &nbsp; 7 &nbsp; 11 &nbsp; 15</font></div><div><font size="2"   >[4,] &nbsp; 4 &nbsp; 8 &nbsp; 12 &nbsp; 16</font></div><p></p></pre></div></div><div><br></div><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://zh.wikipedia.org/zh-cn/QR%E5%88%86%E8%A7%A3"   >http://zh.wikipedia.org/zh-cn/QR%E5%88%86%E8%A7%A3</a></div><div>2.&nbsp;&gt; help(qr)</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >qr &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;package:base &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; R Documentation</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >The QR Decomposition of a Matrix</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Description:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘qr’ computes the QR decomposition of a matrix.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Usage:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qr(x, ...)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;## Default S3 method:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qr(x, tol = 1e-07 , LAPACK = FALSE, ...)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qr.coef(qr, y)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qr.qy(qr, y)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qr.qty(qr, y)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qr.resid(qr, y)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qr.fitted(qr, y, k = qr$rank)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qr.solve(a, b, tol = 1e-7)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;## S3 method for class 'qr'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;solve(a, b, ...)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;is.qr(x)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;as.qr(x)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >Arguments:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;x: a numeric or complex matrix whose QR decomposition is to be</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; computed. &nbsp;Logical matrices are coerced to numeric.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;tol: the tolerance for detecting linear dependencies in the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; columns of ‘x’. Only used if ‘LAPACK’ is false and ‘x’ is</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; real.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; qr: a QR decomposition of the type computed by ‘qr’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; y, b: a vector or matrix of right-hand sides of equations.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;a: a QR decomposition or (‘qr.solve’ only) a rectangular matrix.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;k: effective rank.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; LAPACK: logical. &nbsp;For real ‘x’, if true use LAPACK otherwise use</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LINPACK (the default).</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;...: further arguments passed to or from other methods</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Details:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;The QR decomposition plays an important role in many statistical</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;techniques. &nbsp;In particular it can be used to solve the equation Ax</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;= b for given matrix A, and vector b. &nbsp;It is useful for computing</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;regression coefficients and in applying the Newton-Raphson</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;algorithm.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;The functions ‘qr.coef’, ‘qr.resid’, and ‘qr.fitted’ return the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;coefficients, residuals and fitted values obtained when fitting</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘y’ to the matrix with QR decomposition ‘qr’. &nbsp;(If pivoting is</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;used, some of the coefficients will be ‘NA’.) &nbsp;‘qr.qy’ and</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘qr.qty’ return ‘Q %*% y’ and ‘t(Q) %*% y’, where ‘Q’ is the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;(complete) Q matrix.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;All the above functions keep ‘dimnames’ (and ‘names’) of ‘x’ and</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘y’ if there are any.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘solve.qr’ is the method for ‘solve’ for ‘qr’ objects. &nbsp;‘qr.solve’</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;solves systems of equations via the QR decomposition: if ‘a’ is a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;QR decomposition it is the same as ‘solve.qr’, but if ‘a’ is a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;rectangular matrix the QR decomposition is computed first. &nbsp;Either</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;will handle over- and under-determined systems, providing a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;least-squares fit if appropriate.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘is.qr’ returns ‘TRUE’ if ‘x’ is a ‘list’ with components named</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘qr’, ‘rank’ and ‘qraux’ and ‘FALSE’ otherwise.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;It is not possible to coerce objects to mode ‘"qr"’. &nbsp;Objects</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;either are QR decompositions or they are not.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;The LINPACK interface is restricted to matrices ‘x’ with less than</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;2^31 elements.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘qr.fitted’ and ‘qr.resid’ only support the LINPACK interface.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Value:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;The QR decomposition of the matrix as computed by LINPACK or</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;LAPACK. &nbsp;The components in the returned value correspond directly</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;to the values returned by DQRDC/DGEQP3/ZGEQP3.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; qr: a matrix with the same dimensions as ‘x’. &nbsp;The upper triangle</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; contains the R of the decomposition and the lower triangle</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; contains information on the Q of the decomposition (stored in</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; compact form). &nbsp;Note that the storage used by DQRDC and</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DGEQP3 differs.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;qraux: a vector of length ‘ncol(x)’ which contains additional</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; information on Q.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; rank: the rank of ‘x’ as computed by the decomposition: always full</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rank in the LAPACK case.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;pivot: information on the pivoting strategy used during the</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; decomposition.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Non-complex QR objects computed by LAPACK have the attribute</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘"useLAPACK"’ with value ‘TRUE’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Note:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;To compute the determinant of a matrix (do you _really_ need it?),</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;the QR decomposition is much more efficient than using Eigen</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;values (‘eigen’). &nbsp;See ‘det’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Using LAPACK (including in the complex case) uses column pivoting</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;and does not attempt to detect rank-deficient matrices.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Source:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;For ‘qr’, the LINPACK routine ‘DQRDC’ and the LAPACK routines</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘DGEQP3’ and ‘ZGEQP3’. &nbsp;Further LINPACK and LAPACK routines are</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;used for ‘qr.coef’, ‘qr.qy’ and ‘qr.aty’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;LAPACK and LINPACK are from &lt;URL: http://www.netlib.org/lapack&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;and &lt;URL: http://www.netlib.org/linpack&gt; and their guides are</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;listed in the references.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >References:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Anderson. E. and ten others (1999) _LAPACK Users' Guide_. Third</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Edition. SIAM.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Available on-line at &lt;URL:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;http://www.netlib.org/lapack/lug/lapack_lug.html&gt;.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) _The New S</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Language_. &nbsp;Wadsworth &amp; Brooks/Cole.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;Dongarra, J. J., Bunch, J. R., Moler, C. B. and Stewart, G. W.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;(1978) _LINPACK Users Guide._ Philadelphia: SIAM Publications.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >See Also:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘qr.Q’, ‘qr.R’, ‘qr.X’ for reconstruction of the matrices.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘lm.fit’, ‘lsfit’, ‘eigen’, ‘svd’.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;‘det’ (using ‘qr’) to compute the determinant of a matrix.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Examples:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;hilbert &lt;- function(n) { i &lt;- 1:n; 1 / outer(i - 1, i, "+") }</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;h9 &lt;- hilbert(9); h9</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qr(h9)$rank &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #--&gt; only 7</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qrh9 &lt;- qr(h9, tol = 1e-10)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qrh9$rank &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #--&gt; 9</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;##-- Solve linear equation system &nbsp;H %*% x = y :</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;y &lt;- 1:9/10</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;x &lt;- qr.solve(h9, y, tol = 1e-10) # or equivalently :</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;x &lt;- qr.coef(qrh9, y) #-- is == but much better than</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#-- solve(h9) %*% y</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;h9 %*% x &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# = y</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;## overdetermined system</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;A &lt;- matrix(runif(12), 4)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;b &lt;- 1:4</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qr.solve(A, b) # or solve(qr(A), b)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;solve(qr(A, LAPACK = TRUE), b)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;# this is a least-squares solution, cf. lm(b ~ 0 + A)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;## underdetermined system</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;A &lt;- matrix(runif(12), 3)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;b &lt;- 1:3</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;qr.solve(A, b)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;solve(qr(A, LAPACK = TRUE), b)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;# solutions will have one zero, not necessarily the same one</font></div><p></p></pre></div><div><br></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="使用qr()对矩阵QR分解 - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>