<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">a powerful upgrade from pgfincore 1.0</h2>
	<h5 id="">2011-07-30 23:35:39&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402011630102117658/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;">很久没有关注pgfincore的更新了，昨天Galy老师在群里发布了一条更新消息，我立马看了一下。<br>发现pgfincore 1.0 带来了几个令人振奋的函数。灰常有用。感谢Galy老师提供的信息。<br>&nbsp;&nbsp;&nbsp; 首先是pgfincore函数的更新,通过这个函数可以输出relation的文件系统每个页的缓存位图信息(是否缓存)。<br>&nbsp;&nbsp;&nbsp; 另一个是pgfadvise_loader函数，可以通过页位图信息操纵relation的文件系统的缓存（精细化的载入或清除文件系统缓存）。<br>&nbsp;&nbsp;&nbsp; 通过以上两个函数，可以记录下当前relation的页位图信息（活跃数据信息），保存到一个SNAPSHOT表，下次数据库启动的时候可以预先精细化的加载RELATION的文件系统页到系统缓存中。<br><br>下面举例来说明一下用法 : <br>首先是安装，我测试的时候使用的环境是PostgreSQL 9.1beta2 (9.1的模块安装已经改为create extension,所以安装方式和9.1以前有所不同，以前的安装方式可以参考我之前写的相关BLOG)<br>1. 下载pgfincore 1.0 ： http://villemain.org/projects/pgfincore<br>解压pgfincore-v1.0到以前编译postgresql的时候的软件目录.<br><pre class="prettyprint"   ><p><font size="2"   >[root@db5 pgfincore-v1.0]# ll<br>total 100<br>-rw-rw-r-- 1 postgres postgres&nbsp;&nbsp; 341 Jul 28 20:53 AUTHORS<br>-rw-rw-r-- 1 postgres postgres&nbsp; 2460 Jul 28 20:53 ChangeLog<br>-rw-rw-r-- 1 postgres postgres&nbsp; 1576 Jul 28 20:53 COPYRIGHT<br>drwxrwxr-x 3 postgres postgres&nbsp; 4096 Jul 28 20:53 debian<br>-rw-rw-r-- 1 postgres postgres&nbsp; 1041 Jul 28 20:53 Makefile<br>-rw-rw-r-- 1 postgres postgres&nbsp; 3867 Jul 30 21:15 pgfincore--1.0.sql<br>-rw-rw-r-- 1 postgres postgres 24231 Jul 28 20:53 pgfincore.c<br>-rw-rw-r-- 1 postgres postgres&nbsp;&nbsp; 154 Jul 28 20:53 pgfincore.control<br>-rwxrwxr-x 1 postgres postgres 17056 Jul 30 21:15 pgfincore.so<br>-rw-rw-r-- 1 postgres postgres 13483 Jul 28 20:53 README.rst<br>drwxrwxr-x 2 postgres postgres&nbsp; 4096 Jul 28 20:53 sql<br>-rw-rw-r-- 1 postgres postgres&nbsp;&nbsp; 170 Jul 28 20:53 TODO<br>[root@db5 pgfincore-v1.0]# pwd<br>/opt/soft_bak/postgresql-9.1beta2/contrib/pgfincore-v1.0<br>,另外需要做一个操作(手册上没有提及,可能是个BUG)<br>cp /opt/soft_bak/postgresql-9.1beta2/contrib/pgfincore-v1.0/sql/pgfincore--unpackaged--1.0.sql /opt/soft_bak/postgresql-9.1beta2/contrib/pgfincore-v1.0<br>否则会报错 /opt/pgsql/lib/pgxs/src/makefiles/../../config/install-sh: ./pgfincore--unpackaged--1.0.sql does not exist.</font></p></pre>然后,编译<br><pre class="prettyprint"   ><p><font size="2"   >&nbsp; su - postgres<br>&nbsp; cd /opt/soft_bak/postgresql-9.1beta2/contrib/pgfincore-v1.0<br>&nbsp; gmake USE_PGXS=1 clean<br>&nbsp; gmake USE_PGXS=1<br>&nbsp; su - root<br>&nbsp; cd /opt/soft_bak/postgresql-9.1beta2/contrib/pgfincore-v1.0<br>&nbsp; . /home/postgres/.bash_profile<br>&nbsp; gmake USE_PGXS=1 install</font></p></pre><br>2. 加载extension<br><pre class="prettyprint"   ><p><font size="2"   >postgres@db5-&gt; psql -h 127.0.0.1 digoal postgres<br>psql (9.1beta2)<br>digoal=# create EXTENSION pgfincore;<br>digoal=# select * from pg_extension ;<br>&nbsp;&nbsp;&nbsp;&nbsp; extname&nbsp;&nbsp;&nbsp;&nbsp; | extowner | extnamespace | extrelocatable | extversion | extconfig | extcondition <br>-----------------+----------+--------------+----------------+------------+-----------+--------------<br>&nbsp;pgfincore&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2200 | t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 1.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </font></p></pre><br>3. 使用<br># 为了能让测试的时候不受PostgreSQL自身的shared buffers的干扰,先把PostgreSQL的shared_buffers设置小一点。<br><pre class="prettyprint"   ><p><font size="2"   >postgres@db5-&gt; cd $PGDATA<br>postgres@db5-&gt; vi postgresql.conf <br>shared_buffers = 64MB<br>pg_ctl stop -m fast<br>pg_ctl start</font></p></pre><br># 接下来新建测试数据,测试数据量大于64M，防止shared_buffers干扰。<br><pre class="prettyprint"   ><p><font size="2"   >postgres@db5-&gt; psql -h 127.0.0.1 digoal digoal<br>digoal=&gt; create table user_info(id bigint,firstname text,lastname text,corp text,post text,age int,crt_time timestamp without time zone,comment text);<br>digoal=&gt; insert into user_info(id,firstname,lastname,corp,post,age,crt_time,comment) select generate_series(1,10000000),'zhou','digoal'||generate_series(2,10000001),'sky-mobi','dba team leader',28,clock_timestamp(),'abcdefg'||generate_series(3,10000002);<br>digoal=&gt; select pg_relation_size('user_info'::regclass)/1024/1024||' MB';<br>&nbsp;?column? <br>----------<br>&nbsp;1698 MB</font></p></pre><br>4. 查询user_info占用了多少个文件系统页。<br><pre class="prettyprint"   ><p><font size="2"   >digoal=&gt; select * from pgfincore('user_info'::regclass);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relpath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | segment | os_page_size | rel_os_pages | pages_mem | group_mem | os_pages_free | data<br>bit <br>----------------------------------------------+---------+--------------+--------------+-----------+-----------+---------------+-----<br>----<br>&nbsp;pg_tblspc/16385/PG_9.1_201105231/16386/90956 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4096 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 434798 |&nbsp;&nbsp;&nbsp; 434798 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1177644 | <br>(1 row)</font></p></pre>os_page_size表示文件系统页的SIZE，单位字节。<br>rel_os_pages表示占用了多少个文件系统页。<br>(rel_os_pages乘以os_page_size结果就等于pg_relation_size('user_info'::regclass)返回的SIZE。)<br>pages_mem表示有多少个文件系统页在操作系统的CACHE里面。<br>databit 就是页位图信息，比特长度等于os_page_size，也就是说每一个文件系统页在这里占用一个比特位。<br>比特位的值0表示这个页没有在OS CACHE里面，1表示这个页在OS CACHE里面。从上门我们查看到的rel_os_pages的结果与pages_mem相等，表示这个表所有的页都在文件系统CACHE里面，比特位的值都等于1.<br>如:<br><pre class="prettyprint"   ><p><font size="2"   >digoal=&gt; select bit_length(databit) from pgfincore('user_info'::regclass,true);<br>&nbsp;bit_length <br>------------<br>&nbsp;&nbsp;&nbsp;&nbsp; 434798</font></p></pre><br>5. 把user_info表的页缓存全部清除掉。<br>首先要获取segment和databit的信息，来自pgfincore('user_info'::regclass,true)函数的输出。<br>然后要把databit的等于1的比特位全部反转为0，并且允许UNLOAD，但是不允许LOAD。<br><pre class="prettyprint"   ><p><font size="2"   >digoal=&gt; select pgfadvise_loader('user_info'::regclass,segment,false,true,bitnot(databit)) from (select segment,databit from pgfincore('user_info'::regclass,true)) as t;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pgfadvise_loader&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>----------------------------------------------------------------------<br>&nbsp;(pg_tblspc/16385/PG_9.1_201105231/16386/90956,4096,1611667,0,434798)<br>(1 row)<br>Time: 883.412 ms<br>digoal=&gt; select * from pgfincore('user_info'::regclass);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relpath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | segment | os_page_size | rel_os_pages | pages_mem | group_mem | os_pages_free | data<br>bit <br>----------------------------------------------+---------+--------------+--------------+-----------+-----------+---------------+-----<br>----<br>&nbsp;pg_tblspc/16385/PG_9.1_201105231/16386/90956 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4096 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 434798 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1611667 | <br>(1 row)<br>Time: 21.345 ms</font></p></pre>执行完后，user_info的文件系统层缓存就被全部清除了。这个时候去执行select count(*) from user_info;的话就全部物理IO。<br><p></p><pre class="prettyprint"   ><p></p><p><font size="2"   >digoal=&gt; select count(*) from user_info;<br>&nbsp; count&nbsp;&nbsp; <br>----------<br>&nbsp;10000000<br>(1 row)</font></p><font size="2"   >Time: 25609.348 ms </font><p></p></pre>在另一个SSH窗口监控操作系统的IO，可以看到物理IO的产生。<br><pre class="prettyprint"   ><p><font size="2"   >postgres@db5-&gt; vmstat -n 1<br> procs -----------memory---------- ---swap-- -----io---- --system-- -----cpu------<br> &nbsp;r&nbsp; b&nbsp;&nbsp; swpd&nbsp;&nbsp; free&nbsp;&nbsp; buff&nbsp; cache&nbsp;&nbsp; si&nbsp;&nbsp; so&nbsp;&nbsp;&nbsp; bi&nbsp;&nbsp;&nbsp; bo&nbsp;&nbsp; in&nbsp;&nbsp; cs us sy id wa st<br> &nbsp;1&nbsp; 1&nbsp; 18092 6432696 470456 9065288&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 19972&nbsp;&nbsp;&nbsp;&nbsp; 4 1340&nbsp; 646&nbsp; 0&nbsp; 0 96&nbsp; 3&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 6358956 470456 9139008&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 73600&nbsp;&nbsp;&nbsp;&nbsp; 0 2190 1505&nbsp; 1&nbsp; 1 88 11&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 6284736 470456 9213184&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 74240&nbsp;&nbsp;&nbsp;&nbsp; 0 2185 1449&nbsp; 1&nbsp; 1 87 11&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 6213456 470456 9284576&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 71296&nbsp;&nbsp;&nbsp; 12 2145 1455&nbsp; 1&nbsp; 1 86 12&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 6142296 470456 9355616&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 71168&nbsp;&nbsp;&nbsp; 56 2117 1587&nbsp; 1&nbsp; 1 87 12&nbsp; 0<br> &nbsp;1&nbsp; 1&nbsp; 18092 6078156 470460 9419632&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 64128&nbsp;&nbsp;&nbsp; 96 2038 1331&nbsp; 1&nbsp; 1 86 13&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 6003396 470460 9494404&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 74752&nbsp;&nbsp;&nbsp;&nbsp; 0 2180 1499&nbsp; 1&nbsp; 1 87 11&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 5929536 470460 9568124&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 73856&nbsp;&nbsp;&nbsp;&nbsp; 0 2181 1495&nbsp; 1&nbsp; 1 88 11&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 5866464 470468 9630988&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 62720&nbsp;&nbsp;&nbsp; 80 2012 1437&nbsp; 1&nbsp; 1 87 12&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 5797700 470468 9699664&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 68608&nbsp;&nbsp;&nbsp; 56 2102 1524&nbsp; 1&nbsp; 1 87 12&nbsp; 0<br> &nbsp;1&nbsp; 1&nbsp; 18092 5725400 470468 9771780&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 72320&nbsp;&nbsp;&nbsp;&nbsp; 0 2160 1519&nbsp; 1&nbsp; 1 88 11&nbsp; 0<br> &nbsp;1&nbsp; 0&nbsp; 18092 5655860 470468 9841620&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 69504&nbsp;&nbsp;&nbsp;&nbsp; 0 1714 1406&nbsp; 1&nbsp; 1 87 11&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 5585120 470468 9912168&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 70784&nbsp;&nbsp;&nbsp;&nbsp; 0 1615 1442&nbsp; 1&nbsp; 1 88 11&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 5518280 470468 9978904&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 66816&nbsp;&nbsp;&nbsp; 16 1578 1380&nbsp; 1&nbsp; 1 87 11&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 5453784 470468 10043692&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 64640&nbsp;&nbsp;&nbsp; 56 1567 1372&nbsp; 1&nbsp; 1 87 12&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 5382864 470468 10114696&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 70912&nbsp;&nbsp;&nbsp;&nbsp; 0 1609 1447&nbsp; 1&nbsp; 1 88 11&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 5312844 470468 10184676&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 70016&nbsp;&nbsp;&nbsp;&nbsp; 0 1611 1443&nbsp; 1&nbsp; 1 88 11&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 5245644 470468 10251800&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 67200&nbsp;&nbsp;&nbsp;&nbsp; 0 1589 1385&nbsp; 1&nbsp; 1 88 11&nbsp; 0<br> &nbsp;1&nbsp; 0&nbsp; 18092 5180844 470468 10316472&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 64896&nbsp;&nbsp;&nbsp;&nbsp; 0 1574 1358&nbsp; 1&nbsp; 0 88 11&nbsp; 0<br> &nbsp;0&nbsp; 2&nbsp; 18092 5113164 470468 10384372&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 67584&nbsp;&nbsp;&nbsp; 56 1589 1404&nbsp; 1&nbsp; 1 87 12&nbsp; 0<br> &nbsp;1&nbsp; 1&nbsp; 18092 5051484 470468 10445868&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 61696&nbsp;&nbsp;&nbsp;&nbsp; 0 1548 1322&nbsp; 1&nbsp; 1 87 11&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 4983744 470468 10513768&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 67712&nbsp;&nbsp;&nbsp;&nbsp; 0 1589 1391&nbsp; 1&nbsp; 1 88 11&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 4919004 470468 10578628&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 64768&nbsp;&nbsp;&nbsp;&nbsp; 0 1567 1357&nbsp; 1&nbsp; 1 88 11&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 4856544 470468 10641096&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 62464&nbsp;&nbsp;&nbsp;&nbsp; 0 1560 1337&nbsp; 1&nbsp; 1 88 11&nbsp; 0<br> &nbsp;0&nbsp; 2&nbsp; 18092 4794084 470468 10703408&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 62464&nbsp;&nbsp;&nbsp; 56 1550 1331&nbsp; 1&nbsp; 1 87 12&nbsp; 0<br> &nbsp;0&nbsp; 1&nbsp; 18092 4733124 470468 10764324&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 60928&nbsp;&nbsp;&nbsp;&nbsp; 0 1543 1297&nbsp; 1&nbsp; 0 87 11&nbsp; 0<br> &nbsp;0&nbsp; 0&nbsp; 18092 4714824 470468 10782704&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 18304&nbsp;&nbsp;&nbsp;&nbsp; 0 1182&nbsp; 604&nbsp; 0&nbsp; 0 96&nbsp; 3&nbsp; 0</font></p></pre><br>再次查看这个表的CACHE信息。因为此前没有使用pgfadvise_willneed,所以CACHE被冲走了一部分，只有434337 。<br><pre class="prettyprint"   ><p><font size="2"   >digoal=&gt; select * from pgfincore('user_info'::regclass);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relpath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | segment | os_page_size | rel_os_pages | pages_mem | group_mem | os_pages_free | data<br>bit <br>----------------------------------------------+---------+--------------+--------------+-----------+-----------+---------------+-----<br>----<br>&nbsp;pg_tblspc/16385/PG_9.1_201105231/16386/90956 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4096 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 434798 |&nbsp;&nbsp;&nbsp; 434337 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1178706 | <br>(1 row)<br><br>Time: 106.333 ms<br>digoal=&gt; select * from pgfadvise_willneed('user_info'::regclass);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relpath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | os_page_size | rel_os_pages | os_pages_free <br>----------------------------------------------+--------------+--------------+---------------<br>&nbsp;pg_tblspc/16385/PG_9.1_201105231/16386/90956 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4096 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 434798 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1178041<br>(1 row)<br><br>Time: 7.542 ms<br>digoal=&gt; select * from pgfincore('user_info'::regclass);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relpath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | segment | os_page_size | rel_os_pages | pages_mem | group_mem | os_pages_free | data<br>bit <br>----------------------------------------------+---------+--------------+--------------+-----------+-----------+---------------+-----<br>----<br>&nbsp;pg_tblspc/16385/PG_9.1_201105231/16386/90956 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4096 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 434798 |&nbsp;&nbsp;&nbsp; 434798 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1177979 | <br>(1 row)<br><br>Time: 106.427 ms</font></p></pre>再次执行count(*)速度就块了。<br><pre class="prettyprint"   ><p><font size="2"   >digoal=&gt; select count(*) from user_info;<br>&nbsp; count&nbsp;&nbsp; <br>----------<br>&nbsp;10000000<br>(1 row)<br>Time: 2542.474 ms</font></p></pre><br>6. 实现snapshot的功能。<br>说白了就是保存信息供给pgfadvise_loader调用,调用时允许加载和清除OS CACHE。<br>测试之前，先手工清除掉一部分OS CACHE信息。<br><pre class="prettyprint"   ><p><font size="2"   >digoal=&gt; select pgfadvise_loader('user_info'::regclass,0,false,true,B'0000000000000000000') ;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pgfadvise_loader&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>------------------------------------------------------------------<br>&nbsp;(pg_tblspc/16385/PG_9.1_201105231/16386/90956,4096,1177458,0,19)<br>(1 row)<br>Time: 0.511 ms<br>digoal=&gt; select pgfadvise_loader('user_info'::regclass,0,false,true,B'0000000000000000000') ;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pgfadvise_loader&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>------------------------------------------------------------------<br>&nbsp;(pg_tblspc/16385/PG_9.1_201105231/16386/90956,4096,1177520,0,19)<br>(1 row)<br>Time: 0.269 ms<br>digoal=&gt; select pgfadvise_loader('user_info'::regclass,0,false,true,B'0000000000000000000') ;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pgfadvise_loader&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>------------------------------------------------------------------<br>&nbsp;(pg_tblspc/16385/PG_9.1_201105231/16386/90956,4096,1177520,0,19)<br>(1 row)<br>Time: 0.313 ms<br>digoal=&gt; <br>digoal=&gt; select * from pgfincore('user_info'::regclass);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relpath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | segment | os_page_size | rel_os_pages | pages_mem | group_mem | os_pages_free | data<br>bit <br>----------------------------------------------+---------+--------------+--------------+-----------+-----------+---------------+-----<br>----<br>&nbsp;pg_tblspc/16385/PG_9.1_201105231/16386/90956 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4096 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 434798 |&nbsp;&nbsp;&nbsp; 434741 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1177489 | <br>(1 row)<br>Time: 106.345 ms</font></p></pre>现在只缓存了434741 个页面。<br>把现在的信息做一个SNAPSHOT。等会重启数据库后，预加载执行完也将看到缓存了434741 个页面。<br><pre class="prettyprint"   ><p><font size="2"   >digoal=&gt; create table pgfincore_snap_user_info as select * from pgfincore('user_info'::regclass,true);<br>SELECT 1<br>Time: 139.425 ms</font></p></pre>好了，现在把user_info表的OS CACHE都清除掉，然后关闭数据库。<br><pre class="prettyprint"   ><p><font size="2"   >digoal=&gt; select pgfadvise_loader('user_info'::regclass,segment,false,true,bitnot(databit)) from (select segment,databit from pgfincore('user_info'::regclass,true)) as t;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pgfadvise_loader&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>----------------------------------------------------------------------<br>&nbsp;(pg_tblspc/16385/PG_9.1_201105231/16386/90956,4096,1612768,0,434741)<br>(1 row)<br><br>Time: 887.642 ms<br>postgres@db5-&gt; pg_ctl stop -m fast<br>waiting for server to shut down.... done<br>server stopped</font></p></pre>启动数据库，先查看一下当前的user_info表的OS CACHE信息，以免干扰结果。预加载刚才保留的SNAPSHOT。<br><pre class="prettyprint"   ><p><font size="2"   >postgres@db5-&gt; pg_ctl start<br>server starting<br>postgres@db5-&gt; psql -h 127.0.0.1 digoal digoal<br>psql (9.1beta2)<br>Type "help" for help.<br><br>digoal=&gt; select * from pgfincore('user_info'::regclass);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relpath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | segment | os_page_size | rel_os_pages | pages_mem | group_mem | os_pages_free | data<br>bit <br>----------------------------------------------+---------+--------------+--------------+-----------+-----------+---------------+-----<br>----<br>&nbsp;pg_tblspc/16385/PG_9.1_201105231/16386/90956 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4096 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 434798 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1581057 | <br>(1 row)<br><br>digoal=&gt; select pgfadvise_loader('user_info'::regclass,segment,true,true,databit) from pgfincore_snap_user_info;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pgfadvise_loader&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>-----------------------------------------------------------------------<br>&nbsp;(pg_tblspc/16385/PG_9.1_201105231/16386/90956,4096,1146177,434741,57)<br>(1 row)<br><br>digoal=&gt; select * from pgfincore('user_info'::regclass);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; relpath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | segment | os_page_size |  rel_os_pages | pages_mem | group_mem | os_pages_free | data<br> bit <br> ----------------------------------------------+---------+--------------+--------------+-----------+-----------+---------------+-----<br> ----<br> &nbsp;pg_tblspc/16385/PG_9.1_201105231/16386/90956 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4096 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 434798 |&nbsp;&nbsp;&nbsp; 434741 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1146144 | <br> (1 row)</font></p></pre>测试结果表明加载了434741个页面,清除了57个页面。(注意这里的数字只是对BIT信息的一个反馈，如果事先OS层的CACHE已经加载了，则这里不会重复加载，但是数字还是显示这个数字。包括清除也是一样，如果此前就没有在cache里面，那也不会重复清除，但是数字还是显示这个数字)<br>例如，再执行一遍还是这个结果。<br><pre class="prettyprint"   ><p><font size="2"   >digoal=&gt; select pgfadvise_loader('user_info'::regclass,segment,true,true,databit) from pgfincore_snap_user_info;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pgfadvise_loader&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>-----------------------------------------------------------------------<br>&nbsp;(pg_tblspc/16385/PG_9.1_201105231/16386/90956,4096,1146115,434741,57)<br>(1 row)</font></p></pre><br>【参考】<br><a target="_blank" rel="nofollow" href="http://villemain.org/projects/pgfincore"   >http://villemain.org/projects/pgfincore</a><br><br>【语法】<br><pre class="prettyprint"   ><p><font size="2"   >SYNOPSIS<br>========<br><br>::<br><br>&nbsp;&nbsp; pgsysconf(OUT os_page_size bigint, OUT os_pages_free bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT os_total_pages bigint)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS record<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp; pgsysconf_pretty(OUT os_page_size text, OUT os_pages_free text,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT os_total_pages text)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS record<br><br>&nbsp;&nbsp; pgfadvise(IN relname regclass, IN fork text, IN action int,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT relpath text, OUT os_page_size bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT rel_os_pages bigint, OUT os_pages_free bigint)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS setof record<br><br>&nbsp;&nbsp; pgfadvise_willneed(IN relname regclass,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT relpath text, OUT os_page_size bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT rel_os_pages bigint, OUT os_pages_free bigint)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS setof record<br><br>&nbsp;&nbsp; pgfadvise_dontneed(IN relname regclass,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT relpath text, OUT os_page_size bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT rel_os_pages bigint, OUT os_pages_free bigint)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS setof record<br><br>&nbsp;&nbsp; pgfadvise_normal(IN relname regclass,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT relpath text, OUT os_page_size bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT rel_os_pages bigint, OUT os_pages_free bigint)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS setof record<br><br>&nbsp;&nbsp; pgfadvise_sequential(IN relname regclass,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT relpath text, OUT os_page_size bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT rel_os_pages bigint, OUT os_pages_free bigint)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS setof record<br><br>&nbsp;&nbsp; pgfadvise_random(IN relname regclass,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT relpath text, OUT os_page_size bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT rel_os_pages bigint, OUT os_pages_free bigint)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS setof record<br><br>&nbsp;&nbsp; pgfadvise_loader(IN relname regclass, IN fork text, IN segment int,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IN load bool, IN unload bool, IN databit varbit,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT relpath text, OUT os_page_size bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT os_pages_free bigint, OUT pages_loaded bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT pages_unloaded bigint)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS setof record<br><br>&nbsp;&nbsp; pgfadvise_loader(IN relname regclass, IN segment int,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IN load bool, IN unload bool, IN databit varbit,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT relpath text, OUT os_page_size bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT os_pages_free bigint, OUT pages_loaded bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT pages_unloaded bigint)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS setof record<br><br>&nbsp;&nbsp; pgfincore(IN relname regclass, IN fork text, IN getdatabit bool,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT relpath text, OUT segment int, OUT os_page_size bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT rel_os_pages bigint, OUT pages_mem bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT group_mem bigint, OUT os_pages_free bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT databit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; varbit)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS setof record<br><br>&nbsp;&nbsp; pgfincore(IN relname regclass, IN getdatabit bool,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT relpath text, OUT segment int, OUT os_page_size bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT rel_os_pages bigint, OUT pages_mem bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT group_mem bigint, OUT os_pages_free bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT databit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; varbit)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS setof record<br><br>&nbsp;&nbsp; pgfincore(IN relname regclass,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT relpath text, OUT segment int, OUT os_page_size bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT rel_os_pages bigint, OUT pages_mem bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT group_mem bigint, OUT os_pages_free bigint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT databit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; varbit)<br>&nbsp;&nbsp;&nbsp;&nbsp; RETURNS setof record</font></p></pre>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="a powerful upgrade from pgfincore 1.0 - 德哥@Digoal - PostgreSQL"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>