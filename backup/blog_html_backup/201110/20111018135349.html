<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL use redis_fdw connect to Redis</h2>
	<h5 id="">2011-10-18 13:53:49&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020119181188247/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><a target="_blank" rel="nofollow" href="https://wiki.postgresql.org/wiki/Foreign_data_wrappers"   >https://wiki.postgresql.org/wiki/Foreign_data_wrappers</a></div><wbr>首先要感谢Dave先生的贡献才有了redis_fdw。Dave贡献了两个FDW模块，mysql_fdw和redis_fdw分别用于PostgreSQL9.1连接到MySQL和Redis。<div>接下来通过redis_fdw来测试一下PostgreSQL 9.1是怎么连接到Redis的。</div><div>首先到<a rel="nofollow" href="http://redis.io/"   >http://redis.io</a>下载一个redis2.4.1的稳定版源码。</div><div>安装参考README</div><div><br></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@digoal redis-2.4.1]# tar -zxvf redis-2.4.1.tar.gz</font></div><div><font size="2"   >[root@digoal redis-2.4.1]# cd redis-2.4.1</font></div><div><font size="2"   >[root@digoal redis-2.4.1]# make</font></div><div><font size="2"   >[root@digoal redis-2.4.1]# vi redis.conf</font></div><p></p></pre></div><div>加上密码校验，并放置后台运行，用作测试其他参数不修改了。</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >daemonize yes</font></div><div><font size="2"   >requirepass DIGOAL</font></div><p></p></pre></div><div>启动redis</div><div><pre class="prettyprint"   ><p><font size="2"   >[root@digoal redis-2.4.1]# src/redis-server ./redis.conf&nbsp;</font></p></pre></div><div>确认已启动</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@digoal redis-2.4.1]# netstat -anp|grep 6379</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:6379 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;26647/redis-server&nbsp;</font></div><p></p></pre></div><div>接下来在另一台PostgreSQL数据库服务器上配置redis_fdw.</div><div>首先是下载redis_fdw&nbsp;<a rel="nofollow" href="http://www.pgxn.org/user/pgsnake"   >http://www.pgxn.org/user/pgsnake</a></div><div>解压到postgresql源码包的 postgresql-9.1.0/contrib/ 目录</div><div>然后把redis-2.4.1/deps/hiredis 目录拷贝到&nbsp;postgresql-9.1.0/contrib/redis_fdw-1.0.0</div><div>接下来编译hiredis</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >cd hiredis</font></div><div><font size="2"   >make</font></div><div><font size="2"   >make install</font></div><p></p></pre></div><div>确认安装OK之后。编译redis_fdw</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@digoal redis_fdw-1.0.0]# . /home/postgres/.bash_profile</font></div><div><font size="2"   >(导入两个环境变量 PATH, LD_LIBRARY_PATH)</font></div><div><font size="2"   >PATH和LD_LIBRARY_PATH如下 : <br>export PGHOME=/opt/pgsql91<br>export LD_LIBRARY_PATH=$PGHOME/lib:/lib64:/usr/lib64:/usr/local/lib64:/lib:/usr/lib:/usr/local/lib<br>export PATH=$PGHOME/bin:$PATH:.</font></div><div><font size="2"   ><font color="#880000"   ><span style="line-height: 21px;"   ><br></span></font></font></div><div><font size="2"   >[root@digoal redis_fdw-1.0.0]#&nbsp;USE_PGXS=1 make clean</font></div><div><font size="2"   >[root@digoal redis_fdw-1.0.0]#&nbsp;USE_PGXS=1 make</font></div><div><font size="2"   >[root@digoal redis_fdw-1.0.0]#&nbsp;USE_PGXS=1 make install</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >-- 以下步骤可能可以省略, 如果没有才需要拷贝.</font></div><div><font size="2"   >[root@digoal redis_fdw-1.0.0]#&nbsp;cp&nbsp;redis_fdw.so /opt/pgsql/lib/</font></div><div><font size="2"   >[root@digoal redis_fdw-1.0.0]#&nbsp;cp&nbsp;redis_fdw--1.0.sql /opt/pgsql/share/extension/</font></div><div><font size="2"   >[root@digoal redis_fdw-1.0.0]#&nbsp;cp&nbsp;redis_fdw.control&nbsp;/opt/pgsql/share/extension/</font></div><p></p></pre></div><div><br></div><div>OK，至此就算安装好了。</div><div><br></div><div>接下来体验一下。</div><div>先到PostgreSQL数据库里面创建redis_fdw这个extension .&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >psql -h 127.0.0.1 digoal postgres</font></div><div><font size="2"   >psql (9.1.0)</font></div><div><font size="2"   >Type "help" for help.</font></div><div><font size="2"   >digoal=# create extension redis_fdw;</font></div><p></p></pre></div><div><br></div><div>然后到redis服务端插入一些数据。</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >vi ins.sh</font></div><div><div><font size="2"   >&nbsp;set visits:digoal1:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1</font></div><div><font size="2"   >&nbsp;set visits:digoal2:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2</font></div><div><font size="2"   >&nbsp;set visits:digoal3:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3</font></div><div><font size="2"   >&nbsp;set visits:digoal4:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4</font></div><div><font size="2"   >&nbsp;set visits:digoal5:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5</font></div><div><font size="2"   >&nbsp;set visits:digoal6:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6</font></div><div><font size="2"   >&nbsp;set visits:digoal7:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7</font></div><div><font size="2"   >&nbsp;set visits:digoal8:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8</font></div><div><font size="2"   >&nbsp;set visits:digoal9:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 9</font></div><div><font size="2"   >&nbsp;set visits:digoal10:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10</font></div><div><font size="2"   >&nbsp;set visits:digoal11:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11</font></div><div><font size="2"   >&nbsp;set visits:digoal12:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12</font></div><div><font size="2"   >&nbsp;set visits:digoal13:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13</font></div><div><font size="2"   >&nbsp;set visits:digoal14:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14</font></div><div><font size="2"   >&nbsp;set visits:digoal15:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 15</font></div><div><font size="2"   >&nbsp;set visits:digoal16:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16</font></div><div><font size="2"   >&nbsp;set visits:digoal17:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 17</font></div><div><font size="2"   >&nbsp;set visits:digoal18:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 18</font></div><div><font size="2"   >&nbsp;set visits:digoal19:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 19</font></div><div><font size="2"   >&nbsp;set visits:digoal20:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 20</font></div><div><font size="2"   >&nbsp;set visits:digoal21:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21</font></div><div><font size="2"   >&nbsp;set visits:digoal22:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 22</font></div><div><font size="2"   >&nbsp;set visits:digoal23:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 23</font></div><div><font size="2"   >&nbsp;set visits:digoal24:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 24</font></div><div><font size="2"   >&nbsp;set visits:digoal25:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 25</font></div><div><font size="2"   >&nbsp;set visits:digoal26:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 26</font></div><div><font size="2"   >&nbsp;set visits:digoal27:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 27</font></div><div><font size="2"   >&nbsp;set visits:digoal28:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 28</font></div><div><font size="2"   >&nbsp;set visits:digoal29:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 29</font></div><div><font size="2"   >&nbsp;set visits:digoal30:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 30</font></div><div><font size="2"   >&nbsp;set visits:digoal31:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 31</font></div><div><font size="2"   >&nbsp;set visits:digoal32:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 32</font></div><div><font size="2"   >&nbsp;set visits:digoal33:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 33</font></div><div><font size="2"   >&nbsp;set visits:digoal34:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 34</font></div><div><font size="2"   >&nbsp;set visits:digoal35:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 35</font></div><div><font size="2"   >&nbsp;set visits:digoal36:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 36</font></div><div><font size="2"   >&nbsp;set visits:digoal37:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 37</font></div><div><font size="2"   >&nbsp;set visits:digoal38:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 38</font></div><div><font size="2"   >&nbsp;set visits:digoal39:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 39</font></div><div><font size="2"   >&nbsp;set visits:digoal40:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 40</font></div><div><font size="2"   >&nbsp;set visits:digoal41:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 41</font></div><div><font size="2"   >&nbsp;set visits:digoal42:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 42</font></div><div><font size="2"   >&nbsp;set visits:digoal43:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 43</font></div><div><font size="2"   >&nbsp;set visits:digoal44:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 44</font></div><div><font size="2"   >&nbsp;set visits:digoal45:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 45</font></div><div><font size="2"   >&nbsp;set visits:digoal46:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 46</font></div><div><font size="2"   >&nbsp;set visits:digoal47:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 47</font></div><div><font size="2"   >&nbsp;set visits:digoal48:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 48</font></div><div><font size="2"   >&nbsp;set visits:digoal49:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 49</font></div><div><font size="2"   >&nbsp;set visits:digoal50:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 50</font></div><div><font size="2"   >&nbsp;set visits:digoal51:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 51</font></div><div><font size="2"   >&nbsp;set visits:digoal52:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 52</font></div><div><font size="2"   >&nbsp;set visits:digoal53:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 53</font></div><div><font size="2"   >&nbsp;set visits:digoal54:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 54</font></div><div><font size="2"   >&nbsp;set visits:digoal55:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 55</font></div><div><font size="2"   >&nbsp;set visits:digoal56:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 56</font></div><div><font size="2"   >&nbsp;set visits:digoal57:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 57</font></div><div><font size="2"   >&nbsp;set visits:digoal58:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 58</font></div><div><font size="2"   >&nbsp;set visits:digoal59:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 59</font></div><div><font size="2"   >&nbsp;set visits:digoal60:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 60</font></div><div><font size="2"   >&nbsp;set visits:digoal61:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 61</font></div><div><font size="2"   >&nbsp;set visits:digoal62:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 62</font></div><div><font size="2"   >&nbsp;set visits:digoal63:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 63</font></div><div><font size="2"   >&nbsp;set visits:digoal64:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 64</font></div><div><font size="2"   >&nbsp;set visits:digoal65:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 65</font></div><div><font size="2"   >&nbsp;set visits:digoal66:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 66</font></div><div><font size="2"   >&nbsp;set visits:digoal67:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 67</font></div><div><font size="2"   >&nbsp;set visits:digoal68:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 68</font></div><div><font size="2"   >&nbsp;set visits:digoal69:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 69</font></div><div><font size="2"   >&nbsp;set visits:digoal70:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 70</font></div><div><font size="2"   >&nbsp;set visits:digoal71:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 71</font></div><div><font size="2"   >&nbsp;set visits:digoal72:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 72</font></div><div><font size="2"   >&nbsp;set visits:digoal73:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 73</font></div><div><font size="2"   >&nbsp;set visits:digoal74:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 74</font></div><div><font size="2"   >&nbsp;set visits:digoal75:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 75</font></div><div><font size="2"   >&nbsp;set visits:digoal76:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 76</font></div><div><font size="2"   >&nbsp;set visits:digoal77:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 77</font></div><div><font size="2"   >&nbsp;set visits:digoal78:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 78</font></div><div><font size="2"   >&nbsp;set visits:digoal79:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 79</font></div><div><font size="2"   >&nbsp;set visits:digoal80:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 80</font></div><div><font size="2"   >&nbsp;set visits:digoal81:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 81</font></div><div><font size="2"   >&nbsp;set visits:digoal82:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 82</font></div><div><font size="2"   >&nbsp;set visits:digoal83:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 83</font></div><div><font size="2"   >&nbsp;set visits:digoal84:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 84</font></div><div><font size="2"   >&nbsp;set visits:digoal85:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 85</font></div><div><font size="2"   >&nbsp;set visits:digoal86:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 86</font></div><div><font size="2"   >&nbsp;set visits:digoal87:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 87</font></div><div><font size="2"   >&nbsp;set visits:digoal88:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 88</font></div><div><font size="2"   >&nbsp;set visits:digoal89:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 89</font></div><div><font size="2"   >&nbsp;set visits:digoal90:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 90</font></div><div><font size="2"   >&nbsp;set visits:digoal91:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 91</font></div><div><font size="2"   >&nbsp;set visits:digoal92:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 92</font></div><div><font size="2"   >&nbsp;set visits:digoal93:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 93</font></div><div><font size="2"   >&nbsp;set visits:digoal94:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 94</font></div><div><font size="2"   >&nbsp;set visits:digoal95:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 95</font></div><div><font size="2"   >&nbsp;set visits:digoal96:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 96</font></div><div><font size="2"   >&nbsp;set visits:digoal97:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 97</font></div><div><font size="2"   >&nbsp;set visits:digoal98:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 98</font></div><div><font size="2"   >&nbsp;set visits:digoal99:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 99</font></div><div><font size="2"   >&nbsp;set visits:digoal100:totals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 100</font></div></div><p></p></pre></div><div>导入到库0和库1</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@digoal src]# cat ./ins.sh|./redis-cli -h 127.0.0.1 -p 6379 -a DIGOAL -n 0</font></div><div><font size="2"   >[root@digoal src]# cat ./ins.sh|./redis-cli -h 127.0.0.1 -p 6379 -a DIGOAL -n 1</font></div><p></p></pre></div><div><br></div><div>接下来在PostgreSQL数据库创建连接REDIS的外部表：</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >digoal=# CREATE SERVER redis_server1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >FOREIGN DATA WRAPPER redis_fdw&nbsp;</font></div><div><font size="2"   >OPTIONS (address '172.xxx.xxx.xxx', port '6379');</font></div></div><div><div><font size="2"   >digoal=# CREATE USER MAPPING FOR digoal &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >SERVER redis_server1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >OPTIONS (password 'DIGOAL');</font></div><div><font size="2"   >CREATE USER MAPPING</font></div></div><div><div><font size="2"   >digoal=# grant usage on FOREIGN server redis_server1 to digoal;</font></div><div><font size="2"   >GRANT</font></div></div><div><div><font size="2"   >digoal=&gt; CREATE FOREIGN TABLE redis_db0 (key text, value text)&nbsp;</font></div><div><font size="2"   >SERVER redis_server1</font></div><div><font size="2"   >OPTIONS (database '0');</font></div><div><font size="2"   >CREATE FOREIGN TABLE</font></div><div><font size="2"   >digoal=&gt; CREATE FOREIGN TABLE redis_db1 (key text, value text)&nbsp;</font></div><div><font size="2"   >SERVER redis_server1</font></div><div><font size="2"   >OPTIONS (database '1');</font></div><div><font size="2"   >CREATE FOREIGN TABLE</font></div></div><div><div><font size="2"   >digoal=&gt; select * from redis_db0 limit 5;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; key &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | value&nbsp;</font></div><div><font size="2"   >------------------------+-------</font></div><div><font size="2"   >&nbsp;visits:digoal13:totals | 13</font></div><div><font size="2"   >&nbsp;visits:digoal23:totals | 23</font></div><div><font size="2"   >&nbsp;visits:digoal33:totals | 33</font></div><div><font size="2"   >&nbsp;visits:digoal43:totals | 43</font></div><div><font size="2"   >&nbsp;visits:digoal17:totals | 17</font></div><div><font size="2"   >(5 rows)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >digoal=&gt; select * from redis_db1 limit 5;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; key &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | value&nbsp;</font></div><div><font size="2"   >------------------------+-------</font></div><div><font size="2"   >&nbsp;visits:digoal13:totals | 13</font></div><div><font size="2"   >&nbsp;visits:digoal23:totals | 23</font></div><div><font size="2"   >&nbsp;visits:digoal33:totals | 33</font></div><div><font size="2"   >&nbsp;visits:digoal43:totals | 43</font></div><div><font size="2"   >&nbsp;visits:digoal17:totals | 17</font></div><div><font size="2"   >(5 rows)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >digoal=&gt; select count(*) from redis_db0;</font></div><div><font size="2"   >&nbsp;count&nbsp;</font></div><div><font size="2"   >-------</font></div><div><font size="2"   >&nbsp; &nbsp;100</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >digoal=&gt; select count(*) from redis_db1;</font></div><div><font size="2"   >&nbsp;count&nbsp;</font></div><div><font size="2"   >-------</font></div><div><font size="2"   >&nbsp; &nbsp;100</font></div><div><font size="2"   >(1 row)</font></div></div><p></p></pre></div><div><br></div><div><br></div><div>注意事项请参考redis_fdw README.</div><div><br></div><div>【参考】</div><div><a rel="nofollow" href="http://redis.io/"   >http://redis.io</a></div><div><a rel="nofollow" href="http://www.pgxn.org/dist/redis_fdw/"   >http://www.pgxn.org/dist/redis_fdw/</a></div><div><br></div><div>【其他FDW】</div><div>1. hive</div><div><a rel="nofollow" href="https://github.com/youngwookim/hive-fdw-for-postgresql"   >https://github.com/youngwookim/hive-fdw-for-postgresql</a> </div><div><div>2. PostgreSQL Foreign Table - pgsql_fdw</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201231514057303/"   >http://blog.163.com/digoal@126/blog/static/163877040201231514057303/</a></div><div>3. PostgreSQL Foreign Table - oracle_fdw 1</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201181505331588/"   >http://blog.163.com/digoal@126/blog/static/163877040201181505331588/</a></div><div>4. PostgreSQL Foreign Table - oracle_fdw 2</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020118151162340/"   >http://blog.163.com/digoal@126/blog/static/16387704020118151162340/</a></div><div>5. PostgreSQL Foreign Table - oracle_fdw 3</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020118951953408/"   >http://blog.163.com/digoal@126/blog/static/16387704020118951953408/</a></div><div>6. PostgreSQL Foreign Table - file_fdw</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201141641148311/"   >http://blog.163.com/digoal@126/blog/static/163877040201141641148311/</a></div><div>7. PostgreSQL Foreign Table - redis_fdw</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020119181188247/"   >http://blog.163.com/digoal@126/blog/static/16387704020119181188247/</a></div><div>8. PostgreSQL Foreign Table - mysql_fdw 1</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402011111233524987/"   >http://blog.163.com/digoal@126/blog/static/1638770402011111233524987/</a></div><div>9. PostgreSQL Foreign Table - mysql_fdw 2</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020121108551698/"   >http://blog.163.com/digoal@126/blog/static/16387704020121108551698/</a></div></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="PostgreSQL use redis_fdw connect to Redis - 德哥@Digoal - PostgreSQL"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
	<h3>评论</h3>
	<div class="" id="" style="padding:0 20px;">
			<div id="">
				<h5 id="">youseeli - 2011-10-18 14:14:55</h5>
				<div><P>给力!~~</P></div>
			</div>
	</div>
</div>
</body>
</html>