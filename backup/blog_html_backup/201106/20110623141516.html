<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL Archived in the Cloud</h2>
	<h5 id="">2011-06-23 14:15:16&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201152321027994/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;">建立一个集中调度的PostgreSQL归档系统。<wbr><div>特点:</div><div>1. 生产库存储指纹信息。</div><div>2. 调度库存储</div><div>&nbsp; &nbsp;指纹信息，以及生产库的其他补充信息。</div><div>&nbsp; &nbsp;归档服务器（存储）信息。</div><div>&nbsp; &nbsp;生产库与归档服务器的映射信息，包括优先级信息等等。</div><div>&nbsp; &nbsp;归档日志信息。</div><div>3. DNS存储环境IP与域名信息。</div><div>4. Nagios 负责实时监控归档状态信息。</div><div><br></div><div>方案概貌 :&nbsp;</div><div><div><img title="PostgreSQL Archived in the Cloud - 德哥@Digoal - The Heart,The World." alt="PostgreSQL Archived in the Cloud - 德哥@Digoal - The Heart,The World." style="margin:0 10px 0 0;" src="http://img.ph.126.net/KsFIqE0vLVaE4o2cBBNabQ==/645703596591024031.jpg"></div>&nbsp;</div><div>数据结构:</div><div><div>digoal=&gt; \d arch_db_info</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Table "digoal.arch_db_info"</div><div>&nbsp; &nbsp; Column &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Type &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Modifiers&nbsp;</div><div>---------------+-----------------------------+-----------</div><div>&nbsp;id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| uuid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| not null</div><div>&nbsp;idc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | text &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;platform &nbsp; &nbsp; &nbsp;| text &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;software &nbsp; &nbsp; &nbsp;| text &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;version &nbsp; &nbsp; &nbsp; | text &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;vip &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | inet &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;port &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| integer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;</div><div>&nbsp;create_time &nbsp; | timestamp without time zone |&nbsp;</div><div>&nbsp;modify_time &nbsp; | timestamp without time zone |&nbsp;</div><div>&nbsp;active_status | boolean &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;</div><div>Indexes:</div><div>&nbsp; &nbsp; "arch_db_info_pkey" PRIMARY KEY, btree (id)</div><div>&nbsp; &nbsp; "uk_db_info_1" UNIQUE, btree (idc, vip, port)</div><div>Referenced by:</div><div>&nbsp; &nbsp; TABLE "arch_path_map" CONSTRAINT "fk_path_1" FOREIGN KEY (db_id) REFERENCES arch_db_info(id)</div><div><br></div><div>digoal=&gt; \d arch_path_info</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Table "digoal.arch_path_info"</div><div>&nbsp; &nbsp; Column &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Type &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Modifiers&nbsp;</div><div>---------------+-----------------------------+-----------</div><div>&nbsp;id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| integer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | not null</div><div>&nbsp;ssh_ip &nbsp; &nbsp; &nbsp; &nbsp;| inet &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;ssh_port &nbsp; &nbsp; &nbsp;| integer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;</div><div>&nbsp;ssh_user &nbsp; &nbsp; &nbsp;| text &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;root_path &nbsp; &nbsp; | text &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;create_time &nbsp; | timestamp without time zone |&nbsp;</div><div>&nbsp;modify_time &nbsp; | timestamp without time zone |&nbsp;</div><div>&nbsp;active_status | boolean &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;</div><div>Indexes:</div><div>&nbsp; &nbsp; "arch_path_info_pkey" PRIMARY KEY, btree (id)</div><div>&nbsp; &nbsp; "uk_path_info_1" UNIQUE, btree (ssh_ip, ssh_port, root_path)</div><div>Referenced by:</div><div>&nbsp; &nbsp; TABLE "arch_path_map" CONSTRAINT "fk_path_2" FOREIGN KEY (path_id) REFERENCES arch_path_info(id)</div><div><br></div><div>digoal=&gt; \d arch_path_map</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Table "digoal.arch_path_map"</div><div>&nbsp; &nbsp; Column &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Type &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Modifiers&nbsp;</div><div>---------------+-----------------------------+-----------</div><div>&nbsp;id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| integer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | not null</div><div>&nbsp;db_id &nbsp; &nbsp; &nbsp; &nbsp; | uuid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;path_id &nbsp; &nbsp; &nbsp; | integer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;</div><div>&nbsp;priority &nbsp; &nbsp; &nbsp;| integer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;</div><div>&nbsp;active_status | boolean &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;</div><div>&nbsp;create_time &nbsp; | timestamp without time zone |&nbsp;</div><div>&nbsp;modify_time &nbsp; | timestamp without time zone |&nbsp;</div><div>Indexes:</div><div>&nbsp; &nbsp; "arch_path_map_pkey" PRIMARY KEY, btree (id)</div><div>&nbsp; &nbsp; "uk_path_map_1" UNIQUE, btree (db_id, path_id)</div><div>Foreign-key constraints:</div><div>&nbsp; &nbsp; "fk_path_1" FOREIGN KEY (db_id) REFERENCES arch_db_info(id)</div><div>&nbsp; &nbsp; "fk_path_2" FOREIGN KEY (path_id) REFERENCES arch_path_info(id)</div><div><br></div><div>digoal=&gt; \d arch_remote_log&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Table "digoal.arch_remote_log"</div><div>&nbsp; &nbsp; &nbsp;Column &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Type &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Modifiers&nbsp;</div><div>----------------+-----------------------------+-----------</div><div>&nbsp;db_id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| uuid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;ssh_ip &nbsp; &nbsp; &nbsp; &nbsp; | inet &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;ssh_port &nbsp; &nbsp; &nbsp; | integer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;</div><div>&nbsp;ssh_user &nbsp; &nbsp; &nbsp; | text &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;full_path &nbsp; &nbsp; &nbsp;| text &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;wal_size_bytes | bigint &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;create_time &nbsp; &nbsp;| timestamp without time zone |&nbsp;</div><div>&nbsp;status &nbsp; &nbsp; &nbsp; &nbsp; | boolean &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;</div><div><br></div><div>digoal=&gt; \d arch_local_log&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Table "digoal.arch_local_log"</div><div>&nbsp; &nbsp; &nbsp;Column &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Type &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Modifiers&nbsp;</div><div>----------------+-----------------------------+-----------</div><div>&nbsp;db_id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| uuid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;full_path &nbsp; &nbsp; &nbsp;| text &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;wal_size_bytes | bigint &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;</div><div>&nbsp;create_time &nbsp; &nbsp;| timestamp without time zone |&nbsp;</div><div>&nbsp;status &nbsp; &nbsp; &nbsp; &nbsp; | boolean &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;</div></div><div><br></div><div>其他功能围绕集中调度开发。</div><div>ER图:</div><div><div><img title="PostgreSQL Archived in the Cloud - 德哥@Digoal - The Heart,The World." alt="PostgreSQL Archived in the Cloud - 德哥@Digoal - The Heart,The World." style="margin:0 10px 0 0;" src="http://img.ph.126.net/89XiyzISZUkwdK9gAhpIpg==/3220355208548545133.jpg"></div>&nbsp;</div></div>
	</div>
	<h3>评论</h3>
	<div class="" id="" style="padding:0 20px;">
			<div id="">
				<h5 id="">本人纯属虚构 - 2011-06-23 14:18:47</h5>
				<div><P>再使劲一点憋 ...<IMG src="http://b.bst.126.net/common/portrait/face/preview/face7.gif"></P></div>
			</div>
			<div style="padding-left:40px;">
				<h5 id="">德哥@Digoal 回复 本人纯属虚构 - 2011-06-23 14:18:47</h5>
				<div style="width:600px;"><img src="http://b.bst.126.net/common/portrait/face/preview/face1.gif">&nbsp;拔萝卜。</div>
			</div>
	</div>
</div>
</body>
</html>