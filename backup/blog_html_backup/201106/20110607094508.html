<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">qla2xxx 0000:04:00.0: scsi(1:0:2): Abort command issued -- 1 1b22e 2002.</h2>
	<h5 id="">2011-06-07 9:45:08&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020115794217588/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>又一存储类故障,</div><div>两台DELL R610服务器.</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >HBA :&nbsp;04:00.0 Fibre Channel: QLogic Corp. ISP2432-based 4Gb Fibre Channel to PCI Express HBA (rev 03)</font></div><div><font size="2"  >SWITCH ： Brocade 300</font></div><div><font size="2"  >System : RHEL 5.6 64bit</font></div><div><font size="2"  >Storage : EVA6400</font></div><div><font size="2"  >device mapper :&nbsp;device-mapper-multipath-0.4.7-42.el5</font></div><p></p></pre></div><div><br></div><div>两台服务器同时报错:</div><div><pre class="prettyprint"  ><p></p><div><div><font size="2"  >qla2xxx 0000:04:00.0: scsi(1:0:2): Abort command issued -- 1 1b22e 2002.</font></div><div><font size="2"  >qla2xxx 0000:04:00.0: scsi(1:0:2): Abort command issued -- 1 2603b 2002.</font></div><div><font size="2"  >qla2xxx 0000:04:00.0: scsi(1:0:2): Abort command issued -- 1 2603c 2002.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: scsi(2:0:2): Abort command issued -- 1 27437 2002.</font></div></div><div><font size="2"  ><br></font></div><div><div><font size="2"  >qla2xxx 0000:04:00.1: Performing ISP error recovery - ha= ffff81034a9404f8.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: LIP reset occured (f700).</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: LIP occured (f700).</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: LIP reset occured (f7f7).</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: LOOP UP detected (4 Gbps).</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: qla2xxx_eh_bus_reset: reset succeeded</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: Mailbox command timeout occured. Issuing ISP abort.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: Performing ISP error recovery - ha= ffff81034a9404f8.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: Failed mailbox send register test</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: qla2x00_abort_isp: **** FAILED ****</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: scsi(2:0:2): Abort command issued -- 0 64981 2003.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: Performing ISP error recovery - ha= ffff81034a9404f8.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: LIP reset occured (f700).</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: LIP occured (f700).</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: LIP reset occured (f7f7).</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: LOOP UP detected (4 Gbps).</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: scsi(2:0:2): DEVICE RESET ISSUED.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: Mailbox command timeout occured. Issuing ISP abort.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: Performing ISP error recovery - ha= ffff81034a9404f8.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: Failed mailbox send register test</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: qla2x00_abort_isp: **** FAILED ****</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: qla2xxx_eh_device_reset: device reset failed</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: Performing ISP error recovery - ha= ffff81034a9404f8.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: LIP reset occured (f700).</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: LIP occured (f700).</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: LIP reset occured (f7f7).</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: LOOP UP detected (4 Gbps).</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: scsi(2:0:2): LOOP RESET ISSUED.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: Mailbox command timeout occured. Issuing ISP abort.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: Performing ISP error recovery - ha= ffff81034a9404f8.</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: Failed mailbox send register test</font></div><div><font size="2"  >qla2xxx 0000:04:00.1: qla2x00_abort_isp: **** FAILED ****</font></div><div><font size="2"  >&nbsp;rport-2:0-0: blocked FC remote port time out: saving binding</font></div><div><font size="2"  >&nbsp;rport-2:0-1: blocked FC remote port time out: saving binding</font></div></div><p></p></pre></div><div><br></div><div>提交qlogic CASE后建议执行:</div><div><pre class="prettyprint"  ><p><font size="2"  >ftp://ftp.qlogic.com/support/Hidden/scripts/qla_linux_info.sh</font></p></pre></div><div><br></div><div>不过执行到Gathering OS info: ... done</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >Gathering /sys files: ... done</font></div><div><font size="2"  >Gathering /proc files: ... done</font></div><div><font size="2"  >Gathering /etc files: ... done</font></div><div><font size="2"  >Gathering module information: ... done</font></div><div><font size="2"  >Gathering ethernet info: ... done</font></div><div><font size="2"  >Gathering infiniband info: ... done</font></div><div><font size="2"  >Gathering miscellaneous system info:</font></div><p></p></pre></div><div>的时候，就卡住了.IOSTAT显示HBA连接的存储使用率100%.</div><div>等待QLOGIC出示解决办法了。</div><div><br></div><div>之前碰到过类似的情况，使用MSA2312fc的存储，后来故障原因是存储的控制器有问题。</div><div>在其他地方还找到一个类似案例，据说是存储端得问题，需要重建RAID（也就意味着数据要迁出去再迁回来）。</div><div><a rel="nofollow" href="http://solutions.qlogic.com/KanisaSupportSite/dynamickc.do?externalId=Post-9128006&amp;sliceId=Post-245254038&amp;command=show&amp;forward=threadedKC&amp;kcId=Post-9128006"  >http://solutions.qlogic.com/KanisaSupportSite/dynamickc.do?externalId=Post-9128006&amp;sliceId=Post-245254038&amp;command=show&amp;forward=threadedKC&amp;kcId=Post-9128006</a></div><div><br></div><div><span style="line-height: 22px;"  ># 20110608 CASE被转到了DELL</span></div><div>又有一套收集日志的方法</div><div><a rel="nofollow" href="http://support1.ap.dell.com/cn/zh/forum/thread.asp?fid=20&amp;tid=276581"  >http://support1.ap.dell.com/cn/zh/forum/thread.asp?fid=20&amp;tid=276581</a></div><div><br></div><div>【其他】</div><div>尝试重新扫描设备 :&nbsp;</div><div><span style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >find /sys/class/scsi_host/host*/scan | while read line; do echo - - - &gt; $line; done</span></div><div><span style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 25px;"  >参考 :&nbsp;</span></div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020130144424699/"  >http://blog.163.com/digoal@126/blog/static/16387704020130144424699/</a></div><wbr></div>
	</div>
</div>
</body>
</html>