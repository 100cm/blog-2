<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Ruby Study 1 : Strings, Numbers, Classes, Objects</h2>
	<h5 id="">2012-02-27 11:32:07&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201212710232916/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>1. 输入输出</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >#!/opt/ruby/bin/ruby  # 这行表示用什么程序来执行该脚本</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >print("please enter your firstname : ") # print()用于打印,末尾不会自动加上换行符 </font></div><div><font size="2"  >firstname = gets().chomp # gets()用于接收用户输入, chomp用于去除输入字符的前后的空格\t,\n等.试试去掉.chomp你就知道了.</font></div><div><font size="2"  >print("please enter your lastname : ")</font></div><div><font size="2"  >lastname = gets().chomp</font></div><div><font size="2"  >puts("your fullname is : #{lastname}.#{firstname}") # puts()</font><span style="font-size: small; line-height: 19px;"  >用于打印,末尾自动加上换行符</span></div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  ># ./test.rb&nbsp;</font></div><div><font size="2"  >please enter your firstname : Zhou</font></div><div><font size="2"  >please enter your lastname : Digoal</font></div><div><font size="2"  >your fullname is : Digoal.Zhou</font></div><p></p></pre></div><div><br></div><div>2. strings中嵌套表达式</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >a = "hello"</font></div><div><font size="2"  >b = "goodbye"</font></div><div><font size="2"  >puts("\t#{a}, #{b}\t") # 双引号内的#{}用于内嵌表达式或变量,转义符等</font></div><div><font size="2"  >puts("#{1+2}")</font></div><div><font size="2"  >puts('\t#{a}, #{b}\t') # 单引号内的#{}保持原样,同时转义符在单引号内无效<br>puts('#{1+2}')</font></div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  ><span> </span>hello, goodbye<span> </span></font></div><div><font size="2"  >3</font></div><div><font size="2"  >\t#{a}, #{b}\t<br>#{1+2}</font></div><p></p></pre></div><div>3. Numbers</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >#!/opt/ruby/bin/ruby<br><br>taxrate = 0.175<br>print "Enter price (ex tax): "<br>s = gets()<br>subtotal = s.to_f  # String的to_f方法用于将Sting对象转成Float对象<br>tax = subtotal * taxrate # * 在这里是Float的一个方法.<br>puts("Tax on $#{subtotal} is $#{tax}, so grand total is $#{subtotal+tax}")</font></div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p><font size="2"  >Enter price (ex tax): 1000 # 输入1000<br>Tax on $1000.0 is $175.0, so grand total is $1175.0</font></p></pre></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >p String.methods # 返回一个Array, 表示String类中有那些定义的方法. p() 是 puts(Object.inspect)的缩写</font></div><div><font size="2"  >p String.methods.class # 返回上面返回的类即Array</font></div><div><font size="2"  >p String.method_defined?('to_f') # String类的to_f方法是否存在</font></div><div><font size="2"  >p 'a'.to_f.class # String类的to_f方法返回的是什么类, 结果是Float</font></div><div><font size="2"  >p (10.0).methods.include?(:*) #Array类的include?方法, 这里用于查看符合:*是否存在, 也就是Float类有没有定义*方法.</font></div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >[:try_convert, :allocate, :new, :superclass, :freeze, :===, :==, :&lt;=&gt;, :&lt;, :&lt;=, :&gt;, :&gt;=, :to_s, :included_modules, :include?, :name, :ancestors, :instance_methods, :public_instance_methods, :protected_instance_methods, :private_instance_methods, :constants, :const_get, :const_set, :const_defined?, :const_missing, :class_variables, :remove_class_variable, :class_variable_get, :class_variable_set, :class_variable_defined?, :public_constant, :private_constant, :module_exec, :class_exec, :module_eval, :class_eval, :method_defined?, :public_method_defined?, :private_method_defined?, :protected_method_defined?, :public_class_method, :private_class_method, :autoload, :autoload?, :instance_method, :public_instance_method, :nil?, :=~, :!~, :eql?, :hash, :class, :singleton_class, :clone, :dup, :initialize_dup, :initialize_clone, :taint, :tainted?, :untaint, :untrust, :untrusted?, :trust, :frozen?, :inspect, :methods, :singleton_methods, :protected_methods, :private_methods, :public_methods, :instance_variables, :instance_variable_get, :instance_variable_set, :instance_variable_defined?, :instance_of?, :kind_of?, :is_a?, :tap, :send, :public_send, :respond_to?, :respond_to_missing?, :extend, :display, :method, :public_method, :define_singleton_method, :object_id, :to_enum, :enum_for, :equal?, :!, :!=, :instance_eval, :instance_exec, :__send__, :__id__]</font></div><div><font size="2"  >Array</font></div><div><font size="2"  >true</font></div><div><font size="2"  >Float</font></div><div><font size="2"  >true</font></div><p></p></pre></div><div><br></div><div>4. 注释</div><div>上面很多代码都在用注释, # 后面的都是注释. 另一种多行注释如下 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >=begin</font></div><div><font size="2"  >p String.methods.class</font></div><div><font size="2"  >p String.method_defined?('to_f')</font></div><div><font size="2"  >p 'a'.to_f.class</font></div><div><font size="2"  >p (10.0).methods.include?(:*)</font></div><div><font size="2"  >=end</font></div><p></p></pre></div><div>=begin和=end 之间的行被注释掉. =必须放在行首.</div><div><br></div><div>5. 条件判断</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >#!/opt/ruby/bin/ruby</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >taxrate = 0.175&nbsp;</font></div><div><font size="2"  >print "Enter price (ex tax): "</font></div><div><font size="2"  >s = gets()</font></div><div><font size="2"  >subtotal = s.to_f</font></div><div><font size="2"  >if (subtotal &lt; 0.0) &nbsp;then</font></div><div><font size="2"  >&nbsp; subtotal = 0.0&nbsp;</font></div><div><font size="2"  >end</font></div><div><font size="2"  >tax = subtotal * taxrate</font></div><div><font size="2"  >puts("Tax on $#{subtotal} is $#{tax}, so grand total is $#{subtotal+tax}")</font></div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >./test.rb</font></div><div><font size="2"  >Enter price (ex tax): -1000 &nbsp;</font></div><div><font size="2"  >Tax on $0.0 is $0.0, so grand total is $0.0</font></div><p></p></pre></div><div><br></div><div>6. 本地变量与全局变量</div><div><p></p><div><pre class="prettyprint"  ><p></p><div><font size="2"  >localvar = "hello"</font></div><div><font size="2"  >$globalvar = "goodbye"</font></div><div><font size="2"  >def amethod</font></div><div><font size="2"  >&nbsp; &nbsp; localvar = 10</font></div><div><font size="2"  >&nbsp; &nbsp; puts( localvar )</font></div><div><font size="2"  >&nbsp; &nbsp; puts( $globalvar )</font></div><div><font size="2"  >end</font></div><div><font size="2"  >def anotherMethod</font></div><div><font size="2"  >&nbsp; &nbsp; localvar = 500</font></div><div><font size="2"  >&nbsp; &nbsp; $globalvar = "bonjour"</font></div><div><font size="2"  >&nbsp; &nbsp; puts( localvar )</font></div><div><font size="2"  >&nbsp; &nbsp; puts( $globalvar )</font></div><div><font size="2"  >end</font></div><div><font size="2"  >amethod</font></div><div><span style="font-size: small;"  >anotherMethod</span></div><div><font size="2"  >amethod</font></div><div><font size="2"  >puts( localvar )</font></div><div><font size="2"  >puts( $globalvar )</font></div><p></p></pre></div><div></div><p></p></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >10</font></div><div><font size="2"  >goodbye</font></div><div><font size="2"  >500</font></div><div><font size="2"  >bonjour</font></div><div><font size="2"  >10</font></div><div><font size="2"  >bonjour</font></div><div><font size="2"  >hello</font></div><div><font size="2"  >bonjour</font></div><p></p></pre></div><div>本地变量localvar在这里有三个作用域, 互不干扰.</div><div>全局变量$globalvar在这里全局有效.&nbsp;</div><div><br></div><div>7. 类, 方法, 对象</div><div><pre><pre class="prettyprint"  ><p></p><div><img title="Ruby Study 1 : Strings, Numbers, Classes, Objects - 德哥@Digoal - The Heart,The World."  alt="Ruby Study 1 : Strings, Numbers, Classes, Objects - 德哥@Digoal - The Heart,The World."  style="margin:0 10px 0 0;"  src="http://img6.ph.126.net/KJevEO7cYXGEIuoAFNra2w==/2715107625368268756.jpg"  ></div></pre></pre></div><div>这个继承关系截取自API.</div><div>注意大小写, 类必须以大写字母开头, 实例(对象)以小写字母开头(如obj).</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >class Thing # 注意类名必须大写字母开头, 否则会报错. 定义类以class为关键字, end结束.</font></div><div><font size="2"  >&nbsp; &nbsp; def set_name( aName ) # 方法名小写, 定义方法以def为关键字, end结束.</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; @name = aName # @开头的为实例(或叫对象)变量, 作用域在实例内, 外部不可以直接访问, 需要通过方法.</font></div><div><font size="2"  >&nbsp; &nbsp; end</font></div><div><font size="2"  >&nbsp; &nbsp;&nbsp;</font></div><div><font size="2"  >&nbsp; &nbsp; def get_name</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; return @name # 方法的返回值为方法中的最后一个表达式的值或者写明return直接跳出该方法, 不继续执行.</font></div><div><font size="2"  >&nbsp; &nbsp; end</font></div><div><font size="2"  >end</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >class Treasure</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; def initialize( aName, aDescription ) # initialize方法用于在new构造一个对象时初始化对象的变量.省去了用上面的set_name这种繁琐的方法.</font></div><div><font size="2"  >&nbsp; &nbsp;     @name = aName</font></div><div><font size="2"  >&nbsp; &nbsp;     @description &nbsp;= aDescription</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; end</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; def to_s # override default to_s method</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp;"The #{@name} Treasure is #{@description}\n"</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; end</font></div><div><font size="2"  >end</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >thing1 = Thing.new</font></div><div><font size="2"  >thing1.set_name( "A lovely Thing" )</font></div><div><font size="2"  >puts thing1.get_name</font></div><div><font size="2"  >t1 = Treasure.new("Sword", "an Elvish weapon forged of gold")</font></div><div><font size="2"  >t2 = Treasure.new("Ring", "a magic ring of great power")</font></div><div><font size="2"  >puts t1.to_s</font></div><div><font size="2"  >puts t2.to_s</font></div><div><font size="2"  ># The inspect method lets you look inside an object</font></div><div><font size="2"  ># puts(object.inspect)和p(object)的结果一样. inspect实际上是调用了to_s方法. 所以如果这里不复写to_s方法结果就不一样了.</font></div><div><font size="2"  >puts( "Inspecting 1st treasure: #{t1.inspect}" )</font></div><div><font size="2"  >p( t1 )</font></div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >A lovely Thing</font></div><div><font size="2"  >The Sword Treasure is an Elvish weapon forged of gold</font></div><div><font size="2"  >The Ring Treasure is a magic ring of great power</font></div><div><font size="2"  >Inspecting 1st treasure: The Sword Treasure is an Elvish weapon forged of gold</font></div><div><font size="2"  >The Sword Treasure is an Elvish weapon forged of gold</font></div></pre></div><div>不复写to_s方法看看inspect的结果如何 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >class Treasure</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; def initialize( aName, aDescription )</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; @name = aName</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; @description &nbsp;= aDescription</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; end</font></div><div><font size="2"  >end</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >t1 = Treasure.new("Sword", "an Elvish weapon forged of gold")</font></div><div><font size="2"  >puts( "Inspecting 1st treasure: #{t1.inspect}" )</font></div><div><font size="2"  >p( t1 )</font></div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >Inspecting 1st treasure: #&lt;Treasure:0x1f11138 @name="Sword", @description="an Elvish weapon forged of gold"&gt;</font></div><div><font size="2"  >#&lt;Treasure:0x1f11138 @name="Sword", @description="an Elvish weapon forged of gold"&gt;</font></div><p></p></pre></div><div>输出的是这个对象的类(Treasure), 然后是对象的ID(<span style="font-family: monospace; font-size: small; line-height: 19px; white-space: pre;"  >0x1f11138</span>), 然后是实例变量的值(<span style="font-family: monospace; font-size: small; line-height: 19px; white-space: pre;"  >@name="Sword", @description="an Elvish weapon forged of gold"</span>).</div><div><br></div>【参考】<div>The Book Of Ruby</div><div>Ruby 1.9.3 API<br><br><wbr></div></div>
	</div>
</div>
</body>
</html>