<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Common Address Redundancy Protocol Introduction</h2>
	<h5 id="">2010-05-11 23:04:13&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201041111413858/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><P style="TEXT-INDENT: 2em;"  >The&nbsp;Common Address Redundancy Protocol&nbsp;or&nbsp;CARP&nbsp;is a protocol which allows multiple hosts on the same local network to share a set of&nbsp;<A rel="nofollow" href="http://en.wikipedia.org/wiki/IP_addresses"  >IP addresses</A>. Its primary purpose is to provide&nbsp;<A rel="nofollow" href="http://en.wikipedia.org/wiki/Failover"  >failover</A>&nbsp;redundancy, especially when used with firewalls and routers. In some configurations CARP can also provide&nbsp;<A rel="nofollow" href="http://en.wikipedia.org/wiki/Load_balancing_(computing)"  >load balancing</A>&nbsp;functionality. It is a free, non patent-encumbered alternative to CISCO’s&nbsp;<A rel="nofollow" href="http://en.wikipedia.org/wiki/VRRP"  >VRRP</A>, implemented mostly in&nbsp;<A rel="nofollow" href="http://en.wikipedia.org/wiki/BSD"  >BSD</A>&nbsp;operating systems.</P>  <P style="TEXT-INDENT: 2em;"  >pfsyncd:</P>  <P style="TEXT-INDENT: 2em;"  >pfsync&nbsp;is a network interface that helps a number of computers running&nbsp;<A rel="nofollow" href="http://en.wikipedia.org/wiki/OpenBSD"  >OpenBSD’s</A>&nbsp;<A rel="nofollow" href="http://en.wikipedia.org/wiki/Pf_(firewall)"  >pf</A>&nbsp;(packet filter) keep their state tables the same. pfsync can send messages indicating changes, or listen for such changes. pfsync can be configured using&nbsp;<A rel="nofollow" href="http://en.wikipedia.org/wiki/Ifconfig"  >ifconfig</A>. pfsync can be used in conjunction with&nbsp;<A rel="nofollow" href="http://en.wikipedia.org/wiki/Common_Address_Redundancy_Protocol"  >CARP</A>&nbsp;to make sure a backup firewall has the same information as the main firewall.</P>  <P style="TEXT-INDENT: 2em;"  >Example</P>  <P style="TEXT-INDENT: 2em;"  >If there is a single computer running a&nbsp;<A rel="nofollow" href="http://en.wikipedia.org/wiki/Packet_filter"  >packet filter</A>, and it goes down, the networks on either side of the packet filter can no longer communicate with each other, or they communicate without any packet filtering. If, however, there are two computers running a packet filter, running CARP, then if one fails, the other will take over, and computers on either side of the packet filter will not be aware of the failure, so operation will continue as normal. In order to make sure the new master operates the same as the old one,&nbsp;<A rel="nofollow" href="http://en.wikipedia.org/wiki/Pfsyncd"  >pfsyncd</A>&nbsp;is used to synchronize packet filter states.</P>  <P style="TEXT-INDENT: 2em;"  >Principle of redundancy</P>  <P style="TEXT-INDENT: 2em;"  >A group of hosts using CARP is called a “group of redundancy”. The group of redundancy allocates itself an IP address which is shared or divided among the members of the group. Within this group, a host is designated as “Master”. The other members are called “slaves”. The main host is that which “takes” the IP address. It answers any traffic or ARP request brought to the attention of this address. Each host can belong to several groups of redundancy. It should be noted that each host must have a second unique IP address.</P>  <P style="TEXT-INDENT: 2em;"  >A common use of CARP is the creation of a group of redundant firewalls. The&nbsp;<A rel="nofollow" href="http://en.wikipedia.org/wiki/Virtual_IP"  >virtual IP</A>&nbsp;address allotted to the group of redundancy is indicated as the address of the default router on the computers behind this group of firewalls. If the main firewall breaks down or is disconnected from the network, the virtual IP address will be taken by one of the firewall slaves and the service availability will not be interrupted.</P></div>
	</div>
</div>
</body>
</html>