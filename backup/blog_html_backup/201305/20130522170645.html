<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL hostssl auth use openssl - Encrypting Data Across A Network</h2>
	<h5 id="">2013-05-22 17:06:45&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201342233131835/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>要支持ssl连接, 数据库服务端和客户端都需要openssl包.</div><div>以CentOS 5.x 64为例 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >openssl-0.9.8e-20.el5</font></div><div><font size="2"   >openssl-devel-0.9.8e-20.el5</font></div><p></p></pre></div><div>默认情况下PostgreSQL 读取openssl的配置文件openssl.cnf, 在openssl version -d返回的目录中.</div><div>当然也可以使用OPENSSL_CONF环境变量读取指定的配置的文件.</div><div><pre class="prettyprint"   ><p><font size="2"   >PostgreSQL reads the system-wide OpenSSL configuration file. By default, this file is named openssl.cnf and is located in the directory reported by openssl version -d. This default can be overridden by setting environment variable OPENSSL_CONF to the name of the desired configuration file.</font></p></pre></div><div><span style="line-height: 22px;"   >查看目录 :&nbsp;</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pg93@db-172-16-3-33-&gt; openssl version -d</font></div><div><font size="2"   >OPENSSLDIR: "/etc/pki/tls"</font></div><div><font size="2"   >pg93@db-172-16-3-33-&gt; cd /etc/pki/tls</font></div><div><font size="2"   >pg93@db-172-16-3-33-&gt; ll</font></div><div><font size="2"   >total 36K</font></div><div><font size="2"   >lrwxrwxrwx 1 root root &nbsp; 19 Apr 10 09:01 cert.pem -&gt; certs/ca-bundle.crt</font></div><div><font size="2"   >drwxr-xr-x 2 root root 4.0K Apr 10 09:01 certs</font></div><div><font size="2"   >drwxr-xr-x 2 root root 4.0K Apr 10 09:01 misc</font></div><div><font size="2"   >-rw-r--r-- 1 root root 9.6K Mar &nbsp;5 19:26 openssl.cnf</font></div><div><font size="2"   >drwxr-xr-x 2 root root 4.0K Mar &nbsp;5 19:26 private</font></div><p></p></pre></div><div><br></div><div>ssl认证配置 :&nbsp;</div><div>PostgreSQL 服务器配置 :&nbsp;</div><div>1. 生成自签名的key, postgres操作系统用户执行 :&nbsp;</div><div><pre class="prettyprint"   ><p><font size="2"   >openssl req -new -text -out server.req</font></p></pre></div><div>进入交互模式 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >输入phrase : 假设这里填的是digoal</font></div><div><div><font size="2"   >Enter PEM pass phrase:</font></div><div><font size="2"   >Verifying - Enter PEM pass phrase:</font></div></div><div><font size="2"   >输入国家缩写</font></div><div><div><font size="2"   >Country Name (2 letter code) [GB]:CN</font></div><div><font size="2"   >输入省份缩写</font></div><div><font size="2"   >State or Province Name (full name) [Berkshire]:Zhejiang</font></div><div><font size="2"   >输入城市缩写</font></div><div><font size="2"   >Locality Name (eg, city) [Newbury]:Hangzhou</font></div><div><font size="2"   >输入组织缩写</font></div><div><font size="2"   >Organization Name (eg, company) [My Company Ltd]:skymobi</font></div><div><font size="2"   >输入单位缩写</font></div><div><font size="2"   >Organizational Unit Name (eg, section) []:</font></div><div><font size="2"   >输入common name, 必填.</font></div><div><font size="2"   >Common Name (eg, your name or your server's hostname) []:db-172-16-3-33.sky-mobi.com</font></div><div><font size="2"   >输入email</font></div><div><font size="2"   >Email Address []:</font></div><div><font size="2"   >Please enter the following 'extra' attributes</font></div><div><font size="2"   >to be sent with your certificate request</font></div><div><font size="2"   >密码直接回车</font></div><div><font size="2"   >A challenge password []:</font></div><div><font size="2"   >An optional company name []:</font></div></div><p></p></pre></div><div>输入完后在当前目录下生成了以下两个文件 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >-rw-r--r-- 1 pg93 pg93 2.1K May 22 16:18 server.req</font></div><div><font size="2"   >-rw-r--r-- 1 pg93 pg93 &nbsp;963 May 22 16:18 privkey.pem</font></div><p></p></pre></div><div><br></div><div>如果直接在命令行中指定, 可以使用以下缩写 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >commonName (alias CN)</font></div><div><font size="2"   >surname (alias SN)</font></div><div><font size="2"   >givenName (alias GN)</font></div><div><font size="2"   >countryName (alias C)</font></div><div><font size="2"   >localityName (alias L)</font></div><div><font size="2"   >stateOrProvinceName (alias ST)</font></div><div><font size="2"   >organizationName (alias O)</font></div><div><font size="2"   >organizationUnitName (alias OU)</font></div><p></p></pre></div><div>例如以上命令可以使用下面代替, 减少输入 :&nbsp;</div><pre class="prettyprint"   ><p></p><div><font size="2"   >openssl req -new -text -out server.req -subj '/C=CN/ST=Zhejiang/L=Hangzhou/O=skymobi/CN=db-172-16-3-33.sky-mobi.com'</font></div><div></div><p></p></pre><div><span style="line-height: 22px;"   >直接输入phrase即可.</span></div><div>同样会生成两个文件 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >-rw-r--r-- 1 pg93 pg93 2.1K May 22 16:27 server.req</font></div><div><font size="2"   >-rw-r--r-- 1 pg93 pg93 &nbsp;963 May 22 16:27 privkey.pem</font></div><p></p></pre></div><div><br></div><div>2. 接下来删除passphrase, 不删除的话启动数据库会报这个错, 提示输入pass phrase :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pg93@db-172-16-3-33-&gt; Enter PEM pass phrase:</font></div><div><font size="2"   >FATAL: &nbsp;XX000: could not load private key file "server.key": problems getting password</font></div><div><font size="2"   >LOCATION: &nbsp;initialize_SSL, be-secure.c:784</font></div><p></p></pre></div><div>使用pg_ctl -w参数后会等待用户输入, 可以正常启动.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pg93@db-172-16-3-33-&gt; pg_ctl start -w</font></div><div><font size="2"   >waiting for server to start....Enter PEM pass phrase:.</font></div><div><font size="2"   >LOG: &nbsp;00000: loaded library "pg_stat_statements"</font></div><div><font size="2"   >LOCATION: &nbsp;load_libraries, miscinit.c:1296</font></div><div><font size="2"   >&nbsp;done</font></div><div><font size="2"   >server started</font></div></pre></div><div>删除pass phrase后则不会出现这个问题.</div><div><span style="line-height: 22px;"   ><br></span></div><div><span style="line-height: 22px;"   >3. 删除passphrase,&nbsp;</span></div><div><div style="line-height: 22px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 22px;"   ><font size="2"   >openssl rsa -in privkey.pem -out server.key</font></div><div style="line-height: 22px;"   ><font size="2"   >rm privkey.pem</font></div><p></p></pre></div><div style="line-height: 22px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 22px;"   ><font size="2"   >如果想保留passphrase的话, 第四步的命令使用</font></div><div><font size="2"   >openssl req -x509 -in server.req -text -key privkey.pem -out server.crt</font></div><div><font size="2"   >这里会提示输入passphrase.</font></div><div><font size="2"   >然后第六步改为</font></div><div><font size="2"   >mv server.crt privkey.pem $PGDATA</font></div><div><font size="2"   >同时修改postgresql.conf时改为</font></div><div><font size="2"   >ssl_key_file = '<span style="line-height: 28px;"   >privkey.pem'</span>&nbsp;</font></div><p></p></pre></div><div>4. 接下来turn the certificate into a self-signed certificate and to copy the key and certificate to where the server will look for them.</div><div><pre class="prettyprint"   ><p><font size="2"   >openssl req -x509 -in server.req -text -key server.key -out server.crt</font></p></pre></div></div><div>5. 修改server.key文件权限 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >chmod 600 server.key</font></div><div></div><p></p></pre></div><div>6. 然后将server.crt和server.key移动到$PGDATA</div><div><pre class="prettyprint"   ><p><font size="2"   >mv&nbsp;<span style="line-height: 22px;"   >server.crt&nbsp;</span><span style="line-height: 22px;"   >server.key $PGDATA</span></font></p></pre></div><div><br></div><div>7. 接下来要配置postgresql.conf. 打开ssl.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >ssl = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# (change requires restart)</font></div><div><font size="2"   >ssl_ciphers = 'DEFAULT:!LOW:!EXP:!MD5:@STRENGTH' &nbsp; &nbsp; &nbsp; &nbsp;# allowed SSL ciphers</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # (change requires restart)</font></div><div><font size="2"   >ssl_renegotiation_limit = 512MB &nbsp; # amount of data between renegotiations</font></div><div><font size="2"   >ssl_cert_file = 'server.crt' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# (change requires restart)</font></div><div><font size="2"   >ssl_key_file = 'server.key' &nbsp;</font></div><p></p></pre></div><div><br></div><div>8. 接下来配置pg_hba.conf, 让客户端使用ssl连接数据库.</div><div><pre class="prettyprint"   ><p><font size="2"   >hostssl all all 0.0.0.0/0 md5</font></p></pre></div><div><br></div><div>9. 重启数据库 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pg_ctl restart -m fast</font></div><div></div><p></p></pre></div><div><br></div><div>10. (客户端也需要openssl lib库)客户端连接数据库 :&nbsp;</div><div>注意到提示了SSL连接.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres@db-172-16-3-39-&gt; psql -h 172.16.3.33 -p 1999 -U postgres -d digoal</font></div><div><font size="2"   >Password for user postgres:&nbsp;</font></div><div><font size="2"   >psql (9.1.3, server 9.3devel)</font></div><div><font size="2"   >WARNING: psql version 9.1, server version 9.3.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Some psql features might not work.</font></div><div><font size="2"   >SSL connection (cipher: DHE-RSA-AES256-SHA, bits: 256)</font></div><div><font size="2"   >Type "help" for help.</font></div><p></p></pre></div><div><br></div><div>查看到客户端psql调用了libssl这个库.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-39 ~]# lsof|grep psql|grep ssl</font></div><div><font size="2"   >psql &nbsp; &nbsp; &nbsp; 9018 &nbsp;postgres &nbsp;mem &nbsp; &nbsp; &nbsp; REG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8,1 &nbsp; 315064 &nbsp; &nbsp;5331140 /lib64/libssl.so.0.9.8e</font></div><p></p></pre></div><div>来自这个包 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-39 ~]# rpm -qf /lib64/libssl.so.0.9.8e</font></div><div><font size="2"   >openssl-0.9.8e-20.el5</font></div></pre></div><div><span style="line-height: 22px;"   >11. 创建sslinfo extension, 可以查看一些ssl相关的连接信息.</span></div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >postgres@db-172-16-3-39-&gt; psql -h 172.16.3.33 -p 1999 -U postgres postgres</font></div><div><font size="2"   >Password for user postgres:&nbsp;</font></div><div><font size="2"   >psql (9.1.3, server 9.3devel)</font></div><div><font size="2"   >WARNING: psql version 9.1, server version 9.3.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Some psql features might not work.</font></div><div><font size="2"   >SSL connection (cipher: DHE-RSA-AES256-SHA, bits: 256)</font></div><div><font size="2"   >Type "help" for help.</font></div></div><div><div><font size="2"   >postgres=# create extension sslinfo;</font></div><div><font size="2"   >CREATE EXTENSION</font></div></div><div><div><font size="2"   >digoal=# select ssl_is_used();</font></div><div><font size="2"   >&nbsp;ssl_is_used&nbsp;</font></div><div><font size="2"   >-------------</font></div><div><font size="2"   >&nbsp;t</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >digoal=# select ssl_cipher();</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;ssl_cipher &nbsp; &nbsp;&nbsp;</font></div><div><font size="2"   >--------------------</font></div><div><font size="2"   >&nbsp;DHE-RSA-AES256-SHA</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >digoal=# select ssl_version();</font></div><div><font size="2"   >&nbsp;ssl_version&nbsp;</font></div><div><font size="2"   >-------------</font></div><div><font size="2"   >&nbsp;TLSv1</font></div><div><font size="2"   >(1 row)</font></div></div><p></p></pre></div><div><br></div><div>[其他]</div><div>1. 配置了ssl=on后, pg_hba.conf中如果只配置了host选项, 那么会优先选择ssl认证.</div><div>如果要强制nossl, 那么使用hostnossl.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   ># The first field is the connection type: "local" is a Unix-domain</font></div><div><font size="2"   ># socket, "host" is either a plain or SSL-encrypted TCP/IP socket,</font></div><div><font size="2"   ># "hostssl" is an SSL-encrypted TCP/IP socket, and "hostnossl" is a</font></div><div><font size="2"   ># plain TCP/IP socket.</font></div><p></p></pre></div><div>2. tcpdump 对比ssl和nossl的包信息.</div><div>调整pg_hba.conf</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >hostssl all all 0.0.0.0/0 md5</font></div><div><span style="line-height: 22px;"   ><font size="2"   >#hostnossl all all 0.0.0.0/0 md5</font></span></div></div><div><span style="line-height: 22px;"   ><font size="2"   >reload</font></span></div><div><div><font size="2"   >[root@db-172-16-3-33 ~]# tcpdump -i eth0 host 172.16.3.39 -s 0 -w ssl.dmp</font></div></div><p></p></pre></div><div><div><span style="line-height: 22px;"   >使用psql连接数据库.</span></div><div>dump结果 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes</font></div><div><font size="2"   >33 packets captured</font></div><div><font size="2"   >33 packets received by filter</font></div><div><font size="2"   >0 packets dropped by kernel</font></div><p></p></pre></div></div><div><br></div><div><span style="line-height: 22px;"   >调整pg_hba.conf</span></div><div><pre class="prettyprint"   ><p></p><div><span style="line-height: 22px;"   ><font size="2"   >#hostssl all all 0.0.0.0/0 md5</font></span></div><div><span style="line-height: 22px;"   ><font size="2"   >hostnossl all all 0.0.0.0/0 md5</font></span></div><div><span style="line-height: 22px;"   ><font size="2"   >reload</font></span></div><div><div><font size="2"   >[root@db-172-16-3-33 ~]# tcpdump -i eth0 host 172.16.3.39 -s 0 -w nossl.dmp</font></div></div><p></p></pre></div><div><div><span style="line-height: 22px;"   >使用psql连接数据库.</span></div><div><span style="line-height: 22px;"   >dump结果 :&nbsp;</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes</font></div><div><font size="2"   >52 packets captured</font></div><div><font size="2"   >52 packets received by filter</font></div><div><font size="2"   >0 packets dropped by kernel</font></div><p></p></pre></div></div><div><br></div><div>3. 使用wireshark分析数据包 :&nbsp;</div><div>nossl.dmp中找到了md5内容.</div><div>这个md5值并不是pg_shadow中存储的md5值, 而是加上了一个token后再次md5的值. 所以密码相对来说被破解的概率较小.</div><div>但是数据则不是加密的, 很容易被截获.</div><div><br></div><div>在ssl.dmp中则只有加密后的信息, 因为所有的数据都加密了, 所以无法窥探到有价值的信息.</div><div><br></div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >Encrypting Passwords Across A Network</font></div><div><font size="2"   >The MD5 authentication method double-encrypts the password on the client before sending it to the server. It first MD5-encrypts it based on the user name, and then encrypts it based on a random salt sent by the server when the database connection was made. It is this double-encrypted value that is sent over the network to the server. Double-encryption not only prevents the password from being discovered, it also prevents another connection from using the same encrypted password to connect to the database server at a later time.</font></div></div><div><div><font size="2"   ><br></font></div><div><font size="2"   >SSL Host Authentication</font></div><div><font size="2"   >It is possible for both the client and server to provide SSL certificates to each other. It takes some extra configuration on each side, but this provides stronger verification of identity than the mere use of passwords. It prevents a computer from pretending to be the server just long enough to read the password sent by the client. It also helps prevent "man in the middle" attacks where a computer between the client and server pretends to be the server and reads and passes all data between the client and server.</font></div></div><p></p></pre></div><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://www.postgresql.org/docs/9.3/static/ssl-tcp.html"   >http://www.postgresql.org/docs/9.3/static/ssl-tcp.html</a></div><div>2.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://www.postgresql.org/docs/9.3/static/auth-methods.html#AUTH-CERT"   >http://www.postgresql.org/docs/9.3/static/auth-methods.html#AUTH-CERT</a></div><div>3.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://www.postgresql.org/docs/9.3/static/auth-username-maps.html"   >http://www.postgresql.org/docs/9.3/static/auth-username-maps.html</a></div><div>4.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://h71000.www7.hp.com/doc/83final/ba554_90007/ch04s02.html"   >http://h71000.www7.hp.com/doc/83final/ba554_90007/ch04s02.html</a></div><div>5.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://www.postgresql.org/docs/9.3/static/libpq-ssl.html"   >http://www.postgresql.org/docs/9.3/static/libpq-ssl.html</a></div><div>6.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://www.postgresql.org/docs/9.3/static/runtime-config-connection.html#GUC-SSL"   >http://www.postgresql.org/docs/9.3/static/runtime-config-connection.html#GUC-SSL</a></div><div>7.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://www.postgresql.org/docs/9.3/static/auth-pg-hba-conf.html"   >http://www.postgresql.org/docs/9.3/static/auth-pg-hba-conf.html</a></div><div>8.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://www.postgresql.org/docs/9.3/static/sslinfo.html"   >http://www.postgresql.org/docs/9.3/static/sslinfo.html</a></div><div>9.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://joelonsql.com/2013/04/27/securing-postgresql-using-hostssl-cert-clientcert1/"   >http://joelonsql.com/2013/04/27/securing-postgresql-using-hostssl-cert-clientcert1/</a></div><div>10.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://www.oschina.net/translate/securing-postgresql-using-hostssl-cert-clientcert1?cmp"   >http://www.oschina.net/translate/securing-postgresql-using-hostssl-cert-clientcert1?cmp</a></div><div>11.&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><span style="line-height: 22px;"   ><font size="2"   >pg93@db-172-16-3-33-&gt; openssl genrsa help</font></span></div><div><font size="2"   >usage: genrsa [args] [numbits]</font></div><div><font size="2"   >&nbsp;-des &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;encrypt the generated key with DES in cbc mode</font></div><div><font size="2"   >&nbsp;-des3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; encrypt the generated key with DES in ede cbc mode (168 bit key)</font></div><div><font size="2"   >&nbsp;-aes128, -aes192, -aes256</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;encrypt PEM output with cbc aes</font></div><div><font size="2"   >&nbsp;-out file &nbsp; &nbsp; &nbsp; output the key to 'file</font></div><div><font size="2"   >&nbsp;-passout arg &nbsp; &nbsp;output file pass phrase source</font></div><div><font size="2"   >&nbsp;-f4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; use F4 (0x10001) for the E value</font></div><div><font size="2"   >&nbsp;-3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;use 3 for the E value</font></div><div><font size="2"   >&nbsp;-engine e &nbsp; &nbsp; &nbsp; use engine e, possibly a hardware device.</font></div><div><font size="2"   >&nbsp;-rand file:file:...</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;load the file (or the files in the directory) into</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the random number generator</font></div><p></p></pre></div><div>12.&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><span style="line-height: 22px;"   ><font size="2"   >pg93@db-172-16-3-33-&gt; openssl rsa help</font></span></div><div><font size="2"   >unknown option help</font></div><div><font size="2"   >rsa [options] &lt;infile &gt;outfile</font></div><div><font size="2"   >where options are</font></div><div><font size="2"   >&nbsp;-inform arg &nbsp; &nbsp; input format - one of DER NET PEM</font></div><div><font size="2"   >&nbsp;-outform arg &nbsp; &nbsp;output format - one of DER NET PEM</font></div><div><font size="2"   >&nbsp;-in arg &nbsp; &nbsp; &nbsp; &nbsp; input file</font></div><div><font size="2"   >&nbsp;-sgckey &nbsp; &nbsp; &nbsp; &nbsp; Use IIS SGC key format</font></div><div><font size="2"   >&nbsp;-passin arg &nbsp; &nbsp; input file pass phrase source</font></div><div><font size="2"   >&nbsp;-out arg &nbsp; &nbsp; &nbsp; &nbsp;output file</font></div><div><font size="2"   >&nbsp;-passout arg &nbsp; &nbsp;output file pass phrase source</font></div><div><font size="2"   >&nbsp;-des &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;encrypt PEM output with cbc des</font></div><div><font size="2"   >&nbsp;-des3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; encrypt PEM output with ede cbc des using 168 bit key</font></div><div><font size="2"   >&nbsp;-aes128, -aes192, -aes256</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;encrypt PEM output with cbc aes</font></div><div><font size="2"   >&nbsp;-text &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print the key in text</font></div><div><font size="2"   >&nbsp;-noout &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;don't print key out</font></div><div><font size="2"   >&nbsp;-modulus &nbsp; &nbsp; &nbsp; &nbsp;print the RSA key modulus</font></div><div><font size="2"   >&nbsp;-check &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;verify key consistency</font></div><div><font size="2"   >&nbsp;-pubin &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;expect a public key in input file</font></div><div><font size="2"   >&nbsp;-pubout &nbsp; &nbsp; &nbsp; &nbsp; output a public key</font></div><div><font size="2"   >&nbsp;-engine e &nbsp; &nbsp; &nbsp; use engine e, possibly a hardware device.</font></div><p></p></pre></div><div>13.&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><span style="line-height: 22px;"   ><font size="2"   >pg93@db-172-16-3-33-&gt; openssl req help</font></span></div><div><font size="2"   >unknown option help</font></div><div><font size="2"   >req [options] &lt;infile &gt;outfile</font></div><div><font size="2"   >where options &nbsp;are</font></div><div><font size="2"   >&nbsp;-inform arg &nbsp; &nbsp;input format - DER or PEM</font></div><div><font size="2"   >&nbsp;-outform arg &nbsp; output format - DER or PEM</font></div><div><font size="2"   >&nbsp;-in arg &nbsp; &nbsp; &nbsp; &nbsp;input file</font></div><div><font size="2"   >&nbsp;-out arg &nbsp; &nbsp; &nbsp; output file</font></div><div><font size="2"   >&nbsp;-text &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text form of request</font></div><div><font size="2"   >&nbsp;-pubkey &nbsp; &nbsp; &nbsp; &nbsp;output public key</font></div><div><font size="2"   >&nbsp;-noout &nbsp; &nbsp; &nbsp; &nbsp; do not output REQ</font></div><div><font size="2"   >&nbsp;-verify &nbsp; &nbsp; &nbsp; &nbsp;verify signature on REQ</font></div><div><font size="2"   >&nbsp;-modulus &nbsp; &nbsp; &nbsp; RSA modulus</font></div><div><font size="2"   >&nbsp;-nodes &nbsp; &nbsp; &nbsp; &nbsp; don't encrypt the output key</font></div><div><font size="2"   >&nbsp;-engine e &nbsp; &nbsp; &nbsp;use engine e, possibly a hardware device</font></div><div><font size="2"   >&nbsp;-subject &nbsp; &nbsp; &nbsp; output the request's subject</font></div><div><font size="2"   >&nbsp;-passin &nbsp; &nbsp; &nbsp; &nbsp;private key password source</font></div><div><font size="2"   >&nbsp;-key file &nbsp; &nbsp; &nbsp;use the private key contained in file</font></div><div><font size="2"   >&nbsp;-keyform arg &nbsp; key file format</font></div><div><font size="2"   >&nbsp;-keyout arg &nbsp; &nbsp;file to send the key to</font></div><div><font size="2"   >&nbsp;-rand file:file:...</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; load the file (or the files in the directory) into</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the random number generator</font></div><div><font size="2"   >&nbsp;-newkey rsa:bits generate a new RSA key of 'bits' in size</font></div><div><font size="2"   >&nbsp;-newkey dsa:file generate a new DSA key, parameters taken from CA in 'file'</font></div><div><font size="2"   >&nbsp;-[digest] &nbsp; &nbsp; &nbsp;Digest to sign with (see openssl dgst -h for list)</font></div><div><font size="2"   >&nbsp;-config file &nbsp; request template file.</font></div><div><font size="2"   >&nbsp;-subj arg &nbsp; &nbsp; &nbsp;set or modify request subject</font></div><div><font size="2"   >&nbsp;-multivalue-rdn enable support for multivalued RDNs</font></div><div><font size="2"   >&nbsp;-new &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new request.</font></div><div><font size="2"   >&nbsp;-batch &nbsp; &nbsp; &nbsp; &nbsp; do not ask anything during request generation</font></div><div><font size="2"   >&nbsp;-x509 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;output a x509 structure instead of a cert. req.</font></div><div><font size="2"   >&nbsp;-days &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;number of days a certificate generated by -x509 is valid for.</font></div><div><font size="2"   >&nbsp;-set_serial &nbsp; &nbsp;serial number to use for a certificate generated by -x509.</font></div><div><font size="2"   >&nbsp;-newhdr &nbsp; &nbsp; &nbsp; &nbsp;output "NEW" in the header lines</font></div><div><font size="2"   >&nbsp;-asn1-kludge &nbsp; Output the 'request' in a format that is wrong but some CA's</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; have been reported as requiring</font></div><div><font size="2"   >&nbsp;-extensions .. specify certificate extension section (override value in config file)</font></div><div><font size="2"   >&nbsp;-reqexts .. &nbsp; &nbsp;specify request extension section (override value in config file)</font></div><div><font size="2"   >&nbsp;-utf8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;input characters are UTF8 (default ASCII)</font></div><div><font size="2"   >&nbsp;-nameopt arg &nbsp; &nbsp;- various certificate name options</font></div><div><font size="2"   >&nbsp;-reqopt arg &nbsp; &nbsp;- various request text options</font></div><p></p></pre></div></div>
	</div>
</div>
</body>
</html>