<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL 9.3 add functions pg_is_in_backup() and pg_backup_start_time() report the status of base backups</h2>
	<h5 id="">2013-05-08 16:00:14&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402013484014117/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><div>Add SQL functions pg_is_in_backup() and pg_backup_start_time() (Gilles Darold)</div><div>These functions report the status of base backups.</div></div><div>这两个函数可用于查看当前数据库是否在备份, 以及开始备份的时间.</div><div><br></div><div>[测试]</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres=# select pg_start_backup(now()::text),now();</font></div><div><font size="2"   >&nbsp;pg_start_backup | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;now &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >-----------------+-------------------------------</font></div><div><font size="2"   >&nbsp;2/54000028 &nbsp; &nbsp; &nbsp;| 2013-05-08 15:55:00.267025+08</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >postgres=# select pg_is_in_backup();</font></div><div><font size="2"   >&nbsp;pg_is_in_backup&nbsp;</font></div><div><font size="2"   >-----------------</font></div><div><font size="2"   >&nbsp;t</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >postgres=# select pg_backup_start_time();</font></div><div><font size="2"   >&nbsp; pg_backup_start_time &nbsp;</font></div><div><font size="2"   >------------------------</font></div><div><font size="2"   >&nbsp;2013-05-09 05:55:00+08</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >postgres=# select pg_stop_backup();</font></div><div><font size="2"   >NOTICE: &nbsp;pg_stop_backup complete, all required WAL segments have been archived</font></div><div><font size="2"   >&nbsp;pg_stop_backup&nbsp;</font></div><div><font size="2"   >----------------</font></div><div><font size="2"   >&nbsp;2/540000F0</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >postgres=# select pg_backup_start_time();</font></div><div><font size="2"   >&nbsp;pg_backup_start_time&nbsp;</font></div><div><font size="2"   >----------------------</font></div><div><font size="2"   >&nbsp;</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >postgres=# select pg_is_in_backup();</font></div><div><font size="2"   >&nbsp;pg_is_in_backup&nbsp;</font></div><div><font size="2"   >-----------------</font></div><div><font size="2"   >&nbsp;f</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><div><br></div><div>[参考]</div><div>1.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://git.postgresql.org/gitweb/?p=postgresql.git;a=commit;h=68de499bda40fdf1395b714bb63febad61046700"   >http://git.postgresql.org/gitweb/?p=postgresql.git;a=commit;h=68de499bda40fdf1395b714bb63febad61046700</a></div><div>2.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://www.postgresql.org/docs/devel/static/functions-admin.html#FUNCTIONS-ADMIN-BACKUP"   >http://www.postgresql.org/docs/devel/static/functions-admin.html#FUNCTIONS-ADMIN-BACKUP</a></div></div>
	</div>
</div>
</body>
</html>