<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">MonetDB vs PostgreSQL a lite case</h2>
	<h5 id="">2014-08-13 22:02:24&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020147139412871/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>本文对比一下MonetDB 和 PostgreSQL在某些SQL下的性能.&nbsp;</div><div>(MonetDB 使用列存储, 支持单SQL使用多核, 线程模式, 支持数据压缩, 还有较多的OLAP相关的插件, 更适合OLAP的应用场景)</div><div><br></div><div><span style="color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; line-height: 28px;"   >注意, PostgreSQL注重的是高并发, 而MonetDB注重数据分析, 所以两者没有什么可比性, 这里拿MonetDB的强项来VS PostgreSQL的软肋, 主要是给一些在使用PostgreSQL做数据分析并且遇到瓶颈的朋友一些启发, 换个产品试试, 不要使用一个产品的软肋(这里指PostgreSQL在统计方面目前略差, 未来9.4+版本出来单SQL可以用到多核再来谈统计效率)</span></div><div><span style="color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; line-height: 28px;"   >PostgreSQL支持的列存储插件cstore_fdw性能, 如果要玩的话可以</span><span style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >参考 :&nbsp;</span></div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020144141052312/"   >http://blog.163.com/digoal@126/blog/static/16387704020144141052312/</a></div><div>对于定长类型, 可以提升较高的性能.</div><div><br></div><div>测试环境</div><div>DELL R610</div><div>CPU 1.6G 8核</div><div>CentOS 6.5 x64</div><div>PostgreSQL 9.3.5 (主要参数 shared_buffer=1G, block_size=8KB, checkpoint_segment=32, wal_segsize=16MB, synchronous_commit=off, autovacuum=on)</div><div>MonetDB 11.17.21</div><div>块设备 OCZ RevoDrive3X2 240G</div><div>文件系统 ext4</div><div>内存 96GB</div><div>测试数据2.6亿</div><div>MonetDB 占用 1.9G. (含PK)</div><div>PostgreSQL 占用 22G.&nbsp;<span style="line-height: 28px;"   >(含PK)</span></div><div><br></div><div>插入性能对比, PostgreSQL比MonetDB几乎差了9倍性能.</div><div><table width="80%"   border="1"   cellpadding="1"   cellspacing="1"   ><tbody><tr><td>&nbsp;插入条数 <br>/ 时间(毫秒)</td><td>&nbsp;MonetDB</td><td>&nbsp;PostgreSQL</td></tr><tr><td>&nbsp;1024</td><td>&nbsp;6</td><td>&nbsp;11</td></tr><tr><td>&nbsp;2048</td><td>&nbsp;7</td><td>&nbsp;21</td></tr><tr><td>&nbsp;4096</td><td>&nbsp;10</td><td>&nbsp;42</td></tr><tr><td>&nbsp;8192</td><td>&nbsp;17</td><td>&nbsp;84</td></tr><tr><td>&nbsp;16384</td><td>&nbsp;29</td><td>&nbsp;166</td></tr><tr><td>&nbsp;32768</td><td>&nbsp;51</td><td>&nbsp;332</td></tr><tr><td>&nbsp;65536</td><td>&nbsp;96</td><td>&nbsp;661</td></tr><tr><td>&nbsp;131072</td><td>&nbsp;184</td><td>&nbsp;1361</td></tr><tr><td>&nbsp;262144</td><td>&nbsp;361</td><td>&nbsp;2760</td></tr><tr><td>&nbsp;524288</td><td>&nbsp;701</td><td>&nbsp;5550</td></tr><tr><td>&nbsp;1048576</td><td>&nbsp;1300</td><td>&nbsp;11221</td></tr><tr><td>&nbsp;2097152</td><td>&nbsp;2800</td><td>&nbsp;22581</td></tr><tr><td>&nbsp;4194304</td><td>&nbsp;5500</td><td>&nbsp;45018</td></tr><tr><td>&nbsp;8388608</td><td>&nbsp;11200</td><td>&nbsp;91126</td></tr><tr><td>&nbsp;16777216</td><td>&nbsp;22100</td><td>&nbsp;183895</td></tr><tr><td>&nbsp;33554432</td><td>&nbsp;45300</td><td>&nbsp;376365</td></tr><tr><td>&nbsp;67108864</td><td>&nbsp;97000</td><td>&nbsp;764031</td></tr><tr><td>&nbsp;134217728</td><td>&nbsp;178000</td><td>&nbsp;1533433</td></tr><tr><td>&nbsp;平均每秒插入条数</td><td>&nbsp;754000/s</td><td>&nbsp;87000/s</td></tr></table>&nbsp; &nbsp;</div><div>查询性能对比, MonetDB完胜, 完全不是一个数量级的差别.&nbsp;</div><div>当然PostgreSQL count(*)性能本来就不咋地, 更适合OLTP, 曾经用了大量的篇幅来写使用PostgreSQL实现准实时数据统计, 可参阅</div><div><div style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   ><div style="line-height: 25px; font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   ><div style="line-height: 25px;"   >1.&nbsp;<a style="line-height: 25px; text-decoration: none; color: rgb(85, 108, 136);" target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201331252945440/"   >http://blog.163.com/digoal@126/blog/static/163877040201331252945440/</a></div><div style="line-height: 25px;"   >2.&nbsp;<a style="line-height: 25px; text-decoration: none; color: rgb(85, 108, 136);" target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020133151402415/"   >http://blog.163.com/digoal@126/blog/static/16387704020133151402415/</a></div><div style="line-height: 25px;"   >3.&nbsp;<a style="line-height: 25px; text-decoration: none; color: rgb(85, 108, 136);" target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020133155179877/"   >http://blog.163.com/digoal@126/blog/static/16387704020133155179877/</a></div><div style="line-height: 25px;"   >4.&nbsp;<a style="line-height: 25px; text-decoration: none; color: rgb(85, 108, 136);" target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020133156636579/"   >http://blog.163.com/digoal@126/blog/static/16387704020133156636579/</a></div><div style="line-height: 25px;"   >5.&nbsp;<a style="line-height: 25px; text-decoration: none; color: rgb(85, 108, 136);" target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020133218305242/"   >http://blog.163.com/digoal@126/blog/static/16387704020133218305242/</a></div><div style="line-height: 25px;"   >6.&nbsp;<a style="line-height: 25px; text-decoration: none; color: rgb(85, 108, 136);" target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020133224161563/"   >http://blog.163.com/digoal@126/blog/static/16387704020133224161563/</a></div></div><span style="line-height: 22px; font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >7.&nbsp;</span><a style="line-height: 22px; text-decoration: none; color: rgb(85, 108, 136); font-family: Arial, Helvetica, simsun, u5b8bu4f53;" href="http://blog.163.com/digoal@126/blog/static/16387704020133271134563/"   >http://blog.163.com/digoal@126/blog/static/16387704020133271134563/</a></div><div style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >8.&nbsp;<a style="line-height: 28px; text-decoration: none; color: rgb(85, 108, 136);" target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020134311144755/"   >http://blog.163.com/digoal@126/blog/static/16387704020134311144755/</a></div><div style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >9.&nbsp;<a style="line-height: 28px; text-decoration: none; color: rgb(85, 108, 136); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, &#23435;&#20307;;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402013113044354661/"   >http://blog.163.com/digoal@126/blog/static/1638770402013113044354661/</a></div><div style="line-height: 28px; color: rgb(51, 51, 51); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53;"   >10.&nbsp;<a style="line-height: 28px; text-decoration: none; color: rgb(85, 108, 136); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, &#23435;&#20307;;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020137111254816/"   >http://blog.163.com/digoal@126/blog/static/16387704020137111254816/</a></div></div><div><table width="80%"   border="1"   cellpadding="1"   cellspacing="1"   ><tbody><tr><td>&nbsp;SQL<br>/<br>时间(毫秒)</td><td>&nbsp;MonetDB</td><td>&nbsp;PostgreSQL</td></tr><tr><td>&nbsp;select count(*) from a;</td><td>&nbsp;1</td><td>&nbsp;<span style="line-height: 28px;"   >46484</span></td></tr><tr><td>&nbsp;select count(*) from a where id=1;</td><td>&nbsp;1</td><td>&nbsp;1</td></tr><tr><td>&nbsp;select count(*) from a where id&gt;1;</td><td>&nbsp;2</td><td>&nbsp;<span style="line-height: 28px;"   >68813</span></td></tr><tr><td>&nbsp;select count(*) from a where id&lt;1;</td><td>&nbsp;2</td><td>&nbsp;0.6</td></tr><tr><td>&nbsp;select count(*) from a where id&lt;&gt;1;</td><td>&nbsp;3500</td><td>&nbsp;<span style="line-height: 28px;"   >68710</span></td></tr><tr><td>&nbsp;select count(*) from a where id is null;</td><td>&nbsp;752</td><td>&nbsp;0.5</td></tr><tr><td>&nbsp;select count(*) from a where id is not null;</td><td>&nbsp;710</td><td>&nbsp;<span style="line-height: 28px;"   >64771</span></td></tr><tr><td>&nbsp;select count(*) from a where info='2014-08-13 20:20:14.000000+08:00';</td><td>&nbsp;0.4</td><td>&nbsp;<span style="line-height: 28px;"   >68006</span></td></tr><tr><td>&nbsp;select count(*) from a where info&gt;'2014-08-13 20:20:14.000000+08:00';</td><td>&nbsp;0.8</td><td>&nbsp;<span style="line-height: 28px;"   >91155</span></td></tr><tr><td>&nbsp;select count(*) from a where info&lt;'2014-08-13 20:20:14.000000+08:00';</td><td>&nbsp;1.7</td><td>&nbsp;<span style="line-height: 28px;"   >72517</span></td></tr><tr><td>&nbsp;select count(*) from a where info&lt;&gt;'2014-08-13 20:20:14.000000+08:00';</td><td>&nbsp;2800</td><td>&nbsp;<span style="line-height: 28px;"   >86810</span></td></tr><tr><td>&nbsp;select count(*) from a where info is null;</td><td>&nbsp;773</td><td>&nbsp;<span style="line-height: 28px;"   >43593</span></td></tr><tr><td>&nbsp;select count(*) from a where info is not null;</td><td>&nbsp;748</td><td>&nbsp;<span style="line-height: 28px;"   >65161</span></td></tr><tr><td>&nbsp;select count(*) from (select info from a group by info having count(*) &gt;1) as t;</td><td>&nbsp;4700</td><td>&nbsp;144180</td></tr></table></div><div><br></div><div>空间占用对比,</div><div>2.6亿数据(含索引), MonetDB 1.9G, PostgreSQL 22G.</div><div>当然这里和测试数据有关, 因为字符串大量重复了.</div><div>后期做一下宽 表的测试. 对比GreenPlum.</div><div>MonetDB还有很多强大的功能等待挖掘, 大家一起来玩吧.</div><div><br></div><div>详细数据如下 :&nbsp;</div><div>MonetDB</div><div>插入性能</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >sql&gt;create table a(id int auto_increment primary key, info varchar(32));</font></div><div><font size="2"   >operation successful (10.112ms)</font></div></div><div><div><font size="2"   >sql&gt;insert into a (info) values (now());</font></div><div><font size="2"   >1 affected rows, last generated key: 1 (3.274ms)</font></div><div><font size="2"   >sql&gt;select * from a;</font></div><div><font size="2"   >+------+----------------------------------+</font></div><div><font size="2"   >| id &nbsp; | info &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</font></div><div><font size="2"   >+======+==================================+</font></div><div><font size="2"   >| &nbsp; &nbsp;1 | 2014-08-13 20:18:53.000000+08:00 |</font></div><div><font size="2"   >+------+----------------------------------+</font></div><div><font size="2"   >1 tuple (2.448ms)</font></div></div><div><div><font size="2"   >sql&gt;insert into a (info) values (now());</font></div><div><font size="2"   >1 affected rows, last generated key: 2 (3.023ms)</font></div></div><div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >2 affected row (6.033ms)</font></div></div><div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >4 affected row (3.798ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >8 affected row (2.893ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >16 affected row (2.700ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >32 affected row (5.064ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >64 affected row (4.054ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >128 affected row (4.138ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >256 affected row (4.304ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >512 affected row (2.563ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >1024 affected row (6.094ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >2048 affected row (6.956ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >4096 affected row (9.618ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >8192 affected row (17.475ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >16384 affected row (29.347ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >32768 affected row (50.941ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >65536 affected row (95.736ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >131072 affected row (183.726ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >262144 affected row (361.436ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >524288 affected row (701.202ms)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >1048576 affected row (1.3s)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >2097152 affected row (2.8s)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >4194304 affected row (5.5s)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >8388608 affected row (11.2s)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >16777216 affected row (22.1s)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >33554432 affected row (45.3s)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >67108864 affected row (1m 27s)</font></div><div><font size="2"   >sql&gt;insert into a (info) select now() from a;</font></div><div><font size="2"   >134217728 affected row (2m 58s)</font></div></div><p></p></pre></div><div><br></div><div>空间占用大约1.9G.</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@150 ~]# cd /data02/mdb1/</font></div><div><font size="2"   >[root@150 mdb1]# ll</font></div><div><font size="2"   >total 16</font></div><div><font size="2"   >-rw------- 1 root root 7196 Aug 13 21:08 merovingian.log</font></div><div><font size="2"   >-rw-r--r-- 1 root root &nbsp; &nbsp;6 Aug 13 20:08 merovingian.pid</font></div><div><font size="2"   >drwx------ 5 root root 4096 Aug 13 20:09 test</font></div><div><font size="2"   >[root@150 mdb1]# du -sh *</font></div><div><font size="2"   >8.0K &nbsp; &nbsp;merovingian.log</font></div><div><font size="2"   >4.0K &nbsp; &nbsp;merovingian.pid</font></div><div><font size="2"   >1.9G &nbsp; &nbsp;test</font></div><div><font size="2"   >[root@150 mdb1]# cd test/</font></div><div><font size="2"   >[root@150 test]# ll</font></div><div><font size="2"   >total 12</font></div><div><font size="2"   >-rw------- &nbsp;1 root root &nbsp; &nbsp;0 Aug 13 20:09 58ec944a-5cff-dc51-4873-986923c64567</font></div><div><font size="2"   >drwx------ 14 root root 4096 Aug 13 20:33 bat</font></div><div><font size="2"   >drwx------ &nbsp;2 root root 4096 Aug 13 20:09 box</font></div><div><font size="2"   >drwx------ &nbsp;3 root root 4096 Aug 13 20:09 sql_logs</font></div><div><font size="2"   >[root@150 test]# du -sh *</font></div><div><font size="2"   >0 &nbsp; &nbsp; &nbsp; 58ec944a-5cff-dc51-4873-986923c64567</font></div><div><font size="2"   >1.9G &nbsp; &nbsp;bat</font></div><div><font size="2"   >4.0K &nbsp; &nbsp;box</font></div><div><font size="2"   >12K &nbsp; &nbsp; sql_logs</font></div><div><font size="2"   >[root@150 test]# cd bat</font></div><div><font size="2"   >[root@150 bat]# du -sh *</font></div><div><div><font size="2"   >492K &nbsp; &nbsp;01</font></div><div><font size="2"   >288K &nbsp; &nbsp;02</font></div><div><font size="2"   >92K &nbsp; &nbsp; 04</font></div><div><font size="2"   >1.1G &nbsp; &nbsp;05</font></div><div><font size="2"   >513M &nbsp; &nbsp;07</font></div><div><font size="2"   >572K &nbsp; &nbsp;10</font></div><div><font size="2"   >4.0K &nbsp; &nbsp;11</font></div><div><font size="2"   >4.0K &nbsp; &nbsp;12</font></div><div><font size="2"   >65M &nbsp; &nbsp; 13</font></div><div><font size="2"   >323M &nbsp; &nbsp;14</font></div><div><font size="2"   >772K &nbsp; &nbsp;15</font></div><div><font size="2"   >4.0K &nbsp; &nbsp;3.head</font></div><div><font size="2"   >4.0K &nbsp; &nbsp;3.tail</font></div><div><font size="2"   >12K &nbsp; &nbsp; 3.theap</font></div><div><font size="2"   >4.0K &nbsp; &nbsp;4.head</font></div><div><font size="2"   >4.0K &nbsp; &nbsp;4.tail</font></div><div><font size="2"   >12K &nbsp; &nbsp; 4.theap</font></div><div><font size="2"   >28K &nbsp; &nbsp; BACKUP</font></div></div></div><div><div><font size="2"   ><br></font></div><div><font size="2"   >[root@150 bat]# ll</font></div><div><font size="2"   >total 88</font></div><div><div><font size="2"   >drwx------ 2 root root 4096 Aug 13 21:27 01</font></div><div><font size="2"   >drwx------ 2 root root 4096 Aug 13 20:21 02</font></div><div><font size="2"   >drwx------ 2 root root 4096 Aug 13 21:15 04</font></div><div><font size="2"   >drwx------ 2 root root 4096 Aug 13 21:12 05</font></div><div><font size="2"   >drwx------ 2 root root 4096 Aug 13 21:27 07</font></div><div><font size="2"   >drwx------ 2 root root 4096 Aug 13 21:27 10</font></div><div><font size="2"   >drwx------ 2 root root 4096 Aug 13 21:15 11</font></div><div><font size="2"   >drwx------ 2 root root 4096 Aug 13 21:27 12</font></div><div><font size="2"   >drwx------ 2 root root 4096 Aug 13 21:27 13</font></div><div><font size="2"   >drwx------ 2 root root 4096 Aug 13 21:27 14</font></div><div><font size="2"   >drwx------ 2 root root 4096 Aug 13 21:27 15</font></div><div><font size="2"   >-rw------- 1 root root &nbsp; &nbsp;8 Aug 13 20:09 3.head</font></div><div><font size="2"   >-rw------- 1 root root &nbsp; &nbsp;1 Aug 13 20:09 3.tail</font></div><div><font size="2"   >-rw------- 1 root root 8216 Aug 13 20:09 3.theap</font></div><div><font size="2"   >-rw------- 1 root root &nbsp; &nbsp;8 Aug 13 20:09 4.head</font></div><div><font size="2"   >-rw------- 1 root root &nbsp; &nbsp;1 Aug 13 20:09 4.tail</font></div><div><font size="2"   >-rw------- 1 root root 8343 Aug 13 20:09 4.theap</font></div><div><font size="2"   >drwx------ 2 root root 4096 Aug 13 21:27 BACKUP</font></div></div></div><p></p></pre></div><div>通过函数storage可以查看详细大小. 这里包含了count和columnsize. info字段占用500mb左右, id字段占用1G左右.</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >sql&gt;select * from storage();</font></div><div><font size="2"   >+-------+-------------------+----------------+-----------+----------+-----------+-------+------------+----------+---------+--------+</font></div><div><font size="2"   >| schem | table &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | column &nbsp; &nbsp; &nbsp; &nbsp; | type &nbsp; &nbsp; &nbsp;| location | count &nbsp; &nbsp; | typew | columnsize | heapsize | indices | sorted |</font></div><div><font size="2"   >: a &nbsp; &nbsp; : &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : idth &nbsp;: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: &nbsp; &nbsp; &nbsp; &nbsp; : &nbsp; &nbsp; &nbsp; &nbsp;:</font></div><div><font size="2"   >+=======+===================+================+===========+==========+===========+=======+============+==========+=========+========+</font></div></div><div><div><font size="2"   >| sys &nbsp; | a &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | int &nbsp; &nbsp; &nbsp; | 05/573 &nbsp; | 268435456 | &nbsp; &nbsp; 4 | 1073741824 | &nbsp; &nbsp; &nbsp; &nbsp;0 | &nbsp; &nbsp; &nbsp; 0 | true &nbsp; |</font></div><div><font size="2"   >| sys &nbsp; | a &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | info &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | varchar &nbsp; | 07/734 &nbsp; | 268435456 | &nbsp; &nbsp;32 | &nbsp;536870912 | &nbsp; &nbsp;16384 | &nbsp; &nbsp; &nbsp; 0 | true &nbsp; |</font></div><div><font size="2"   >| sys &nbsp; | a &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | a_id_pkey &nbsp; &nbsp; &nbsp;| oid &nbsp; &nbsp; &nbsp; | 05/567 &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 0 | &nbsp; &nbsp; 8 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 | &nbsp; &nbsp; &nbsp; &nbsp;0 | &nbsp; &nbsp; &nbsp; 0 | true &nbsp; |</font></div></div><p></p></pre></div><div><br></div><div>查询测试</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >sql&gt;select count(*) from a;</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >| L1 &nbsp; &nbsp; &nbsp; &nbsp;|</font></div><div><font size="2"   >+===========+</font></div><div><font size="2"   >| 268435456 |</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >1 tuple (0.979ms)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from a where id=1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;1 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (0.920ms)</font></div><div><font size="2"   >sql&gt;select count(*) from a where id&gt;1;</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >| L1 &nbsp; &nbsp; &nbsp; &nbsp;|</font></div><div><font size="2"   >+===========+</font></div><div><font size="2"   >| 268435455 |</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >1 tuple (2.347ms)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from a where id&lt;1;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (2.270ms)</font></div><div><font size="2"   >sql&gt;select count(*) from a where id&lt;&gt;1;</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >| L1 &nbsp; &nbsp; &nbsp; &nbsp;|</font></div><div><font size="2"   >+===========+</font></div><div><font size="2"   >| 268435455 |</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >1 tuple (3.5s)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from a where id is null;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (751.665ms)</font></div><div><font size="2"   >sql&gt;select count(*) from a where id is not null;</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >| L1 &nbsp; &nbsp; &nbsp; &nbsp;|</font></div><div><font size="2"   >+===========+</font></div><div><font size="2"   >| 268435456 |</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >1 tuple (710.477ms)</font></div></div><div><div><font size="2"   >sql&gt;select * from a limit 10;</font></div><div><font size="2"   >+------+----------------------------------+</font></div><div><font size="2"   >| id &nbsp; | info &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</font></div><div><font size="2"   >+======+==================================+</font></div><div><font size="2"   >| &nbsp; &nbsp;1 | 2014-08-13 20:18:53.000000+08:00 |</font></div><div><font size="2"   >| &nbsp; &nbsp;2 | 2014-08-13 20:18:59.000000+08:00 |</font></div><div><font size="2"   >| &nbsp; &nbsp;3 | 2014-08-13 20:20:06.000000+08:00 |</font></div><div><font size="2"   >| &nbsp; &nbsp;4 | 2014-08-13 20:20:06.000000+08:00 |</font></div><div><font size="2"   >| &nbsp; &nbsp;5 | 2014-08-13 20:20:14.000000+08:00 |</font></div><div><font size="2"   >| &nbsp; &nbsp;6 | 2014-08-13 20:20:14.000000+08:00 |</font></div><div><font size="2"   >| &nbsp; &nbsp;7 | 2014-08-13 20:20:14.000000+08:00 |</font></div><div><font size="2"   >| &nbsp; &nbsp;8 | 2014-08-13 20:20:14.000000+08:00 |</font></div><div><font size="2"   >| &nbsp; &nbsp;9 | 2014-08-13 20:20:14.000000+08:00 |</font></div><div><font size="2"   >| &nbsp; 10 | 2014-08-13 20:20:14.000000+08:00 |</font></div><div><font size="2"   >+------+----------------------------------+</font></div><div><font size="2"   >10 tuples (1.581ms)</font></div><div><font size="2"   >sql&gt;select count(*) from a where info='2014-08-13 20:20:14.000000+08:00';</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; 12 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (0.442ms)</font></div><div><font size="2"   >sql&gt;select count(*) from a where info&gt;'2014-08-13 20:20:14.000000+08:00';</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >| L1 &nbsp; &nbsp; &nbsp; &nbsp;|</font></div><div><font size="2"   >+===========+</font></div><div><font size="2"   >| 268435440 |</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >1 tuple (0.844ms)</font></div><div><font size="2"   >sql&gt;select count(*) from a where info&lt;'2014-08-13 20:20:14.000000+08:00';</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;4 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (1.734ms)</font></div><div><font size="2"   >sql&gt;select count(*) from a where info&lt;&gt;'2014-08-13 20:20:14.000000+08:00';</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >| L1 &nbsp; &nbsp; &nbsp; &nbsp;|</font></div><div><font size="2"   >+===========+</font></div><div><font size="2"   >| 268435444 |</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >1 tuple (2.8s)</font></div><div><font size="2"   >sql&gt;select count(*) from a where info is null;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L1 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; &nbsp;0 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (772.987ms)</font></div><div><font size="2"   >sql&gt;select count(*) from a where info is not null;</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >| L1 &nbsp; &nbsp; &nbsp; &nbsp;|</font></div><div><font size="2"   >+===========+</font></div><div><font size="2"   >| 268435456 |</font></div><div><font size="2"   >+-----------+</font></div><div><font size="2"   >1 tuple (747.712ms)</font></div></div><div><div><font size="2"   >sql&gt;select count(*) from (select info from a group by info having count(*) &gt;1) as t;</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >| L2 &nbsp; |</font></div><div><font size="2"   >+======+</font></div><div><font size="2"   >| &nbsp; 18 |</font></div><div><font size="2"   >+------+</font></div><div><font size="2"   >1 tuple (4.7s)</font></div></div><p></p></pre></div><div><br></div><div>PostgreSQL</div><div>插入测试</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >postgres=# create table a(id serial primary key, info text);</font></div><div><font size="2"   >CREATE TABLE</font></div><div><font size="2"   >postgres=# insert into a(info) values (now());</font></div><div><font size="2"   >INSERT 0 1</font></div></div><div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 1</font></div><div><font size="2"   >Time: 0.954 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 2</font></div><div><font size="2"   >Time: 0.606 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 4</font></div><div><font size="2"   >Time: 0.352 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 8</font></div><div><font size="2"   >Time: 0.393 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 16</font></div><div><font size="2"   >Time: 0.476 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 32</font></div><div><font size="2"   >Time: 0.840 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 64</font></div><div><font size="2"   >Time: 1.166 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 128</font></div><div><font size="2"   >Time: 1.632 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 256</font></div><div><font size="2"   >Time: 3.214 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 512</font></div><div><font size="2"   >Time: 5.519 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 1024</font></div><div><font size="2"   >Time: 10.924 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 2048</font></div><div><font size="2"   >Time: 21.212 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 4096</font></div><div><font size="2"   >Time: 41.930 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 8192</font></div><div><font size="2"   >Time: 84.242 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 16384</font></div><div><font size="2"   >Time: 165.705 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 32768</font></div><div><font size="2"   >Time: 332.269 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 65536</font></div><div><font size="2"   >Time: 661.579 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 131072</font></div><div><font size="2"   >Time: 1361.281 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 262144</font></div><div><font size="2"   >Time: 2760.690 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 524288</font></div><div><font size="2"   >Time: 5550.096 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 1048576</font></div><div><font size="2"   >Time: 11221.544 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 2097152</font></div><div><font size="2"   >Time: 22581.858 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 4194304</font></div><div><font size="2"   >Time: 45018.124 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 8388608</font></div><div><font size="2"   >Time: 91126.619 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 16777216</font></div><div><font size="2"   >Time: 183895.102 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 33554432</font></div><div><font size="2"   >Time: 376365.578 ms</font></div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 67108864</font></div><div><font size="2"   >Time: 764031.565 ms</font></div></div><div><div><font size="2"   >postgres=# insert into a(info) select now() from a;</font></div><div><font size="2"   >INSERT 0 134217728</font></div><div><font size="2"   >Time: 1533433.507 ms</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >postgres=# select pg_total_relation_size('a')/1024/1024/1024||'GB';</font></div><div><font size="2"   >&nbsp;?column?&nbsp;</font></div><div><font size="2"   >----------</font></div><div><font size="2"   >&nbsp;22GB</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >Time: 1.027 ms<br></font><div><font size="2"   >postgres=# select pg_relation_size('a')/1024/1024/1024||'GB';</font></div><div><font size="2"   >&nbsp;?column?&nbsp;</font></div><div><font size="2"   >----------</font></div><div><font size="2"   >&nbsp;17GB</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >Time: 0.702 ms</font></div></div></div><p></p></pre></div><div><br></div><div>查询测试</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres=# select count(*) from a;</font></div><div><font size="2"   >&nbsp; &nbsp;count &nbsp;&nbsp;</font></div><div><font size="2"   >-----------</font></div><div><font size="2"   >&nbsp;268435456</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 60818.321 ms</font></div><div><font size="2"   >postgres=# select count(*) from a;</font></div><div><font size="2"   >&nbsp; &nbsp;count &nbsp;&nbsp;</font></div><div><font size="2"   >-----------</font></div><div><font size="2"   >&nbsp;268435456</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 46484.165 ms</font></div><div><font size="2"   >postgres=# select count(*) from a where id=1;</font></div><div><font size="2"   >&nbsp;count&nbsp;</font></div><div><font size="2"   >-------</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;1</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 0.996 ms</font></div><div><font size="2"   >postgres=# select count(*) from a where id&gt;1;</font></div><div><font size="2"   >&nbsp; &nbsp;count &nbsp;&nbsp;</font></div><div><font size="2"   >-----------</font></div><div><font size="2"   >&nbsp;268435455</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 68812.883 ms</font></div><div><font size="2"   >postgres=# select count(*) from a where id&lt;1;</font></div><div><font size="2"   >&nbsp;count&nbsp;</font></div><div><font size="2"   >-------</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;0</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 0.647 ms</font></div><div><font size="2"   >postgres=# select count(*) from a where id&lt;&gt;1;</font></div><div><font size="2"   >&nbsp; &nbsp;count &nbsp;&nbsp;</font></div><div><font size="2"   >-----------</font></div><div><font size="2"   >&nbsp;268435455</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 68710.001 ms</font></div><div><font size="2"   >postgres=# select count(*) from a where id is null;</font></div><div><font size="2"   >&nbsp;count&nbsp;</font></div><div><font size="2"   >-------</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;0</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 0.537 ms</font></div><div><font size="2"   >postgres=# select count(*) from a where id is not null;</font></div><div><font size="2"   >&nbsp; &nbsp;count &nbsp;&nbsp;</font></div><div><font size="2"   >-----------</font></div><div><font size="2"   >&nbsp;268435456</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 64771.858 ms</font></div><div><font size="2"   >postgres=# select * from a limit 10;</font></div><div><font size="2"   >&nbsp;id | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >----+-------------------------------</font></div><div><font size="2"   >&nbsp; 1 | 2014-08-13 20:37:52.165199+08</font></div><div><font size="2"   >&nbsp; 2 | 2014-08-13 20:38:06.945296+08</font></div><div><font size="2"   >&nbsp; 3 | 2014-08-13 20:38:07.965092+08</font></div><div><font size="2"   >&nbsp; 4 | 2014-08-13 20:38:07.965092+08</font></div><div><font size="2"   >&nbsp; 5 | 2014-08-13 20:38:08.502181+08</font></div><div><font size="2"   >&nbsp; 6 | 2014-08-13 20:38:08.502181+08</font></div><div><font size="2"   >&nbsp; 7 | 2014-08-13 20:38:08.502181+08</font></div><div><font size="2"   >&nbsp; 8 | 2014-08-13 20:38:08.502181+08</font></div><div><font size="2"   >&nbsp; 9 | 2014-08-13 20:38:08.966175+08</font></div><div><font size="2"   >&nbsp;10 | 2014-08-13 20:38:08.966175+08</font></div><div><font size="2"   >(10 rows)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 0.629 ms</font></div><div><font size="2"   >postgres=# select count(*) from a where info='2014-08-13 20:38:08.966175+08';</font></div><div><font size="2"   >&nbsp;count&nbsp;</font></div><div><font size="2"   >-------</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;8</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 68005.864 ms</font></div><div><font size="2"   >postgres=# select count(*) from a where info&gt;'2014-08-13 20:38:08.966175+08';</font></div><div><font size="2"   >&nbsp; &nbsp;count &nbsp;&nbsp;</font></div><div><font size="2"   >-----------</font></div><div><font size="2"   >&nbsp;268435440</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 91154.757 ms</font></div><div><font size="2"   >postgres=# select count(*) from a where info&lt;'2014-08-13 20:38:08.966175+08';</font></div><div><font size="2"   >&nbsp;count&nbsp;</font></div><div><font size="2"   >-------</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;8</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 72516.503 ms</font></div><div><font size="2"   >postgres=# select count(*) from a where info&lt;&gt;'2014-08-13 20:38:08.966175+08';</font></div><div><font size="2"   >&nbsp; &nbsp;count &nbsp;&nbsp;</font></div><div><font size="2"   >-----------</font></div><div><font size="2"   >&nbsp;268435448</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 86810.115 ms</font></div><div><font size="2"   >postgres=# select count(*) from a where info is null;</font></div><div><font size="2"   >&nbsp;count&nbsp;</font></div><div><font size="2"   >-------</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;0</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 43593.035 ms</font></div><div><font size="2"   >postgres=# select count(*) from a where info is not null;</font></div><div><font size="2"   >&nbsp; &nbsp;count &nbsp;&nbsp;</font></div><div><font size="2"   >-----------</font></div><div><font size="2"   >&nbsp;268435456</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Time: 65161.258 ms</font></div><div><font size="2"   >postgres=# select count(*) from (select info from a group by info having count(*) &gt;1) as t;</font></div><div><font size="2"   >&nbsp;count&nbsp;</font></div><div><font size="2"   >-------</font></div><div><font size="2"   >&nbsp; &nbsp; 27</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   >Time: 144180.678 ms</font></div><p></p></pre></div><wbr><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020147135859247/"   >http://blog.163.com/digoal@126/blog/static/16387704020147135859247/</a></div><div><br></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="MonetDB vs PostgreSQL with lite case - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>