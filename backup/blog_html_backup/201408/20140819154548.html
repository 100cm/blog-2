<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">what is ARP announcements OR gratuitous</h2>
	<h5 id="">2014-08-19 15:45:48&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201471934548440/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><h2 style="font-weight: normal; margin: 1em 0px 0.25em; overflow: hidden; padding: 0px; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(170, 170, 170); font-family: 'Linux Libertine', Georgia, Times, serif; line-height: 1.3; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;"   ><span id="ARP_announcements"   >ARP announcements</span><span style="-webkit-user-select: none; font-size: small; margin-left: 1em; vertical-align: baseline; line-height: 1em; display: inline-block; white-space: nowrap; unicode-bidi: -webkit-isolate; font-family: sans-serif;"   ><span style="margin-right: 0px; color: rgb(85, 85, 85); margin-left: 0px;"   >[</span><a title="Edit section: ARP announcements" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" rel="nofollow" href="http://en.wikipedia.org/w/index.php?title=Address_Resolution_Protocol&amp;action=edit&amp;section=5"   >edit</a><span style="margin-left: 0px; color: rgb(85, 85, 85); margin-right: 0px;"   >]</span></span></h2><p style="margin-top: 0.5em; margin-bottom: 0.5em; line-height: 22.399999618530273px; color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px;"   >ARP may also be used as a simple announcement protocol. This is useful for updating other hosts' mapping of a hardware address when the sender's IP address or MAC address has changed. Such an announcement, also called a&nbsp;<i>gratuitous ARP</i>&nbsp;message, is usually broadcast as an ARP request containing the sender's protocol address (SPA) in the target field (TPA=SPA), with the target hardware address (THA) set to zero. An alternative is to broadcast an ARP reply with the sender's hardware and protocol addresses (SHA and SPA) duplicated in the target fields (TPA=SPA, THA=SHA).</p><p style="margin-top: 0.5em; margin-bottom: 0.5em; line-height: 22.399999618530273px; color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px;"   >An ARP announcement is not intended to solicit a reply; instead it updates any cached entries in the ARP tables of other hosts that receive the packet. The operation code may indicate a request or a reply because the ARP standard specifies that the opcode is only processed after the ARP table has been updated from the address fields.<sup id="cite_ref-9"   style="line-height: 1; unicode-bidi: -webkit-isolate;"   ><a style="text-decoration: none; color: rgb(11, 0, 128); white-space: nowrap; background: none;" rel="nofollow" href="http://en.wikipedia.org/wiki/Address_Resolution_Protocol#cite_note-9"   >[9]</a></sup><sup id="cite_ref-10"   style="line-height: 1; unicode-bidi: -webkit-isolate;"   ><a style="text-decoration: none; color: rgb(11, 0, 128); white-space: nowrap; background: none;" rel="nofollow" href="http://en.wikipedia.org/wiki/Address_Resolution_Protocol#cite_note-10"   >[10]</a></sup><sup id="cite_ref-11"   style="line-height: 1; unicode-bidi: -webkit-isolate;"   ><a style="text-decoration: none; color: rgb(11, 0, 128); white-space: nowrap; background: none;" rel="nofollow" href="http://en.wikipedia.org/wiki/Address_Resolution_Protocol#cite_note-11"   >[11]</a></sup></p><p style="margin-top: 0.5em; margin-bottom: 0.5em; line-height: 22.399999618530273px; color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px;"   >Many operating systems perform gratuitous ARP during startup. That helps to resolve problems which would otherwise occur if, for example, a&nbsp;<a title="Network interface controller" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" rel="nofollow" href="http://en.wikipedia.org/wiki/Network_interface_controller"   >network card</a>&nbsp;was recently changed (changing the IP-address-to-MAC-address mapping) and other hosts still have the old mapping in their ARP caches.</p><p style="margin-top: 0.5em; margin-bottom: 0.5em; line-height: 22.399999618530273px; color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px;"   >Gratuitous ARP is also used by some interface drivers to provide load balancing for incoming traffic. In a team of network cards, it is used to announce a different MAC address within the team that should receive incoming packets.</p><p style="margin-top: 0.5em; margin-bottom: 0.5em; line-height: 22.399999618530273px; color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px;"   >ARP announcements can be used to defend&nbsp;<a title="Link-local address" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" rel="nofollow" href="http://en.wikipedia.org/wiki/Link-local_address"   >link-local IP addresses</a>&nbsp;in the&nbsp;<a title="Zeroconf" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" class="mw-redirect" rel="nofollow" href="http://en.wikipedia.org/wiki/Zeroconf"   >Zeroconf</a>&nbsp;protocol (<a rel="nofollow" href="http://tools.ietf.org/html/rfc3927"   >RFC 3927</a>), and for IP address takeover within&nbsp;<a title="High-availability cluster" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" rel="nofollow" href="http://en.wikipedia.org/wiki/High-availability_cluster"   >high-availability clusters</a>.</p></div><div><br></div><div>即ARP宣告, 一般IP启动的时候会宣告一下, 告诉路由器自己的IP和mac地址对应关系.</div><div>keepalived中也有这项配置, 例如角色切换成主的时候, 需要宣告一下, 告诉路由器, 我的IP和MAC对应关系, 因为可能变了.</div><div>例如没有使用虚拟MAC地址的话, 虚拟IP对应的MAC肯定是变了的.</div><div><br></div><div>[参考]</div><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://en.wikipedia.org/wiki/Address_Resolution_Protocol"   >http://en.wikipedia.org/wiki/Address_Resolution_Protocol</a></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="what is ARP announcements OR gratuitous - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>