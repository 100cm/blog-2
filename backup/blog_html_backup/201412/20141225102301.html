<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Ceph FINDING AN OBJECT LOCATION</h2>
	<h5 id="">2014-12-25 10:23:01&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402014112510823602/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><div>CEPH作为对象存储时, 例如用于Openstack的对象存储. 如何查找对象在ceph的位置?</div><div>首选, 我们看看如何将数据作为对象存储到ceph :&nbsp;</div><div>1. 需要选择一个池</div><div>2. 需要指定对象名</div><div>例如我把test.img放到ceph的pool1这个池.</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@localhost rbd0]# ceph osd lspools</font></div><div><font size="2"   >0 rbd,1 pool1,</font></div></div><div><div><font size="2"   >[root@localhost rbd0]# rados lspools</font></div><div><font size="2"   >rbd</font></div><div><font size="2"   >pool1</font></div></div><div><div><font size="2"   >[root@localhost rbd0]# ll</font></div><div><font size="2"   >total 1024000</font></div><div><font size="2"   >-rw-r--r-- 1 root root 1048576000 Dec 25 01:43 test.img</font></div></div><p></p></pre></div><div>使用rados把这个文件放到pool1池, 对象名设置为test.img.digoal.</div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost rbd0]# rados put test.img.digoal ./test.img --pool=pool1</font></div><div></div><p></p></pre><div><span style="line-height: 28px;"   >查看池中的对象</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost rbd0]# rados ls --pool=pool1|grep test</font></div><div><font size="2"   >test.img.digoal</font></div><p></p></pre></div><div>查找对象在ceph集群的位置</div></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost rbd0]# ceph osd map pool1 test.img.digoal</font></div><div><font size="2"   >osdmap e62 pool 'pool1' (1) object 'test.img.digoal' -&gt; pg 1.79035c22 (1.22) -&gt; up ([3,0], p3) acting ([3,0], p3)</font></div><p></p></pre></div><wbr><div>导出对象</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost rbd0]# rm -f test.img&nbsp;</font></div><div><font size="2"   >[root@localhost rbd0]# rados get test.img.digoal ./test.img --pool=pool1</font></div><div><font size="2"   >[root@localhost rbd0]# ll</font></div><div><font size="2"   >total 1024000</font></div><div><font size="2"   >-rw-r--r-- 1 root root 1048576000 Dec 25 18:19 test.img</font></div><p></p></pre></div><div>查看对象的信息</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost rbd0]# rados stat test.img.digoal --pool=pool1</font></div><div><font size="2"   >pool1/test.img.digoal mtime 1419502604, size 1048576000</font></div><p></p></pre></div><div>删除对象</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost rbd0]# rados rm test.img.digoal --pool=pool1</font></div><div></div><p></p></pre></div>[参考]<div>1.&nbsp;</div><div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost rbd0]# rados --help</font></div><div><font size="2"   >usage: rados [options] [commands]</font></div><div><font size="2"   >POOL COMMANDS</font></div><div><font size="2"   >&nbsp; &nbsp;lspools &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;list pools</font></div><div><font size="2"   >&nbsp; &nbsp;mkpool &lt;pool-name&gt; [123[ 4]] &nbsp; &nbsp; create pool &lt;pool-name&gt;'</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [with auid 123[and using crush rule 4]]</font></div><div><font size="2"   >&nbsp; &nbsp;cppool &lt;pool-name&gt; &lt;dest-pool&gt; &nbsp; copy content of a pool</font></div><div><font size="2"   >&nbsp; &nbsp;rmpool &lt;pool-name&gt; [&lt;pool-name&gt; --yes-i-really-really-mean-it]</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; remove pool &lt;pool-name&gt;'</font></div><div><font size="2"   >&nbsp; &nbsp;df &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; show per-pool and total usage</font></div><div><font size="2"   >&nbsp; &nbsp;ls &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; list objects in pool</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;chown 123 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;change the pool owner to auid 123</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >OBJECT COMMANDS</font></div><div><font size="2"   >&nbsp; &nbsp;get &lt;obj-name&gt; [outfile] &nbsp; &nbsp; &nbsp; &nbsp; fetch object</font></div><div><font size="2"   >&nbsp; &nbsp;put &lt;obj-name&gt; [infile] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;write object</font></div><div><font size="2"   >&nbsp; &nbsp;truncate &lt;obj-name&gt; length &nbsp; &nbsp; &nbsp; truncate object</font></div><div><font size="2"   >&nbsp; &nbsp;create &lt;obj-name&gt; [category] &nbsp; &nbsp; create object</font></div><div><font size="2"   >&nbsp; &nbsp;rm &lt;obj-name&gt; ... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;remove object(s)</font></div><div><font size="2"   >&nbsp; &nbsp;cp &lt;obj-name&gt; [target-obj] &nbsp; &nbsp; &nbsp; copy object</font></div><div><font size="2"   >&nbsp; &nbsp;clonedata &lt;src-obj&gt; &lt;dst-obj&gt; &nbsp; &nbsp;clone object data</font></div><div><font size="2"   >&nbsp; &nbsp;listxattr &lt;obj-name&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;getxattr &lt;obj-name&gt; attr</font></div><div><font size="2"   >&nbsp; &nbsp;setxattr &lt;obj-name&gt; attr val</font></div><div><font size="2"   >&nbsp; &nbsp;rmxattr &lt;obj-name&gt; attr</font></div><div><font size="2"   >&nbsp; &nbsp;stat objname &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stat the named object</font></div><div><font size="2"   >&nbsp; &nbsp;mapext &lt;obj-name&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;lssnap &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; list snaps</font></div><div><font size="2"   >&nbsp; &nbsp;mksnap &lt;snap-name&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; create snap &lt;snap-name&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;rmsnap &lt;snap-name&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; remove snap &lt;snap-name&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;rollback &lt;obj-name&gt; &lt;snap-name&gt; &nbsp;roll back object to snap &lt;snap-name&gt;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;listsnaps &lt;obj-name&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; list the snapshots of this object</font></div><div><font size="2"   >&nbsp; &nbsp;bench &lt;seconds&gt; write|seq|rand [-t concurrent_operations] [--no-cleanup] [--run-name run_name]</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default is 16 concurrent IOs and 4 MB ops</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default is to clean up after write benchmark</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default run-name is 'benchmark_last_metadata'</font></div><div><font size="2"   >&nbsp; &nbsp;cleanup [--run-name run_name] [--prefix prefix]</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; clean up a previous benchmark operation</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default run-name is 'benchmark_last_metadata'</font></div><div><font size="2"   >&nbsp; &nbsp;load-gen [options] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; generate load on the cluster</font></div><div><font size="2"   >&nbsp; &nbsp;listomapkeys &lt;obj-name&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;list the keys in the object map</font></div><div><font size="2"   >&nbsp; &nbsp;listomapvals &lt;obj-name&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;list the keys and vals in the object map&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp;getomapval &lt;obj-name&gt; &lt;key&gt; [file] show the value for the specified key</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; in the object's object map</font></div><div><font size="2"   >&nbsp; &nbsp;setomapval &lt;obj-name&gt; &lt;key&gt; &lt;val&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;rmomapkey &lt;obj-name&gt; &lt;key&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;getomapheader &lt;obj-name&gt; [file]</font></div><div><font size="2"   >&nbsp; &nbsp;setomapheader &lt;obj-name&gt; &lt;val&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;tmap-to-omap &lt;obj-name&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;convert tmap keys/values to omap</font></div><div><font size="2"   >&nbsp; &nbsp;listwatchers &lt;obj-name&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;list the watchers of this object</font></div><div><font size="2"   >&nbsp; &nbsp;set-alloc-hint &lt;obj-name&gt; &lt;expected-object-size&gt; &lt;expected-write-size&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set allocation hint for an object</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >IMPORT AND EXPORT</font></div><div><font size="2"   >&nbsp; &nbsp;import [options] &lt;local-directory&gt; &lt;rados-pool&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;Upload &lt;local-directory&gt; to &lt;rados-pool&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;export [options] &lt;rados-pool&gt; &lt;local-directory&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;Download &lt;rados-pool&gt; to &lt;local-directory&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;options:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;-f / --force &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Copy everything, even if it hasn't changed.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;-d / --delete-after &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;After synchronizing, delete unreferenced</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; files or objects from the target bucket</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or directory.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;--workers &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Number of worker threads to spawn&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (default 5)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >ADVISORY LOCKS</font></div><div><font size="2"   >&nbsp; &nbsp;lock list &lt;obj-name&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;List all advisory locks on an object</font></div><div><font size="2"   >&nbsp; &nbsp;lock get &lt;obj-name&gt; &lt;lock-name&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;Try to acquire a lock</font></div><div><font size="2"   >&nbsp; &nbsp;lock break &lt;obj-name&gt; &lt;lock-name&gt; &lt;locker-name&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;Try to break a lock acquired by another client</font></div><div><font size="2"   >&nbsp; &nbsp;lock info &lt;obj-name&gt; &lt;lock-name&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;Show lock information</font></div><div><font size="2"   >&nbsp; &nbsp;options:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;--lock-tag &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Lock tag, all locks operation should use</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the same tag</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;--lock-cookie &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Locker cookie</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;--lock-description &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Description of lock</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;--lock-duration &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Lock duration (in seconds)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;--lock-type &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Lock type (shared, exclusive)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >CACHE POOLS: (for testing/development only)</font></div><div><font size="2"   >&nbsp; &nbsp;cache-flush &lt;obj-name&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flush cache pool object (blocking)</font></div><div><font size="2"   >&nbsp; &nbsp;cache-try-flush &lt;obj-name&gt; &nbsp; &nbsp; &nbsp; flush cache pool object (non-blocking)</font></div><div><font size="2"   >&nbsp; &nbsp;cache-evict &lt;obj-name&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; evict cache pool object</font></div><div><font size="2"   >&nbsp; &nbsp;cache-flush-evict-all &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;flush+evict all objects</font></div><div><font size="2"   >&nbsp; &nbsp;cache-try-flush-evict-all &nbsp; &nbsp; &nbsp; &nbsp;try-flush+evict all objects</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >GLOBAL OPTIONS:</font></div><div><font size="2"   >&nbsp; &nbsp;--object_locator object_locator</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; set object_locator for operation</font></div><div><font size="2"   >&nbsp; &nbsp;-p pool</font></div><div><font size="2"   >&nbsp; &nbsp;--pool=pool</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; select given pool by name</font></div><div><font size="2"   >&nbsp; &nbsp;--target-pool=pool</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; select target pool by name</font></div><div><font size="2"   >&nbsp; &nbsp;-b op_size</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; set the size of write ops for put or benchmarking</font></div><div><font size="2"   >&nbsp; &nbsp;-s name</font></div><div><font size="2"   >&nbsp; &nbsp;--snap name</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; select given snap name for (read) IO</font></div><div><font size="2"   >&nbsp; &nbsp;-i infile</font></div><div><font size="2"   >&nbsp; &nbsp;--create</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; create the pool or directory that was specified</font></div><div><font size="2"   >&nbsp; &nbsp;-N namespace</font></div><div><font size="2"   >&nbsp; &nbsp;--namespace=namespace</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; specify the namespace to use for the object</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >BENCH OPTIONS:</font></div><div><font size="2"   >&nbsp; &nbsp;-t N</font></div><div><font size="2"   >&nbsp; &nbsp;--concurrent-ios=N</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Set number of concurrent I/O operations</font></div><div><font size="2"   >&nbsp; &nbsp;--show-time</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; prefix output with date/time</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >LOAD GEN OPTIONS:</font></div><div><font size="2"   >&nbsp; &nbsp;--num-objects &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;total number of objects</font></div><div><font size="2"   >&nbsp; &nbsp;--min-object-size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;min object size</font></div><div><font size="2"   >&nbsp; &nbsp;--max-object-size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;max object size</font></div><div><font size="2"   >&nbsp; &nbsp;--min-ops &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;min number of operations</font></div><div><font size="2"   >&nbsp; &nbsp;--max-ops &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;max number of operations</font></div><div><font size="2"   >&nbsp; &nbsp;--max-backlog &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;max backlog (in MB)</font></div><div><font size="2"   >&nbsp; &nbsp;--percent &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;percent of operations that are read</font></div><div><font size="2"   >&nbsp; &nbsp;--target-throughput &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;target throughput (in MB)</font></div><div><font size="2"   >&nbsp; &nbsp;--run-length &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; total time (in seconds)</font></div><p></p></pre></div><wbr><div>2.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://ceph.com/docs/master/rados/operations/monitoring-osd-pg/"   >http://ceph.com/docs/master/rados/operations/monitoring-osd-pg/</a></div><div><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div><div style="line-height: 28px;"   ><font size="2"   >To store object data in the Ceph Object Store, a Ceph client must:</font></div><div style="line-height: 28px;"   ><font size="2"   >1. Set an object name</font></div><div style="line-height: 28px;"   ><font size="2"   >2. Specify a pool</font></div><div style="line-height: 28px;"   ><font size="2"   ><br style="line-height: 28px;"   ></font></div><div style="line-height: 28px;"   ><font size="2"   >The Ceph client retrieves the latest cluster map and the CRUSH algorithm calculates how to map the object to a placement group, and then calculates how to assign the placement group to an OSD dynamically. To find the object location, all you need is the object name and the pool name. For example:</font></div><div style="line-height: 28px;"   ><font size="2"   ><br style="line-height: 28px;"   ></font></div><div style="line-height: 28px;"   ><font size="2"   >ceph osd map {poolname} {object-name}</font></div><div style="line-height: 28px;"   ><font size="2"   >Exercise: Locate an Object</font></div><div style="line-height: 28px;"   ><font size="2"   ><br style="line-height: 28px;"   ></font></div><div style="line-height: 28px;"   ><font size="2"   >As an exercise, lets create an object. Specify an object name, a path to a test file containing some object data and a pool name using the rados put command on the command line. For example:</font></div><div style="line-height: 28px;"   ><font size="2"   ><br style="line-height: 28px;"   ></font></div><div style="line-height: 28px;"   ><font size="2"   >rados put {object-name} {file-path} --pool=data</font></div><div style="line-height: 28px;"   ><font size="2"   >rados put test-object-1 testfile.txt --pool=data</font></div><div style="line-height: 28px;"   ><font size="2"   >To verify that the Ceph Object Store stored the object, execute the following:</font></div><div style="line-height: 28px;"   ><font size="2"   ><br style="line-height: 28px;"   ></font></div><div style="line-height: 28px;"   ><font size="2"   >rados -p data ls</font></div><div style="line-height: 28px;"   ><font size="2"   >Now, identify the object location:</font></div><div style="line-height: 28px;"   ><font size="2"   ><br style="line-height: 28px;"   ></font></div><div style="line-height: 28px;"   ><font size="2"   >ceph osd map {pool-name} {object-name}</font></div><div style="line-height: 28px;"   ><font size="2"   >ceph osd map data test-object-1</font></div><div style="line-height: 28px;"   ><font size="2"   >Ceph should output the object’s location. For example:</font></div><div style="line-height: 28px;"   ><font size="2"   ><br style="line-height: 28px;"   ></font></div><div style="line-height: 28px;"   ><font size="2"   >osdmap e537 pool 'data' (0) object 'test-object-1' -&gt; pg 0.d1743484 (0.4) -&gt; up [1,0] acting [1,0]</font></div><div style="line-height: 28px;"   ><font size="2"   >To remove the test object, simply delete it using the rados rm command. For example:</font></div><div style="line-height: 28px;"   ><font size="2"   ><br style="line-height: 28px;"   ></font></div><div style="line-height: 28px;"   ><font size="2"   >rados rm test-object-1 --pool=data</font></div><div style="line-height: 28px;"   ><font size="2"   >As the cluster evolves, the object location may change dynamically. One benefit of Ceph’s dynamic rebalancing is that Ceph relieves you from having to perform the migration manually. See the Architecture section for details.</font></div></div><div style="line-height: 28px;"   ></div><p></p></pre></div></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="Ceph FINDING AN OBJECT LOCATION - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a><br></div></div>
	</div>
</div>
</body>
</html>