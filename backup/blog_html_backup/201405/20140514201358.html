<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Postgres-XL MPP improved from Postgres-XC , stormDB</h2>
	<h5 id="">2014-05-14 20:13:58&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201441423449445/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>Postgres-XL是从Postgres-XC衍生而来的一款产品, 经过改良, 对MPP这块做了比较大的改进.</div><div>所以它同样包含了4个组件</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >GTM</font></div><div><font size="2"   >GTM stands for Global Transaction Manager. It provides global transaction ID and snapshot to each transaction in Postgres-XL database cluster. It also provide several global value such as sequence and global timestamp.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >GTM itself can be configured as a backup of other GTM as GTM-Standby so that GTM can continue to run even if main GTM fails. You may want to install GTM-Standby to separate server.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >GTM-Proxy</font></div><div><font size="2"   >Because GTM has to take care of each transaction, it has to read and write enormous amount of messages which may restrict Postgres-XL scalability. GTM-Proxy is a proxy of GTM feature which groups requests and response to reduce network read/write by GTM. Distributing one snapshot to multiple transactions also contributes to reduce GTM network workload.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Coordinator</font></div><div><font size="2"   >The Coordinator is an entry point to Postgres-XL from applications. You can run more than one Coordinator simultaneously in the cluster. Each Coordinator behaves just as a PostgreSQL database server, while all the Coordinators handles transactions in harmonized way so that any transaction coming into one Coordinator is protected against any other transactions coming into others. Updates by a transaction is visible immediately to others running in other Coordinators. To simplify the load balance of Coordinators and Datanodes, as mentioned below, it is highly advised to install same number of Coordinator and Datanode in a server.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Datanode</font></div><div><font size="2"   >Datanode</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >The Coordinator and Datanode shares the same binary but their behavior is a little different. The Coordinator decomposes incoming statements into those handled by Datanodes. If necessary, the Coordinator materializes response from Datanodes to calculate final response to applications.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >The Datanode is very close to PostgreSQL itself because it just handles incoming statements locally.</font></div><p></p></pre></div><div>来看一下pg-xl和postgresql, pg-xc的对比 :&nbsp;</div><div><table width="100%"   border="0"   cellspacing="0"   cellpadding="15"   style="color: rgb(85, 85, 85); font-family: Arial, Helvetica, sans-serif; font-size: 14px; line-height: normal;"   ><tbody><tr><td style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); background-color: rgb(221, 221, 221); font-size: 18px; color: rgb(184, 0, 0); font-weight: bold; background-position: initial initial; background-repeat: initial initial;"   >PostgreSQL</td><td style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(255, 255, 255); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(255, 255, 255); background-color: rgb(221, 221, 221); font-size: 18px; color: rgb(184, 0, 0); font-weight: bold; background-position: initial initial; background-repeat: initial initial;"   >Postgres-XC</td><td style="border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); background-color: rgb(221, 221, 221); font-size: 18px; color: rgb(184, 0, 0); font-weight: bold; background-position: initial initial; background-repeat: initial initial;"   >Postgres-XL</td></tr><tr><td style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"   ><font color="#000000"   >Open source SQL database for Enterprises</font></td><td style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(238, 238, 238); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"   ><font color="#000000"   >Open source SQL database for Enterprises</font></td><td style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221);"   ><font color="#000000"   >Open source SQL database for Enterprises</font></td></tr><tr><td style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"   ><font color="#000000"   >&nbsp;</font></td><td style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(238, 238, 238); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"   ><font color="#000000"   >Large coverage of PostgreSQL support</font></td><td style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221);"   ><font color="#000000"   >Large coverage of PostgreSQL support</font></td></tr><tr><td align="center"   style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"   ><font color="#000000"   >―</font></td><td style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(238, 238, 238); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"   ><font color="#000000"   >Global MVCC Consistency</font></td><td style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221);"   ><font color="#000000"   >Global MVCC Consistency</font></td></tr><tr><td align="center"   style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"   ><font color="#000000"   >―</font></td><td align="center"   style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(238, 238, 238); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"   ><font color="#000000"   >―</font></td><td style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221);"   ><font color="#000000"   >MPP query support</font></td></tr><tr><td align="center"   style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"   ><font color="#000000"   >―</font></td><td align="center"   style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(238, 238, 238); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"   ><font color="#000000"   >―</font></td><td style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221);"   ><font color="#000000"   >Performance improvements</font></td></tr><tr><td align="center"   style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"   ><font color="#000000"   >―</font></td><td align="center"   style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(221, 221, 221); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(238, 238, 238); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"   ><font color="#000000"   >―</font></td><td style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221);"   ><font color="#000000"   >Multi-tenant security</font></td></tr></table><p style="line-height: 21px; color: rgb(85, 85, 85); font-family: Arial, Helvetica, sans-serif; font-size: 14px; margin-top: 0px; margin-bottom: 0px;"   >&nbsp;</p><p style="line-height: 21px; font-family: Arial, Helvetica, sans-serif; font-size: 14px; margin-bottom: 0in;"   >In vanilla PostgreSQL and Postgres-XC, users of the database can get cluster information such as other database names. In Postgres-XL, this has been locked down for enhanced security in multi-tenant environments.</p><p style="line-height: 21px; font-family: Arial, Helvetica, sans-serif; font-size: 14px; margin-bottom: 0in;"   >Without MPP parallelism, Postgres-XC can struggle with certain types of queries, where it may ship entire tables to a single coordinator for joining. In comparison, the Postgres-XL architecture is massively parallel with fully parallel query plans for analytical Business Intelligence workloads; each data node can communicate with one another. Postgres-XL can uniquely handle such queries with a write transaction heavy workload at the same time.</p><p style="line-height: 21px; color: rgb(85, 85, 85); font-family: Arial, Helvetica, sans-serif; font-size: 14px; margin-bottom: 0in;"   ><br></p></div><div>安装方法和pg-xc相差无几, 可参考我以前写过的BLOG.</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020133292915600/"   >http://blog.163.com/digoal@126/blog/static/16387704020133292915600/</a></div><div>下面以CentOS 6.5 x64为例, 简单的写一下软件安装的过程.</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   ># yum -y install lrzsz sysstat e4fsprogs ntp readline-devel zlib zlib-devel openssl openssl-devel pam-devel libxml2-devel libxslt-devel python-devel tcl-devel gcc make smartmontools flex bison perl perl-devel perl-ExtUtils* OpenIPMI-tools&nbsp;openjade&nbsp;libxslt</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   ><span style="line-height: 28px;"   >#&nbsp;</span>wget http://files.postgres-xl.org/release/9.2rc/postgres-xl-v9.2-src.tar.gz</font></div><div><div><font size="2"   ><span style="line-height: 28px;"   >#&nbsp;</span>tar -zxvf postgres-xl-v9.2-src.tar.gz&nbsp;</font></div><div><font size="2"   ><span style="line-height: 28px;"   >#&nbsp;</span>cd postgres-xl</font></div></div><div><font size="2"   >[root@db-172-16-3-150 postgres-xl]# useradd pgxl</font></div><div><font size="2"   >[root@db-172-16-3-150 postgres-xl]# ./configure --prefix=/home/pgxl/pgxl9.2 --with-pgport=11921 --with-perl --with-tcl --with-python --with-openssl --with-pam --without-ldap --with-libxml --with-libxslt --enable-thread-safety --enable-dtrace --enable-debug --enable-cassert</font></div><div><span style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-150 postgres-xl]# gmake world</font></span></div><div><span style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-150 postgres-xl]# gmake install-world</font></span></div><div><div><font size="2"   >[root@db-172-16-3-150 postgres-xl]# su - pgxl</font></div><div><font size="2"   >[pgxl@db-172-16-3-150 ~]$ ll</font></div><div><font size="2"   >total 4</font></div><div><font size="2"   >drwxr-xr-x 6 root root 4096 May 14 15:30 pgxl9.2</font></div></div><div><font size="2"   >[pgxl@db-172-16-3-150 ~]$ vi .bash_profile&nbsp;</font></div><div><font size="2"   ># add by digoal</font></div><div><div><font size="2"   >export PS1="$USER@`/bin/hostname -s`-&gt; "</font></div><div><font size="2"   >export PGDATA=/ssd4/pgxl/coordinator/pg_root</font></div><div><font size="2"   >export LANG=en_US.utf8</font></div><div><font size="2"   >export PGHOME=/home/pgxl/pgxl9.2</font></div><div><font size="2"   >export LD_LIBRARY_PATH=$PGHOME/lib:/lib64:/usr/lib64:/usr/local/lib64:/lib:/usr/lib:/usr/local/lib:$LD_LIBRARY_PATH</font></div><div><font size="2"   >export DATE=`date +"%Y%m%d%H%M"`</font></div><div><font size="2"   >export PATH=$PGHOME/bin:$PATH:.</font></div><div><font size="2"   >export MANPATH=$PGHOME/share/man:$MANPATH</font></div><div><font size="2"   >export PGHOST=$PGDATA</font></div><div><font size="2"   >export PGPORT=11921</font></div><div><font size="2"   >export PGUSER=postgres</font></div><div><font size="2"   >export PGDATABASE=digoal</font></div><div><font size="2"   >alias rm='rm -i'</font></div><div><font size="2"   >alias ll='ls -lh'</font></div></div><div><div><font size="2"   >[pgxl@db-172-16-3-150 ~]$ . .bash_profile&nbsp;</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; which psql</font></div><div><font size="2"   >~/pgxl9.2/bin/psql</font></div></div><div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; psql -V</font></div><div><font size="2"   >psql (Postgres-XL) 9.2.0</font></div><div><font size="2"   >(based on PostgreSQL) 9.2.4 (Postgres-XL 9.2.0)</font></div></div><div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; which gtm</font></div><div><font size="2"   >~/pgxl9.2/bin/gtm</font></div></div><p></p></pre></div><div>数据库集群配置 :&nbsp;</div><div>4个coordinator</div><div>4个datanode</div><div>4个gtm-proxy</div><div>1个gtm</div><div>1个gtm-standby</div><div>合理的配置对应的服务器 :&nbsp;</div><div>coordinator, datanode, gtm-proxy3个组件放在1台服务器上, 共计耗费4台服务器.</div><div>gtm和gtm-standby各耗费1台服务器, 共计耗费2台服务器.</div><div>总共需要6台服务器.</div><div>本例的话把他们全部放在1台服务器上.</div><div><pre class="prettyprint"   ><p></p><div><span style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-150 ssd3]# mkdir -p /ssd3/pgxl/coord11921</font></span></div><div><div><font size="2"   >[root@db-172-16-3-150 ssd3]# mkdir -p /ssd3/pgxl/coord11922</font></div><div><font size="2"   >[root@db-172-16-3-150 ssd3]# mkdir -p /ssd3/pgxl/datan12921</font></div><div><font size="2"   >[root@db-172-16-3-150 ssd3]# mkdir -p /ssd3/pgxl/datan12922</font></div><div><font size="2"   >[root@db-172-16-3-150 ssd3]# mkdir -p /ssd4/pgxl/coord11923</font></div><div><font size="2"   >[root@db-172-16-3-150 ssd3]# mkdir -p /ssd4/pgxl/coord11924</font></div><div><font size="2"   >[root@db-172-16-3-150 ssd3]# mkdir -p /ssd4/pgxl/datan12923</font></div><div><font size="2"   >[root@db-172-16-3-150 ssd3]# mkdir -p /ssd4/pgxl/datan12924</font></div><div><font size="2"   >[root@db-172-16-3-150 ssd3]# chown -R pgxl:pgxl /ssd3/pgxl</font></div><div><font size="2"   >[root@db-172-16-3-150 ssd3]# chown -R pgxl:pgxl /ssd4/pgxl</font></div></div><p></p></pre></div><div>初始化数据库集群 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@db-172-16-3-150 ssd3]# su - pgxl</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; initdb -D /ssd3/pgxl/coord11921 -E UTF8 --locale=C -U postgres -W --nodename coord11921</font></div></div><div><div style="line-height: 28px;"   ><font size="2"   >pgxl@db-172-16-3-150-&gt; initdb -D /ssd3/pgxl/coord11922 -E UTF8 --locale=C -U postgres -W --nodename coord11922</font></div><div><div style="line-height: 28px;"   ><font size="2"   >pgxl@db-172-16-3-150-&gt; initdb -D /ssd4/pgxl/coord11923 -E UTF8 --locale=C -U postgres -W --nodename coord11923</font></div><div><div style="line-height: 28px;"   ><font size="2"   >pgxl@db-172-16-3-150-&gt; initdb -D /ssd4/pgxl/coord11924 -E UTF8 --locale=C -U postgres -W --nodename coord11924</font></div><div><div style="line-height: 28px;"   ><font size="2"   >pgxl@db-172-16-3-150-&gt; initdb -D /ssd3/pgxl/datan12921 -E UTF8 --locale=C -U postgres -W --nodename datan12921</font></div><div><div style="line-height: 28px;"   ><font size="2"   >pgxl@db-172-16-3-150-&gt; initdb -D /ssd3/pgxl/datan12922 -E UTF8 --locale=C -U postgres -W --nodename datan12922</font></div><div><div style="line-height: 28px;"   ><font size="2"   >pgxl@db-172-16-3-150-&gt; initdb -D /ssd4/pgxl/datan12923 -E UTF8 --locale=C -U postgres -W --nodename datan12923</font></div><div><div style="line-height: 28px;"   ><font size="2"   >pgxl@db-172-16-3-150-&gt; initdb -D /ssd4/pgxl/datan12924 -E UTF8 --locale=C -U postgres -W --nodename datan12924</font></div></div></div></div></div></div></div></div><p></p></pre></div><div><div style="line-height: 28px;"   ><br></div><div style="line-height: 28px;"   >配置和启动GTM以及gtm standby :&nbsp;</div><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><div><font size="2"   >[root@db-172-16-3-150 ~]# mkdir /ssd3/pgxl/gtm13921</font></div><div><font size="2"   >[root@db-172-16-3-150 ~]# mkdir /ssd4/pgxl/gtm13922</font></div></div><div style="line-height: 28px;"   ><div><font size="2"   >[root@db-172-16-3-150 ~]# chown -R pgxl:pgxl /ssd3/pgxl</font></div><div><font size="2"   >[root@db-172-16-3-150 ~]# chown -R pgxl:pgxl /ssd4/pgxl</font></div></div><div><div><font size="2"   >[root@db-172-16-3-150 ~]# su - pgxl</font></div><div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; initgtm --help</font></div><div><font size="2"   >initgtm initializes GTM for a Postgres-XL database cluster.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Usage:</font></div><div><font size="2"   >&nbsp; initgtm [NODE-TYPE] [OPTION]... [DATADIR]</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Options:</font></div><div><font size="2"   >&nbsp;[-D, --pgdata=]DATADIR &nbsp; &nbsp; location for this GTM node</font></div><div><font size="2"   >&nbsp;[-Z]NODE-TYPE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;can be "gtm" or "gtm_proxy"</font></div><div><font size="2"   >Less commonly used options:</font></div><div><font size="2"   >&nbsp; -d, --debug &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; generate lots of debugging output</font></div><div><font size="2"   >&nbsp; -n, --noclean &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do not clean up after errors</font></div><div><font size="2"   >&nbsp; -s, --show &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;show internal settings</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Other options:</font></div><div><font size="2"   >&nbsp; -?, --help &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;show this help, then exit</font></div><div><font size="2"   >&nbsp; -V, --version &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output version information, then exit</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; initgtm -Z gtm -D /ssd3/pgxl/gtm13921</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; cd /ssd3/pgxl/gtm13921/</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; vi gtm.conf</font></div><div><div><font size="2"   >nodename = 'gtm13921' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Specifies the node name.</font></div><div><font size="2"   >listen_addresses = '0.0.0.0' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Listen addresses of this GTM.</font></div><div><font size="2"   >port = 13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Port number of this GTM.</font></div><div><font size="2"   >startup = ACT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Start mode. ACT/STANDBY.</font></div><div><font size="2"   >keepalives_idle = 60 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Keepalives_idle parameter.</font></div><div><font size="2"   >keepalives_interval = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Keepalives_interval parameter.</font></div><div><font size="2"   >keepalives_count = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Keepalives_count internal parameter.</font></div><div><font size="2"   >log_file = 'gtm.log' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Log file name</font></div><div><font size="2"   >log_min_messages = WARNING &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# log_min_messages. &nbsp;Default WARNING.</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl start -Z gtm -D /ssd3/pgxl/gtm13921</font></div><div><font size="2"   >server starting</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; initgtm -Z gtm -D /ssd4/pgxl/gtm13922</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; vi /ssd4/pgxl/gtm13922/gtm.conf</font></div><div><div><font size="2"   >nodename = 'gtm13922' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Specifies the node name.</font></div><div><font size="2"   >listen_addresses = '0.0.0.0' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Listen addresses of this GTM.</font></div><div><font size="2"   >port = 13922 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Port number of this GTM.</font></div><div><font size="2"   >startup = STANDBY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Start mode. ACT/STANDBY.</font></div><div><font size="2"   >active_host = '172.16.3.150' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Listen address of active GTM.</font></div><div><font size="2"   >active_port = 13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Port number of active GTM.</font></div><div><font size="2"   >keepalives_idle = 60 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Keepalives_idle parameter.</font></div><div><font size="2"   >keepalives_interval = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Keepalives_interval parameter.</font></div><div><font size="2"   >keepalives_count = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Keepalives_count internal parameter.</font></div><div><font size="2"   >log_file = 'gtm.log' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Log file name</font></div><div><font size="2"   >log_min_messages = WARNING &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# log_min_messages. &nbsp;Default WARNING.</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl start -Z gtm -D /ssd4/pgxl/gtm13922</font></div><div><font size="2"   >server starting</font></div></div></div><p></p></pre></div><div><div><br></div><div>配置和启动gtm-proxy :&nbsp;</div></div></div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@db-172-16-3-150 ~]# mkdir /ssd3/pgxl/gtm14921</font></div><div><font size="2"   >[root@db-172-16-3-150 ~]# mkdir /ssd3/pgxl/gtm14922</font></div><div><font size="2"   >[root@db-172-16-3-150 ~]# mkdir /ssd4/pgxl/gtm14923</font></div><div><font size="2"   >[root@db-172-16-3-150 ~]# mkdir /ssd4/pgxl/gtm14924</font></div><div><font size="2"   >[root@db-172-16-3-150 ~]# chown -R pgxl:pgxl /ssd3/pgxl</font></div><div><font size="2"   >[root@db-172-16-3-150 ~]# chown -R pgxl:pgxl /ssd4/pgxl</font></div></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; initgtm -Z gtm_proxy -D /ssd3/pgxl/gtm14921</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; initgtm -Z gtm_proxy -D /ssd3/pgxl/gtm14922</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; initgtm -Z gtm_proxy -D /ssd4/pgxl/gtm14923</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; initgtm -Z gtm_proxy -D /ssd4/pgxl/gtm14924</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; vi /ssd3/pgxl/gtm14921/gtm_proxy.conf</font></div><div><div><font size="2"   >nodename = 'gtm14921' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Specifies the node name.</font></div><div><font size="2"   >listen_addresses = '0.0.0.0' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Listen addresses of this GTM.</font></div><div><font size="2"   >port = 14921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Port number of this GTM.</font></div><div><font size="2"   >worker_threads = 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Number of the worker thread of this</font></div><div><font size="2"   >gtm_host = '172.16.3.150' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Listen address of the active GTM.</font></div><div><font size="2"   >gtm_port = 13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Port number of the active GTM.</font></div><div><font size="2"   >gtm_connect_retry_interval = 5 &nbsp;# How long (in secs) to wait until the next</font></div><div><font size="2"   >keepalives_idle = 60 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Keepalives_idle parameter.</font></div><div><font size="2"   >keepalives_interval = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Keepalives_interval parameter.</font></div><div><font size="2"   >keepalives_count = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Keepalives_count internal parameter.</font></div><div><font size="2"   >log_file = 'gtm_proxy.log' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Log file name</font></div><div><font size="2"   >log_min_messages = WARNING &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# log_min_messages. &nbsp;Default WARNING.</font></div></div><div><font size="2"   >另外几个配置略, 端口和名字改一下即可.</font></div><div><font size="2"   >启动gtm_proxy</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl start -Z gtm_proxy -D /ssd3/pgxl/gtm14921</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl start -Z gtm_proxy -D /ssd3/pgxl/gtm14922</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl start -Z gtm_proxy -D /ssd4/pgxl/gtm14923</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl start -Z gtm_proxy -D /ssd4/pgxl/gtm14924</font></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; netstat -anp|grep 13921</font></div><div><font size="2"   >(Not all processes could be identified, non-owned process info</font></div><div><font size="2"   >&nbsp;will not be shown, you would have to be root to see it all.)</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;1768/gtm &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:54576 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 1768/gtm &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:54572 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 1768/gtm &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:54570 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 2637/gtm_proxy &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:54566 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 1768/gtm &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:54570 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 1768/gtm &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:54564 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 1768/gtm &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:54546 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 2606/gtm_proxy &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:54578 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 2653/gtm_proxy &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:54578 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 1768/gtm &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:54544 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 1768/gtm &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:54564 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 2622/gtm_proxy &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:54566 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 2622/gtm_proxy &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:54546 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 1768/gtm &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:54572 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 2637/gtm_proxy &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:54576 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 2653/gtm_proxy &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.150:54544 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172.16.3.150:13921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 2606/gtm_proxy &nbsp; &nbsp; &nbsp;</font></div></div><p></p></pre></div><div><br></div><div>配置和启动datanode 节点 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pgxl@db-172-16-3-150-&gt; cd /ssd3/pgxl/datan12921</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; vi pg_hba.conf</font></div><div><font size="2"   >host all all 127.0.0.1/32 trust<br>host all all 172.16.3.150/32 trust</font></div><div><font size="2"   >其他几个数据节点同上.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; vi postgresql.conf</font></div><div><div><font size="2"   >listen_addresses = '0.0.0.0' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# what IP address(es) to listen on;</font></div><div><font size="2"   >port = 12921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# (change requires restart)</font></div><div><font size="2"   >max_connections = 400 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # (change requires restart)</font></div><div><font size="2"   >superuser_reserved_connections = 13 &nbsp; &nbsp; # (change requires restart)</font></div><div><font size="2"   >unix_socket_directory = '.' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # (change requires restart)</font></div><div><font size="2"   >tcp_keepalives_idle = 60 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# TCP_KEEPIDLE, in seconds;</font></div><div><font size="2"   >tcp_keepalives_interval = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# TCP_KEEPINTVL, in seconds;</font></div><div><font size="2"   >tcp_keepalives_count = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # TCP_KEEPCNT;</font></div><div><font size="2"   >shared_buffers = 2048MB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # min 128kB</font></div><div><font size="2"   >maintenance_work_mem = 512MB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# min 1MB</font></div><div><font size="2"   >vacuum_cost_delay = 10ms &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 0-100 milliseconds</font></div><div><font size="2"   >vacuum_cost_limit = 10000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 1-10000 credits</font></div><div><font size="2"   >bgwriter_delay = 10ms &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 10-10000ms between rounds</font></div><div><font size="2"   >shared_queues = 64 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# min 16 &nbsp;&nbsp;</font></div><div><font size="2"   >shared_queue_size = 2048kB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# min 16KB</font></div><div><font size="2"   >synchronous_commit = off &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# synchronization level;</font></div><div><font size="2"   >wal_buffers = 16384kB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # min 32kB, -1 sets based on shared_buffers</font></div><div><font size="2"   >wal_writer_delay = 10ms &nbsp; &nbsp; &nbsp; &nbsp; # 1-10000 milliseconds</font></div><div><font size="2"   >checkpoint_segments = 128 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # in logfile segments, min 1, 16MB each</font></div><div><font size="2"   >network_byte_cost = 0.001 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # same scale as above</font></div><div><font size="2"   >remote_query_cost = 100.0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # same scale as above</font></div><div><font size="2"   >effective_cache_size = 96000MB</font></div><div><font size="2"   >log_destination = 'csvlog' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Valid values are combinations of</font></div><div><font size="2"   >logging_collector = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Enable capturing of stderr and csvlog</font></div><div><font size="2"   >log_truncate_on_rotation = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # If on, an existing log file with the</font></div><div><font size="2"   >log_checkpoints = on</font></div><div><font size="2"   >log_connections = on</font></div><div><font size="2"   >log_disconnections = on</font></div><div><font size="2"   >log_error_verbosity = verbose &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # terse, default, or verbose messages</font></div><div><font size="2"   >log_statement = 'ddl' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # none, ddl, mod, all</font></div><div><font size="2"   >log_timezone = 'PRC'</font></div><div><font size="2"   >log_autovacuum_min_duration = 0 # -1 disables, 0 logs all actions and</font></div><div><font size="2"   >datestyle = 'iso, mdy'</font></div><div><font size="2"   >timezone = 'PRC'</font></div><div><font size="2"   >lc_messages = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # locale for system error message</font></div><div><font size="2"   >lc_monetary = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # locale for monetary formatting</font></div><div><font size="2"   >lc_numeric = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# locale for number formatting</font></div><div><font size="2"   >lc_time = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # locale for time formatting</font></div><div><font size="2"   >default_text_search_config = 'pg_catalog.english'</font></div><div><font size="2"   >pooler_port = 16921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Pool Manager TCP port</font></div><div><font size="2"   >max_pool_size = 100 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Maximum pool size</font></div><div><font size="2"   >pool_conn_keepalive = 60 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Close connections if they are idle</font></div><div><font size="2"   >pool_maintenance_timeout = 30 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Launch maintenance routine if pooler</font></div><div><span style="line-height: 28px;"   ><font size="2"   >max_coordinators = 16 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Maximum number of Coordinators</font></span></div><div><font size="2"   >max_datanodes = 16 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Maximum number of Datanodes</font></div><div><font size="2"   >gtm_host = 'localhost' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Host name or address of GTM</font></div><div><font size="2"   >gtm_port = 14921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Port of GTM</font></div><div><font size="2"   >pgxc_node_name = 'datan12921' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Coordinator or Datanode name</font></div></div><div><font size="2"   >其他节点配置同上, 修改对应端口</font></div><div><font size="2"   >启动datanode</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z datanode -D /ssd3/pgxl/datan12921&nbsp;</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z datanode -D /ssd3/pgxl/datan12922</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z datanode -D /ssd4/pgxl/datan12923&nbsp;</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z datanode -D /ssd4/pgxl/datan12924&nbsp;</font></div><p></p></pre></div><div><br></div><div>配置和启动coordinator 节点 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pgxl@db-172-16-3-150-&gt; cd /ssd3/pgxl/coord11921</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; vi pg_hba.conf&nbsp;</font></div><div><div><font size="2"   >host all all 127.0.0.1/32 trust</font></div><div><font size="2"   >host all all 172.16.3.150/32 trust</font></div></div><div><font size="2"   >host all all 0.0.0.0/0 md5</font></div><p></p></pre></div><div>其他几个节点同上.</div><div><br></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pgxl@db-172-16-3-150-&gt; vi postgresql.conf</font></div><div><div><font size="2"   >listen_addresses = '0.0.0.0' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# what IP address(es) to listen on;</font></div><div><font size="2"   >port = 11921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# (change requires restart)</font></div><div><font size="2"   >max_connections = 100 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # (change requires restart)</font></div><div><font size="2"   >superuser_reserved_connections = 13 &nbsp; &nbsp; # (change requires restart)</font></div><div><font size="2"   >unix_socket_directory = '.' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # (change requires restart)</font></div><div><font size="2"   >tcp_keepalives_idle = 60 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# TCP_KEEPIDLE, in seconds;</font></div><div><font size="2"   >tcp_keepalives_interval = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# TCP_KEEPINTVL, in seconds;</font></div><div><font size="2"   >tcp_keepalives_count = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # TCP_KEEPCNT;</font></div><div><font size="2"   >shared_buffers = 1024MB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # min 128kB</font></div><div><font size="2"   >max_prepared_transactions = 16 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# zero disables the feature</font></div><div><font size="2"   >maintenance_work_mem = 512MB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# min 1MB</font></div><div><font size="2"   >vacuum_cost_delay = 10ms &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 0-100 milliseconds</font></div><div><font size="2"   >vacuum_cost_limit = 10000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 1-10000 credits</font></div><div><font size="2"   >bgwriter_delay = 10ms &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 10-10000ms between rounds</font></div><div><font size="2"   >synchronous_commit = on &nbsp; &nbsp; &nbsp; &nbsp; # synchronization level;</font></div><div><font size="2"   >checkpoint_segments = 64 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# in logfile segments, min 1, 16MB each</font></div><div><font size="2"   >network_byte_cost = 0.001 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # same scale as above</font></div><div><font size="2"   >remote_query_cost = 100.0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # same scale as above</font></div><div><font size="2"   >effective_cache_size = 96000MB</font></div><div><font size="2"   >log_destination = 'csvlog' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Valid values are combinations of</font></div><div><font size="2"   >logging_collector = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Enable capturing of stderr and csvlog</font></div><div><font size="2"   >log_truncate_on_rotation = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # If on, an existing log file with the</font></div><div><font size="2"   >log_checkpoints = on</font></div><div><font size="2"   >log_connections = on</font></div><div><font size="2"   >log_disconnections = on</font></div><div><font size="2"   >log_error_verbosity = verbose &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # terse, default, or verbose messages</font></div><div><font size="2"   >log_statement = 'ddl' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # none, ddl, mod, all</font></div><div><font size="2"   >log_timezone = 'PRC'</font></div><div><font size="2"   >log_autovacuum_min_duration = 0 # -1 disables, 0 logs all actions and</font></div><div><font size="2"   >datestyle = 'iso, mdy'</font></div><div><font size="2"   >timezone = 'PRC'</font></div><div><font size="2"   >lc_messages = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # locale for system error message</font></div><div><font size="2"   >lc_monetary = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # locale for monetary formatting</font></div><div><font size="2"   >lc_numeric = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# locale for number formatting</font></div><div><font size="2"   >lc_time = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # locale for time formatting</font></div><div><font size="2"   >default_text_search_config = 'pg_catalog.english'</font></div><div><font size="2"   >pooler_port = 15921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Pool Manager TCP port</font></div><div><font size="2"   >max_pool_size = 1600 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Maximum pool size</font></div><div><font size="2"   >pool_conn_keepalive = 60 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Close connections if they are idle</font></div><div><font size="2"   >pool_maintenance_timeout = 30 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Launch maintenance routine if pooler</font></div><div><font size="2"   >max_coordinators = 16 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Maximum number of Coordinators</font></div><div><font size="2"   >max_datanodes = 16 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Maximum number of Datanodes</font></div><div><font size="2"   >gtm_host = 'localhost' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Host name or address of GTM</font></div><div><font size="2"   >gtm_port = 14921 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Port of GTM</font></div><div><font size="2"   >pgxc_node_name = 'coord11921' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Coordinator or Datanode name</font></div><div><font size="2"   >sequence_range = 100</font></div></div><p></p></pre></div><div>其他几个节点同上, 修改对应的端口<br>启动coordinator</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z coordinator -D /ssd3/pgxl/coord11921</font></div><div><span style="line-height: 28px;"   ><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z coordinator -D /ssd3/pgxl/coord11922</font></span></div><div><span style="line-height: 28px;"   ><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z coordinator -D /ssd4/pgxl/coord11923</font></span></div><div><span style="line-height: 28px;"   ><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z coordinator -D /ssd4/pgxl/coord11924</font></span></div><p></p></pre></div><div><br></div><div>测试 :&nbsp;</div><div>连接到任意一个coordinator.</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; psql -h 127.0.0.1 -p 11921 -U postgres postgres</font></div><div><font size="2"   >psql (PGXL 9.2.0, based on PG 9.2.4 (Postgres-XL 9.2.0))</font></div><div><font size="2"   >Type "help" for help.</font></div><div><font size="2"   >postgres=# \dtS pgxc*</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;List of relations</font></div><div><font size="2"   >&nbsp; &nbsp;Schema &nbsp; | &nbsp; &nbsp;Name &nbsp; &nbsp;| Type &nbsp;| &nbsp;Owner &nbsp;&nbsp;</font></div><div><font size="2"   >------------+------------+-------+----------</font></div><div><font size="2"   >&nbsp;pg_catalog | pgxc_class | table | postgres</font></div><div><font size="2"   >&nbsp;pg_catalog | pgxc_group | table | postgres</font></div><div><font size="2"   >&nbsp;pg_catalog | pgxc_node &nbsp;| table | postgres</font></div><div><font size="2"   >(3 rows)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >postgres=# \dvS pgxc*</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;List of relations</font></div><div><font size="2"   >&nbsp; &nbsp;Schema &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;Name &nbsp; &nbsp; &nbsp; &nbsp; | Type | &nbsp;Owner &nbsp;&nbsp;</font></div><div><font size="2"   >------------+---------------------+------+----------</font></div><div><font size="2"   >&nbsp;pg_catalog | pgxc_prepared_xacts | view | postgres</font></div><div><font size="2"   >(1 row)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >postgres=# select * from pgxc_node;</font></div><div><font size="2"   >&nbsp;node_name &nbsp;| node_type | node_port | node_host | nodeis_primary | nodeis_preferred | &nbsp;node_id &nbsp;&nbsp;</font></div><div><font size="2"   >------------+-----------+-----------+-----------+----------------+------------------+------------</font></div><div><font size="2"   >&nbsp;coord11921 | C &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp;5432 | localhost | f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| -629813779</font></div><div><font size="2"   >(1 row)</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; psql -h 127.0.0.1 -p 11922 -U postgres postgres</font></div><div><font size="2"   >psql (PGXL 9.2.0, based on PG 9.2.4 (Postgres-XL 9.2.0))</font></div><div><font size="2"   >Type "help" for help.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >postgres=# select * from pgxc_node;</font></div><div><font size="2"   >&nbsp;node_name &nbsp;| node_type | node_port | node_host | nodeis_primary | nodeis_preferred | &nbsp;node_id &nbsp;</font></div><div><font size="2"   >------------+-----------+-----------+-----------+----------------+------------------+-----------</font></div><div><font size="2"   >&nbsp;coord11922 | C &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp;5432 | localhost | f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 478655587</font></div><div><font size="2"   >(1 row)</font></div></div><p></p></pre></div><div>创建coordinator节点信息</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pgxl@db-172-16-3-150-&gt; psql -h 127.0.0.1 -p 11921 -U postgres postgres</font></div><div><font size="2"   >psql (PGXL 9.2.0, based on PG 9.2.4 (Postgres-XL 9.2.0))</font></div><div><font size="2"   >Type "help" for help.</font></div><p></p></pre></div><div>创建coordinator节点 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >postgres=# create node coord11922 with (type=coordinator, host='172.16.3.150', port=11922);</font></div><div><font size="2"   >CREATE NODE</font></div><div><font size="2"   >postgres=# create node coord11923 with (type=coordinator, host='172.16.3.150', port=11923);</font></div><div><font size="2"   >CREATE NODE</font></div><div><font size="2"   >postgres=# create node coord11924 with (type=coordinator, host='172.16.3.150', port=11924);</font></div><div><font size="2"   >CREATE NODE</font></div></div><div><div><font size="2"   >postgres=# alter node coord11921 with (type=coordinator, host='172.16.3.150', port=11921);</font></div><div><font size="2"   >ALTER NODE</font></div></div><p></p></pre></div><div><br></div><div>创建datanode节点.</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >postgres=# create node datan12921 with (type=datanode, host='172.16.3.150', port=12921, primary=true);</font></div><div><font size="2"   >CREATE NODE</font></div><div><font size="2"   >postgres=# create node datan12922 with (type=datanode, host='172.16.3.150', port=12922, primary=false);</font></div><div><font size="2"   >CREATE NODE</font></div><div><font size="2"   >postgres=# create node datan12923 with (type=datanode, host='172.16.3.150', port=12923, primary=false);</font></div><div><font size="2"   >CREATE NODE</font></div><div><font size="2"   >postgres=# create node datan12924 with (type=datanode, host='172.16.3.150', port=12924, primary=false);</font></div><div><font size="2"   >CREATE NODE</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >postgres=# SELECT pgxc_pool_reload();</font></div><div><font size="2"   >&nbsp;pgxc_pool_reload&nbsp;</font></div><div><font size="2"   >------------------</font></div><div><font size="2"   >&nbsp;t</font></div><div><font size="2"   >(1 row)</font></div></div><div><div><font size="2"   >postgres=# create node group gp1 with (datan12921, datan12922, datan12923, datan12924);</font></div><div><font size="2"   >CREATE NODE GROUP</font></div></div><div><font size="2"   ><br></font></div><div><div style="line-height: 28px;"   ><font size="2"   >postgres=# SELECT pgxc_pool_reload();</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;pgxc_pool_reload&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >------------------</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;t</font></div><div style="line-height: 28px;"   ><font size="2"   >(1 row)</font></div></div><p></p></pre></div><div style="line-height: 28px;"   ><br></div><div>同样需要连接到其他coordinator节点创建coordinator节点和datanode节点的信息.</div><div><br></div><div>创建测试表 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pgxl@db-172-16-3-150-&gt; psql -h 127.0.0.1 -p 11921 -U postgres postgres</font></div><div><font size="2"   >psql (PGXL 9.2.0, based on PG 9.2.4 (Postgres-XL 9.2.0))</font></div><div><font size="2"   >Type "help" for help.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >postgres=# create table userinfo(id serial8 primary key, info text, crt_time timestamp) distribute by hash(id) to group gp1;</font></div><div><font size="2"   >NOTICE: &nbsp;CREATE TABLE will create implicit sequence "userinfo_id_seq" for serial column "userinfo.id"</font></div><div><font size="2"   >NOTICE: &nbsp;CREATE TABLE / PRIMARY KEY will create implicit index "userinfo_pkey" for table "userinfo"</font></div><div><font size="2"   >CREATE TABLE</font></div><div><font size="2"   >postgres=# \dt</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List of relations</font></div><div><font size="2"   >&nbsp;Schema | &nbsp; Name &nbsp; | Type &nbsp;| &nbsp;Owner &nbsp;&nbsp;</font></div><div><font size="2"   >--------+----------+-------+----------</font></div><div><font size="2"   >&nbsp;public | userinfo | table | postgres</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><div>在其他coordinator可以看到这个表的定义</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pgxl@db-172-16-3-150-&gt; psql -h 127.0.0.1 -p 11924 -U postgres postgres</font></div><div><font size="2"   >psql (PGXL 9.2.0, based on PG 9.2.4 (Postgres-XL 9.2.0))</font></div><div><font size="2"   >Type "help" for help.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >postgres=# \dt</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List of relations</font></div><div><font size="2"   >&nbsp;Schema | &nbsp; Name &nbsp; | Type &nbsp;| &nbsp;Owner &nbsp;&nbsp;</font></div><div><font size="2"   >--------+----------+-------+----------</font></div><div><font size="2"   >&nbsp;public | userinfo | table | postgres</font></div><div><font size="2"   >(1 row)</font></div><p></p></pre></div><div><br></div><div>关闭集群的顺序.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >coordinator</font></div><div><font size="2"   >datanode</font></div><div><font size="2"   >gtm_proxy</font></div><div><font size="2"   >gtm_standby</font></div><div><font size="2"   >gtm</font></div><p></p></pre></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl stop -D /ssd3/pgxl/coord11921</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl stop -D /ssd3/pgxl/coord11922</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl stop -D /ssd4/pgxl/coord11923</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl stop -D /ssd4/pgxl/coord11924</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl stop -D /ssd3/pgxl/datan12921</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl stop -D /ssd3/pgxl/datan12922</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl stop -D /ssd4/pgxl/datan12923</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl stop -D /ssd4/pgxl/datan12924</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl stop -Z gtm_proxy -D /ssd3/pgxl/gtm14921</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl stop -Z gtm_proxy -D /ssd3/pgxl/gtm14922</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl stop -Z gtm_proxy -D /ssd4/pgxl/gtm14923</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl stop -Z gtm_proxy -D /ssd4/pgxl/gtm14924</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl stop -Z gtm -D /ssd4/pgxl/gtm13922</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl stop -Z gtm -D /ssd3/pgxl/gtm13921</font></div><p></p></pre></div><div><br></div><div>启动集群的顺序</div><div><pre class="prettyprint"   style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   style="line-height: 21px;"   >gtm</font></div><div style="line-height: 28px;"   ><font size="2"   style="line-height: 21px;"   >gtm_standby</font></div><div style="line-height: 28px;"   ><font size="2"   style="line-height: 21px;"   >gtm_proxy</font></div><div style="line-height: 28px;"   ><font size="2"   style="line-height: 21px;"   >datanode</font></div><div style="line-height: 28px;"   ><font size="2"   style="line-height: 21px;"   >coordinator</font></div></pre></div><div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl start -Z gtm -D /ssd3/pgxl/gtm13921</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl start -Z gtm -D /ssd4/pgxl/gtm13922</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl start -Z gtm_proxy -D /ssd3/pgxl/gtm14921</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl start -Z gtm_proxy -D /ssd3/pgxl/gtm14922</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl start -Z gtm_proxy -D /ssd4/pgxl/gtm14923</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; gtm_ctl start -Z gtm_proxy -D /ssd4/pgxl/gtm14924</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z datanode -D /ssd3/pgxl/datan12921</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z datanode -D /ssd3/pgxl/datan12922</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z datanode -D /ssd4/pgxl/datan12923</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z datanode -D /ssd4/pgxl/datan12924</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z coordinator -D /ssd3/pgxl/coord11921</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z coordinator -D /ssd3/pgxl/coord11922</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z coordinator -D /ssd4/pgxl/coord11923</font></div><div><font size="2"   >pgxl@db-172-16-3-150-&gt; pg_ctl start -Z coordinator -D /ssd4/pgxl/coord11924</font></div></div><div></div><p></p></pre></div></div><div><br></div><div>[其他建议]</div><div>1. 如果用作MPP, 可以不需要加gtm_proxy, 以及只需要1台coordinator即可, 因为TPS不是压力. 大量的压力在DATANODE端.</div><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://files.postgres-xl.org/documentation/index.html"   >http://files.postgres-xl.org/documentation/index.html</a></div><div>2.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://www.postgres-xl.org/"   >http://www.postgres-xl.org/</a></div><div>3.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://www.translattice.com/postgres_compare.shtml"   >http://www.translattice.com/postgres_compare.shtml</a></div><div>4.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://postgres-xl.sourceforge.net/"   >http://postgres-xl.sourceforge.net/</a></div><div>5.&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020133292915600/"   >http://blog.163.com/digoal@126/blog/static/16387704020133292915600/</a></div><div>6.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://files.postgres-xl.org/documentation/pg-xc-specifics.html"   >http://files.postgres-xl.org/documentation/pg-xc-specifics.html</a></div><div><br></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="Postgres-XL MPP improved from Postgres-XC , stormDB - 德哥@Digoal - PostgreSQL"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
	<h3>评论</h3>
	<div class="" id="" style="padding:0 20px;">
			<div id="">
				<h5 id="">23334 - 2015-04-16 13:43:48</h5>
				<div>楼主在生产环境用过没？健壮性如何？</div>
			</div>
			<div style="padding-left:40px;">
				<h5 id="">德哥@Digoal 回复 23334 - 2015-04-16 13:43:48</h5>
				<div style="width:600px;">健壮性肯定不如PostgreSQL, 但是能cover住就可以了, 至于要不要上生产, 这个应该看业务需求.</div>
			</div>
			<div id="">
				<h5 id="">freya - 2014-09-04 14:02:43</h5>
				<div><P>哇，pg_xl功能这么强大。。</P></div>
			</div>
	</div>
</div>
</body>
</html>