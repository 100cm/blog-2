<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">ZPOOL health check and repair use scrub</h2>
	<h5 id="">2014-06-17 15:45:44&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402014517322972/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>zpool健康检查(scrub)主要用于通过checksum来检查zpool数据块的数据是否正常, 如果vdev是mirror或raidz的, 可以自动从其他设备来修复异常的数据块. 由于健康检查是IO开销很大的动作, 所以建议在不繁忙的时候操作(scrub只检查分配出去的数据块, 不会检查空闲的数据块, 所以只和使用率有关, 对于一个很大的zpool, 如果使用率很低的话, scrub也是很快完成的).</div><div><br></div><div>用法 :&nbsp;</div><div><font size="2"   color="#ff0000"   ># zpool scrub zp1</font></div><div>查看zpool状态, 如下, 正在做scrub</div><div><div><font size="2"   color="#ff0000"   ># zpool status zp1</font></div><div><font size="2"   color="#ff0000"   >&nbsp; pool: zp1</font></div><div><font size="2"   color="#ff0000"   >&nbsp;state: ONLINE</font></div><div><font size="2"   color="#ff0000"   >&nbsp; scan: scrub in progress since Tue Jun 17 15:17:01 2014</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; 19.7G scanned out of 1.23T at 56.7M/s, 6h11m to go</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; 0 repaired, 1.57% done</font></div><div><font size="2"   color="#ff0000"   >config:</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; NAME &nbsp; &nbsp; &nbsp; &nbsp; STATE &nbsp; &nbsp; READ WRITE CKSUM</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; zp1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ONLINE &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; 0 &nbsp; &nbsp; 0</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vd01vol01 &nbsp;ONLINE &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; 0 &nbsp; &nbsp; 0</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vd02vol01 &nbsp;ONLINE &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; 0 &nbsp; &nbsp; 0</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vd03vol01 &nbsp;ONLINE &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; 0 &nbsp; &nbsp; 0</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vd04vol01 &nbsp;ONLINE &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; 0 &nbsp; &nbsp; 0</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >errors: No known data errors</font></div></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><div><font size="2"   color="#ff0000"   ># zpool get all zp1</font></div><div><font size="2"   color="#ff0000"   >NAME &nbsp;PROPERTY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VALUE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SOURCE</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 9.75T &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; capacity &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12% &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; altroot &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; health &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ONLINE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; guid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5877722976139588848 &nbsp; &nbsp;default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; version &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; bootfs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; delegation &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; autoreplace &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;off &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; cachefile &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; failmode &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wait &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; listsnapshots &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;off &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; autoexpand &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; off &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; dedupditto &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; dedupratio &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1.01x &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; free &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8.52T &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; allocated &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.23T &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; readonly &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; off &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; ashift &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; comment &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; expandsize &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; freeing &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; feature@async_destroy &nbsp;enabled &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;local</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; feature@empty_bpobj &nbsp; &nbsp;active &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; local</font></div><div><font size="2"   color="#ff0000"   >zp1 &nbsp; feature@lz4_compress &nbsp; active &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; local</font></div></div><div><br></div><div><div>在做scrub时, 设备的io几乎消耗殆尽.</div><div><font size="2"   color="#ff0000"   >Device: &nbsp; &nbsp; &nbsp; &nbsp; rrqm/s &nbsp; wrqm/s &nbsp; &nbsp; r/s &nbsp; &nbsp; w/s &nbsp; rsec/s &nbsp; wsec/s avgrq-sz avgqu-sz &nbsp; await &nbsp;svctm &nbsp;%util</font></div><div><font size="2"   color="#ff0000"   >sda &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp;0.00 &nbsp; &nbsp;0.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp;0.00 &nbsp; 0.00 &nbsp; 0.00</font></div><div><font size="2"   color="#ff0000"   >sdb &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 0.00 &nbsp;160.00 &nbsp; &nbsp;0.00 &nbsp; 982.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 6.14 &nbsp; &nbsp; 0.61 &nbsp; &nbsp;3.81 &nbsp; 3.80 &nbsp;60.80</font></div><div><font size="2"   color="#ff0000"   >sdc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 0.00 &nbsp;164.00 &nbsp; &nbsp;0.00 &nbsp; 864.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 5.27 &nbsp; &nbsp; 0.59 &nbsp; &nbsp;3.57 &nbsp; 3.57 &nbsp;58.50</font></div><div><font size="2"   color="#ff0000"   >sdd &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 0.00 &nbsp;168.00 &nbsp; &nbsp;0.00 &nbsp;1100.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 6.55 &nbsp; &nbsp; 0.61 &nbsp; &nbsp;3.63 &nbsp; 3.64 &nbsp;61.20</font></div><div><font size="2"   color="#ff0000"   >sde &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 0.00 &nbsp;172.00 &nbsp; &nbsp;0.00 &nbsp;1116.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 6.49 &nbsp; &nbsp; 0.61 &nbsp; &nbsp;3.52 &nbsp; 3.52 &nbsp;60.60</font></div><div><font size="2"   color="#ff0000"   >sdf &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 0.00 &nbsp;160.00 &nbsp; &nbsp;0.00 &nbsp;1018.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 6.36 &nbsp; &nbsp; 0.61 &nbsp; &nbsp;3.80 &nbsp; 3.80 &nbsp;60.80</font></div><div><font size="2"   color="#ff0000"   >sdg &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 0.00 &nbsp;164.00 &nbsp; &nbsp;0.00 &nbsp; 857.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 5.23 &nbsp; &nbsp; 0.57 &nbsp; &nbsp;3.49 &nbsp; 3.50 &nbsp;57.40</font></div><div><font size="2"   color="#ff0000"   >sdh &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 0.00 &nbsp;169.00 &nbsp; &nbsp;0.00 &nbsp; 995.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 5.89 &nbsp; &nbsp; 0.61 &nbsp; &nbsp;3.63 &nbsp; 3.60 &nbsp;60.90</font></div><div><font size="2"   color="#ff0000"   >sdi &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 0.00 &nbsp;173.00 &nbsp; &nbsp;0.00 &nbsp;1066.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 6.16 &nbsp; &nbsp; 0.60 &nbsp; &nbsp;3.49 &nbsp; 3.46 &nbsp;59.90</font></div><div><font size="2"   color="#ff0000"   >dm-0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 0.00 &nbsp;320.00 &nbsp; &nbsp;0.00 &nbsp;2000.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 6.25 &nbsp; &nbsp; 1.99 &nbsp; &nbsp;6.21 &nbsp; 3.12 100.00</font></div><div><font size="2"   color="#ff0000"   >dm-1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 0.00 &nbsp;328.00 &nbsp; &nbsp;0.00 &nbsp;1721.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 5.25 &nbsp; &nbsp; 1.91 &nbsp; &nbsp;5.83 &nbsp; 3.01 &nbsp;98.60</font></div><div><font size="2"   color="#ff0000"   >dm-2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 0.00 &nbsp;337.00 &nbsp; &nbsp;0.00 &nbsp;2095.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 6.22 &nbsp; &nbsp; 1.99 &nbsp; &nbsp;5.92 &nbsp; 2.97 100.00</font></div><div><font size="2"   color="#ff0000"   >dm-3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 0.00 &nbsp;345.00 &nbsp; &nbsp;0.00 &nbsp;2182.00 &nbsp; &nbsp; 0.00 &nbsp; &nbsp; 6.32 &nbsp; &nbsp; 1.99 &nbsp; &nbsp;5.77 &nbsp; 2.90 100.00</font></div></div><div><br></div><div>scrub结束后, 可以通过-xv来查看是否有异常.</div><div><div><font size="2"   color="#ff0000"   ># zpool status zp1 -xv</font></div><div><font size="2"   color="#ff0000"   >pool 'zp1' is healthy</font></div></div><div><br></div><div><br></div>[参考]<wbr><div>1. man zpool</div><div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp;zpool scrub [-s] pool ...</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Begins &nbsp;a &nbsp;scrub. The scrub examines all data in the specified pools to verify that it checksums correctly.</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;For replicated (mirror or raidz) devices, ZFS automatically repairs any damage discovered during the scrub.</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The &nbsp;"zpool &nbsp;status" command reports the progress of the scrub and summarizes the results of the scrub upon</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;completion.</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Scrubbing and resilvering are very similar operations. The difference is &nbsp;that &nbsp;resilvering &nbsp;only &nbsp;examines</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;data that ZFS knows to be out of date (for example, when attaching a new device to a mirror or replacing an</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;existing device), whereas scrubbing examines all data to discover silent errors due to hardware &nbsp;faults &nbsp;or</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;disk failure.</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Because &nbsp;scrubbing &nbsp;and resilvering are I/O-intensive operations, ZFS only allows one at a time. If a scrub</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is already in progress, the "zpool scrub" command terminates it and starts a new scrub. If a resilver is in</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;progress, ZFS does not allow a scrub to be started until the resilver completes.</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-s &nbsp; &nbsp;Stop scrubbing.</font></div></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp;zpool status [-xvD] [-T d | u] [pool] ... [interval [count]]</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Displays &nbsp;the &nbsp;detailed health status for the given pools. If no pool is specified, then the status of each</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pool in the system is displayed. For more information on pool and device health, see &nbsp;the &nbsp;"Device &nbsp;Failure</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and Recovery" section.</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;If &nbsp;a &nbsp;scrub or resilver is in progress, this command reports the percentage done and the estimated time to</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;completion. Both of these are only approximate, because the amount of data in the pool and the other &nbsp;work-</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;loads on the system can change.</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-x &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Only display status for pools that are exhibiting errors or are otherwise unavailable. Warnings</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;about pools not using the latest on-disk format will not be included.</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Displays verbose data error information, printing out a complete list of all data errors &nbsp;since</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the last complete pool scrub.</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-D &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Display &nbsp;a &nbsp;histogram of deduplication statistics, showing the allocated (physically present on</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;disk) and referenced (logically referenced in the pool) block counts &nbsp;and &nbsp;sizes &nbsp;by &nbsp;reference</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;count.</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-T d | u &nbsp; &nbsp;Display a time stamp.</font></div><div><font size="2"   color="#ff0000"   ><br></font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Specify &nbsp;u &nbsp;for &nbsp;a &nbsp;printed representation of the internal representation of time. See time(2).</font></div><div><font size="2"   color="#ff0000"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Specify d for standard date format. See date(1).</font></div></div><div><br></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="ZPOOL health check and repair use scrub - 德哥@Digoal - PostgreSQL"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>