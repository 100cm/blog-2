<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">宝存 shannon PCI-E SSD VS OCZ RevoDrive3 X2 PCI-E SSD on CentOS 6.5 2.6.32-431.el6.x86_64</h2>
	<h5 id="">2014-06-19 22:39:54&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020145198321025/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;">今天拿到一块上海宝存 shannon 的1.2TB SSD一块, 以前一直在用的是OCZ RevoDrive3 X2, 所以对比一下这两款的性能如何.
<div>感谢上海宝存提供SSD卡进行测试.<br><wbr>
<div><br></div>
<div>首先看一下宝存官方提供的性能指标.</div>
<div>
<h3 style="LINE-HEIGHT: 40px; MARGIN: 10px 0px; FONT-FAMILY: inherit; FONT-SIZE: 24px; text-rendering: optimizelegibility;"   id="shannon-direct-io-ssd-g2"   >Shannon Direct-IO SSD G2</h3>
<h4 style="LINE-HEIGHT: 20px; MARGIN: 10px 0px; FONT-FAMILY: inherit; FONT-SIZE: 17px; text-rendering: optimizelegibility;"   id="iops"   >IOPS</h4>
<table style="BACKGROUND-COLOR: transparent; BORDER-SPACING: 0px; WIDTH: 870px; BORDER-COLLAPSE: collapse; MAX-WIDTH: 100%; MARGIN-BOTTOM: 20px;"   >
<colgroup>
<col width="23%"   >
<col width="11%"   >
<col width="13%"   >
<col width="13%"   >
<col width="16%"   >
<thead>
<tr>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >用户可用容量</th>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >800GB</th>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >1200GB</th>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >1600GB</th>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >3200GB</th></tr></thead>
<tbody>
<tr>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >读带宽</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >1.4GB/s</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >2.0GB/s</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >2.4GB/s</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >2.0GB/s</td></tr>
<tr style="BACKGROUND-COLOR: rgb(249,249,249);"   >
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >写带宽</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >1.2GB/s</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >1.8GB/s</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >1.8GB/s</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >1.9GB/s</td></tr>
<tr>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >随机读取 IOPS &nbsp;-4KB</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >300,000</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >450,000</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >590,000</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >500,000</td></tr>
<tr style="BACKGROUND-COLOR: rgb(249,249,249);"   >
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >随机写入 IOPS &nbsp;-4KB</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >310,000</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >460,000</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >480,000</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >480,000</td></tr></table>
<h4 style="LINE-HEIGHT: 20px; MARGIN: 10px 0px; FONT-FAMILY: inherit; FONT-SIZE: 17px; text-rendering: optimizelegibility;"   id="延迟"   >延迟</h4>
<table style="BACKGROUND-COLOR: transparent; BORDER-SPACING: 0px; WIDTH: 870px; BORDER-COLLAPSE: collapse; MAX-WIDTH: 100%; MARGIN-BOTTOM: 20px;"   >
<colgroup>
<col width="23%"   >
<col width="11%"   >
<col width="13%"   >
<col width="13%"   >
<col width="16%"   >
<thead>
<tr>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >用户可用容量</th>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >800GB</th>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >1200GB</th>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >1600GB</th>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >3200GB</th></tr></thead>
<tbody>
<tr>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >随机读延迟 -4KB</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >67us</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >67us</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >67us</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >70us</td></tr>
<tr style="BACKGROUND-COLOR: rgb(249,249,249);"   >
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >随机写延迟 -4KB</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >9us</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >9us</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >9us</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >9us</td></tr></table>
<h4 style="LINE-HEIGHT: 20px; MARGIN: 10px 0px; FONT-FAMILY: inherit; FONT-SIZE: 17px; text-rendering: optimizelegibility;"   id="接口配置"   >接口配置</h4>
<table style="BACKGROUND-COLOR: transparent; BORDER-SPACING: 0px; WIDTH: 870px; BORDER-COLLAPSE: collapse; MAX-WIDTH: 100%; MARGIN-BOTTOM: 20px;"   >
<colgroup>
<col width="16%"   >
<col width="33%"   >
<col width="33%"   >
<thead>
<tr>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >用户可用 容量</th>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >800GB/1200GB</th>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >1600GB/3200GB</th></tr></thead>
<tbody>
<tr>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >接口配置</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >PCIe 2.0x8 half-height half-length</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >PCIe 2.0x8 Full-height half-length</td></tr>
<tr style="BACKGROUND-COLOR: rgb(249,249,249);"   >
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >功耗</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >6W~25W</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >8W~25W</td></tr></table>
<h4 style="LINE-HEIGHT: 20px; MARGIN: 10px 0px; FONT-FAMILY: inherit; FONT-SIZE: 17px; text-rendering: optimizelegibility;"   id="环境参数"   >环境参数</h4><br>
<table style="BACKGROUND-COLOR: transparent; BORDER-SPACING: 0px; WIDTH: 870px; BORDER-COLLAPSE: collapse; MAX-WIDTH: 100%; MARGIN-BOTTOM: 20px;"   >
<colgroup>
<col width="22%"   >
<col width="18%"   >
<col width="18%"   >
<thead>
<tr>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   ></th>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >最小值</th>
<th style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; BACKGROUND-COLOR: rgb(233,233,233); PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: bottom; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >最大值</th></tr></thead>
<tbody>
<tr>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >工作温度</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >0℃</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >50℃</td></tr>
<tr style="BACKGROUND-COLOR: rgb(249,249,249);"   >
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >非工作状态温度</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >-40℃</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >70℃</td></tr>
<tr>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >工作湿度</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >5%</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >95%</td></tr>
<tr style="BACKGROUND-COLOR: rgb(249,249,249);"   >
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >海拔(m)</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   ></td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >3000</td></tr>
<tr>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; FONT-FAMILY: 'Helvetica Neue', Helvetica, Arial, sans-serif; COLOR: rgb(51,51,51); FONT-SIZE: 14px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >气流(LFM)</td>
<td style="BORDER-BOTTOM: rgb(221,221,221) 1px solid; PADDING-BOTTOM: 8px; LINE-HEIGHT: 20px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; FONT-FAMILY: 'Helvetica Neue', Helvetica, Arial, sans-serif; COLOR: rgb(51,51,51); FONT-SIZE: 14px; VERTICAL-ALIGN: top; BORDER-TOP: rgb(221,221,221) 1px solid; PADDING-TOP: 8px;"   align="left"   >300</td></tr></table></div>
<div><br></div>
<div>介绍一下两款进行对比的SSD的测试环境.</div>
<div>测试环境1</div>
<div><font color="#ff0000"   size="2"   >主机 &nbsp;DELL R720xd</font></div>
<div><font color="#ff0000"   size="2"   >内存 &nbsp;32G</font></div>
<div><font color="#ff0000"   size="2"   >CPU &nbsp;8核&nbsp;Intel(R) Xeon(R) CPU E5-2609 v2 @ 2.50GHz</font></div>
<div><font color="#ff0000"   size="2"   >SSD &nbsp;<span style="LINE-HEIGHT: 28px;"   >shannon 1.2TB</span></font></div>
<div><font color="#ff0000"   size="2"   >系统 &nbsp;CentOS 6.5 x64</font></div>
<div><font color="#ff0000"   size="2"   >内核 &nbsp;2.6.32-431.el6.x86_64</font></div>
<div><font color="#ff0000"   size="2"   >SSD 驱动信息 &nbsp;</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># modinfo shannon</font></div>
<div><font color="#ff0000"   size="2"   >filename: &nbsp; &nbsp; &nbsp; /lib/modules/2.6.32-431.el6.x86_64/extra/shannon/shannon.ko</font></div>
<div><font color="#ff0000"   size="2"   >license: &nbsp; &nbsp; &nbsp; &nbsp;GPL</font></div>
<div><font color="#ff0000"   size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001CB0d00000275sv*sd*bc*sc*i*</font></div>
<div><font color="#ff0000"   size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001CB0d00000265sv*sd*bc*sc*i*</font></div>
<div><font color="#ff0000"   size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v000010EEd00006024sv*sd*bc*sc*i*</font></div>
<div><font color="#ff0000"   size="2"   >depends: &nbsp; &nbsp; &nbsp; &nbsp;</font></div>
<div><font color="#ff0000"   size="2"   >vermagic: &nbsp; &nbsp; &nbsp; 2.6.32-431.el6.x86_64 SMP mod_unload modversions&nbsp;</font></div>
<div><font color="#ff0000"   size="2"   >parm: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shannon_sector_size:int</font></div>
<div><font color="#ff0000"   size="2"   >parm: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shannon_debug_level:int</font></div>
<div><font color="#ff0000"   size="2"   >parm: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shannon_force_rw:int</font></div>
<div><font color="#ff0000"   size="2"   >parm: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shannon_major:int</font></div>
<div><font color="#ff0000"   size="2"   >parm: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shannon_auto_attach:int</font></div></div>
<div><font color="#ff0000"   size="2"   >PCI接口信息</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># lspci -vvvv -s 04:00.0</font></div>
<div><font color="#ff0000"   size="2"   >04:00.0 SCSI storage controller: OCZ Technology Group, Inc. RevoDrive 3 X2 PCI-Express SSD 240 GB (Marvell Controller) (rev 02)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Subsystem: OCZ Technology Group, Inc. RevoDrive 3 X2 PCI-Express SSD 240 GB (Marvell Controller)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Latency: 0, Cache Line Size: 64 bytes</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin A routed to IRQ 122</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at df1a0000 (64-bit, non-prefetchable) [size=128K]</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Region 2: Memory at df1c0000 (64-bit, non-prefetchable) [size=256K]</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Expansion ROM at df100000 [disabled] [size=64K]</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [40] Power Management version 3</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Flags: PMEClk- DSI- D1+ D2- AuxCurrent=375mA PME(D0+,D1+,D2-,D3hot+,D3cold-)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [50] MSI: Enable- Count=1/1 Maskable- 64bit+</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Address: 0000000000000000 &nbsp;Data: 0000</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [70] Express (v2) Endpoint, MSI 00</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCap: MaxPayload 4096 bytes, PhantFunc 0, Latency L0s &lt;1us, L1 &lt;8us</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported+</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MaxPayload 256 bytes, MaxReadReq 256 bytes</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCap: Port #0, Speed 5GT/s, Width x8, ASPM L0s L1, Latency L0 &lt;512ns, L1 &lt;64us</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ClockPM- Surprise- LLActRep- BwNot-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCtl: ASPM L0s Enabled; RCB 64 bytes Disabled- Retrain- CommClk+</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCap2: Completion Timeout: Not Supported, TimeoutDis+</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis+</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Compliance De-emphasis: -6dB</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkSta2: Current De-emphasis Level: -6dB</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [100 v1] Advanced Error Reporting</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UESta: &nbsp;DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UEMsk: &nbsp;DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt+ UnxCmplt+ RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UESvrt: DLP+ SDES+ TLP+ FCP+ CmpltTO+ CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC+ UnsupReq- ACSViol-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CESta: &nbsp;RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CEMsk: &nbsp;RxErr+ BadTLP+ BadDLLP+ Rollover+ Timeout+ NonFatalErr+</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AERCap: First Error Pointer: 00, GenCap+ CGenEn- ChkCap+ ChkEn-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [140 v1] Virtual Channel</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Caps: &nbsp; LPEVC=0 RefClk=100ns PATEntryBits=1</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Arb: &nbsp; &nbsp;Fixed- WRR32- WRR64- WRR128-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Ctrl: &nbsp; ArbSelect=Fixed</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: InProgress-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VC0: &nbsp; &nbsp;Caps: &nbsp; PATOffset=00 MaxTimeSlots=1 RejSnoopTrans-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Arb: &nbsp; &nbsp;Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Ctrl: &nbsp; Enable+ ID=0 ArbSelect=Fixed TC/VC=ff</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: NegoPending- InProgress-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel driver in use: ocz10xx</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel modules: ocz10xx</font></div></div>
<div><br></div>
<div>测试环境2</div>
<div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >主机 DELL R610</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >内存 &nbsp;96G</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >CPU &nbsp;8核 Intel(R) Xeon(R) CPU &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; E5504 &nbsp;@ 2.00GHz</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >SSD &nbsp;OCZ RevoDrive3 X2 960G</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >系统 &nbsp;CentOS 5.8 x64</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >内核 &nbsp;2.6.18-308.el5</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >SSD 驱动信息 &nbsp;</font></div></div>
<div style="LINE-HEIGHT: 28px;"   >
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   ># modinfo ocz10xx</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >filename: &nbsp; &nbsp; &nbsp; /lib/modules/2.6.18-308.el5/extra/ocz10xx.ko</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >version: &nbsp; &nbsp; &nbsp; &nbsp;2.3.1.1977</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >license: &nbsp; &nbsp; &nbsp; &nbsp;Proprietary</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >description: &nbsp; &nbsp;OCZ Linux driver</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >author: &nbsp; &nbsp; &nbsp; &nbsp; OCZ Technology Group, Inc.</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >srcversion: &nbsp; &nbsp; 27F0A3AF2BD189FDFA8ED54</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001084sv*sd*bc*sc*i*</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001083sv*sd*bc*sc*i*</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001044sv*sd*bc*sc*i*</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001043sv*sd*bc*sc*i*</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001042sv*sd*bc*sc*i*</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001041sv*sd*bc*sc*i*</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001022sv*sd*bc*sc*i*</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001021sv*sd*bc*sc*i*</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001080sv*sd*bc*sc*i*</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >depends: &nbsp; &nbsp; &nbsp; &nbsp;scsi_mod</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >vermagic: &nbsp; &nbsp; &nbsp; 2.6.18-308.4.1.el5 SMP mod_unload gcc-4.1</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >parm: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ocz_msi_enable: Enable MSI Support for OCZ VCA controllers (default=0) (int)</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >PCI接口信息</font></div>
<div style="LINE-HEIGHT: 28px;"   >
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   ># lspci -vvvv -s 41:00.0</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >41:00.0 Mass storage controller: Device 1cb0:0275</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Subsystem: Device 1cb0:0275</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Latency: 0, Cache Line Size: 64 bytes</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin A routed to IRQ 150</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at d40fc000 (32-bit, non-prefetchable) [size=16K]</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [40] Power Management version 3</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [48] MSI: Enable+ Count=1/1 Maskable- 64bit+</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Address: 00000000fee000d8 &nbsp;Data: 0000</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [60] Express (v2) Endpoint, MSI 00</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCap: MaxPayload 256 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 unlimited</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset-</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported+</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RlxdOrd+ ExtTag+ PhantFunc- AuxPwr- NoSnoop+</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MaxPayload 256 bytes, MaxReadReq 4096 bytes</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCap: Port #0, Speed 5GT/s, Width x8, ASPM L0s, Latency L0 unlimited, L1 unlimited</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ClockPM- Surprise- LLActRep- BwNot-</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- Retrain- CommClk+</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkSta: Speed 5GT/s, Width x8, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCap2: Completion Timeout: Range B, TimeoutDis-, LTR-, OBFF Not Supported</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCtl2: Completion Timeout: 65ms to 210ms, TimeoutDis-, LTR-, OBFF Disabled</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Compliance De-emphasis: -6dB</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [9c] MSI-X: Enable- Count=1 Masked-</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Vector table: BAR=0 offset=00000180</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PBA: BAR=0 offset=000001e0</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [fc] #00 [0000]</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [100 v1] Device Serial Number 00-00-00-01-01-00-0a-35</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel driver in use: shannon</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel modules: shannon</font></div></div></div>
<div style="LINE-HEIGHT: 28px;"   ><br></div>
<div style="LINE-HEIGHT: 28px;"   >shannon驱动的安装方法 :&nbsp;</div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >1. 使用已编译好的包</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >找到与内核版本一直的驱动rpm</font></div>
<div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   ># uname -r</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >2.6.32-431.el6.x86_64</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >安装</font></div>
<div><font color="#ff0000"   size="2"   >shannon-2.6.32-431.el6.x86_64.x86_64-v2.6-9.x86_64.rpm</font></div></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >2. 或者使用源码build</font></div>
<div style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >如果安装包里没有对应的内核版本包, 那么可以使用源码包直接build</font></div>
<div><font color="#ff0000"   size="2"   >shannon-v2.6-9.src.rpm</font></div>
<div><font color="#ff0000"   size="2"   ># rpm -ivh shannon-v2.6-9.src.rpm</font></div>
<div><font color="#ff0000"   size="2"   ># cd /root/rpmbuild</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># ll</font></div>
<div><font color="#ff0000"   size="2"   >total 8</font></div>
<div><font color="#ff0000"   size="2"   >drwxr-xr-x 2 root root 4096 Jun 19 21:00 SOURCES</font></div>
<div><font color="#ff0000"   size="2"   >drwxr-xr-x 2 root root 4096 Jun 19 21:00 SPECS</font></div></div>
<div><font color="#ff0000"   size="2"   ># cd SPECS/</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># ll</font></div>
<div><font color="#ff0000"   size="2"   >total 8</font></div>
<div><font color="#ff0000"   size="2"   >-rw-rw-r--. 1 spike spike 7183 May 21 17:10 shannon-driver.spec</font></div></div>
<div><font color="#ff0000"   size="2"   ># rpmbuild -bb shannon-driver.spec&nbsp;</font></div>
<div><font color="#ff0000"   size="2"   ># cd ..</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># ll</font></div>
<div><font color="#ff0000"   size="2"   >total 24</font></div>
<div><font color="#ff0000"   size="2"   >drwxr-xr-x 3 root root 4096 Jun 19 21:05 BUILD</font></div>
<div><font color="#ff0000"   size="2"   >drwxr-xr-x 2 root root 4096 Jun 19 21:05 BUILDROOT</font></div>
<div><font color="#ff0000"   size="2"   >drwxr-xr-x 3 root root 4096 Jun 19 21:05 RPMS</font></div>
<div><font color="#ff0000"   size="2"   >drwxr-xr-x 2 root root 4096 Jun 19 21:00 SOURCES</font></div>
<div><font color="#ff0000"   size="2"   >drwxr-xr-x 2 root root 4096 Jun 19 21:00 SPECS</font></div>
<div><font color="#ff0000"   size="2"   >drwxr-xr-x 2 root root 4096 Jun 19 21:05 SRPMS</font></div></div>
<div><font color="#ff0000"   size="2"   ># cd RPMS</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># ll</font></div>
<div><font color="#ff0000"   size="2"   >total 4</font></div>
<div><font color="#ff0000"   size="2"   >drwxr-xr-x 2 root root 4096 Jun 19 21:05 x86_64</font></div></div>
<div><font color="#ff0000"   size="2"   ># cd x86_64/</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># ll</font></div>
<div><font color="#ff0000"   size="2"   >total 392</font></div>
<div><font color="#ff0000"   size="2"   >-rw-r--r-- 1 root root 401268 Jun 19 21:05 shannon-2.6.32-431.el6.x86_64.x86_64-v2.6-9.x86_64.rpm</font></div></div>
<div><font color="#ff0000"   size="2"   ># rpm -ivh&nbsp;shannon-2.6.32-431.el6.x86_64.x86_64-v2.6-9.x86_64.rpm</font></div>
<div><font color="#ff0000"   size="2"   >安装完就可以把rpmbuild目录删掉了.</font></div>
<div style="LINE-HEIGHT: 28px;"   ><br></div>
<div style="LINE-HEIGHT: 28px;"   ><span style="LINE-HEIGHT: 28px;"   >shannon linux下的命令行管理工具使用介绍</span></div>
<div style="LINE-HEIGHT: 28px;"   ><span style="LINE-HEIGHT: 28px;"   >可以监控SSD的状态, 擦除SSD数据, 修改保留容量等.</span></div>
<div style="LINE-HEIGHT: 28px;"   >(因为shannon的数据未被收录到smartmontools工具中, 所以不能使用smartctl查看该SSD的状态)</div>
<div style="LINE-HEIGHT: 28px;"   >我下载了最新的smartctl还是无法查看shannon的信息.</div>
<div>
<div><font color="#ff0000"   size="2"   ># /opt/smartmontools-6.2/sbin/smartctl -A /dev/dfa</font></div>
<div><font color="#ff0000"   size="2"   >smartctl 6.2 2013-07-26 r3841 [x86_64-linux-2.6.32-431.el6.x86_64] (local build)</font></div>
<div><font color="#ff0000"   size="2"   >Copyright (C) 2002-13, Bruce Allen, Christian Franke, www.smartmontools.org</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >/dev/dfa: Unable to detect device type</font></div>
<div><font color="#ff0000"   size="2"   >Please specify device type with the -d option.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Use smartctl -h to get a usage summary</font></div></div>
<div><br></div>
<div>我们看看shannon的驱动包带了哪些工具</div>
<div>
<div><font color="#ff0000"   size="2"   ># rpm -qa|grep shan</font></div>
<div><font color="#ff0000"   size="2"   >shannon-2.6.32-431.el6.x86_64.x86_64-v2.6-9.x86_64</font></div></div>
<div>
<div><font color="#ff0000"   size="2"   ># rpm -ql shannon-2.6.32-431.el6.x86_64.x86_64-v2.6-9.x86_64</font></div>
<div><font color="#ff0000"   size="2"   >/lib/modules/2.6.32-431.el6.x86_64/extra/shannon/Module.symvers</font></div>
<div><font color="#ff0000"   size="2"   >/lib/modules/2.6.32-431.el6.x86_64/extra/shannon/shannon.ko</font></div>
<div><font color="#ff0000"   size="2"   >/lib/udev/rules.d/60-persistent-storage-shannon.rules</font></div>
<div><font color="#ff0000"   size="2"   >/usr/bin/shannon-attach</font></div>
<div><font color="#ff0000"   size="2"   >/usr/bin/shannon-beacon</font></div>
<div><font color="#ff0000"   size="2"   >/usr/bin/shannon-bugreport</font></div>
<div><font color="#ff0000"   size="2"   >/usr/bin/shannon-detach</font></div>
<div><font color="#ff0000"   size="2"   >/usr/bin/shannon-format</font></div>
<div><font color="#ff0000"   size="2"   >/usr/bin/shannon-status</font></div></div>
<div><br></div>
<div>挨个介绍一下这些管理工具的使用.</div>
<div>
<div>1.&nbsp;<span style="LINE-HEIGHT: 28px;"   >绑定SSD卡给操作系统使用. 这个一般不需要操作, 除非你detach了.</span></div>
<div><font color="#ff0000"   size="2"   ># /usr/bin/shannon-attach -h</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Usage: shannon-attach [OPTIONS] [device]</font></div>
<div><font color="#ff0000"   size="2"   >Attaches Direct-IO PCIe SSD card and makes it available to the operating system.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >OPTIONS:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-h, --help</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Display this usage message.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-n, --readonly</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Attach the Direct-IO drive and set access mode to readonly.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-r, --reduced-write</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Attach the Direct-IO drive and set access mode to reduced-write.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; If no -n or -r option is given, set access mode to normal readwrite.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;[device]</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Device node for the Direct-IO PCIe SSD card (/dev/sctx).</font></div></div>
<div><br></div>
<div>2.&nbsp;<span style="LINE-HEIGHT: 28px;"   >LED标示, 一般用于在多个SSD中物理的区分.</span></div>
<div><font color="#ff0000"   size="2"   ># /usr/bin/shannon-beacon -h</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Usage: shannon-beacon [OPTIONS] [device]</font></div>
<div><font color="#ff0000"   size="2"   >Lights the Direct-IO PCIe SSD card's yellow LED to locate the device.</font></div>
<div><font color="#ff0000"   size="2"   >This utility always turns the LED on, unless you specifically use the -o option.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >OPTIONS:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-h, --help</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Display this usage message.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-l, --on</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Light on the yellow LED.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-o, --off</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Turn off the yellow LED.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;[device]</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Device node for the Direct-IO PCIe SSD card (/dev/sctx).</font></div>
<div><br></div>
<div>3.&nbsp;<span style="LINE-HEIGHT: 28px;"   >收集BUG报告. 例如</span></div>
<div><font color="#ff0000"   size="2"   ># /usr/bin/shannon-bugreport -h</font></div>
<div><font color="#ff0000"   size="2"   >usage: shannon-bugreport</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div>
<div><font color="#ff0000"   size="2"   ># /usr/bin/shannon-bugreport</font></div>
<div><font color="#ff0000"   size="2"   >$hostname$</font></div>
<div><font color="#ff0000"   size="2"   >Linux-2.6.32-431.el6.x86_64</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into system... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into system... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into system... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into proc... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into proc/self... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into log... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into log... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into log... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into log... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping dmesg ... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into sys... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into sys... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into sys... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into sys... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping lspci -vvvvv... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping uname -a... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping hostname ... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping ps aux... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping ps aux --sort start_time... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping pstree ... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping lsof ... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping w ... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping lsmod ... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping dmidecode ... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping sar -A... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping sar -r... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping sar ... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping iostat -dmx 1 5... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping vmstat 1 5... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping top -bc -d1 -n5... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into disk... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into disk... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping df -h... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping pvs ... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping vgs ... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping lvs ... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping dmsetup table... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping dmsetup status... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Gathering information using shannon-status... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping numactl --hardware... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping numactl --show... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Dumping numastat ... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   >Copying files into debug... &nbsp; done.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Building tarball...</font></div>
<div><font color="#ff0000"   size="2"   >存放到/tmp下的一个TAR包, 便于给厂商提供分析数据.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Tarball: /tmp/shannon-bugreport-20140619-211326.tar.gz</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Plz send it to our customer service, including steps to reproduce the problem.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;All the information would help us address the issue tremendously.</font></div></div>
<div><br></div>
<div>4.&nbsp;<span style="LINE-HEIGHT: 28px;"   >把一个SSD设备从操作系统中删除, 即解绑.&nbsp;</span></div>
<div><font color="#ff0000"   size="2"   ># /usr/bin/shannon-detach -h</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Usage: shannon-detach [OPTIONS] [device]</font></div>
<div><font color="#ff0000"   size="2"   >Detaches and removes the corresponding /dev/dfx Direct-IO block device.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >OPTIONS:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-h, --help</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Display this usage message.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;[device]</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Device node for the Direct-IO PCIe SSD card (/dev/sctx).</font></div>
<div><br></div>
<div>5. SSD设备格式化, 查看当前设备的物理容量, 擦除, 设置最小逻辑访问单元, 设置用户可用空间, 等.</div>
<div>注意SSD一般物理容量都要大于实际的可用容量, 保留的容量用于纠错, 替换坏块. 因为SSD的存储单元有擦写次数限制, 超出限制就会造成物理损伤, 变成坏块, 坏块就需要额外的容量来替换和修复.&nbsp;</div>
<div>shannon保留的容量一般为27% 这个保留值可以使用状态命令看到.</div>
<div>当坏块比较多之后, SSD还可以继续使用, 但是如果保留容量也用的差不多的话, SSD随着坏块的增多, 最后就会报废.</div>
<div>所以一般坏块多了, 还可以通过缩小用户可用空间, 保持27%甚至更多的可用空间来维持SSD继续使用, 直到所有块都变成坏块. 就不能再写入了.</div>
<div><span style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   ># /usr/bin/shannon-format -h</font></span></div>
<div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Usage: shannon-format [OPTIONS] [device]</font></div>
<div><font color="#ff0000"   size="2"   >Direct-IO PCIe SSD card is pre-formated before shipped to the customer.</font></div>
<div><font color="#ff0000"   size="2"   >This tool can perform a re-format as needed.</font></div>
<div><font color="#ff0000"   size="2"   >WARNING:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;Re-format will erase all your data on the drive.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;Please use shannon-detach to detach block device before using this tool,</font></div>
<div><font color="#ff0000"   size="2"   >OPTIONS:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-h, --help</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Display this usage message.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-p, --probe</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Probe current physical capacity and advertised user capacity.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-e, --erase</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Erase all data and re-format the drive without changing setting.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-y, --always-yes</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Auto-answer "yes" to all queries from this tool (i.e. bypass prompts).</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-i DELAY, --interrupt=DELAY</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Set interrupt delay (unit: us).</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-b SIZE, --logical-block=SIZE</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Set logical block size, i.e the minimum access unit from host.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-s CAPACITY, --capacity=CAPACITY</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Set user capacity as a specific size(in TB, GB, or MB)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; or as a percentage(such as 70%) of the advertised capacity.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-o CAPACITY, --overformat=CAPACITY</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Over-format user capacity (to greater than the advertised capacity)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; as a specific size(in TB, GB, or MB)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; or as a percentage(e.g. 70%) of physical capacity.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-a, --advertised &nbsp; &nbsp; Set user capacity to advertised capacity directly.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;Warning: -s, -o , -a options are mutually exclusive!</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;[device]</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Device node for the Direct-IO PCIe SSD card (/dev/sctx).</font></div></div>
<div><br></div>
<div>6. 前面我们说shannon SSD没有录入smartmontools字典, 还好shannon厂商提供了这个工具来查看SSD的状态, 包括使用寿命, 坏块占比, 预留空间, 温度传感器值, 等.</div>
<div>
<div><font color="#ff0000"   size="2"   ># /usr/bin/shannon-status -h</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Usage: shannon-status [OPTIONS] [device]</font></div>
<div><font color="#ff0000"   size="2"   >Shows information about Direct-IO PCIe card(s) installed on the system.</font></div>
<div><font color="#ff0000"   size="2"   >OPTIONS:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-h, --help</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Display this usage message.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-r SECS, --refresh=SECS</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Set refresh interval of monitoring (unit: second, default: 2 seconds).</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-a, --all</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Find all Direct-IO drive(s), and provide basic information of them.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-m, --monitor</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; If given, this tool will open a monitoring window,</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; which dynamically shows detailed information of the specified drive.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;-p, --print</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;Generate key=value format output for easier parsing.</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp;[device]</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Device node for the Direct-IO PCIe SSD card (/dev/sctx).</font></div></div>
<div><font color="#ff0000"   size="2"   >例如 :&nbsp;</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># /usr/bin/shannon-status -a</font></div>
<div><font color="#ff0000"   size="2"   >Found Shannon PCIE SSD card /dev/scta:</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Direct-IO drive scta at PCI Address:41:00:0: &nbsp;PCI接口信息, 使用lspci可以查看对应的驱动信息等.</font></div>
<div><font color="#ff0000"   size="2"   >Model:sh-shannon-pcie-ssd, SN: 006819246149b014 &nbsp;序列号</font></div>
<div><font color="#ff0000"   size="2"   >Device state: attached as disk /dev/dfa, Access mode: readwrite</font></div>
<div><font color="#ff0000"   size="2"   >Firmware version: 0c321351, Driver version: 2.6.9 &nbsp;固件版本, 驱动版本</font></div>
<div><font color="#ff0000"   size="2"   >Vendor:1cb0, Device:0275, Sub vendor:1cb0, Sub device:0275</font></div>
<div><font color="#ff0000"   size="2"   >Flash manufacturer: 98, Flash id: 3a</font></div>
<div><font color="#ff0000"   size="2"   >Channels: 7, Lunsets in channel: 8, Luns in lunset: 2, Available luns: 112</font></div>
<div><font color="#ff0000"   size="2"   >Eblocks in lun: 2116, Pages in eblock: 256, Nand page size: 32768 &nbsp;闪存信息</font></div>
<div><font color="#ff0000"   size="2"   >Logical sector: 512, Physical sector: 4096 &nbsp;逻辑扇区和SSD的物理扇区(字节), 分区对齐时使用物理扇区大小, 也就是4K对齐</font></div>
<div><font color="#ff0000"   size="2"   >User capacity: 1200.00 GB/1117.59 GiB &nbsp;用户可用容量</font></div>
<div><font color="#ff0000"   size="2"   >Physical capacity: 1632.37 GB/1520.26 GiB &nbsp;物理容量, 可用看到预留了大概400GB作为修复坏块用</font></div>
<div><font color="#ff0000"   size="2"   >Overprovision: 27%, warn at 10% &nbsp;</font></div>
<div><font color="#ff0000"   size="2"   >Error correction: 35 bits per 880 bytes codeword &nbsp;错误校验信息</font></div>
<div><font color="#ff0000"   size="2"   >Controller internal temperature: 71 degC, max 77 degC &nbsp;温度传感器信息</font></div>
<div><font color="#ff0000"   size="2"   >Controller board temperature: 53 degC, max 59 degC</font></div>
<div><font color="#ff0000"   size="2"   >NAND Flash temperature: 53 degC, max 63 degC</font></div>
<div><font color="#ff0000"   size="2"   >Internal voltage: 1001 mV, max 1028 mV &nbsp; &nbsp;电压</font></div>
<div><font color="#ff0000"   size="2"   >Auxiliary voltage: 1795 mV, max 1804 mV</font></div>
<div><font color="#ff0000"   size="2"   >Media status: 1.0760% bad block &nbsp; 存储介质状态, 已经有1%的坏块了.</font></div>
<div><font color="#ff0000"   size="2"   >Power on hours: 9 hours 15 minutes, Power cycles: 3 &nbsp; 加电时间和加电次数</font></div>
<div><font color="#ff0000"   size="2"   >Lifetime data volumes: &nbsp;生命信息</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; Host write data &nbsp; &nbsp;: 13774.36 GB / 12828.37 GiB</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; Host read data &nbsp; &nbsp; : 5172.11 GB / 4816.90 GiB</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; Total write data &nbsp; : 19974.61 GB / 18602.80 GiB</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; Write amplifier &nbsp; &nbsp;: 1.4501</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; Estimated life left: 99% left &nbsp; 评估的剩余生命. 这个可以作为是否需要换盘的参考.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Totally found 1 Direct-IO PCIe SSD card on this system.</font></div></div>
<div><font color="#ff0000"   size="2"   >KEY-VALUE输出格式, 信息和前面的差不多.</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># /usr/bin/shannon-status -p /dev/scta&nbsp;</font></div>
<div><font color="#ff0000"   size="2"   >drive=/dev/scta</font></div>
<div><font color="#ff0000"   size="2"   >pci_address=41:00:0</font></div>
<div><font color="#ff0000"   size="2"   >model=sh-shannon-pcie-ssd</font></div>
<div><font color="#ff0000"   size="2"   >serial_number=006819246149b014</font></div>
<div><font color="#ff0000"   size="2"   >device_state=attached as disk /dev/dfa</font></div>
<div><font color="#ff0000"   size="2"   >access_mode=readwrite</font></div>
<div><font color="#ff0000"   size="2"   >firmware_version=0c321351</font></div>
<div><font color="#ff0000"   size="2"   >driver_version=2.6.9</font></div>
<div><font color="#ff0000"   size="2"   >vendor_id=1cb0</font></div>
<div><font color="#ff0000"   size="2"   >device_id=0275</font></div>
<div><font color="#ff0000"   size="2"   >subsystem_vendor_id=1cb0</font></div>
<div><font color="#ff0000"   size="2"   >subsystem_device_id=0275</font></div>
<div><font color="#ff0000"   size="2"   >flash_manufacturer=98</font></div>
<div><font color="#ff0000"   size="2"   >flash_id=3a</font></div>
<div><font color="#ff0000"   size="2"   >channels=7</font></div>
<div><font color="#ff0000"   size="2"   >lunsets_in_channel=8</font></div>
<div><font color="#ff0000"   size="2"   >luns_in_lunset=2</font></div>
<div><font color="#ff0000"   size="2"   >available_luns=112</font></div>
<div><font color="#ff0000"   size="2"   >eblocks_in_lun=2116</font></div>
<div><font color="#ff0000"   size="2"   >pages_in_eblock=256</font></div>
<div><font color="#ff0000"   size="2"   >nand_page_size=32768</font></div>
<div><font color="#ff0000"   size="2"   >logical_sector=512</font></div>
<div><font color="#ff0000"   size="2"   >physical_sector=4096</font></div>
<div><font color="#ff0000"   size="2"   >user_capacity=1200.00 GB</font></div>
<div><font color="#ff0000"   size="2"   >physical_capacity=1632.37 GB</font></div>
<div><font color="#ff0000"   size="2"   >overprovision=27%</font></div>
<div><font color="#ff0000"   size="2"   >error_correction=35 bits per 880 bytes codeword</font></div>
<div><font color="#ff0000"   size="2"   >controller_temp=71 degC</font></div>
<div><font color="#ff0000"   size="2"   >controller_temp_max=77 degC</font></div>
<div><font color="#ff0000"   size="2"   >board_temp=53 degC</font></div>
<div><font color="#ff0000"   size="2"   >board_temp_max=59 degC</font></div>
<div><font color="#ff0000"   size="2"   >flash_temp=53 degC</font></div>
<div><font color="#ff0000"   size="2"   >flash_temp_max=63 degC</font></div>
<div><font color="#ff0000"   size="2"   >internal_voltage=1004 mV</font></div>
<div><font color="#ff0000"   size="2"   >internal_voltage_max=1028 mV</font></div>
<div><font color="#ff0000"   size="2"   >auxiliary_voltage=1790 mV</font></div>
<div><font color="#ff0000"   size="2"   >auxiliary_voltage_max=1804 mV</font></div>
<div><font color="#ff0000"   size="2"   >bad_block_percentage=1.0760%</font></div>
<div><font color="#ff0000"   size="2"   >power_on_hours=9 hours 15 minutes</font></div>
<div><font color="#ff0000"   size="2"   >power_cycles=3</font></div>
<div><font color="#ff0000"   size="2"   >host_write_data=13801.32 GB</font></div>
<div><font color="#ff0000"   size="2"   >host_read_data=5172.11 GB</font></div>
<div><font color="#ff0000"   size="2"   >total_write_data=20001.57 GB</font></div>
<div><font color="#ff0000"   size="2"   >write_amplifier=1.4493</font></div>
<div><font color="#ff0000"   size="2"   >estimated_life_left=99%</font></div></div>
<div><font color="#ff0000"   size="2"   >实时监控举例</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># /usr/bin/shannon-status -m -r 1 /dev/scta&nbsp;</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Direct-IO PCIe SSD Card Monitor Program</font></div>
<div><font color="#ff0000"   size="2"   >Commands: q|Q exit; g|G general info; m|M main window</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >We are now monitoring disk 'scta' at PCI:41:00:0</font></div>
<div><font color="#ff0000"   size="2"   >Capacity: 1200.00 GB/1117.59 GiB, Block size: 4096, Overprovision: 27%</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Power on hours &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : 9 hours 20 minutes</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Power cycles &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : 3</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Controller internal temp : 72 degC, max 77 degC</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Controller board temp &nbsp; &nbsp;: 53 degC, max 59 degC</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;NAND Flash temperature &nbsp; : 53 degC, max 63 degC</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Internal voltage &nbsp; &nbsp; &nbsp; &nbsp; : 990 mV, max 1028 mV&nbsp;</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Auxiliary voltage &nbsp; &nbsp; &nbsp; &nbsp;: 1781 mV, max 1804 mV</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Free block count &nbsp; &nbsp; &nbsp; &nbsp; : 32</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Host write data &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: 13987.89 GB / 13027.24 GiB</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Write Bandwith &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : 733.258 MB/s / 699.289 MiB/s</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Write IOPS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : 89.509 K</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Avg write latency &nbsp; &nbsp; &nbsp; &nbsp;: 0.013 ms</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Host read data &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : 5172.11 GB / 4816.90 GiB</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Read Bandwith &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: 0.000 MB/s / 0.000 MiB/s</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Read IOPS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: 0.000 K</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Avg read latency &nbsp; &nbsp; &nbsp; &nbsp; : 0.000 ms</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Total write data &nbsp; &nbsp; &nbsp; &nbsp; : 20188.16 GB / 18801.69 GiB</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Total write Bandwith &nbsp; &nbsp; : 733.258 MB/s / 699.289 MiB/s</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Write amplifier &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: life 1.443, transient 1.000</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp;Buffer write percentage &nbsp;: 99%</font></div></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >使用lspci查看对应的pci接口信息.</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># lspci -vvvv -s 41:00.0</font></div>
<div><font color="#ff0000"   size="2"   >41:00.0 Mass storage controller: Device 1cb0:0275</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Subsystem: Device 1cb0:0275</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Latency: 0, Cache Line Size: 64 bytes</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin A routed to IRQ 150</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at d40fc000 (32-bit, non-prefetchable) [size=16K]</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [40] Power Management version 3</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [48] MSI: Enable+ Count=1/1 Maskable- 64bit+</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Address: 00000000fee000d8 &nbsp;Data: 0000</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [60] Express (v2) Endpoint, MSI 00</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCap: MaxPayload 256 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 unlimited</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported+</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RlxdOrd+ ExtTag+ PhantFunc- AuxPwr- NoSnoop+</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MaxPayload 256 bytes, MaxReadReq 4096 bytes</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCap: Port #0, Speed 5GT/s, Width x8, ASPM L0s, Latency L0 unlimited, L1 unlimited</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ClockPM- Surprise- LLActRep- BwNot-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- Retrain- CommClk+</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkSta: Speed 5GT/s, Width x8, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCap2: Completion Timeout: Range B, TimeoutDis-, LTR-, OBFF Not Supported</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCtl2: Completion Timeout: 65ms to 210ms, TimeoutDis-, LTR-, OBFF Disabled</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Compliance De-emphasis: -6dB</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [9c] MSI-X: Enable- Count=1 Masked-</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Vector table: BAR=0 offset=00000180</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PBA: BAR=0 offset=000001e0</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [fc] #00 [0000]</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [100 v1] Device Serial Number 00-00-00-01-01-00-0a-35</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel driver in use: shannon</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel modules: shannon</font></div></div>
<div><br></div>
<div>重点来了, 接下来测2块东西, 一块是fsync接口的性能, 这个直接影响到数据库的checkpoint, xlog的flush等; 另一块是直接测试PostgreSQL数据库的读写性能, 测试模型后面给出.</div>
<div><br></div>
<div>1. 测试fsync接口的性能.</div>
<div>注意分区时物理块的对齐, 本文场景使用4K对齐; &nbsp;据昨天宝存的工程师阐述宝存SSD盘不存在这个问题.</div><div>参考 :&nbsp;<a style="LINE-HEIGHT: 28px" target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020135753630439/"   >http://blog.163.com/digoal@126/blog/static/16387704020135753630439/</a></div>
<div><br></div>
<div>另外需要写超过50%后进行测试, 因为OCZ有这样的问题, 使用超过容量1半后, 性能会下降.</div>
<div>/dev/dfa1 &nbsp; &nbsp; &nbsp; 788G &nbsp;733G &nbsp; 15G &nbsp;99% /mnt</div>
<div><br></div>
<div>最后要注意的是因为CPU的差异, 可能导致IOPS未能达到测试瓶颈, 这样的话需要开多个进程进行测试, 直到iostat 块设备的&nbsp;%util = 100</div>
<div><br></div>
<div>本文将开启2个进程同时测试, 测试的单次fsync数据块大小为8KB. (如果要测4K的块, 可以修改一下--with-wal-blocksize=4重新编译PostgreSQL, 目前支持的块大小为1,2,4,8,16,32,64), 或者直接使用dd obs指定数据块大小, oflag=sync,nonblock,noatime指定同步调用.</div>
<div><br></div>
<div>OCZ测试结果</div>
<div>进程1</div>
<div>
<div><font color="#ff0000"   size="2"   ># /data_ssd0/pgsql9.3.4/bin/pg_test_fsync -f /ssd/1</font></div>
<div><font color="#ff0000"   size="2"   >5 seconds per test</font></div>
<div><font color="#ff0000"   size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using one 8kB write:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10448.416 ops/sec &nbsp; &nbsp; &nbsp;96 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1002.611 ops/sec &nbsp; &nbsp; 997 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 532.699 ops/sec &nbsp; &nbsp;1877 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6525.048 ops/sec &nbsp; &nbsp; 153 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using two 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3097.379 ops/sec &nbsp; &nbsp; 323 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 939.144 ops/sec &nbsp; &nbsp;1065 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 481.663 ops/sec &nbsp; &nbsp;2076 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3378.838 ops/sec &nbsp; &nbsp; 296 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare open_sync with different write sizes:</font></div>
<div><font color="#ff0000"   size="2"   >(This is designed to compare the cost of writing 16kB</font></div>
<div><font color="#ff0000"   size="2"   >in different write open_sync sizes.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; &nbsp;4442.898 ops/sec &nbsp; &nbsp; 225 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp; 3129.062 ops/sec &nbsp; &nbsp; 320 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp; 1919.259 ops/sec &nbsp; &nbsp; 521 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;978.837 ops/sec &nbsp; &nbsp;1022 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;518.352 ops/sec &nbsp; &nbsp;1929 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Test if fsync on non-write file descriptor is honored:</font></div>
<div><font color="#ff0000"   size="2"   >(If the times are similar, fsync() can sync data written</font></div>
<div><font color="#ff0000"   size="2"   >on a different descriptor.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 493.002 ops/sec &nbsp; &nbsp;2028 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 522.625 ops/sec &nbsp; &nbsp;1913 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Non-Sync'ed 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 189268.154 ops/sec &nbsp; &nbsp; &nbsp; 5 usecs/op</font></div></div>
<div><font color="#ff0000"   size="2"   >进程2</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># /data_ssd0/pgsql9.3.4/bin/pg_test_fsync -f /ssd/2</font></div>
<div><font color="#ff0000"   size="2"   >5 seconds per test</font></div>
<div><font color="#ff0000"   size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using one 8kB write:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3278.009 ops/sec &nbsp; &nbsp; 305 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1074.887 ops/sec &nbsp; &nbsp; 930 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 496.757 ops/sec &nbsp; &nbsp;2013 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5928.269 ops/sec &nbsp; &nbsp; 169 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using two 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3312.785 ops/sec &nbsp; &nbsp; 302 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1006.541 ops/sec &nbsp; &nbsp; 994 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 524.735 ops/sec &nbsp; &nbsp;1906 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3129.400 ops/sec &nbsp; &nbsp; 320 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare open_sync with different write sizes:</font></div>
<div><font color="#ff0000"   size="2"   >(This is designed to compare the cost of writing 16kB</font></div>
<div><font color="#ff0000"   size="2"   >in different write open_sync sizes.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; &nbsp;4433.001 ops/sec &nbsp; &nbsp; 226 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp; 3117.236 ops/sec &nbsp; &nbsp; 321 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp; 1911.074 ops/sec &nbsp; &nbsp; 523 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;978.444 ops/sec &nbsp; &nbsp;1022 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;551.965 ops/sec &nbsp; &nbsp;1812 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Test if fsync on non-write file descriptor is honored:</font></div>
<div><font color="#ff0000"   size="2"   >(If the times are similar, fsync() can sync data written</font></div>
<div><font color="#ff0000"   size="2"   >on a different descriptor.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 553.674 ops/sec &nbsp; &nbsp;1806 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 601.139 ops/sec &nbsp; &nbsp;1664 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Non-Sync'ed 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 194588.313 ops/sec &nbsp; &nbsp; &nbsp; 5 usecs/op</font></div></div>
<div><font color="#ff0000"   size="2"   >两个进程已经到达了OCZ的fsync瓶颈.</font></div>
<div><br></div>
<div>宝存测试结果</div>
<div><font color="#ff0000"   size="2"   >进程1</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># /opt/pgsql9.3.4/bin/pg_test_fsync -f /ssd/1</font></div>
<div><font color="#ff0000"   size="2"   >5 seconds per test</font></div>
<div><font color="#ff0000"   size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using one 8kB write:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 36722.105 ops/sec &nbsp; &nbsp; &nbsp;27 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 38222.994 ops/sec &nbsp; &nbsp; &nbsp;26 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 33121.821 ops/sec &nbsp; &nbsp; &nbsp;30 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 46673.776 ops/sec &nbsp; &nbsp; &nbsp;21 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using two 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21869.056 ops/sec &nbsp; &nbsp; &nbsp;46 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21256.613 ops/sec &nbsp; &nbsp; &nbsp;47 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 17299.647 ops/sec &nbsp; &nbsp; &nbsp;58 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 23230.884 ops/sec &nbsp; &nbsp; &nbsp;43 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare open_sync with different write sizes:</font></div>
<div><font color="#ff0000"   size="2"   >(This is designed to compare the cost of writing 16kB</font></div>
<div><font color="#ff0000"   size="2"   >in different write open_sync sizes.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; 22936.731 ops/sec &nbsp; &nbsp; &nbsp;44 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp;22550.950 ops/sec &nbsp; &nbsp; &nbsp;44 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp;13588.508 ops/sec &nbsp; &nbsp; &nbsp;74 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;432.588 ops/sec &nbsp; &nbsp;2312 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;269.104 ops/sec &nbsp; &nbsp;3716 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Test if fsync on non-write file descriptor is honored:</font></div>
<div><font color="#ff0000"   size="2"   >(If the times are similar, fsync() can sync data written</font></div>
<div><font color="#ff0000"   size="2"   >on a different descriptor.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 15686.374 ops/sec &nbsp; &nbsp; &nbsp;64 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 15723.477 ops/sec &nbsp; &nbsp; &nbsp;64 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Non-Sync'ed 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 187060.951 ops/sec &nbsp; &nbsp; &nbsp; 5 usecs/op</font></div></div>
<div><font color="#ff0000"   size="2"   >进程2</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># /opt/pgsql9.3.4/bin/pg_test_fsync -f /ssd/2</font></div>
<div><font color="#ff0000"   size="2"   >5 seconds per test</font></div>
<div><font color="#ff0000"   size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using one 8kB write:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 37496.895 ops/sec &nbsp; &nbsp; &nbsp;27 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 38063.802 ops/sec &nbsp; &nbsp; &nbsp;26 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 33193.801 ops/sec &nbsp; &nbsp; &nbsp;30 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 46719.307 ops/sec &nbsp; &nbsp; &nbsp;21 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using two 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21853.038 ops/sec &nbsp; &nbsp; &nbsp;46 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21022.927 ops/sec &nbsp; &nbsp; &nbsp;48 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 17531.537 ops/sec &nbsp; &nbsp; &nbsp;57 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 23044.216 ops/sec &nbsp; &nbsp; &nbsp;43 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare open_sync with different write sizes:</font></div>
<div><font color="#ff0000"   size="2"   >(This is designed to compare the cost of writing 16kB</font></div>
<div><font color="#ff0000"   size="2"   >in different write open_sync sizes.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; 22933.531 ops/sec &nbsp; &nbsp; &nbsp;44 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp;22986.931 ops/sec &nbsp; &nbsp; &nbsp;44 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp;13640.880 ops/sec &nbsp; &nbsp; &nbsp;73 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;462.776 ops/sec &nbsp; &nbsp;2161 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;260.950 ops/sec &nbsp; &nbsp;3832 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Test if fsync on non-write file descriptor is honored:</font></div>
<div><font color="#ff0000"   size="2"   >(If the times are similar, fsync() can sync data written</font></div>
<div><font color="#ff0000"   size="2"   >on a different descriptor.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 15492.679 ops/sec &nbsp; &nbsp; &nbsp;65 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 15737.468 ops/sec &nbsp; &nbsp; &nbsp;64 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Non-Sync'ed 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 190884.093 ops/sec &nbsp; &nbsp; &nbsp; 5 usecs/op</font></div></div>
<div>看起来2个进程fsync对宝存毫无压力, 所以开了3个进程, 以下是测试结果</div>
<div><font color="#ff0000"   size="2"   >进程1</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># /opt/pgsql9.3.4/bin/pg_test_fsync -f /ssd/1</font></div>
<div><font color="#ff0000"   size="2"   >5 seconds per test</font></div>
<div><font color="#ff0000"   size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using one 8kB write:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 29959.548 ops/sec &nbsp; &nbsp; &nbsp;33 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 26916.071 ops/sec &nbsp; &nbsp; &nbsp;37 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 19083.832 ops/sec &nbsp; &nbsp; &nbsp;52 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 27749.411 ops/sec &nbsp; &nbsp; &nbsp;36 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using two 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14162.292 ops/sec &nbsp; &nbsp; &nbsp;71 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 15988.317 ops/sec &nbsp; &nbsp; &nbsp;63 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12431.108 ops/sec &nbsp; &nbsp; &nbsp;80 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13515.127 ops/sec &nbsp; &nbsp; &nbsp;74 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare open_sync with different write sizes:</font></div>
<div><font color="#ff0000"   size="2"   >(This is designed to compare the cost of writing 16kB</font></div>
<div><font color="#ff0000"   size="2"   >in different write open_sync sizes.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; 18787.955 ops/sec &nbsp; &nbsp; &nbsp;53 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp;13915.061 ops/sec &nbsp; &nbsp; &nbsp;72 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp; 8684.830 ops/sec &nbsp; &nbsp; 115 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;347.167 ops/sec &nbsp; &nbsp;2880 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;269.654 ops/sec &nbsp; &nbsp;3708 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Test if fsync on non-write file descriptor is honored:</font></div>
<div><font color="#ff0000"   size="2"   >(If the times are similar, fsync() can sync data written</font></div>
<div><font color="#ff0000"   size="2"   >on a different descriptor.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13616.426 ops/sec &nbsp; &nbsp; &nbsp;73 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13115.266 ops/sec &nbsp; &nbsp; &nbsp;76 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Non-Sync'ed 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 161001.305 ops/sec &nbsp; &nbsp; &nbsp; 6 usecs/op</font></div></div>
<div><font color="#ff0000"   size="2"   >进程2</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># /opt/pgsql9.3.4/bin/pg_test_fsync -f /ssd/2</font></div>
<div><font color="#ff0000"   size="2"   >5 seconds per test</font></div>
<div><font color="#ff0000"   size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using one 8kB write:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 29773.938 ops/sec &nbsp; &nbsp; &nbsp;34 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 26694.424 ops/sec &nbsp; &nbsp; &nbsp;37 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 19525.263 ops/sec &nbsp; &nbsp; &nbsp;51 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 27408.323 ops/sec &nbsp; &nbsp; &nbsp;36 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using two 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14181.855 ops/sec &nbsp; &nbsp; &nbsp;71 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16052.939 ops/sec &nbsp; &nbsp; &nbsp;62 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12490.750 ops/sec &nbsp; &nbsp; &nbsp;80 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13723.671 ops/sec &nbsp; &nbsp; &nbsp;73 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare open_sync with different write sizes:</font></div>
<div><font color="#ff0000"   size="2"   >(This is designed to compare the cost of writing 16kB</font></div>
<div><font color="#ff0000"   size="2"   >in different write open_sync sizes.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; 18485.904 ops/sec &nbsp; &nbsp; &nbsp;54 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp;13690.145 ops/sec &nbsp; &nbsp; &nbsp;73 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp; 8538.992 ops/sec &nbsp; &nbsp; 117 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;336.883 ops/sec &nbsp; &nbsp;2968 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;314.388 ops/sec &nbsp; &nbsp;3181 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Test if fsync on non-write file descriptor is honored:</font></div>
<div><font color="#ff0000"   size="2"   >(If the times are similar, fsync() can sync data written</font></div>
<div><font color="#ff0000"   size="2"   >on a different descriptor.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13707.362 ops/sec &nbsp; &nbsp; &nbsp;73 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12839.225 ops/sec &nbsp; &nbsp; &nbsp;78 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Non-Sync'ed 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 153528.755 ops/sec &nbsp; &nbsp; &nbsp; 7 usecs/op</font></div></div>
<div><font color="#ff0000"   size="2"   >进程3</font></div>
<div>
<div><font color="#ff0000"   size="2"   ># /opt/pgsql9.3.4/bin/pg_test_fsync -f /ssd/3</font></div>
<div><font color="#ff0000"   size="2"   >5 seconds per test</font></div>
<div><font color="#ff0000"   size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using one 8kB write:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 29921.701 ops/sec &nbsp; &nbsp; &nbsp;33 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 26656.149 ops/sec &nbsp; &nbsp; &nbsp;38 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 19701.098 ops/sec &nbsp; &nbsp; &nbsp;51 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 27229.080 ops/sec &nbsp; &nbsp; &nbsp;37 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare file sync methods using two 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >(in wal_sync_method preference order, except fdatasync</font></div>
<div><font color="#ff0000"   size="2"   >is Linux's default)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14177.152 ops/sec &nbsp; &nbsp; &nbsp;71 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 15772.293 ops/sec &nbsp; &nbsp; &nbsp;63 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12589.742 ops/sec &nbsp; &nbsp; &nbsp;79 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13787.782 ops/sec &nbsp; &nbsp; &nbsp;73 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Compare open_sync with different write sizes:</font></div>
<div><font color="#ff0000"   size="2"   >(This is designed to compare the cost of writing 16kB</font></div>
<div><font color="#ff0000"   size="2"   >in different write open_sync sizes.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; 18697.155 ops/sec &nbsp; &nbsp; &nbsp;53 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp;13377.013 ops/sec &nbsp; &nbsp; &nbsp;75 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp; 8537.356 ops/sec &nbsp; &nbsp; 117 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;349.729 ops/sec &nbsp; &nbsp;2859 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;311.943 ops/sec &nbsp; &nbsp;3206 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Test if fsync on non-write file descriptor is honored:</font></div>
<div><font color="#ff0000"   size="2"   >(If the times are similar, fsync() can sync data written</font></div>
<div><font color="#ff0000"   size="2"   >on a different descriptor.)</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13971.711 ops/sec &nbsp; &nbsp; &nbsp;72 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12785.385 ops/sec &nbsp; &nbsp; &nbsp;78 usecs/op</font></div>
<div><font color="#ff0000"   size="2"   ><br></font></div>
<div><font color="#ff0000"   size="2"   >Non-Sync'ed 8kB writes:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 147119.435 ops/sec &nbsp; &nbsp; &nbsp; 7 usecs/op</font></div></div>
<div><br></div>
<div>将所有进程的测试结果汇总后的one 8KB write结果对比, 宝存1.2 TB 远超OCZ RevoDrive3 X2 960G</div>
<div><font color="#ff0000"   size="2"   >OCZ</font></div>
<div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13726.425 ops/sec</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2077.498 ops/sec</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1029.456 ops/sec</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12453.317 ops/sec</font></div></div>
<div><font color="#ff0000"   size="2"   >宝存</font></div>
<div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 89655.187 ops/sec</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 80266.644 ops/sec</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 58310.193 ops/sec</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 82386.814 ops/sec</font></div></div>
<div><span style="LINE-HEIGHT: 28px;"   ><br></span></div>
<div><br></div>
<div>2. 测试数据库的tps性能(对SSD性能本身没有太大的参考价值, 因为瓶颈可能出现在CPU上)</div>
<div>数据库版本 9.3.4</div>
<div>数据库配置, 主要是wal fsync method, 从测试结果来看, 我这里选择了两款SSD产品都最好的宝存open_datasync, OCZ open_sync(不支持open_datasync).</div>
<div><br></div>
<div>
<div><font color="#ff0000"   size="2"   >grep "^[a-z]" postgresql.conf&nbsp;</font></div>
<div><font color="#ff0000"   size="2"   >listen_addresses = '0.0.0.0' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# what IP address(es) to listen on;</font></div>
<div><font color="#ff0000"   size="2"   >port = 5432 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # (change requires restart)</font></div>
<div><font color="#ff0000"   size="2"   >max_connections = 100 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # (change requires restart)</font></div>
<div><font color="#ff0000"   size="2"   >unix_socket_directories = '.' &nbsp; # comma-separated list of directories</font></div>
<div><font color="#ff0000"   size="2"   >shared_buffers = 2048MB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # min 128kB</font></div>
<div><font color="#ff0000"   size="2"   >maintenance_work_mem = 512MB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# min 1MB</font></div>
<div><font color="#ff0000"   size="2"   >vacuum_cost_delay = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 0-100 milliseconds</font></div>
<div><font color="#ff0000"   size="2"   >vacuum_cost_limit = 10000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 1-10000 credits</font></div>
<div><font color="#ff0000"   size="2"   >bgwriter_delay = 10ms &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 10-10000ms between rounds</font></div>
<div><font color="#ff0000"   size="2"   >wal_level = hot_standby &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # minimal, archive, or hot_standby</font></div>
<div><font color="#ff0000"   size="2"   >synchronous_commit = on &nbsp; &nbsp; &nbsp; &nbsp; # synchronization level;</font></div>
<div><font color="#ff0000"   size="2"   >wal_sync_method = open_datasync &nbsp; &nbsp; &nbsp; &nbsp; # the default is the first option</font></div>
<div><font color="#ff0000"   size="2"   >wal_buffers = 16384kB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # min 32kB, -1 sets based on shared_buffers</font></div>
<div><font color="#ff0000"   size="2"   >checkpoint_segments = 128 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # in logfile segments, min 1, 16MB each</font></div>
<div><font color="#ff0000"   size="2"   >effective_cache_size = 24000MB</font></div>
<div><font color="#ff0000"   size="2"   >log_destination = 'csvlog' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Valid values are combinations of</font></div>
<div><font color="#ff0000"   size="2"   >logging_collector = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Enable capturing of stderr and csvlog</font></div>
<div><font color="#ff0000"   size="2"   >log_truncate_on_rotation = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # If on, an existing log file with the</font></div>
<div><font color="#ff0000"   size="2"   >log_timezone = 'PRC'</font></div>
<div><font color="#ff0000"   size="2"   >autovacuum = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Enable autovacuum subprocess? &nbsp;'on'</font></div>
<div><font color="#ff0000"   size="2"   >log_autovacuum_min_duration = 0 # -1 disables, 0 logs all actions and</font></div>
<div><font color="#ff0000"   size="2"   >datestyle = 'iso, mdy'</font></div>
<div><font color="#ff0000"   size="2"   >timezone = 'PRC'</font></div>
<div><font color="#ff0000"   size="2"   >lc_messages = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # locale for system error message</font></div>
<div><font color="#ff0000"   size="2"   >lc_monetary = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # locale for monetary formatting</font></div>
<div><font color="#ff0000"   size="2"   >lc_numeric = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# locale for number formatting</font></div>
<div><font color="#ff0000"   size="2"   >lc_time = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # locale for time formatting</font></div>
<div><font color="#ff0000"   size="2"   >default_text_search_config = 'pg_catalog.english'</font></div></div>
<div><br></div>
<div>测试模型</div>
<div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >postgres=# create table test (id int primary key, info text, crt_time timestamp);</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >CREATE TABLE</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >postgres=# create or replace function f(v_id int) returns void as&nbsp;</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >$$</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >declare</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >begin</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >&nbsp; update test set info=md5(now()::text),crt_time=now() where id=v_id;</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >&nbsp; if not found then</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >&nbsp; &nbsp; insert into test values (v_id, md5(now()::text), now()); &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >&nbsp; end if;</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >&nbsp; return;</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >&nbsp; exception when others then</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >&nbsp; &nbsp; return;</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >end;</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >$$ language plpgsql strict;</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >CREATE FUNCTION</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   ><br style="LINE-HEIGHT: 22px;"   ></font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >$ vi test.sql</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >\setrandom vid 1 10000000</font></div>
<div style="LINE-HEIGHT: 28px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(51,51,51);"   ><font style="LINE-HEIGHT: 22px;"   color="#ff0000"   size="2"   >select f(:vid);</font></div></div>
<div><br></div>
<div>测试方法</div>
<div><span style="LINE-HEIGHT: 22px; FONT-FAMILY: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; COLOR: rgb(255,0,0); FONT-SIZE: small;"   >pgbench -M prepared -n -r -f ./test.sql -c 12 -j 4 -T 300</span></div>
<div><br></div>
<div>测试结果对比</div>
<div>OCZ</div>
<div>
<div><font color="#ff0000"   size="2"   >pgbench -M prepared -n -r -f ./test.sql -c 12 -j 4 -T 300 -h /data_ssd1/test -p 5432 -U postgres postgres</font></div>
<div><font color="#ff0000"   size="2"   >transaction type: Custom query</font></div>
<div><font color="#ff0000"   size="2"   >scaling factor: 1</font></div>
<div><font color="#ff0000"   size="2"   >query mode: prepared</font></div>
<div><font color="#ff0000"   size="2"   >number of clients: 12</font></div>
<div><font color="#ff0000"   size="2"   >number of threads: 4</font></div>
<div><font color="#ff0000"   size="2"   >duration: 300 s</font></div>
<div><font color="#ff0000"   size="2"   >number of transactions actually processed: 6215372</font></div>
<div><font color="#ff0000"   size="2"   >tps = 20714.778666 (including connections establishing)</font></div>
<div><font color="#ff0000"   size="2"   >tps = 20715.587367 (excluding connections establishing)</font></div>
<div><font color="#ff0000"   size="2"   >statement latencies in milliseconds:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 0.001759 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom vid 1 10000000</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 0.575683 &nbsp; &nbsp; &nbsp; &nbsp;select f(:vid);</font></div></div>
<div><font color="#ff0000"   size="2"   >与异步提交效率有差距.</font></div>
<div>
<div><font color="#ff0000"   size="2"   >pgbench -M prepared -n -r -f ./test.sql -c 12 -j 4 -T 30 -h /data_ssd1/test -p 5432 -U postgres postgres</font></div>
<div><font color="#ff0000"   size="2"   >transaction type: Custom query</font></div>
<div><font color="#ff0000"   size="2"   >scaling factor: 1</font></div>
<div><font color="#ff0000"   size="2"   >query mode: prepared</font></div>
<div><font color="#ff0000"   size="2"   >number of clients: 12</font></div>
<div><font color="#ff0000"   size="2"   >number of threads: 4</font></div>
<div><font color="#ff0000"   size="2"   >duration: 30 s</font></div>
<div><font color="#ff0000"   size="2"   >number of transactions actually processed: 1284258</font></div>
<div><font color="#ff0000"   size="2"   >tps = 42797.519722 (including connections establishing)</font></div>
<div><font color="#ff0000"   size="2"   >tps = 42813.485019 (excluding connections establishing)</font></div>
<div><font color="#ff0000"   size="2"   >statement latencies in milliseconds:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 0.001762 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom vid 1 10000000</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 0.276727 &nbsp; &nbsp; &nbsp; &nbsp;select f(:vid);</font></div></div>
<div><br></div>
<div>宝存</div>
<div>
<div><font color="#ff0000"   size="2"   >$ /opt/pgsql9.3.4/bin/pgbench -M prepared -n -r -f ./test.sql -c 12 -j 4 -T 300 -h /mnt/pg_root -p 5432 -U postgres postgres</font></div>
<div><font color="#ff0000"   size="2"   >transaction type: Custom query</font></div>
<div><font color="#ff0000"   size="2"   >scaling factor: 1</font></div>
<div><font color="#ff0000"   size="2"   >query mode: prepared</font></div>
<div><font color="#ff0000"   size="2"   >number of clients: 12</font></div>
<div><font color="#ff0000"   size="2"   >number of threads: 4</font></div>
<div><font color="#ff0000"   size="2"   >duration: 300 s</font></div>
<div><font color="#ff0000"   size="2"   >number of transactions actually processed: 10865222</font></div>
<div><font color="#ff0000"   size="2"   >tps = 36214.699980 (including connections establishing)</font></div>
<div><font color="#ff0000"   size="2"   >tps = 36216.135752 (excluding connections establishing)</font></div>
<div><font color="#ff0000"   size="2"   >statement latencies in milliseconds:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 0.002184 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom vid 1 10000000</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 0.327720 &nbsp; &nbsp; &nbsp; &nbsp;select f(:vid);</font></div>
<div><span style="LINE-HEIGHT: 28px;"   ><font color="#ff0000"   size="2"   >与异步提交(synchronous_commit = off)的效率还是有较大差异.</font></span></div></div>
<div>
<div><font color="#ff0000"   size="2"   >$ /opt/pgsql9.3.4/bin/pgbench -M prepared -n -r -f ./test.sql -c 12 -j 4 -T 30 -h /mnt/pg_root -p 5432 -U postgres postgres</font></div>
<div><font color="#ff0000"   size="2"   >transaction type: Custom query</font></div>
<div><font color="#ff0000"   size="2"   >scaling factor: 1</font></div>
<div><font color="#ff0000"   size="2"   >query mode: prepared</font></div>
<div><font color="#ff0000"   size="2"   >number of clients: 12</font></div>
<div><font color="#ff0000"   size="2"   >number of threads: 4</font></div>
<div><font color="#ff0000"   size="2"   >duration: 30 s</font></div>
<div><font color="#ff0000"   size="2"   >number of transactions actually processed: 1740723</font></div>
<div><font color="#ff0000"   size="2"   >tps = 58010.769125 (including connections establishing)</font></div>
<div><font color="#ff0000"   size="2"   >tps = 58032.766226 (excluding connections establishing)</font></div>
<div><font color="#ff0000"   size="2"   >statement latencies in milliseconds:</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 0.001867 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom vid 1 10000000</font></div>
<div><font color="#ff0000"   size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 0.203650 &nbsp; &nbsp; &nbsp; &nbsp;select f(:vid);</font></div></div>
<div>从异步测试的数据来看, OCZ所在服务器因为CPU的性能较弱, 明显要低于宝存所在服务器的性能.</div>
<div>另外就是, 数据库的测试TPS结果, OCZ和宝存的差异并没有直接测试FSYNC接口差异那么大, 因为瓶颈不是在IO上面了, 已经出现在CPU了.</div>
<div><br></div>
<div>测试数据汇总 :&nbsp;</div><div>(注意测试机的CPU分别为2.0G和2.5G, 可以对OCZ的数据乘以1.25的系数. 有时间我会把OCZ的硬盘插到同一台服务器, 同样速率的PCI-E接口再测一遍. 现在的测试数据仅供参考. )</div><div>(同时需要注意数据库这块的测试, 因为不是单纯的IO测试, 还有大多数的开销在CPU上, 所以仅供参考)</div><div>(fsync接口测试单8K数据块的fsync)</div>
<div>
<div><img title="宝存 shannon PCI-E SSD VS OCZ RevoDrive3 X2 PCI-E SSD on CentOS 6.5 2.6.32-431.el6.x86_64 - 德哥@Digoal - PostgreSQL"   alt="宝存 shannon PCI-E SSD VS OCZ RevoDrive3 X2 PCI-E SSD on CentOS 6.5 2.6.32-431.el6.x86_64 - 德哥@Digoal - PostgreSQL"   style="margin: 0px 10px 0px 0px;"   src="http://img1.ph.126.net/ObsZXJPZmTRmqCowOv3c4g==/3186578211441581344.png"   ></div><div><br></div><div>关于这块宝存SSD的cell寿命, 因为才拿到一天, 还没有擦写够. 以下是当前的一个健康状态.</div><div>如果按照现在的强度使用(基本属于虐待), 根据厂家提供的寿命数据(容量*10000), 可以使用200天左右报废.</div><div><div><font size="2"   color="#ff0000"   >Direct-IO drive scta at PCI Address:41:00:0:</font></div><div><font size="2"   color="#ff0000"   >Model:sh-shannon-pcie-ssd, SN: 006819246149b014</font></div><div><font size="2"   color="#ff0000"   >Device state: attached as disk /dev/dfa, Access mode: readwrite</font></div><div><font size="2"   color="#ff0000"   >Firmware version: 0c321351, Driver version: 2.6.9</font></div><div><font size="2"   color="#ff0000"   >Vendor:1cb0, Device:0275, Sub vendor:1cb0, Sub device:0275</font></div><div><font size="2"   color="#ff0000"   >Flash manufacturer: 98, Flash id: 3a</font></div><div><font size="2"   color="#ff0000"   >Channels: 7, Lunsets in channel: 8, Luns in lunset: 2, Available luns: 112</font></div><div><font size="2"   color="#ff0000"   >Eblocks in lun: 2116, Pages in eblock: 256, Nand page size: 32768</font></div><div><font size="2"   color="#ff0000"   >Logical sector: 512, Physical sector: 4096</font></div><div><font size="2"   color="#ff0000"   >User capacity: 1200.00 GB/1117.59 GiB</font></div><div><font size="2"   color="#ff0000"   >Physical capacity: 1632.37 GB/1520.26 GiB</font></div><div><font size="2"   color="#ff0000"   >Overprovision: 27%, warn at 10%</font></div><div><font size="2"   color="#ff0000"   >Error correction: 35 bits per 880 bytes codeword</font></div><div><font size="2"   color="#ff0000"   >Controller internal temperature: 70 degC, max 77 degC</font></div><div><font size="2"   color="#ff0000"   >Controller board temperature: 52 degC, max 59 degC</font></div><div><font size="2"   color="#ff0000"   >NAND Flash temperature: 52 degC, max 63 degC</font></div><div><font size="2"   color="#ff0000"   >Internal voltage: 999 mV, max 1028 mV</font></div><div><font size="2"   color="#ff0000"   >Auxiliary voltage: 1787 mV, max 1807 mV</font></div><div><font size="2"   color="#ff0000"   >Media status: 1.0760% bad block</font></div><div><font size="2"   color="#ff0000"   >Power on hours: 21 hours 9 minutes, Power cycles: 3</font></div><div><font size="2"   color="#ff0000"   >Lifetime data volumes:</font></div><div><font size="2"   color="#ff0000"   >&nbsp; Host write data &nbsp; &nbsp;: 41516.25 GB / 38665.02 GiB</font></div><div><font size="2"   color="#ff0000"   >&nbsp; Host read data &nbsp; &nbsp; : 5172.11 GB / 4816.90 GiB</font></div><div><font size="2"   color="#ff0000"   >&nbsp; Total write data &nbsp; : 48235.25 GB / 44922.58 GiB</font></div><div><font size="2"   color="#ff0000"   >&nbsp; Write amplifier &nbsp; &nbsp;: 1.1618</font></div><div><font size="2"   color="#ff0000"   >&nbsp; Estimated life left: 99% left</font></div></div><br></div>
<div>最后简单介绍一下SSD一般的应用场景.</div>
<div>1. 作为文件系统二级缓存, 例如ZFS的 L2ARC(越大越好,但是它只存非脏数据), SLOG(slog一般10GB以内就够了, 建议mirror).</div><div>2. 类似文件系统二级缓存, FB的flashcache.</div>
<div>3. 作为数据库统计信息文件夹(stats_temp_directory).</div>
<div>4. 作为数据库活跃数据表空间.</div>
<div>5. 操作系统交换分区.</div><div>其他</div>
<div><br></div>
<div>应用注意事项</div>
<div>1. 分区物理访问单元对齐.</div>
<div><br></div>
<div>[参考]</div>
<div>1.&nbsp;<a style="LINE-HEIGHT: 28px" target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020135753630439/"   >http://blog.163.com/digoal@126/blog/static/16387704020135753630439/</a></div>
<div>2. $SRC/contrib/pg_test_fsync/pg_test_fsync.c</div>
<div><span style="LINE-HEIGHT: 28px;"   >#define XLOG_BLCKSZ_K &nbsp; (XLOG_BLCKSZ / 1024)</span></div>
<div><span style="LINE-HEIGHT: 28px;"   >3.&nbsp;</span><a style="LINE-HEIGHT: 28px" target="_blank" rel="nofollow" href="http://www.shannon-sys.com/"   >http://www.shannon-sys.com/</a></div>
<div>4.&nbsp;<a style="LINE-HEIGHT: 28px" target="_blank" href="http://blog.163.com/digoal@126/blog/static/16387704020135753630439/"   >http://blog.163.com/digoal@126/blog/static/16387704020135753630439/</a></div>
<div>5.&nbsp;<a style="LINE-HEIGHT: 28px" target="_blank" rel="nofollow" href="http://en.wikipedia.org/wiki/Data_structure_alignment#Allocating_memory_aligned_to_cache_lines"   >http://en.wikipedia.org/wiki/Data_structure_alignment#Allocating_memory_aligned_to_cache_lines</a></div>
<div>6.&nbsp;<a style="LINE-HEIGHT: 28px" target="_blank" rel="nofollow" href="http://en.wikipedia.org/wiki/Ssd"   >http://en.wikipedia.org/wiki/Ssd</a></div>
<div><br></div><a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="宝存 shannon PCI-E SSD VS OCZ RevoDrive3 X2 PCI-E SSD on CentOS 6.5 2.6.32-431.el6.x86_64 - 德哥@Digoal - PostgreSQL"   border="0"   alt="Flag Counter"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   ></a><br></div></div>
	</div>
</div>
</body>
</html>