<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">upgrade module on pypi</h2>
	<h5 id="">2015-01-26 16:34:39&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020150264410167/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><div>之前写了一篇如何将模块上传到pypi.python.org的文章</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201502693447397/"   >http://blog.163.com/digoal@126/blog/static/163877040201502693447397/</a></div><div>如果代码有更新, 如何更新到pypi呢?</div><div>例如 :&nbsp;</div><div>首选更新代码</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost pydigoal]# vi digoal_nester.py&nbsp;</font></div><div><div><font size="2"   >"""this is comment</font></div><div><font size="2"   >comment end"""</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >def print_lol(the_list, ident=False, level=0):</font></div><div><font size="2"   >&nbsp; """this is function comment</font></div><div><font size="2"   >&nbsp; comment end"""</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; for each_item in the_list:</font></div><div><font size="2"   >&nbsp; &nbsp; if isinstance(each_item, list):</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; print_lol(each_item, ident, level+1)</font></div><div><font size="2"   >&nbsp; &nbsp; else:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; if ident:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; for tab_stop in range(level):</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print("\t", end='')</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; print(each_item)</font></div></div><p></p></pre></div></div><div><br></div><div>然后要更新setup.py, 修改version.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost pydigoal]# vi setup.py&nbsp;</font></div><div><font size="2"   >from distutils.core import setup</font></div><div><font size="2"   >setup(</font></div><div><font size="2"   >&nbsp; &nbsp; name = 'digoal_nester',</font></div><div><font size="2"   >&nbsp; &nbsp; version = '1.2.0',</font></div><div><font size="2"   >&nbsp; &nbsp; py_modules = ['digoal_nester'],</font></div><div><font size="2"   >&nbsp; &nbsp; author = 'digoal',</font></div><div><font size="2"   >&nbsp; &nbsp; author_email = 'digoal@126.com',</font></div><div><font size="2"   >&nbsp; &nbsp; url = 'http://blog.163.com/digoal@126',</font></div><div><font size="2"   >&nbsp; &nbsp; description = 'a test module by digoal'</font></div><div><font size="2"   >)</font></div><p></p></pre></div><div><br></div><div>使用python setup.py sdist upload上传</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost pydigoal]# python setup.py sdist upload</font></div><div><font size="2"   >running sdist</font></div><div><font size="2"   >running check</font></div><div><font size="2"   >warning: sdist: manifest template 'MANIFEST.in' does not exist (using default file list)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >warning: sdist: standard file not found: should have one of README, README.txt</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >writing manifest file 'MANIFEST'</font></div><div><font size="2"   >creating digoal_nester-1.2.0</font></div><div><font size="2"   >making hard links in digoal_nester-1.2.0...</font></div><div><font size="2"   >hard linking digoal_nester.py -&gt; digoal_nester-1.2.0</font></div><div><font size="2"   >hard linking setup.py -&gt; digoal_nester-1.2.0</font></div><div><font size="2"   >Creating tar archive</font></div><div><font size="2"   >removing 'digoal_nester-1.2.0' (and everything under it)</font></div><div><font size="2"   >running upload</font></div><div><font size="2"   >Submitting dist/digoal_nester-1.2.0.tar.gz to https://pypi.python.org/pypi</font></div><div><font size="2"   >Server response (200): OK</font></div><p></p></pre></div><div><br></div><div>上传后可以通过URL搜索到上传的更新模块</div><div><a target="_blank" rel="nofollow" href="https://pypi.python.org/pypi/digoal_nester/1.2.0"   >https://pypi.python.org/pypi/digoal_nester/1.2.0</a></div><div><br></div><div>本地测试</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost pydigoal]# python setup.py install</font></div><div><font size="2"   >running install</font></div><div><font size="2"   >running build</font></div><div><font size="2"   >running build_py</font></div><div><font size="2"   >copying digoal_nester.py -&gt; build/lib</font></div><div><font size="2"   >running install_lib</font></div><div><font size="2"   >copying build/lib/nester.py -&gt; /usr/local/lib/python3.4/site-packages</font></div><div><font size="2"   >copying build/lib/digoal_nester.py -&gt; /usr/local/lib/python3.4/site-packages</font></div><div><font size="2"   >byte-compiling /usr/local/lib/python3.4/site-packages/nester.py to nester.cpython-34.pyc</font></div><div><font size="2"   >byte-compiling /usr/local/lib/python3.4/site-packages/digoal_nester.py to digoal_nester.cpython-34.pyc</font></div><div><font size="2"   >running install_egg_info</font></div><div><font size="2"   >Writing /usr/local/lib/python3.4/site-packages/digoal_nester-1.2.0-py3.4.egg-info</font></div><p></p></pre></div><div><br></div><div>本地测试</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@localhost ~]# vi test.py</font></div><div><font size="2"   >import digoal_nester</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >l_list = ['hello',['i',['am','digoal']]]</font></div><div><font size="2"   >digoal_nester.print_lol(l_list,True)</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >[root@localhost ~]# python ./test.py</font></div><div><font size="2"   >hello</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; i</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; am</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; digoal</font></div></div><p></p></pre></div><div><br></div><wbr>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="upgrade module on pypi - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>