<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">save data to file</h2>
	<h5 id="">2015-01-29 15:12:10&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201502924652220/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>使用python 如何将数据输出到文件呢?</div><div>使用open以写模式或追加模式打开文件, 使用print的file=fileobj来写.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost ~]# cd pydigoal/</font></div><div><font size="2"   >[root@localhost pydigoal]# ll</font></div><div><font size="2"   >total 16</font></div><div><font size="2"   >drwxr-xr-x 3 root root &nbsp; 16 Jan 26 17:25 build</font></div><div><font size="2"   >-rw-r--r-- 1 root root &nbsp;404 Jan 29 22:36 digoal_nester.py</font></div><div><font size="2"   >drwxr-xr-x 2 root root 4096 Jan 29 22:36 dist</font></div><div><font size="2"   >-rw-r--r-- 1 root root &nbsp; 69 Jan 29 22:36 MANIFEST</font></div><div><font size="2"   >-rw-r--r-- 1 root root &nbsp;277 Jan 29 22:36 setup.py</font></div><p></p></pre></div><div>修改之前写的digoal_nester.py</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost pydigoal]# vi digoal_nester.py&nbsp;</font></div><div><font size="2"   >import sys &nbsp; &nbsp;# 导入sys模块, 默认print函数输出到sys.stdou, 即标准输出</font></div><div><font size="2"   >"""this is comment</font></div><div><font size="2"   >comment end"""</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >def print_lol(the_list, ident=False, level=0, fn=sys.stdout): &nbsp; &nbsp;# 增加fn参数, 默认打印到标准输出</font></div><div><font size="2"   >&nbsp; """this is function comment</font></div><div><font size="2"   >&nbsp; comment end"""</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; for each_item in the_list:</font></div><div><font size="2"   >&nbsp; &nbsp; if isinstance(each_item, list):</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; print_lol(each_item, ident, level+1, fn) &nbsp; # 加上fn参数</font></div><div><font size="2"   >&nbsp; &nbsp; else:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; if ident:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; for tab_stop in range(level):</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print("\t", end='', file=fn) &nbsp; # 为print指定输出目标, file=fn</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; print(each_item, file=fn) &nbsp;<span style="line-height: 28px;"   >&nbsp;</span><span style="line-height: 28px;"   ># 为print指定输出目标, file=fn</span></font></div><p></p></pre></div><div><br></div><div>修改setup.py</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost pydigoal]# vi setup.py&nbsp;</font></div><div><font size="2"   >from distutils.core import setup</font></div><div><font size="2"   >setup(</font></div><div><font size="2"   >&nbsp; &nbsp; name = 'digoal_nester',</font></div><div><font size="2"   >&nbsp; &nbsp; version = '1.3.0', &nbsp; &nbsp;# 修改版本号</font></div><div><font size="2"   >&nbsp; &nbsp; py_modules = ['digoal_nester'],</font></div><div><font size="2"   >&nbsp; &nbsp; author = 'digoal',</font></div><div><font size="2"   >&nbsp; &nbsp; author_email = 'digoal@126.com',</font></div><div><font size="2"   >&nbsp; &nbsp; url = 'http://blog.163.com/digoal@126',</font></div><div><font size="2"   >&nbsp; &nbsp; description = 'a test module by digoal'</font></div><div><font size="2"   >)</font></div><p></p></pre></div><div><br></div><div>上传到pypi</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost pydigoal]# python setup.py sdist upload</font></div><div><font size="2"   >running sdist</font></div><div><font size="2"   >running check</font></div><div><font size="2"   >warning: sdist: manifest template 'MANIFEST.in' does not exist (using default file list)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >warning: sdist: standard file not found: should have one of README, README.txt</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >writing manifest file 'MANIFEST'</font></div><div><font size="2"   >creating digoal_nester-1.3.0</font></div><div><font size="2"   >making hard links in digoal_nester-1.3.0...</font></div><div><font size="2"   >hard linking digoal_nester.py -&gt; digoal_nester-1.3.0</font></div><div><font size="2"   >hard linking setup.py -&gt; digoal_nester-1.3.0</font></div><div><font size="2"   >Creating tar archive</font></div><div><font size="2"   >removing 'digoal_nester-1.3.0' (and everything under it)</font></div><div><font size="2"   >running upload</font></div><div><font size="2"   >Submitting dist/digoal_nester-1.3.0.tar.gz to https://pypi.python.org/pypi</font></div><div><font size="2"   >Server response (200): OK</font></div><p></p></pre></div><div><br></div><div>本地安装digoal_nester模块</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost pydigoal]# python setup.py install</font></div><div><font size="2"   >running install</font></div><div><font size="2"   >running build</font></div><div><font size="2"   >running build_py</font></div><div><font size="2"   >copying digoal_nester.py -&gt; build/lib</font></div><div><font size="2"   >running install_lib</font></div><div><font size="2"   >copying build/lib/digoal_nester.py -&gt; /usr/local/lib/python3.4/site-packages</font></div><div><font size="2"   >byte-compiling /usr/local/lib/python3.4/site-packages/digoal_nester.py to digoal_nester.cpython-34.pyc</font></div><div><font size="2"   >running install_egg_info</font></div><div><font size="2"   >Writing /usr/local/lib/python3.4/site-packages/digoal_nester-1.3.0-py3.4.egg-info</font></div><p></p></pre></div><div><br></div><div>测试</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost pydigoal]# cd ..</font></div><div><font size="2"   >[root@localhost ~]# vi test.py</font></div><div><div><font size="2"   >import digoal_nester</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >l_list = ['hello',['i',['am','digoal']]]</font></div><div><font size="2"   >digoal_nester.print_lol(l_list,True)</font></div></div><p></p></pre></div><div>默认输出到标准输出</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost ~]# python ./test.py</font></div><div><font size="2"   >hello</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; i</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; am</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; digoal</font></div><p></p></pre></div><div><br></div><div>改为输出到文件</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@localhost ~]# vi test.py</font></div><div><font size="2"   >import digoal_nester</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >l_list = ['hello',['i',['am','digoal']]]</font></div><div><font size="2"   >with open("/tmp/abc.txt", "w") as f1:</font></div><div><font size="2"   >&nbsp; digoal_nester.print_lol(l_list,True,fn=f1)</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >[root@localhost ~]# python ./test.py</font></div><div><font size="2"   >[root@localhost ~]# cat /tmp/abc.txt&nbsp;</font></div><div><font size="2"   >hello</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; i</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; am</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; digoal</font></div></div><p></p></pre></div><div>多次执行, 文件内容会被覆盖重写</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost ~]# python ./test.py</font></div><div><font size="2"   >[root@localhost ~]# cat /tmp/abc.txt&nbsp;</font></div><div><font size="2"   >hello</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; i</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; am</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; digoal</font></div><p></p></pre></div><div>使用追加模式open("/tmp/abc.txt", "a"), 则会在文件末尾继续写.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@localhost ~]# python ./test.py</font></div><div><font size="2"   >[root@localhost ~]# cat /tmp/abc.txt&nbsp;</font></div><div><font size="2"   >hello</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; i</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; am</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; digoal</font></div><div><font size="2"   >hello</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; i</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; am</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; digoal</font></div><p></p></pre></div><div><br></div><div>open打开文件的格式如下 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >open() returns a file object, and is most commonly used with two arguments: open(filename, mode).</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&gt;&gt;&gt;</font></div><div><font size="2"   >&gt;&gt;&gt; f = open('workfile', 'w')</font></div><div><font size="2"   >The first argument is a string containing the filename. The second argument is another string containing a few characters describing the way in which the file will be used.&nbsp;</font></div><div><font size="2"   >第一个参数是文件名, 第二个是文件的打开模式.</font></div><div><font size="2"   >mode can be 'r' when the file will only be read, 只读</font></div><div><font size="2"   >'w' for only writing (an existing file with the same name will be erased), 写模式, 会覆盖原内容.</font></div><div><font size="2"   >and 'a' opens the file for appending; any data written to the file is automatically added to the end. 追加模式, 在文件末尾继续写.</font></div><div><font size="2"   >'r+' opens the file for both reading and writing. &nbsp;读写模式</font></div><div><font size="2"   >The mode argument is optional; 'r' will be assumed if it’s omitted.</font></div><p></p></pre></div><div><br></div><div>[其他]</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >1. len函数, 获得对象的长度</font></div><div><div><font size="2"   >&gt;&gt;&gt; print(len("hello"))</font></div><div><font size="2"   >5</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >2. 字符串的strip方法, 用于截断字符串前后的空格</font></div><div><div><font size="2"   >&gt;&gt;&gt; print(" &nbsp;hello a b c &nbsp; ".strip())</font></div><div><font size="2"   >hello a b c</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >3. str()函数, 用于将对象转换为字符串, 例如</font></div><div><div><font size="2"   >&gt;&gt;&gt; try:</font></div><div><font size="2"   >... &nbsp; print(me)</font></div><div><font size="2"   >... except NameError as err:</font></div><div><font size="2"   >... &nbsp; print("error" + str(err)) &nbsp;# +号对字符串对象, 用于连接字符串, 对数字对象, 用于数学运算</font></div><div><font size="2"   >...&nbsp;</font></div><div><font size="2"   >errorname 'me' is not defined</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >&gt;&gt;&gt; print(str(123))</font></div><div><font size="2"   >123</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >4. in用于判断对象是否存在</font></div><div><div><font size="2"   >&gt;&gt;&gt; print("a" in ['a','b'])</font></div><div><font size="2"   >True</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >5. locals()函数用于返回当前环境中的变量名列表</font></div><div><div><font size="2"   >&gt;&gt;&gt; print(locals())</font></div><div><font size="2"   >{'__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, '__package__': None, '__spec__': None, '__builtins__': &lt;module 'builtins' (built-in)&gt;, '__name__': '__main__', '__doc__': None}</font></div></div><div><div><font size="2"   >&gt;&gt;&gt; a=1</font></div><div><font size="2"   >&gt;&gt;&gt; print(locals())</font></div><div><font size="2"   >{'__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, 'a': 1, '__package__': None, '__spec__': None, '__builtins__': &lt;module 'builtins' (built-in)&gt;, '__name__': '__main__', '__doc__': None}</font></div></div><div><div><font size="2"   >&gt;&gt;&gt; print(a in locals())</font></div><div><font size="2"   >False</font></div><div><font size="2"   >&gt;&gt;&gt; print('a' in locals()) &nbsp;# 判断对象名是否存在本地变量中</font></div><div><font size="2"   >True</font></div></div><p></p></pre></div><div><br></div><div><br></div><wbr>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="save data to file - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>