<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">python file operate example - 2</h2>
	<h5 id="">2015-01-27 17:41:58&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201502754158287/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>接上一篇文件操作例子, 这里主要是写入文件的例子.</div><div>将test.txt按照key的奇数和偶数分类写入两个文件.</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402015027102245601/"   >http://blog.163.com/digoal@126/blog/static/1638770402015027102245601/</a></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres@localhost-&gt; vi test.py</font></div><div><font size="2"   >import os # 导入os模块</font></div><div><font size="2"   >even=[] &nbsp;# &nbsp;定义两个list</font></div><div><font size="2"   >odd=[]</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >print(os.getcwd()) &nbsp;# 打印当前工作目录</font></div><div><font size="2"   >os.chdir('/home/postgres') &nbsp;# 修改当前工作目录</font></div><div><font size="2"   >print(os.getcwd())</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >try:</font></div><div><font size="2"   >&nbsp; with open('test.txt') as data: &nbsp;# 自动关闭文件的方式打开文件. 当缩进部分操作完成, 自动调用data.close()</font></div><div><font size="2"   >&nbsp; &nbsp; for each_line in data:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; try:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; (key,value)=each_line.split(',', 1) &nbsp;# 切割</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; if int(key) % 2 == 0: &nbsp;# 如果是偶数</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; even.append(key + " : " + value)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; else: &nbsp;# 如果是奇数</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; odd.append(key + " : " + value)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; except ValueError as err: &nbsp;# err记录错误值的内容, 必须str强制类型转换</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; print("ValueError: " + str(err))</font></div><div><font size="2"   >&nbsp; &nbsp;</font></div><div><font size="2"   >except IOError as err:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; print("Error: " + str(err))</font></div><div><font size="2"   >&nbsp; &nbsp;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >try:</font></div><div><font size="2"   >&nbsp; with open('even.txt', "w") as even_data: &nbsp;# 以w模式打开文件</font></div><div><font size="2"   >&nbsp; &nbsp; print(even, file=even_data) &nbsp;# 写入文件</font></div><div><font size="2"   >&nbsp; with open('odd.txt', "w") as odd_data:</font></div><div><font size="2"   >&nbsp; &nbsp; print(odd, file=odd_data)</font></div><div><font size="2"   >except IOError as err:</font></div><div><font size="2"   >&nbsp; print('Error: ' + str(err))</font></div><p></p></pre></div><div>测试 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >postgres@localhost-&gt; python ./test.py</font></div><div><font size="2"   >/home/postgres</font></div><div><font size="2"   >/home/postgres</font></div><p></p></pre></div><div>写入两个文件</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >cat even.txt&nbsp;</font></div><div><font size="2"   >['2 : 75f9acd8d195f905b6ab6014ccef3a6b\n', '4 : 41d48a6a19a061e1297339681173c491\n', '6 : 0f33bd2eae60c9f00a2824e777c27d02\n', '8 : c51474a7d2f939ed97976ea67fdc554e\n', '10........</font></div></div><div><div><font size="2"   >postgres@localhost-&gt; cat odd.txt&nbsp;</font></div><div><font size="2"   >['1 : 891ca83e2c0971a8a0dc8d7e5edda338\n', '3 : ac4c2dc4d9de3461614d26a132f9c82f\n', '5 : 756f8ed2d4dce954bb5af9793fbb6581\n', '7 : 24a75602d88008760ecb4043f1e47fa6\n', '9 :......</font></div></div><p></p></pre></div><wbr><div><br></div>其他<div>finally: 一般用于无论是否出现except: 都执行.</div><div>例如, 如果不是有with来打开文件的话, 无论如何都要关闭文件描述符 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><span style="line-height: 28px;"   ><font size="2"   >try:</font></span></div><div><div><font size="2"   >&nbsp; even_data = open('even.txt', "w") &nbsp;# 以w模式打开文件</font></div><div><font size="2"   >&nbsp; print(even, file=even_data) &nbsp;# 写入文件</font></div><div><font size="2"   >&nbsp; odd_data = open('odd.txt', "w")</font></div><div><font size="2"   >&nbsp; print(odd, file=odd_data)</font></div><div><font size="2"   >except IOError as err:</font></div><div><font size="2"   >&nbsp; print('Error: ' + str(err))</font></div><div><font size="2"   >finally:</font></div><div><font size="2"   >&nbsp; even_data.close()</font></div><div><font size="2"   >&nbsp; odd_data.close()</font></div></div><p></p></pre></div><div><div><br></div><div><a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="python file operate example - 2 - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a><br></div></div></div>
	</div>
</div>
</body>
</html>