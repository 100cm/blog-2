<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL 9.1 performance improve</h2>
	<h5 id="">2011-08-24 8:13:45&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201172481345197/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><span style="font-family: verdana, sans-serif; font-size: 12px; line-height: 18px;"  >1. Merge duplicate fsync requests</span></div><div><span style="font-family: verdana, sans-serif; font-size: 12px; line-height: 18px;"  >This greatly improves performance under heavy write loads.</span></div><div><span style="font-family: verdana, sans-serif; font-size: 12px; line-height: 18px;"  >2.&nbsp;</span><span style="font-family: verdana, sans-serif; font-size: 12px; line-height: 18px;"  >Allow inheritance table scans to return meaningfully-sorted results (Greg Stark, Hans-Jurgen Schonig, Robert Haas, Tom Lane)</span></div><span style="font-family: verdana, sans-serif; font-size: 12px; line-height: 18px;"  ><p style="line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em; font-size: 1em;"  >This allows better optimization of queries that use&nbsp;<tt style="line-height: 19px;"  >ORDER BY</tt>,&nbsp;<tt style="line-height: 19px;"  >LIMIT</tt>, or&nbsp;<tt style="line-height: 19px;"  >MIN</tt>/<tt style="line-height: 19px;"  >MAX</tt>&nbsp;with inherited tables.</p></span><div><span style="font-family: verdana, sans-serif; font-size: 12px; line-height: 18px;"  >这几条太养眼了。</span></div><div><br></div><div><span style="font-family: verdana, sans-serif; font-size: 12px; line-height: normal;"  ><h4 style="font-size: 0.95em; margin-top: 1.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em; color: rgb(102, 102, 102);"  ><a name="AEN106601" rel="nofollow"  >E.1.3.1.1. Performance</a></h4><p style="font-size: 1em; line-height: 1.5em; margin-top: 1.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  ></p><ul style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Support unlogged tables using the&nbsp;<tt>UNLOGGED</tt>&nbsp;option in&nbsp;<a style="color: rgb(0, 102, 162); text-decoration: underline; " rel="nofollow" href="http://www.postgresql.org/docs/9.1/static/sql-createtable.html"  ><tt>CREATE TABLE</tt></a>&nbsp;(Robert Haas)</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Such tables provide better update performance than regular tables, but are not crash-safe: their contents are automatically cleared in case of a server crash. Their contents do not propagate to replication slaves, either.</p></li><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Allow&nbsp;<tt>FULL OUTER JOIN</tt>&nbsp;to be implemented as a hash join, and allow either side of a&nbsp;<tt>LEFT OUTER JOIN</tt>&nbsp;or&nbsp;<tt>RIGHT OUTER JOIN</tt>&nbsp;to be hashed (Tom Lane)</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Previously&nbsp;<tt>FULL OUTER JOIN</tt>&nbsp;could only be implemented as a merge join, and&nbsp;<tt>LEFT OUTER JOIN</tt>&nbsp;and&nbsp;<tt>RIGHT OUTER JOIN</tt>&nbsp;could hash only the nullable side of the join. These changes provide additional query optimization possibilities.</p></li><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Merge duplicate fsync requests (Robert Haas, Greg Smith)</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >This greatly improves performance under heavy write loads.</p></li><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Improve performance of&nbsp;<a style="color: rgb(0, 102, 162); text-decoration: underline; " rel="nofollow" href="http://www.postgresql.org/docs/9.1/static/runtime-config-wal.html#GUC-COMMIT-SIBLINGS"  ><tt>commit_siblings</tt></a>&nbsp;(Greg Smith)</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >This allows the use of&nbsp;<tt>commit_siblings</tt>&nbsp;with less overhead.</p></li><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Reduce the memory requirement for large ispell dictionaries (Pavel Stehule, Tom Lane)</p></li><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Avoid leaving data files open after&nbsp;<span>"blind writes"</span>&nbsp;(Alvaro Herrera)</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >This fixes scenarios where backends might hold open files that were long since deleted, preventing the kernel from reclaiming disk space.</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >----</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  ></p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  ><span style="white-space:pre;"  > </span>Allow inheritance table scans to return meaningfully-sorted results (Greg Stark, Hans-Jurgen Schonig, Robert Haas, Tom Lane)</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >This allows better optimization of queries that use&nbsp;<tt>ORDER BY</tt>,&nbsp;<tt>LIMIT</tt>, or&nbsp;<tt>MIN</tt>/<tt>MAX</tt>&nbsp;with inherited tables.</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >----</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  ></p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  ><span style="white-space:pre;"  > </span>Allow&nbsp;<a style="color: rgb(0, 102, 162); text-decoration: underline; " rel="nofollow" href="http://www.postgresql.org/docs/9.1/static/sql-altertable.html"  ><tt>ALTER TABLE ... SET DATA TYPE</tt></a>&nbsp;to avoid table rewrites in appropriate cases (Noah Misch, Robert Haas)</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >For example, converting a&nbsp;<tt>varchar</tt>&nbsp;column to&nbsp;<tt>text</tt>&nbsp;no longer requires a rewrite of the table. However, increasing the length constraint on a&nbsp;<tt>varchar</tt>&nbsp;column still requires a table rewrite.</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >----</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  ><span style="line-height: normal;"  ><ul style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Add nearest-neighbor (order-by-operator) searching to&nbsp;<a style="color: rgb(0, 102, 162); text-decoration: underline; " rel="nofollow" href="http://www.postgresql.org/docs/9.1/static/gist.html"  ><acronym>GiST&nbsp;indexes</a>&nbsp;(Teodor Sigaev, Tom Lane)</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >This allows&nbsp;<acronym>GiST&nbsp;indexes to quickly return the&nbsp;<tt><i>N</i></tt>&nbsp;closest values in a query with&nbsp;<tt>LIMIT</tt>. For example</p><pre style="font-family: monospace; font-size: 1em; -webkit-box-shadow: rgb(223, 223, 223) 3px 3px 5px; box-shadow: rgb(223, 223, 223) 3px 3px 5px; color: black; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; padding-top: 2ex; padding-right: 2ex; padding-bottom: 2ex; padding-left: 2ex; margin-top: 2ex; margin-right: 0px; margin-bottom: 2ex; margin-left: 2ex; overflow-x: auto; overflow-y: auto; border-top-left-radius: 8px 8px; border-top-right-radius: 8px 8px; border-bottom-right-radius: 8px 8px; border-bottom-left-radius: 8px 8px; border-top-color: rgb(207, 207, 207); border-right-color: rgb(207, 207, 207); border-bottom-color: rgb(207, 207, 207); border-left-color: rgb(207, 207, 207); background-color: rgb(247, 247, 247);"  >SELECT * FROM places ORDER BY location &lt;-&gt; point '(101,456)' LIMIT 10;</pre><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >finds the ten places closest to a given target point.</p></li><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Allow&nbsp;<a style="color: rgb(0, 102, 162); text-decoration: underline; " rel="nofollow" href="http://www.postgresql.org/docs/9.1/static/gin.html"  ><acronym>GIN&nbsp;indexes</a>&nbsp;to index null and empty values (Tom Lane)</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >This allows full&nbsp;<acronym>GIN&nbsp;index scans, and fixes various corner cases in which GIN scans would fail.</p></li><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Allow&nbsp;<a style="color: rgb(0, 102, 162); text-decoration: underline; " rel="nofollow" href="http://www.postgresql.org/docs/9.1/static/gin.html"  ><acronym>GIN&nbsp;indexes</a>&nbsp;to better recognize duplicate search entries (Tom Lane)</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >This reduces the cost of index scans, especially in cases where it avoids unnecessary full index scans.</p></li><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Fix&nbsp;<a style="color: rgb(0, 102, 162); text-decoration: underline; " rel="nofollow" href="http://www.postgresql.org/docs/9.1/static/gist.html"  ><acronym>GiST&nbsp;indexes</a>&nbsp;to be fully crash-safe (Heikki Linnakangas)</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Previously there were rare cases where a&nbsp;<tt>REINDEX</tt>&nbsp;would be required (you would be informed).</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >----</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  ></p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Allow&nbsp;<tt>numeric</tt>&nbsp;to use a more compact, two-byte header in common cases (Robert Haas)</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Previously all&nbsp;<tt>numeric</tt>&nbsp;values had four-byte headers; this saves on disk storage.</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >----</p><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  ><span style="line-height: normal;"  ><h4 style="font-size: 0.95em; margin-top: 1.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em; color: rgb(102, 102, 102);"  ><a style="color: rgb(102, 102, 102); text-decoration: none; " name="AEN107650" rel="nofollow"  >E.1.3.13.2. Contrib Performance</a></h4><p style="font-size: 1em; line-height: 1.5em; margin-top: 1.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  ></p><ul style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Add support for&nbsp;<tt>LIKE</tt>&nbsp;and&nbsp;<tt>ILIKE</tt>&nbsp;index searches to&nbsp;<a style="color: rgb(0, 102, 162); text-decoration: underline; " rel="nofollow" href="http://www.postgresql.org/docs/9.1/static/pgtrgm.html"  ><tt>contrib/pg_trgm</tt></a>&nbsp;(Alexander Korotkov)</p></li><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Add&nbsp;<code>levenshtein_less_equal()</code>&nbsp;function to&nbsp;<a style="color: rgb(0, 102, 162); text-decoration: underline; " rel="nofollow" href="http://www.postgresql.org/docs/9.1/static/fuzzystrmatch.html"  ><tt>contrib/fuzzystrmatch</tt></a>, which is optimized for small distances (Alexander Korotkov)</p></li><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Improve performance of index lookups on&nbsp;<a style="color: rgb(0, 102, 162); text-decoration: underline; " rel="nofollow" href="http://www.postgresql.org/docs/9.1/static/seg.html"  ><tt>contrib/seg</tt></a>&nbsp;columns (Alexander Korotkov)</p></li><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Improve performance of&nbsp;<a style="color: rgb(0, 102, 162); text-decoration: underline; " rel="nofollow" href="http://www.postgresql.org/docs/9.1/static/pgupgrade.html"  ><span>pg_upgrade</span></a>&nbsp;for databases with many relations (Bruce Momjian)</p></li><li style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-bottom: 0.1em;"  ><p style="font-size: 1em; line-height: 1.5em; margin-top: 0.2em; margin-right: 0em; margin-bottom: 1.2em; margin-left: 0em;"  >Add flag to&nbsp;<a style="color: rgb(0, 102, 162); text-decoration: underline; " rel="nofollow" href="http://www.postgresql.org/docs/9.1/static/pgbench.html"  ><tt>contrib/pgbench</tt></a>&nbsp;to report per-statement latencies (Florian Pflug)</p></li></ul></span></p></li></ul></span></p></li></ul></span></div></div>
	</div>
</div>
</body>
</html>