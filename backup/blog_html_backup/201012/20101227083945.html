<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">MongoDB's avaliable commands</h2>
	<h5 id="">2010-12-27 8:39:45&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402010112783453369/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;">命令是mongoDB中一个比较特殊的操作。<br>在mongoDB中执行命令有两种常用的方法,<br>1. runCommand({$key : $value})<br>如:<br>&gt; db.runCommand({"shutdown" : 1})<br><br>2. 查询$cmd这个特殊的collection<br>如:<br>&gt; db.$cmd.findOne({"shutdown" : 1})<br><br>列出当前mongoDB中可以支持的命令,可以通过调用db.listCommands()或者是查看浏览器 run “mongod --rest” and then visit http://localhost:28017/_commands in your web browser.<br>如:<br>&gt; db.listCommands()<br>_recvChunkCommit: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; internal should not be calling this directly<br>&nbsp; <br><br>_recvChunkStart: write-lock adminOnly&nbsp; slaveOk <br>&nbsp; internal should not be calling this directly<br>&nbsp; <br><br>_recvChunkStatus: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; internal should not be calling this directly<br>&nbsp; <br><br>_testDistLockWithSyncCluster: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; should not be calling this directly<br>&nbsp; <br><br>_transferMods: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; internal should not be calling this directly<br>&nbsp; <br><br>applyOps: write-lock<br>&nbsp; examples: { applyOps : [ ] , preCondition : [ { ns : ... , q : ... , res : ... } ] }<br><br>assertInfo: write-lock<br>&nbsp; check if any asserts have occurred on the server<br><br>authenticate: write-lock<br>&nbsp; internal<br><br>availablequeryoptions: no-lock<br>&nbsp; no help defined<br><br>buildInfo: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; get version #, etc.<br>&nbsp; { buildinfo:1 }<br><br>captrunc: write-lock<br>&nbsp; no help defined<br><br>clean: write-lock<br>&nbsp; internal<br><br>clone: write-lock<br>&nbsp; clone this database from an instance of the db on another host<br>&nbsp; { clone : "host13" }<br><br>cloneCollection: no-lock<br>&nbsp; { cloneCollection: &lt;namespace&gt;, from: &lt;host&gt; [,query: &lt;query_filter&gt;] [,copyIndexes:&lt;bool&gt;] }<br>&nbsp; Copies a collection from one server to another. Do not use on a single server as the destination is placed at the same db.collection (namespace) as the source.<br>&nbsp; Warning: the local copy of 'ns' is emptied before the copying begins. Any existing data will be lost there.<br><br>cloneCollectionAsCapped: write-lock<br>&nbsp; { cloneCollectionAsCapped:&lt;fromName&gt;, toCollection:&lt;toName&gt;, size:&lt;sizeInBytes&gt; }<br><br>closeAllDatabases: write-lock adminOnly&nbsp; slaveOk <br>&nbsp; Close all database files.<br>&nbsp; A new request will cause an immediate reopening; thus, this is mostly for testing purposes.<br><br>collStats: read-lock<br>&nbsp; { collStats:"blog.posts" , scale : 1 } scale divides sizes e.g. for KB use 1024<br><br>connPoolStats: no-lock<br>&nbsp; stats about connection pool<br><br>connPoolSync: no-lock<br>&nbsp; internal<br><br>convertToCapped: write-lock<br>&nbsp; { convertToCapped:&lt;fromCollectionName&gt;, size:&lt;sizeInBytes&gt; }<br><br>copydb: write-lock adminOnly&nbsp; slaveOk <br>&nbsp; copy a database from another host to this host<br>&nbsp; usage: {copydb: 1, fromhost: &lt;hostname&gt;, fromdb: &lt;db&gt;, todb: &lt;db&gt;[, username: &lt;username&gt;, nonce: &lt;nonce&gt;, key: &lt;key&gt;]}<br><br>copydbgetnonce: write-lock adminOnly&nbsp; slaveOk <br>&nbsp; get a nonce for subsequent copy db request from secure server<br>&nbsp; usage: {copydbgetnonce: 1, fromhost: &lt;hostname&gt;}<br><br>count: read-lock<br>&nbsp; count objects in collection<br><br>create: write-lock<br>&nbsp; create a collection<br><br>cursorInfo: no-lock<br>&nbsp;&nbsp; example: { cursorInfo : 1 }<br><br>dataSize: read-lock<br>&nbsp; determine data size for a set of data in a certain range<br>&nbsp; example: { datasize:"blog.posts", keyPattern:{x:1}, min:{x:10}, max:{x:55} }<br>&nbsp; keyPattern, min, and max parameters are optional.<br>&nbsp; note: This command may take a while to run<br><br>dbHash: read-lock<br>&nbsp; no help defined<br><br>dbStats: read-lock<br>&nbsp;&nbsp; example: { dbstats:1 } <br><br>diagLogging: write-lock adminOnly&nbsp; slaveOk <br>&nbsp; http://www.mongodb.org/display/DOCS/Monitoring+and+Diagnostics#MonitoringandDiagnostics-DatabaseRecord%2FReplay<br><br>distinct: read-lock<br>&nbsp; { distinct : 'collection name' , key : 'a.b' , query : {} }<br><br>driverOIDTest: no-lock<br>&nbsp; no help defined<br><br>drop: write-lock<br>&nbsp; drop a collection<br>&nbsp; {drop : &lt;collectionName&gt;}<br><br>dropDatabase: write-lock<br>&nbsp; drop (delete) this database<br><br>dropIndexes: write-lock<br>&nbsp; drop indexes for a collection<br><br>emptycapped: write-lock<br>&nbsp; no help defined<br><br>eval: no-lock<br>&nbsp; Evaluate javascript at the server.<br>&nbsp; http://www.mongodb.org/display/DOCS/Server-side+Code+Execution<br><br>features: read-lock<br>&nbsp; return on build level feature settings<br><br>filemd5: read-lock<br>&nbsp;&nbsp; example: { filemd5 : ObjectId(aaaaaaa) , root : "fs" }<br><br>findAndModify: write-lock<br>&nbsp; { findandmodify: "collection", query: {processed:false}, update: {$set: {processed:true}}, new: true}<br>&nbsp; { findandmodify: "collection", query: {processed:false}, remove: true, sort: {priority:-1}}<br>&nbsp; Either update or remove is required, all other fields have default values.<br>&nbsp; Output is in the "value" field<br>&nbsp; <br><br>forcedead: write-lock adminOnly&nbsp; slaveOk <br>&nbsp; internal<br><br>forceerror: no-lock<br>&nbsp; for testing purposes only.&nbsp; forces a user assertion exception<br><br>fsync: write-lock adminOnly&nbsp; slaveOk <br>&nbsp; http://www.mongodb.org/display/DOCS/fsync+Command<br><br>geoNear: read-lock<br>&nbsp; http://www.mongodb.org/display/DOCS/Geospatial+Indexing#GeospatialIndexing-geoNearCommand<br><br>geoSearch: read-lock<br>&nbsp; no help defined<br><br>geoWalk: read-lock<br>&nbsp; no help defined<br><br>getCmdLineOpts: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; get argv<br><br>getLastError: no-lock<br>&nbsp; return error status of the last operation on this connection<br><br>getPrevError: no-lock<br>&nbsp; check for errors since last reseterror commandcal<br><br>getShardVersion: no-lock adminOnly&nbsp; slaveOk <br>&nbsp;&nbsp; example: { getShardVersion : 'alleyinsider.foo'&nbsp; } <br><br>getnonce: no-lock<br>&nbsp; internal<br><br>getoptime: no-lock<br>&nbsp; internal<br><br>godinsert: write-lock<br>&nbsp; internal. for testing only.<br><br>group: read-lock<br>&nbsp; http://www.mongodb.org/display/DOCS/Aggregation<br><br>handshake: no-lock<br>&nbsp; internal<br><br>isMaster: no-lock<br>&nbsp; Check if this server is primary for a replica pair/set; also if it is --master or --slave in simple master/slave setups.<br>&nbsp; { isMaster : 1 }<br><br>isinitialsynccomplete: write-lock<br>&nbsp; no help defined<br><br>listCommands: no-lock<br>&nbsp; get a list of all db commands<br><br>listDatabases: read-lock adminOnly&nbsp; slaveOk <br>&nbsp; list databases on this server<br><br>logRotate: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; no help defined<br><br>logout: no-lock<br>&nbsp; de-authenticate<br><br>mapReduce: no-lock<br>&nbsp; Run a map/reduce operation on the server.<br>&nbsp; Note this is used for aggregation, not querying, in MongoDB.<br>&nbsp; http://www.mongodb.org/display/DOCS/MapReduce<br><br>mapreduce.shardedfinish: no-lock<br>&nbsp; no help defined<br><br>medianKey: read-lock<br>&nbsp; Internal command.<br>&nbsp; example: { medianKey:"blog.posts", keyPattern:{x:1}, min:{x:10}, max:{x:55} }<br>&nbsp; NOTE: This command may take a while to run<br><br>moveChunk: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; should not be calling this directly<br>&nbsp; <br><br>negotiatemaster: write-lock adminOnly&nbsp; slaveOk <br>&nbsp; no help defined<br><br>ping: no-lock<br>&nbsp; a way to check that the server is alive. responds immediately even if server is in a db lock.<br><br>profile: write-lock<br>&nbsp; enable or disable performance profiling<br>&nbsp; { profile : &lt;n&gt; }<br>&nbsp; 0=off 1=log slow ops 2=log all<br>&nbsp; http://www.mongodb.org/display/DOCS/Database+Profiler<br><br>reIndex: write-lock<br>&nbsp; re-index a collection<br><br>renameCollection: write-lock adminOnly&nbsp; slaveOk <br>&nbsp;&nbsp; example: { renameCollection: foo.a, to: bar.b }<br><br>repairDatabase: write-lock<br>&nbsp; repair database.&nbsp; also compacts. note: slow.<br><br>replSetElect: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; internal<br><br>replSetFreeze: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; Enable / disable failover for the set - locks current primary as primary even if issues occur.<br>&nbsp; For use during system maintenance.<br>&nbsp; { replSetFreeze : &lt;bool&gt; }<br>&nbsp; http://www.mongodb.org/display/DOCS/Replica+Set+Commands<br><br>replSetFresh: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; internal<br><br>replSetGetRBID: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; internal<br><br>replSetGetStatus: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; Report status of a replica set from the POV of this server<br>&nbsp; { replSetGetStatus : 1 }<br>&nbsp; http://www.mongodb.org/display/DOCS/Replica+Set+Commands<br><br>replSetHeartbeat: no-lock<br>&nbsp; internal<br><br>replSetInitiate: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; Initiate/christen a replica set.<br>&nbsp; http://www.mongodb.org/display/DOCS/Replica+Set+Commands<br><br>replSetReconfig: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; Adjust configuration of a replica set<br>&nbsp; { replSetReconfig : config_object }<br>&nbsp; http://www.mongodb.org/display/DOCS/Replica+Set+Commands<br><br>replSetStepDown: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; Step down as primary.&nbsp; Will not try to reelect self or 1 minute.<br>&nbsp; (If another member with same priority takes over in the meantime, it will stay primary.)<br>&nbsp; http://www.mongodb.org/display/DOCS/Replica+Set+Commands<br><br>replSetTest: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; Just for regression tests.<br>&nbsp; <br><br>replacePeer: write-lock adminOnly&nbsp; slaveOk <br>&nbsp; replace a node in a replica pair<br><br>resetError: no-lock<br>&nbsp; reset error state (used with getpreverror)<br><br>resync: write-lock adminOnly&nbsp; slaveOk <br>&nbsp; resync (from scratch) an out of date replica slave.<br>&nbsp; http://www.mongodb.org/display/DOCS/Master+Slave<br><br>serverStatus: no-lock<br>&nbsp; returns lots of administrative server statistics<br><br>setShardVersion: write-lock adminOnly&nbsp; slaveOk <br>&nbsp;&nbsp; example: { setShardVersion : 'alleyinsider.foo' , version : 1 , configdb : '' } <br><br>shardingState: write-lock adminOnly&nbsp; slaveOk <br>&nbsp; no help defined<br><br>shutdown: write-lock adminOnly&nbsp; slaveOk <br>&nbsp; shutdown the database.&nbsp; must be ran against admin db and either (1) ran from localhost or (2) authenticated.<br>&nbsp; <br><br>sleep: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; internal testing command.&nbsp; Makes db block (in a read lock) for 100 seconds<br>&nbsp; w:true write lock<br><br>splitVector: read-lock<br>&nbsp; Internal command.<br>&nbsp; example: { splitVector : "myLargeCollection" , keyPattern : {x:1} , maxChunkSize : 200 }<br>&nbsp; maxChunkSize unit in MBs<br>&nbsp; NOTE: This command may take a while to run<br><br>top: read-lock adminOnly&nbsp; slaveOk <br>&nbsp; usage by collection<br><br>unsetSharding: no-lock adminOnly&nbsp; slaveOk <br>&nbsp;&nbsp; example: { unsetSharding : 1 } <br><br>validate: read-lock<br>&nbsp; Validate contents of a namespace by scanning its data structures for correctness.&nbsp; Slow.<br><br>whatsmyuri: no-lock<br>&nbsp; {whatsmyuri:1}<br><br>writebacklisten: no-lock adminOnly&nbsp; slaveOk <br>&nbsp; internal</div>
	</div>
</div>
</body>
</html>