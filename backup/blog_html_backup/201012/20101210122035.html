<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">phpPgAdmin 5.0 Usage</h2>
	<h5 id="">2010-12-10 12:20:35&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020101110112946236/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><br>phpPgAdmin 图形化PostgreSQL管理工具.<br>2010-11-29 5.0版本，加入了一些新特性,以及一些BUG修正。<br>一、phpPgAdmin5.0 新特性介绍<br>二、phpPgAdmin5.0 部署<br><br>一、phpPgAdmin5.0 新特性介绍&nbsp;<br>  * Support for PostgreSQL 8.4 and 9.0<br>  * Support for database-level collation for 8.4+<br>  * Support for schema-level export<br>  * Add ability to alter schema ownership<br>  * Clean up domain support and improve interface<br>  * Add support for commenting on functions<br>  * Allow user to rename role/users and set new passwords at the same time<br>  * Greatly enhanced Full-Text-Search capabilities (ioguix, Loomis_K)<br>  * Overhauled Selenium Test suite to support multiple database versions<br>  * Optimized application graphics (Limo Driver)<br>  * Support for Column Level Privileges<br>  * Allow users to specify a template database at database creation time<br>  * Support killing processes<br>  * Add ability to create indexes concurrently<br>  * Much better support of autovacuum configuration<br>  * Add an admin page for table level<br>  * Refactored autocompletion:<br>  * fix support for cross-schema objects<br>  * support multi-field FK<br>  * support for pagination of values in the auto-complete list<br>  * Allow user to logicaly group their server under custom named node in the browser tree<br>  * Add a theme switcher on the introduction page<br>  * Add themes "Blue/Green" by Tomasz Pala and "Cappuccino" by ioguix<br>  * Auto refresh Locks page<br>  * Auto refresh Processes page<br>  * Link in the bottom of the page to go to top of page<br>  * Browsing on Foreign Keys (When browsing a table, clicking on a FK value, jump to the PK row)<br><br>注意事项 :&nbsp;<br>1. PHP版本相关 : <br>Please, note that the parameter "date.timezone" should be set in your  php.ini conf file. Since version 5.1, PHP might issue a NOTICE or a  WARNING if your setup is not valid or missing.<br>2. phpPgadmin配置相关 : <br>Due to the large number of phpPgAdmin installations that have not set<br>&nbsp;&nbsp; passwords on local connections, there is now a configuration file<br>&nbsp;&nbsp; option called 'extra_login_security', which is TRUE by default.&nbsp; While<br>&nbsp;&nbsp; this option is enabled, you will be unable to log in to phpPgAdmin as<br>&nbsp;&nbsp; the 'root', 'administrator', 'pgsql' or 'postgres' users and empty passwords<br>&nbsp;&nbsp; will not work.(使用超级用户或空密码用户登陆，报如下错误,所以建议新建一个DBA帐号)<br><div><img title="phpPgAdmin5.0 Usage - 德哥@Digoal - The Heart,The World."  alt="phpPgAdmin5.0 Usage - 德哥@Digoal - The Heart,The World."  style="margin: 0pt 10px 0pt 0pt;"  src="http://img612.ph.126.net/5Lpa-L5LsxLcbTA7ZAVLpg==/1972576636789883918.jpg"  ></div><br><br>二、phpPgAdmin5.0 部署<br>软件需求:<br>postgresql 9+<br>httpd2.2.17<br>php-5.3.4<br>phpPgAdmin5.0<br>其他 gcc make flex tar ...<br><br>1. 安装postgresql<br>安装php时会用到,本例安装到目录 /opt/pgsql_9beta2_magent<br>安装过程略过<br><br>2. 安装httpd<br>官方地址 http://httpd.apache.org/<br>选择最新的稳定版本下载:<a rel="nofollow" href="http://httpd.apache.org/download.cgi#apache22"  > 2.2.17</a> (released 2010-10-19)<br>解压 : tar -jxvf httpd-2.2.17.tar.bz2<br>mkdir -p /opt/apache/httpd<br>cd /opt/soft_bak/httpd-2.2.17<br>./configure&nbsp; --prefix=/opt/apache/httpd --enable-so <br>make<br>make install<br>(确保IPTABLES配置允许你的浏览器所在电脑访问到80端口)<br>/opt/apache/httpd/bin/apachectl start<br>如果弹出 页面 It works! 表示正常.<br>/opt/apache/httpd/bin/apachectl stop<br><br>3. 安装php<br>官方地址 : http://cn.php.net/downloads.php<br>选择最新稳定版本下载: <a rel="nofollow" href="http://cn.php.net/get/php-5.3.4.tar.bz2/from/a/mirror"  >PHP 5.3.4 (tar.bz2)</a> [10,551Kb] -  09 December 2010<br>mkdir -p /opt/php-5.3.4<br>tar -jxvf php-5.3.4.tar.bz2<br>cd php-5.3.4<br>./configure --with-apxs2=/opt/apache/httpd/bin/apxs --with-pgsql=/opt/pgsql_9beta2_magent --prefix=/opt/php-5.3.4<br>make<br>make test<br>make install<br><br>4. 配置php<br>&nbsp;可参考 : http://cn.php.net/manual/en/install.unix.apache2.php<br> cp /opt/soft_bak/php-5.3.4/php.ini-development /opt/php-5.3.4/lib<br>cd /opt/php-5.3.4/lib<br>  mv php.ini-development php.ini<br>  <br>5. 配置phpPgAdmin<br> tar -jxvf phpPgAdmin-5.0.tar.bz2 <br> mv phpPgAdmin-5.0 /opt/<br> cd /opt/phpPgAdmin-5.0/conf<br> vi config.inc.php<br>示例:<br>&lt;?php<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * Central phpPgAdmin configuration.&nbsp; As a user you may modify the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * settings here for your particular configuration.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * $Id: config.inc.php-dist,v 1.55 2008/02/18 21:10:31 xzilla Exp $<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 本例配置了2个被管理的DB,如果要加的话增加$conf['servers'][2]等....<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][0]['desc'] = 'PostgreSQL';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][0]['host'] = '172.16.3.33';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][0]['port'] = 1921;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][0]['sslmode'] = 'allow';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][0]['defaultdb'] = 'template1';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][0]['pg_dump_path'] = '/opt/pgsql_9beta2_magent/bin/pg_dump';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][0]['pg_dumpall_path'] = '/opt/pgsql_9beta2_magent/bin/pg_dumpall';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][0]['slony_support'] = false;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][1]['desc'] = 'Test Server';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][1]['host'] = '172.16.3.39';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][1]['port'] = 1921;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][1]['sslmode'] = 'allow';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][1]['defaultdb'] = 'template1';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][1]['pg_dump_path'] = '/opt/pgsql_9beta2_magent/bin/pg_dump';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][1]['pg_dumpall_path'] = '/opt/pgsql_9beta2_magent/bin/pg_dumpall';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['servers'][1]['slony_support'] = false;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['default_lang'] = 'auto';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['autocomplete'] = 'default on';<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['extra_login_security'] = false;&nbsp;&nbsp; (因为我这里只是测试,所以允许postgres登录)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['owned_only'] = false;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['show_comments'] = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['show_advanced'] = false;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['show_system'] = false;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['show_reports'] = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['reports_db'] = 'phppgadmin';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['reports_schema'] = 'public';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['reports_table'] = 'ppa_reports';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['owned_reports_only'] = false;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['min_password_length'] = 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['left_width'] = 200;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['theme'] = 'default';<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['show_oids'] = false;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['max_rows'] = 30;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['max_chars'] = 50;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['use_xhtml_strict'] = false;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['ajax_refresh'] = 3;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /*****************************************<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * Don't modify anything below this line *<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *****************************************/<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $conf['version'] = 19;<br>?&gt;<br><br> 被管理的库如果需要用到phpPgAdmin的report功能,可以安装phpPgAdmin的安装文档和配置文件执行sql子目录中的脚本:<br><br>6. 配置httpd<br>vi /opt/apache/httpd/conf/httpd.conf<br>修改或加入如下参数<br>LoadModule php5_module&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; modules/libphp5.so<br><br>&lt;FilesMatch "\.ph(p[2-6]?|tml)$"&gt;<br>&nbsp;&nbsp;&nbsp; SetHandler application/x-httpd-php<br>&lt;/FilesMatch&gt;<br><br>&lt;FilesMatch "\.phps$"&gt;<br>&nbsp;&nbsp;&nbsp; SetHandler application/x-httpd-php-source<br>&lt;/FilesMatch&gt;<br><br>&lt;Directory /&gt;<br>&nbsp;&nbsp;&nbsp; Options Indexes FollowSymLinks<br>&nbsp;&nbsp;&nbsp; AllowOverride None<br>&nbsp;&nbsp;&nbsp; Order deny,allow<br>&nbsp;&nbsp;&nbsp; Allow from all<br>&nbsp;&nbsp;&nbsp; Satisfy all<br>&lt;/Directory&gt;<br><br>&lt;IfModule dir_module&gt;<br>&nbsp;&nbsp;&nbsp; DirectoryIndex index.php<br>&lt;/IfModule&gt;<br><br>DocumentRoot "/opt/phpPgAdmin-5.0"<br><br>7. 测试<br>export LD_LIBRARY_PATH=/opt/php-5.3.4/lib:/opt/apache/httpd/lib:$LD_LIBRARY_PATH<br>/opt/apache/httpd/bin/apachectl start<br>http://172.16.3.176<br><div><div><img title="phpPgAdmin5.0 Usage - 德哥@Digoal - The Heart,The World."  alt="phpPgAdmin5.0 Usage - 德哥@Digoal - The Heart,The World."  style="margin: 0pt 10px 0pt 0pt;"  src="http://img534.ph.126.net/1_WtDXsZHSzuRpTJWt51oA==/2651775755592196048.jpg"  ></div>&nbsp;</div>&nbsp;<br>登录:<br><div><img title="phpPgAdmin5.0 Usage - 德哥@Digoal - The Heart,The World."  alt="phpPgAdmin5.0 Usage - 德哥@Digoal - The Heart,The World."  style="margin: 0pt 10px 0pt 0pt;"  src="http://img776.ph.126.net/1NV69aEp29aRApyg5f6emQ==/3127468466233306330.jpg"  ><br><br>附录：<br>phpPgAdmin 5.0 INSTALL文件:<br>phpPgAdmin Installation Guide<br>-----------------------------<br><br>1. Unpack your download<br><br>&nbsp;&nbsp; If you've downloaded a tar.gz package, execute from a terminal:<br><br>&nbsp;&nbsp; gunzip phpPgAdmin-*.tar.gz<br>&nbsp;&nbsp; tar -xvf phpPgAdmin-*.tar<br><br>&nbsp;&nbsp; Else, if you've downloaded a tar.bz2 package, execute from a terminal: <br><br>&nbsp;&nbsp; bunzip2 phpPgAdmin-*.tar.bz2<br>&nbsp;&nbsp; tar -xvf phpPgAdmin-*.tar<br><br>&nbsp;&nbsp; Else, if you've downloaded a zip package, execute from a terminal:<br><br>&nbsp;&nbsp; unzip phpPgAdmin-*.zip<br><br>2. Configure phpPgAdmin<br><br>&nbsp;&nbsp; edit phpPgAdmin/conf/config.inc.php<br><br>&nbsp;&nbsp; If you mess up the configuration file, you can recover it from the<br>&nbsp;&nbsp; config.inc.php-dist file.<br><br>3. Set up the reports database.<br><br>&nbsp;&nbsp; If you want to enable reports (which are a useful feature) then go to<br>&nbsp;&nbsp; the 'sql' subdirectory and view the SQL script for your database.&nbsp; It<br>&nbsp;&nbsp; will contain instructions on how to set up the reports database.<br><br>4. If you run your PHP installation in safe mode, in order that the database<br>&nbsp;&nbsp; dump feature can work correctly, you need to set the 'safe_mode_allowed_env_vars'<br>&nbsp;&nbsp; php.ini variable to include the PGPASSWORD and PGUSER environmental variables<br>&nbsp;&nbsp; and the safe_mode_exec_dir to include /usr/bin (or wherever the pg_dump<br>&nbsp;&nbsp; binaries are found).<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; eg. safe_mode_allowed_env_vars = PHP_,PG<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; safe_mode_exec_dir = /usr/bin<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; Given that you usually don't want to allow everything in /usr/bin to<br>&nbsp;&nbsp; be executed, you might want to copy the pg_dump and pg_dumpall utilities<br>&nbsp;&nbsp; to a directory by themselves.<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; Also, you will need to ensure that your 'pg_dump' and 'pg_dumpall' utilities<br>&nbsp;&nbsp; are executable by the PHP process, if you want dump support in phpPgAdmin.<br><br>&nbsp;&nbsp; Lastly, if you run phpPgAdmin in safe mode, very long running imports,<br>&nbsp;&nbsp; exports and transactions may time out and be aborted.<br><br>5. Enable the statistics collector in PostgreSQL.&nbsp; phpPgAdmin will display<br>&nbsp;&nbsp; table and index performance and usage statistics if you have enabled the<br>&nbsp;&nbsp; PostgreSQL statistics collector.&nbsp; To enable the collector, uncomment the<br>&nbsp;&nbsp; following lines in your postgresql.conf and enable them:<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; stats_start_collector = true<br>&nbsp;&nbsp;&nbsp; stats_command_string = true<br>&nbsp;&nbsp;&nbsp; stats_block_level = true<br>&nbsp;&nbsp;&nbsp; stats_row_level = true<br><br>6. Browse to the phpPgAdmin installation using a web browser.&nbsp; You might<br>&nbsp;&nbsp; need cookies enabled for phpPgAdmin to work.<br><br>7. IMPORTANT - SECURITY<br><br>&nbsp;&nbsp; PostgreSQL by default does not require you to use a password to log in.<br>&nbsp;&nbsp; We STRONGLY recomment that you enable md5 passwords for local connections<br>&nbsp;&nbsp; in your pg_hba.conf, and set a password for the default superuser account.<br><br>&nbsp;&nbsp; Due to the large number of phpPgAdmin installations that have not set<br>&nbsp;&nbsp; passwords on local connections, there is now a configuration file<br>&nbsp;&nbsp; option called 'extra_login_security', which is TRUE by default.&nbsp; While<br>&nbsp;&nbsp; this option is enabled, you will be unable to log in to phpPgAdmin as<br>&nbsp;&nbsp; the 'root', 'administrator', 'pgsql' or 'postgres' users and empty passwords<br>&nbsp;&nbsp; will not work.<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; Once you are certain you have properly secured your database server, you<br>&nbsp;&nbsp; can then disable 'extra_login_security' so that you can log in as your<br>&nbsp;&nbsp; database administrator using the administrator password.<br></div></div>
	</div>
</div>
</body>
</html>