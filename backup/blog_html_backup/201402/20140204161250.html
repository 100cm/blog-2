<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL 9.4 Add pg_stat_archiver statistics view</h2>
	<h5 id="">2014-02-04 16:12:50&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402014144642511/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><pre class="prettyprint"   ><p></p><div><font size="2"   >Add pg_stat_archiver statistics view.</font></div><div><font size="2"   >author<span>	</span>Fujii Masao &lt;fujii@postgresql.org&gt;<span>	</span></font></div><div><font size="2"   ><span>	</span>Tue, 28 Jan 2014 17:58:22 +0000 (02:58 +0900)</font></div><div><font size="2"   >committer<span>	</span>Fujii Masao &lt;fujii@postgresql.org&gt;<span>	</span></font></div><div><font size="2"   ><span>	</span>Tue, 28 Jan 2014 17:58:22 +0000 (02:58 +0900)</font></div><div><font size="2"   >commit<span>	</span>9132b189bf5589591cb63fef7952842b772e4fe6</font></div><div><font size="2"   >tree<span>	</span>ebada3d4f99b03554482b43cf4d6beb7b2a1b371<span>	</span>tree | snapshot</font></div><div><font size="2"   >parent<span>	</span>98d62c28fd774ad8d123b66131dcdaa0b9c9d6d4<span>	</span>commit | diff</font></div><div><font size="2"   >Add pg_stat_archiver statistics view.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >This view shows the statistics about the WAL archiver process's activity.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Gabriele Bartolini, reviewed by Michael Paquier, refactored a bit by me.</font></div><p></p></pre></div><div>9.4将新增一个归档相关的视图, 用于记录归档成功以及最后一次失败的位置,时间信息. 归档和失败次数等.</div><div>视图说明 :&nbsp;</div><div><div style="font-family: verdana, sans-serif; font-size: 12px; line-height: normal;"   ><p style="font-size: 1em; line-height: 1.5em; margin: 1.2em 0em; font-weight: bold;"   >Table 27-3.&nbsp;<tt>pg_stat_archiver</tt>&nbsp;View</p><table border="1"   style="margin: 2ex 0px 2ex 2ex; -webkit-box-shadow: rgb(223, 223, 223) 3px 3px 5px; box-shadow: rgb(223, 223, 223) 3px 3px 5px; border-spacing: 0px; border-collapse: collapse; background-color: rgb(224, 236, 239); border: 2px solid rgb(167, 198, 223);"   ><colgroup><col><col><col><thead><tr><th style="border: 1px solid rgb(167, 198, 223); padding: 0.5ex;"   >Column</th><th style="border: 1px solid rgb(167, 198, 223); padding: 0.5ex;"   >Type</th><th style="border: 1px solid rgb(167, 198, 223); padding: 0.5ex;"   >Description</th></tr></thead><tbody><tr><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>archived_count</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>bigint</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   >Number of WAL files that have been successfully archived</td></tr><tr><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>last_archived_wal</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>text</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   >Name of the last WAL file successfully archived</td></tr><tr><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>last_archived_time</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>timestamp with time zone</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   >Time of the last successful archive operation</td></tr><tr><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>failed_count</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>bigint</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   >Number of failed attempts for archiving WAL files</td></tr><tr><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>last_failed_wal</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>text</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   >Name of the WAL file of the last failed archival operation</td></tr><tr><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>last_failed_time</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>timestamp with time zone</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   >Time of the last failed archival operation</td></tr><tr><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>stats_reset</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   ><tt>timestamp with time zone</tt></td><td style="border: 1px solid rgb(167, 198, 223); background-color: rgb(255, 255, 255); padding: 0.5ex;"   >Time at which these statistics were last reset</td></tr></table></div><p style="font-size: 12px; line-height: 1.5em; margin: 1.2em 0em; font-family: verdana, sans-serif;"   >The&nbsp;<tt>pg_stat_archiver</tt>&nbsp;view will always have a single row, containing data about the archiver process of the cluster.</p></div><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://git.postgresql.org/gitweb/?p=postgresql.git;a=commit;h=9132b189bf5589591cb63fef7952842b772e4fe6"   >http://git.postgresql.org/gitweb/?p=postgresql.git;a=commit;h=9132b189bf5589591cb63fef7952842b772e4fe6</a></div><div>2.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://www.postgresql.org/docs/devel/static/monitoring-stats.html#MONITORING-STATS-VIEWS"   >http://www.postgresql.org/docs/devel/static/monitoring-stats.html#MONITORING-STATS-VIEWS</a></div></div>
	</div>
</div>
</body>
</html>