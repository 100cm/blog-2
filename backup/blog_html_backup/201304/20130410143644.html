<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Ubuntu 12.04 OCZ RevoDrive3 PCI-E performance so bad when cache on</h2>
	<h5 id="">2013-04-10 14:36:44&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201331012913561/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;">前段时间将服务器装成了Ubuntu 12.04.2 desktop x64.<div>内核升级到了<span style="line-height: 22px;"   >3.5.0-26</span></div><div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-PowerEdge-R610:~# uname -a</font></div><div><font size="2"   >Linux digoal-PowerEdge-R610 3.5.0-26-generic #42~precise1-Ubuntu SMP Mon Mar 11 22:17:58 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</font></div><p></p></pre></div><div>OCZ没有提供这个内核版本的Ubuntu 12.04 RevoDrive3的驱动. 如下 :&nbsp;</div><div><a rel="nofollow" href="http://ocz.com/enterprise/download/drivers"   >http://ocz.com/enterprise/download/drivers</a></div><div>虽然12.04能够将其驱起来, 但是奇怪的是1块240G的盘变成了2块120G的盘.</div><div><div style="line-height: 22px;"   ># 设备如下 :&nbsp;</div><div style="line-height: 22px;"   ><div style="line-height: 22px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 22px;"   ><font size="2"   >root@digoal-PowerEdge-R610:~# lspci|grep OCZ</font></div><div style="line-height: 22px;"   ><font size="2"   >04:00.0 SCSI storage controller: OCZ Technology Group, Inc. Device 1021 (rev 02)</font></div><div style="line-height: 22px;"   ><font size="2"   >05:00.0 SCSI storage controller: OCZ Technology Group, Inc. Device 1021 (rev 02)</font></div><p></p></pre></div><div style="line-height: 22px;"   ># fdisk看到的块设备如下 :&nbsp;</div></div></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >Disk /dev/sdd: 120.0 GB, 120034123776 bytes</font></div><div><font size="2"   >255 heads, 63 sectors/track, 14593 cylinders, total 234441648 sectors</font></div><div><font size="2"   >Units = sectors of 1 * 512 = 512 bytes</font></div><div><font size="2"   >Sector size (logical/physical): 512 bytes / 512 bytes</font></div><div><font size="2"   >I/O size (minimum/optimal): 512 bytes / 512 bytes</font></div><div><font size="2"   >Disk identifier: 0x00000000</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Disk /dev/sdd doesn't contain a valid partition table</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Disk /dev/sde: 120.0 GB, 120034123776 bytes</font></div><div><font size="2"   >255 heads, 63 sectors/track, 14593 cylinders, total 234441648 sectors</font></div><div><font size="2"   >Units = sectors of 1 * 512 = 512 bytes</font></div><div><font size="2"   >Sector size (logical/physical): 512 bytes / 512 bytes</font></div><div><font size="2"   >I/O size (minimum/optimal): 512 bytes / 512 bytes</font></div><div><font size="2"   >Disk identifier: 0x00000000</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Disk /dev/sde doesn't contain a valid partition table</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Disk /dev/sdf: 120.0 GB, 120034123776 bytes</font></div><div><font size="2"   >255 heads, 63 sectors/track, 14593 cylinders, total 234441648 sectors</font></div><div><font size="2"   >Units = sectors of 1 * 512 = 512 bytes</font></div><div><font size="2"   >Sector size (logical/physical): 512 bytes / 512 bytes</font></div><div><font size="2"   >I/O size (minimum/optimal): 512 bytes / 512 bytes</font></div><div><font size="2"   >Disk identifier: 0x00000000</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Disk /dev/sdf doesn't contain a valid partition table</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Disk /dev/sdg: 120.0 GB, 120034123776 bytes</font></div><div><font size="2"   >255 heads, 63 sectors/track, 14593 cylinders, total 234441648 sectors</font></div><div><font size="2"   >Units = sectors of 1 * 512 = 512 bytes</font></div><div><font size="2"   >Sector size (logical/physical): 512 bytes / 512 bytes</font></div><div><font size="2"   >I/O size (minimum/optimal): 512 bytes / 512 bytes</font></div><div><font size="2"   >Disk identifier: 0x00000000</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Disk /dev/sdg doesn't contain a valid partition table</font></div><p></p></pre></div><div># 驱动信息如下, 使用的是mvsas驱动 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-PowerEdge-R610:~# lspci -vv -s 04:00.0</font></div><div><font size="2"   >04:00.0 SCSI storage controller: OCZ Technology Group, Inc. Device 1021 (rev 02)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Subsystem: OCZ Technology Group, Inc. Device 1021</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Latency: 0, Cache Line Size: 64 bytes</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin A routed to IRQ 38</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at df1a0000 (64-bit, non-prefetchable) [size=128K]</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Region 2: Memory at df1c0000 (64-bit, non-prefetchable) [size=256K]</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Expansion ROM at df100000 [disabled] [size=64K]</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [40] Power Management version 3</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Flags: PMEClk- DSI- D1+ D2- AuxCurrent=375mA PME(D0+,D1+,D2-,D3hot+,D3cold-)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [50] MSI: Enable- Count=1/1 Maskable- 64bit+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Address: 0000000000000000 &nbsp;Data: 0000</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [70] Express (v2) Endpoint, MSI 00</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCap: MaxPayload 4096 bytes, PhantFunc 0, Latency L0s &lt;1us, L1 &lt;8us</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MaxPayload 256 bytes, MaxReadReq 512 bytes</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCap: Port #0, Speed 5GT/s, Width x8, ASPM L0s L1, Latency L0 &lt;512ns, L1 &lt;64us</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ClockPM- Surprise- LLActRep- BwNot-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- Retrain- CommClk+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCap2: Completion Timeout: Not Supported, TimeoutDis+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Compliance De-emphasis: -6dB</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkSta2: Current De-emphasis Level: -6dB</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [100 v1] Advanced Error Reporting</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UESta: &nbsp;DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UEMsk: &nbsp;DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt+ UnxCmplt+ RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UESvrt: DLP+ SDES+ TLP+ FCP+ CmpltTO+ CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC+ UnsupReq- ACSViol-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CESta: &nbsp;RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CEMsk: &nbsp;RxErr+ BadTLP+ BadDLLP+ Rollover+ Timeout+ NonFatalErr+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AERCap: First Error Pointer: 00, GenCap+ CGenEn- ChkCap+ ChkEn-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [140 v1] Virtual Channel</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Caps: &nbsp; LPEVC=0 RefClk=100ns PATEntryBits=1</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Arb: &nbsp; &nbsp;Fixed- WRR32- WRR64- WRR128-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Ctrl: &nbsp; ArbSelect=Fixed</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: InProgress-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VC0: &nbsp; &nbsp;Caps: &nbsp; PATOffset=00 MaxTimeSlots=1 RejSnoopTrans-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Arb: &nbsp; &nbsp;Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Ctrl: &nbsp; Enable+ ID=0 ArbSelect=Fixed TC/VC=ff</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: NegoPending- InProgress-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel driver in use: mvsas</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel modules: mvsas</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# lspci -vv -s 05:00.0</font></div><div><font size="2"   >05:00.0 SCSI storage controller: OCZ Technology Group, Inc. Device 1021 (rev 02)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Subsystem: OCZ Technology Group, Inc. Device 1021</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Latency: 0, Cache Line Size: 64 bytes</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin A routed to IRQ 40</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at df2a0000 (64-bit, non-prefetchable) [size=128K]</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Region 2: Memory at df2c0000 (64-bit, non-prefetchable) [size=256K]</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Expansion ROM at df200000 [disabled] [size=64K]</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [40] Power Management version 3</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Flags: PMEClk- DSI- D1+ D2- AuxCurrent=375mA PME(D0+,D1+,D2-,D3hot+,D3cold-)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [50] MSI: Enable- Count=1/1 Maskable- 64bit+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Address: 0000000000000000 &nbsp;Data: 0000</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [70] Express (v2) Endpoint, MSI 00</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCap: MaxPayload 4096 bytes, PhantFunc 0, Latency L0s &lt;1us, L1 &lt;8us</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MaxPayload 256 bytes, MaxReadReq 512 bytes</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCap: Port #0, Speed 5GT/s, Width x8, ASPM L0s L1, Latency L0 &lt;512ns, L1 &lt;64us</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ClockPM- Surprise- LLActRep- BwNot-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- Retrain- CommClk+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCap2: Completion Timeout: Not Supported, TimeoutDis+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Compliance De-emphasis: -6dB</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LnkSta2: Current De-emphasis Level: -6dB</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [100 v1] Advanced Error Reporting</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UESta: &nbsp;DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UEMsk: &nbsp;DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt+ UnxCmplt+ RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UESvrt: DLP+ SDES+ TLP+ FCP+ CmpltTO+ CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC+ UnsupReq- ACSViol-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CESta: &nbsp;RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CEMsk: &nbsp;RxErr+ BadTLP+ BadDLLP+ Rollover+ Timeout+ NonFatalErr+</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AERCap: First Error Pointer: 00, GenCap+ CGenEn- ChkCap+ ChkEn-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [140 v1] Virtual Channel</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Caps: &nbsp; LPEVC=0 RefClk=100ns PATEntryBits=1</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Arb: &nbsp; &nbsp;Fixed- WRR32- WRR64- WRR128-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Ctrl: &nbsp; ArbSelect=Fixed</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: InProgress-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VC0: &nbsp; &nbsp;Caps: &nbsp; PATOffset=00 MaxTimeSlots=1 RejSnoopTrans-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Arb: &nbsp; &nbsp;Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Ctrl: &nbsp; Enable+ ID=0 ArbSelect=Fixed TC/VC=ff</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: NegoPending- InProgress-</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel driver in use: mvsas</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Kernel modules: mvsas</font></div><p></p></pre></div><div><br></div><div># 默认情况下cache是开启的</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-PowerEdge-R610:~# hdparm -I /dev/sdd|grep cache</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; cache/buffer size &nbsp;= unknown</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* &nbsp; &nbsp;Write cache</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# hdparm -I /dev/sde|grep cache</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; cache/buffer size &nbsp;= unknown</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* &nbsp; &nbsp;Write cache</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# hdparm -I /dev/sdf|grep cache</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; cache/buffer size &nbsp;= unknown</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* &nbsp; &nbsp;Write cache</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# hdparm -I /dev/sdg|grep cache</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; cache/buffer size &nbsp;= unknown</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* &nbsp; &nbsp;Write cache</font></div><p></p></pre></div><div><br></div><div># 在cache开启的情况下测试io能力, (完全不如以前在CentOS下的测试结果) :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pg92@digoal-PowerEdge-R610-&gt; pg_test_fsync -f /data03/pg92/test</font></div><div><font size="2"   >2 seconds per test</font></div><div><font size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare file sync methods using one 16kB write:</font></div><div><font size="2"   >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"   >is Linux's default)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2071.301 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1990.998 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1805.694 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1823.106 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare file sync methods using two 16kB writes:</font></div><div><font size="2"   >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"   >is Linux's default)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1045.190 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1868.589 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1655.421 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 908.051 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare open_sync with different write sizes:</font></div><div><font size="2"   >(This is designed to compare the cost of writing 16kB</font></div><div><font size="2"   >in different write open_sync sizes.)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; &nbsp;1826.952 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;943.839 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;474.954 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;238.428 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;118.964 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Test if fsync on non-write file descriptor is honored:</font></div><div><font size="2"   >(If the times are similar, fsync() can sync data written</font></div><div><font size="2"   >on a different descriptor.)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1819.038 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1820.679 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Non-Sync'ed 16kB writes:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 133770.955 ops/sec</font></div><p></p></pre></div><div><br></div><div>#关闭cache :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-PowerEdge-R610:~# hdparm -W 0 /dev/sdd</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/dev/sdd:</font></div><div><font size="2"   >&nbsp;setting drive write-caching to 0 (off)</font></div><div><font size="2"   >&nbsp;write-caching = &nbsp;0 (off)</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# hdparm -W 0 /dev/sde</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/dev/sde:</font></div><div><font size="2"   >&nbsp;setting drive write-caching to 0 (off)</font></div><div><font size="2"   >&nbsp;write-caching = &nbsp;0 (off)</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# hdparm -W 0 /dev/sdf</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/dev/sdf:</font></div><div><font size="2"   >&nbsp;setting drive write-caching to 0 (off)</font></div><div><font size="2"   >&nbsp;write-caching = &nbsp;0 (off)</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# hdparm -W 0 /dev/sdg</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/dev/sdg:</font></div><div><font size="2"   >&nbsp;setting drive write-caching to 0 (off)</font></div><div><font size="2"   >&nbsp;write-caching = &nbsp;0 (off)</font></div><p></p></pre></div><div><br></div><div>#再次测试iops能力, 性能居然上来了, 和CentOS中使用ocz提供的驱动性能差不多 :&nbsp;</div><div># 同时增加对open_datasync的支持, fsync的iops也大大增强.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pg92@digoal-PowerEdge-R610-&gt; pg_test_fsync -f /data03/pg92/test</font></div><div><font size="2"   >2 seconds per test</font></div><div><font size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare file sync methods using one 16kB write:</font></div><div><font size="2"   >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"   >is Linux's default)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11713.707 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8277.305 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8006.412 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10998.478 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare file sync methods using two 16kB writes:</font></div><div><font size="2"   >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"   >is Linux's default)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5950.801 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5800.574 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5497.299 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5432.590 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare open_sync with different write sizes:</font></div><div><font size="2"   >(This is designed to compare the cost of writing 16kB</font></div><div><font size="2"   >in different write open_sync sizes.)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; 10227.795 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp; 7077.777 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp; 4336.506 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; 2077.545 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;936.299 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Test if fsync on non-write file descriptor is honored:</font></div><div><font size="2"   >(If the times are similar, fsync() can sync data written</font></div><div><font size="2"   >on a different descriptor.)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7316.087 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7283.201 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Non-Sync'ed 16kB writes:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 136783.312 ops/sec</font></div><p></p></pre></div><div># 当前io调度算法为noop :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-PowerEdge-R610:~# cat /sys/block/sdd/queue/scheduler&nbsp;</font></div><div><font size="2"   >[noop] deadline cfq&nbsp;</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# cat /sys/block/sde/queue/scheduler&nbsp;</font></div><div><font size="2"   >[noop] deadline cfq&nbsp;</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# cat /sys/block/sdf/queue/scheduler&nbsp;</font></div><div><font size="2"   >[noop] deadline cfq&nbsp;</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# cat /sys/block/sdg/queue/scheduler&nbsp;</font></div><div><font size="2"   >[noop] deadline cfq&nbsp;</font></div><p></p></pre></div><div># 修改调度算法为cfq, (这个是CentoS 5中默认使用的算法)</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-PowerEdge-R610:~# echo "cfq" &gt; /sys/block/sdd/queue/scheduler</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# echo "cfq" &gt; /sys/block/sde/queue/scheduler</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# echo "cfq" &gt; /sys/block/sdf/queue/scheduler</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# echo "cfq" &gt; /sys/block/sdg/queue/scheduler</font></div><p></p></pre></div><div># 再次测试 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pg92@digoal-PowerEdge-R610-&gt; pg_test_fsync -f /data03/pg92/test</font></div><div><font size="2"   >2 seconds per test</font></div><div><font size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare file sync methods using one 16kB write:</font></div><div><font size="2"   >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"   >is Linux's default)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12010.934 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10253.836 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9368.252 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11250.309 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare file sync methods using two 16kB writes:</font></div><div><font size="2"   >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"   >is Linux's default)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6145.088 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7003.223 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6475.531 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5644.215 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare open_sync with different write sizes:</font></div><div><font size="2"   >(This is designed to compare the cost of writing 16kB</font></div><div><font size="2"   >in different write open_sync sizes.)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; 11284.139 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp; 7148.275 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp; 4054.198 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; 1961.062 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;997.870 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Test if fsync on non-write file descriptor is honored:</font></div><div><font size="2"   >(If the times are similar, fsync() can sync data written</font></div><div><font size="2"   >on a different descriptor.)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8520.578 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8505.347 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Non-Sync'ed 16kB writes:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 136786.109 ops/sec</font></div><p></p></pre></div><div><span style="line-height: 22px;"   ># 修改调度算法为deadline, 再次测试 :&nbsp;</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pg92@digoal-PowerEdge-R610-&gt; pg_test_fsync -f /data03/pg92/test</font></div><div><font size="2"   >2 seconds per test</font></div><div><font size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare file sync methods using one 16kB write:</font></div><div><font size="2"   >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"   >is Linux's default)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12010.934 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10253.836 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9368.252 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11250.309 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare file sync methods using two 16kB writes:</font></div><div><font size="2"   >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"   >is Linux's default)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6145.088 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7003.223 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6475.531 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5644.215 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare open_sync with different write sizes:</font></div><div><font size="2"   >(This is designed to compare the cost of writing 16kB</font></div><div><font size="2"   >in different write open_sync sizes.)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; 11284.139 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp; 7148.275 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp; 4054.198 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; 1961.062 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp;997.870 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Test if fsync on non-write file descriptor is honored:</font></div><div><font size="2"   >(If the times are similar, fsync() can sync data written</font></div><div><font size="2"   >on a different descriptor.)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8520.578 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8505.347 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Non-Sync'ed 16kB writes:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 136786.109 ops/sec</font></div><div><font size="2"   >pg92@digoal-PowerEdge-R610-&gt; pg_test_fsync -f /data03/pg92/test</font></div><div><font size="2"   >2 seconds per test</font></div><div><font size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare file sync methods using one 16kB write:</font></div><div><font size="2"   >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"   >is Linux's default)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13353.306 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11012.296 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10200.735 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12389.684 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare file sync methods using two 16kB writes:</font></div><div><font size="2"   >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"   >is Linux's default)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6732.473 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7379.819 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6803.874 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6232.601 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare open_sync with different write sizes:</font></div><div><font size="2"   >(This is designed to compare the cost of writing 16kB</font></div><div><font size="2"   >in different write open_sync sizes.)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; 12433.956 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp; 7998.036 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp; 4608.304 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; 2198.007 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; 1154.104 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Test if fsync on non-write file descriptor is honored:</font></div><div><font size="2"   >(If the times are similar, fsync() can sync data written</font></div><div><font size="2"   >on a different descriptor.)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9500.881 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9435.500 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Non-Sync'ed 16kB writes:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 135123.284 ops/sec</font></div><p></p></pre></div><div>关于这几种调度算法的详细介绍参考wiki.</div><div><br></div><div>[其他]</div><div>1. mvsas的版本0.8.16, 下次找个新版本驱动试试看cache on的测试是否正常 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >root@digoal-PowerEdge-R610:~# lsmod|grep mvsas</font></div><div><font size="2"   >mvsas &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;62360 &nbsp;4&nbsp;</font></div><div><font size="2"   >libsas &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 78483 &nbsp;1 mvsas</font></div><div><font size="2"   >scsi_transport_sas &nbsp; &nbsp; 41029 &nbsp;2 mvsas,libsas</font></div><div><font size="2"   >root@digoal-PowerEdge-R610:~# modinfo mvsas</font></div><div><font size="2"   >filename: &nbsp; &nbsp; &nbsp; /lib/modules/3.5.0-26-generic/kernel/drivers/scsi/mvsas/mvsas.ko</font></div><div><font size="2"   >license: &nbsp; &nbsp; &nbsp; &nbsp;GPL</font></div><div><font size="2"   >version: &nbsp; &nbsp; &nbsp; &nbsp;0.8.16</font></div><div><font size="2"   >description: &nbsp; &nbsp;Marvell 88SE6440 SAS/SATA controller driver</font></div><div><font size="2"   >author: &nbsp; &nbsp; &nbsp; &nbsp; Jeff Garzik &lt;jgarzik@pobox.com&gt;</font></div><div><font size="2"   >srcversion: &nbsp; &nbsp; 388EA50BE3558CE73E83218</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001084sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001083sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001080sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001044sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001043sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001042sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001041sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001040sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001022sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B85d00001021sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B4Bd00009485sv*sd00009480bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B4Bd00009445sv*sd00009480bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001B4Bd00009480sv*sd00009480bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001103d00002760sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001103d00002744sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001103d00002740sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001103d00002722sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001103d00002721sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001103d00002720sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00001103d00002710sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v00009005d00000450sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v000017D3d00001320sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v000017D3d00001300sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v000011ABd00009180sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v000011ABd00009480sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v000011ABd00006485sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v000011ABd00006440sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v000011ABd00006440sv*sd00006480bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v000011ABd00006340sv*sd*bc*sc*i*</font></div><div><font size="2"   >alias: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pci:v000011ABd00006320sv*sd*bc*sc*i*</font></div><div><font size="2"   >depends: &nbsp; &nbsp; &nbsp; &nbsp;libsas,scsi_transport_sas</font></div><div><font size="2"   >intree: &nbsp; &nbsp; &nbsp; &nbsp; Y</font></div><div><font size="2"   >vermagic: &nbsp; &nbsp; &nbsp; 3.5.0-26-generic SMP mod_unload modversions&nbsp;</font></div><div><font size="2"   >parm: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collector:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; If greater than one, tells the SAS Layer to run in Task Collector</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Mode. &nbsp;If 1 or 0, tells the SAS Layer to run in Direct Mode.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; The mvsas SAS LLDD supports both modes.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Default: 1 (Direct Mode).</font></div><div><font size="2"   >&nbsp;(int)</font></div><p></p></pre></div><div><br></div>[参考]<wbr></div><div>1.&nbsp;<a style="line-height: 22px;" rel="nofollow" href="http://ocz.com/enterprise/download/drivers"   >http://ocz.com/enterprise/download/drivers</a></div><div>2.&nbsp;<a style="line-height: 22px;" href="http://blog.163.com/digoal@126/blog/static/1638770402012102613815282/"   >http://blog.163.com/digoal@126/blog/static/1638770402012102613815282/</a></div><div>3.&nbsp;<a style="line-height: 22px;" href="http://blog.163.com/digoal@126/blog/static/163877040201210279569426/"   >http://blog.163.com/digoal@126/blog/static/163877040201210279569426/</a></div><div><div style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >4.&nbsp;<a style="line-height: 22px; font-family: Arial, Helvetica, sans-serif;" target="_blank" rel="nofollow" href="http://en.wikipedia.org/wiki/Scheduling_(computing)"   >http://en.wikipedia.org/wiki/Scheduling_(computing)</a></div><div style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >5.&nbsp;<a style="line-height: 22px; font-family: Arial, Helvetica, sans-serif;" target="_blank" rel="nofollow" href="http://en.wikipedia.org/wiki/CFQ"   >http://en.wikipedia.org/wiki/CFQ</a></div><div style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >6.&nbsp;<a style="line-height: 22px; font-family: Arial, Helvetica, sans-serif;" target="_blank" rel="nofollow" href="http://en.wikipedia.org/wiki/Anticipatory_scheduling"   >http://en.wikipedia.org/wiki/Anticipatory_scheduling</a></div><div style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >7.&nbsp;<a style="line-height: 22px; font-family: Arial, Helvetica, sans-serif;" target="_blank" rel="nofollow" href="http://en.wikipedia.org/wiki/Noop_scheduler"   >http://en.wikipedia.org/wiki/Noop_scheduler</a></div><div style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >8.&nbsp;<a style="line-height: 22px; font-family: Arial, Helvetica, sans-serif;" target="_blank" rel="nofollow" href="http://en.wikipedia.org/wiki/Deadline_scheduler"   >http://en.wikipedia.org/wiki/Deadline_scheduler</a></div></div><div>9. 附centos中使用ocz提供的驱动以及cfq, 开启cache下测试数据 :&nbsp;</div><div>centos下关闭cache的测试没有做过, 但是从后面多次测试其他场景的数据来看, 使用ocz驱动开启和关闭cache性能相差不大.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >pg9.2.0@db-172-16-3-150-&gt; pg_test_fsync&nbsp;</font></div><div><font size="2"   >2 seconds per test</font></div><div><font size="2"   >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare file sync methods using one 16kB write:</font></div><div><font size="2"   >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"   >is Linux's default)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9466.480 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 261.271 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12701.793 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare file sync methods using two 16kB writes:</font></div><div><font size="2"   >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"   >is Linux's default)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6148.294 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 250.694 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6321.015 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Compare open_sync with different write sizes:</font></div><div><font size="2"   >(This is designed to compare the cost of writing 16kB</font></div><div><font size="2"   >in different write open_sync sizes.)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 * 16kB open_sync write &nbsp; &nbsp; &nbsp; 12598.168 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 * &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp; 7976.631 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 * &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp; 4740.957 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 * &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; 2232.638 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; 16 * &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; 1138.060 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Test if fsync on non-write file descriptor is honored:</font></div><div><font size="2"   >(If the times are similar, fsync() can sync data written</font></div><div><font size="2"   >on a different descriptor.)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 250.710 ops/sec</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 250.055 ops/sec</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Non-Sync'ed 16kB writes:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 149753.941 ops/sec</font></div><p></p></pre></div></div>
	</div>
	<h3>评论</h3>
	<div class="" id="" style="padding:0 20px;">
			<div id="">
				<h5 id="">zzt4326 - 2013-04-10 14:43:45</h5>
				<div>我的45595447 &nbsp;想了解一下bind &nbsp;连postgreaql的问题</div>
			</div>
			<div id="">
				<h5 id="">zzt4326 - 2013-04-10 14:43:11</h5>
				<div>你好 &nbsp;你有QQ吗？</div>
			</div>
	</div>
</div>
</body>
</html>