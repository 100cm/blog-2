<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Systemtap Userspace probing - 4</h2>
	<h5 id="">2013-09-30 17:55:24&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201383044341926/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >接上一篇BLOG</div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   ><a href="http://blog.163.com/digoal@126/blog/static/163877040201383042846295/"   >http://blog.163.com/digoal@126/blog/static/163877040201383042846295/</a></div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >本文讲一下userspace 探针的最后一点内容, 静态userspace探针.</div><div><font color="#333333"   face="Arial, Helvetica, simsun, u5b8bu4f53"   >Static userspace probing</font></div><div><pre class="prettyprint"   ><p><span style="font-family: Simsun; line-height: normal;"   ><font size="2"   >You can probe symbolic static instrumentation compiled into programs and shared libraries with the following syntax:</font></span></p><dl compact=""   style="font-family: Simsun; line-height: normal;"   ><dt></dt><dd><pre><font size="2"   >process("PATH").mark("LABEL")
</font></pre></dd></dl><p style="font-family: Simsun; line-height: normal;"   ><font size="2"   >The&nbsp;<tt>.mark</tt>&nbsp;variant is called from a static probe defined in the application by&nbsp;<tt>STAP_PROBE1(handle,LABEL,arg1)</tt>.&nbsp;<tt>STAP_PROBE1</tt>&nbsp;is defined in the sdt.h file. The parameters are:</font></p><table cellpadding="3"   border="1"   ><tbody><tr><td align="LEFT"   ><font size="2"   >Parameter</font></td><td align="RIGHT"   ><font size="2"   >Definition</font></td><td align="CENTER"   ><font size="2"   >&nbsp;</font></td></tr><tr><td align="LEFT"   ><tt><font size="2"   >handle</font></tt></td><td align="RIGHT"   ><font size="2"   >the application handle</font></td><td align="CENTER"   ><font size="2"   >&nbsp;</font></td></tr><tr><td align="LEFT"   ><tt><font size="2"   >LABEL</font></tt></td><td align="RIGHT"   ><font size="2"   >corresponds to the&nbsp;<tt>.mark</tt>&nbsp;argument</font></td><td align="CENTER"   ><font size="2"   >&nbsp;</font></td></tr><tr><td align="LEFT"   ><tt><font size="2"   >arg1</font></tt></td><td align="RIGHT"   ><font size="2"   >the argument</font></td><td align="CENTER"   ><font size="2"   >&nbsp;</font></td></tr></table><p style="font-family: Simsun; line-height: normal;"   ><font size="2"   >Use&nbsp;<tt>STAP_PROBE1</tt>&nbsp;for probes with one argument. Use&nbsp;<tt>STAP_PROBE2</tt>&nbsp;for probes with 2 arguments, and so on. The arguments of the probe are available in the context variables <tt>$arg1</tt>,&nbsp;<tt>$arg2</tt>, and so on.</font></p><p style="font-family: Simsun; line-height: normal;"   ><font size="2"   >As an alternative to the&nbsp;<tt>STAP_PROBE</tt>&nbsp;macros, you can use the dtrace script to create custom macros. The sdt.h file also provides dtrace compatible markers through <tt>DTRACE_PROBE</tt>&nbsp;and an associated python&nbsp;<tt>dtrace</tt>&nbsp;script. You can use these in builds based on dtrace that need dtrace -h or -G functionality.</font></p><p></p></pre></div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >使用这些宏添加静态用户空间探针, 支持无参数, 或者1-12个参数的宏. 语法如下 :&nbsp;</div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 23px; font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   ><font size="2"   >STAP_PROBE[1-12](handle,LABEL[,arg1-12])</font></div><div><font size="2"   ><font color="#333333"   face="Arial, Helvetica, simsun, u5b8bu4f53"   >DTRACE_PROBE[1-12]</font><span style="line-height: 23px; font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >(handle,LABEL[,arg1-12])</span></font></div><p></p></pre></div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >静态userspace探针的用法</div><div><pre class="prettyprint"   ><p><font size="2"   >probe process("PATH").mark("LABEL")</font></p></pre></div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   ><br></div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >例如在PostgreSQL定义的某静态探针, 使用的是DTRACE模式定义, 在sdt.h中有DTRACE的兼容模式, 所以也可以用.</div><div><font color="#333333"   face="Arial, Helvetica, simsun, u5b8bu4f53"   >src/backend/utils/probes.h</font></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >/* Generated by the Systemtap dtrace wrapper */</font></div><div><font size="2"   >#define _SDT_HAS_SEMAPHORES 1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#define STAP_HAS_SEMAPHORES 1 /* deprecated */</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#include &lt;sys/sdt.h&gt;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* TRACE_POSTGRESQL_TRANSACTION_START ( unsigned int) */</font></div><div><font size="2"   >#if defined STAP_SDT_V1</font></div><div><font size="2"   >#define TRACE_POSTGRESQL_TRANSACTION_START_ENABLED() __builtin_expect (transaction__start_semaphore, 0)</font></div><div><font size="2"   >#define postgresql_transaction__start_semaphore transaction__start_semaphore</font></div><div><font size="2"   >#else</font></div><div><font size="2"   >#define TRACE_POSTGRESQL_TRANSACTION_START_ENABLED() __builtin_expect (postgresql_transaction__start_semaphore, 0)</font></div><div><font size="2"   >#endif</font></div><div><font size="2"   >__extension__ extern unsigned short postgresql_transaction__start_semaphore __attribute__ ((unused)) __attribute__ ((section (".prob</font></div><div><font size="2"   >es")));</font></div><div><font size="2"   >#define TRACE_POSTGRESQL_TRANSACTION_START(arg1) \</font></div><div><font size="2"   >DTRACE_PROBE1(postgresql,transaction__start,arg1)</font></div><p></p></pre></div><div><font color="#333333"   face="Arial, Helvetica, simsun, u5b8bu4f53"   >PG中使用的是dtrace宏定义,&nbsp;</font></div><pre class="prettyprint"   ><p></p><div><font color="#333333"   face="Arial, Helvetica, simsun, u5b8bu4f53"   size="2"   >DTRACE_PROBE1(postgresql,transaction__start,arg1)</font></div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   ></div><p></p></pre><div><span style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >DTRACE_PROBE1在sdt.h中可以找到.</span></div><div><pre class="prettyprint"   ><p></p><div><font color="#333333"   face="Arial, Helvetica, simsun, u5b8bu4f53"   size="2"   >#define DTRACE_PROBE1(provider,probe,parm1) &nbsp; &nbsp; \</font></div><div><font color="#333333"   face="Arial, Helvetica, simsun, u5b8bu4f53"   size="2"   >&nbsp; STAP_PROBE1(provider,probe,parm1)</font></div><p></p></pre></div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >如果要使用以上PostgreSQL中定义的这个静态探针, 如下 :&nbsp;</div><pre class="prettyprint"   ><p></p><div><font color="#333333"   face="Arial, Helvetica, simsun, u5b8bu4f53"   size="2"   >probe process("/opt/pgsql/bin/postgres").mark("transaction__start")</font></div><div></div><p></p></pre><div><span style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >举例如下 :&nbsp;</span></div><div><font color="#333333"   face="Arial, Helvetica, simsun, u5b8bu4f53"   ><br></font></div><div><font color="#333333"   face="Arial, Helvetica, simsun, u5b8bu4f53"   >首先, 前面举例用到的在PostgreSQL中定义的静态用户空间探针transaction__start对应的宏TRACE_POSTGRESQL_TRANSACTION_START在代码中被植入的位置如下</font><span style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >,&nbsp;</span></div><div><font color="#333333"   face="Arial, Helvetica, simsun, u5b8bu4f53"   >src/backend/access/transam/xact.c</font></div><div><font color="#333333"   face="Arial, Helvetica, simsun, u5b8bu4f53"   ><div><pre class="prettyprint"   ><p></p><div><font size="2"   >/*</font></div><div><font size="2"   >&nbsp;* &nbsp; &nbsp; &nbsp;StartTransaction</font></div><div><font size="2"   >&nbsp;*/</font></div><div><font size="2"   >static void</font></div><div><font size="2"   >StartTransaction(void)</font></div><div><font size="2"   >{</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; TransactionState s;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; VirtualTransactionId vxid;</font></div><div><font size="2"   >... 略</font></div><div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; /*</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* Advertise it in the proc array. &nbsp; &nbsp; &nbsp;We assume assignment of</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* LocalTransactionID is atomic, and the backendId should be set already.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; Assert(MyProc-&gt;backendId == vxid.backendId);</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; MyProc-&gt;lxid = vxid.localTransactionId;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; TRACE_POSTGRESQL_TRANSACTION_START(vxid.localTransactionId);</font></div></div><p></p></pre></div><div>所以对应的参数arg1是<span style="line-height: 23px;"   >vxid.localTransactionId</span></div><div><span style="line-height: 23px;"   >下面我们来做一个测试 :&nbsp;</span></div><div><span style="line-height: 23px;"   >user_string这没有, 因为$arg1不是一个字符串, 可以不用管它.</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'global cnt; probe process("/home/pg94/pgsql9.4devel/bin/postgres").mark("transaction__start") { cnt&lt;&lt;&lt;1; printf("%d, %s, %s, %s\n", pid(), pp(), $$vars, user_string($arg1)) }'</font></div><div></div><p></p></pre><span style="line-height: 23px;"   ><div><span style="line-height: 23px;"   >测试过程中做几条查询</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >begin;</font></div><div><font size="2"   >end;</font></div><div><font size="2"   >begin;</font></div><div><font size="2"   >end;</font></div><div><font size="2"   >begin;</font></div><div><font size="2"   >end;</font></div><p></p></pre></div><div>stap输出如下 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >4349, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x10, &lt;unknown&gt;</font></div><div><font size="2"   >4349, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x11, &lt;unknown&gt;</font></div><div><font size="2"   >4349, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x12, &lt;unknown&gt;</font></div><p></p></pre></div></span></div><div><span style="line-height: 23px;"   >观察久一点的话, 可能还有其他进程的输出.</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'global cnt; probe process("/home/pg94/pgsql9.4devel/bin/postgres").mark("transaction__start") { cnt&lt;&lt;&lt;1; printf("%d, %s, %s, %s\n", pid(), pp(), $$vars, user_string($arg1)) }'</font></div><div><font size="2"   >4349, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x10, &lt;unknown&gt;</font></div><div><font size="2"   >4349, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x11, &lt;unknown&gt;</font></div><div><font size="2"   >4349, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x12, &lt;unknown&gt;</font></div><div><font size="2"   >4212, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0xc, &lt;unknown&gt;</font></div><div><font size="2"   >4991, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x13, &lt;unknown&gt;</font></div><div><font size="2"   >4991, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x14, &lt;unknown&gt;</font></div><div><font size="2"   >4993, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x15, &lt;unknown&gt;</font></div><div><font size="2"   >4993, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x16, &lt;unknown&gt;</font></div><div><font size="2"   >4993, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x17, &lt;unknown&gt;</font></div><div><font size="2"   >4993, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x18, &lt;unknown&gt;</font></div><div><font size="2"   >4993, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x19, &lt;unknown&gt;</font></div><div><font size="2"   >4212, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0xd, &lt;unknown&gt;</font></div><div><font size="2"   >4998, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0xf, &lt;unknown&gt;</font></div><div><font size="2"   >4998, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x10, &lt;unknown&gt;</font></div><div><font size="2"   >4993, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x1a, &lt;unknown&gt;</font></div><div><font size="2"   >4212, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0xe, &lt;unknown&gt;</font></div><div><font size="2"   >5012, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x11, &lt;unknown&gt;</font></div><div><font size="2"   >5012, process("/home/pg94/pgsql9.4devel/bin/postgres").statement(0x4a4caa), $arg1=0x12, &lt;unknown&gt;</font></div><p></p></pre></div></font></div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   ><br></div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >[参考]</div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >1.&nbsp;<a style="line-height: 23px; text-decoration: none; color: rgb(85, 108, 136);" href="http://blog.163.com/digoal@126/blog/static/163877040201382941342901/"   >http://blog.163.com/digoal@126/blog/static/163877040201382941342901/</a></div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >2.&nbsp;<a style="line-height: 23px; text-decoration: none; color: rgb(85, 108, 136);" href="http://blog.163.com/digoal@126/blog/static/16387704020138301545039/"   >http://blog.163.com/digoal@126/blog/static/16387704020138301545039/</a></div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >3.&nbsp;<a style="font-family: Arial, Helvetica, sans-serif; line-height: 23px;" href="http://blog.163.com/digoal@126/blog/static/163877040201383042846295/"   >http://blog.163.com/digoal@126/blog/static/163877040201383042846295/</a></div><div style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"   >4.&nbsp;src/backend/utils/probes.h</div><wbr><div>5.&nbsp;/usr/include/sys/sdt.h</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >/* &lt;sys/sdt.h&gt; - Systemtap static probe definition macros.</font></div><div><font size="2"   >&nbsp; &nbsp;Copyright (C) 2010-2011 Red Hat Inc.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;This file is part of systemtap, and is free software in the public domain.</font></div><div><font size="2"   >*/</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#ifndef _SYS_SDT_H</font></div><div><font size="2"   >#define _SYS_SDT_H &nbsp; &nbsp;1</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#ifdef __ASSEMBLER__</font></div><div><font size="2"   ># define _SDT_PROBE(provider, name, n, arglist) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_BODY(provider, name, _SDT_ASM_STRING_1, (_SDT_DEPAREN_##n arglist)) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_BASE</font></div><div><font size="2"   ># define _SDT_ASM_1(x) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;x;</font></div><div><font size="2"   ># define _SDT_ASM_2(a, b) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a,b;</font></div><div><font size="2"   ># define _SDT_ASM_3(a, b, c) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;a,b,c;</font></div><div><font size="2"   ># define _SDT_ASM_5(a, b, c, d, e) &nbsp; &nbsp; &nbsp;a,b,c,d,e;</font></div><div><font size="2"   ># define _SDT_ASM_STRING_1(x) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .asciz #x;</font></div><div><font size="2"   ># define _SDT_DEPAREN_0() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* empty */</font></div><div><font size="2"   ># define _SDT_DEPAREN_1(a) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;a</font></div><div><font size="2"   ># define _SDT_DEPAREN_2(a,b) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;a b</font></div><div><font size="2"   ># define _SDT_DEPAREN_3(a,b,c) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;a b c</font></div><div><font size="2"   ># define _SDT_DEPAREN_4(a,b,c,d) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;a b c d</font></div><div><font size="2"   ># define _SDT_DEPAREN_5(a,b,c,d,e) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;a b c d e</font></div><div><font size="2"   ># define _SDT_DEPAREN_6(a,b,c,d,e,f) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;a b c d e f</font></div><div><font size="2"   ># define _SDT_DEPAREN_7(a,b,c,d,e,f,g) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;a b c d e f g</font></div><div><font size="2"   ># define _SDT_DEPAREN_8(a,b,c,d,e,f,g,h) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;a b c d e f g h</font></div><div><font size="2"   ># define _SDT_DEPAREN_9(a,b,c,d,e,f,g,h,i) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;a b c d e f g h i</font></div><div><font size="2"   ># define _SDT_DEPAREN_10(a,b,c,d,e,f,g,h,i,j) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a b c d e f g h i j</font></div><div><font size="2"   ># define _SDT_DEPAREN_11(a,b,c,d,e,f,g,h,i,j,k) &nbsp; &nbsp; &nbsp; &nbsp; a b c d e f g h i j k</font></div><div><font size="2"   ># define _SDT_DEPAREN_12(a,b,c,d,e,f,g,h,i,j,k,l) &nbsp; &nbsp; &nbsp; a b c d e f g h i j k l</font></div><div><font size="2"   >#else</font></div><div><font size="2"   ># include &lt;stdint.h&gt;</font></div><div><font size="2"   ># define _SDT_PROBE(provider, name, n, arglist) \</font></div><div><font size="2"   >&nbsp; do { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; &nbsp; __asm__ __volatile__ (_SDT_ASM_BODY(provider, name, _SDT_ASM_ARGS, (n)) \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :: _SDT_ASM_OPERANDS_##n arglist); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; &nbsp; __asm__ __volatile__ (_SDT_ASM_BASE); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; } while (0)</font></div><div><font size="2"   ># define _SDT_S(x) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x</font></div><div><font size="2"   ># define _SDT_ASM_1(x) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_SDT_S(x) "\n"</font></div><div><font size="2"   ># define _SDT_ASM_2(a, b) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_S(a) "," _SDT_S(b) "\n"</font></div><div><font size="2"   ># define _SDT_ASM_3(a, b, c) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_SDT_S(a) "," _SDT_S(b) "," \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_S(c) "\n"</font></div><div><font size="2"   ># define _SDT_ASM_5(a, b, c, d, e) &nbsp; &nbsp; &nbsp;_SDT_S(a) "," _SDT_S(b) "," \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_S(c) "," _SDT_S(d) "," \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_S(e) "\n"</font></div><div><font size="2"   ># define _SDT_ASM_ARGS(n) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_STRING(_SDT_ASM_TEMPLATE_##n)</font></div><div><font size="2"   ># define _SDT_ASM_STRING_1(x) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_1(.asciz #x)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ># define _SDT_ARGFMT(no) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;%n[_SDT_S##no]@_SDT_ARGTMPL(_SDT_A##no)</font></div><div><font size="2"   ># ifndef STAP_SDT_ARG_CONSTRAINT</font></div><div><font size="2"   ># define STAP_SDT_ARG_CONSTRAINT &nbsp; &nbsp; &nbsp; &nbsp;nor</font></div><div><font size="2"   ># endif</font></div><div><font size="2"   ># define _SDT_STRINGIFY(x) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x</font></div><div><font size="2"   ># define _SDT_ARG_CONSTRAINT_STRING(x) &nbsp;_SDT_STRINGIFY(x)</font></div><div><font size="2"   ># define _SDT_ARG(n, x) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; [_SDT_S##n] "n" ((_SDT_ARGSIGNED (x) ? 1 : -1) * (int) _SDT_ARGSIZE (x)), \</font></div><div><font size="2"   >&nbsp; [_SDT_A##n] _SDT_ARG_CONSTRAINT_STRING (STAP_SDT_ARG_CONSTRAINT) (_SDT_ARGVAL (x))</font></div><div><font size="2"   >#endif</font></div><div><font size="2"   >#define _SDT_ASM_STRING(x) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_SDT_ASM_STRING_1(x)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#define _SDT_ARGARRAY(x) &nbsp; &nbsp; &nbsp; &nbsp;(__builtin_classify_type (x) == 14 &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|| __builtin_classify_type (x) == 5)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#ifdef __cplusplus</font></div><div><font size="2"   ># define _SDT_ARGSIGNED(x) &nbsp; &nbsp; &nbsp;(!_SDT_ARGARRAY (x) \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&amp; __sdt_type&lt;__typeof (x)&gt;::__sdt_signed)</font></div><div><font size="2"   ># define _SDT_ARGSIZE(x) &nbsp; &nbsp; &nbsp; &nbsp;(_SDT_ARGARRAY (x) \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;? sizeof (void *) : sizeof (x))</font></div><div><font size="2"   ># define _SDT_ARGVAL(x) &nbsp; &nbsp; &nbsp; &nbsp; (x)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ># include &lt;cstddef&gt;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >template&lt;typename __sdt_T&gt;</font></div><div><font size="2"   >struct __sdt_type</font></div><div><font size="2"   >{</font></div><div><font size="2"   >&nbsp; static const bool __sdt_signed = false;</font></div><div><font size="2"   >};</font></div><div><font size="2"   >&nbsp;&nbsp;</font></div><div><font size="2"   >#define __SDT_ALWAYS_SIGNED(T) \</font></div><div><font size="2"   >template&lt;&gt; struct __sdt_type&lt;T&gt; { static const bool __sdt_signed = true; };</font></div><div><font size="2"   >#define __SDT_COND_SIGNED(T) \</font></div><div><font size="2"   >template&lt;&gt; struct __sdt_type&lt;T&gt; { static const bool __sdt_signed = ((T)(-1) &lt; 1); };</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(signed char)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(short)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(int)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(long)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(long long)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(volatile signed char)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(volatile short)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(volatile int)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(volatile long)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(volatile long long)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(const signed char)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(const short)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(const int)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(const long)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(const long long)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(const volatile signed char)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(const volatile short)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(const volatile int)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(const volatile long)</font></div><div><font size="2"   >__SDT_ALWAYS_SIGNED(const volatile long long)</font></div><div><font size="2"   >__SDT_COND_SIGNED(char)</font></div><div><font size="2"   >__SDT_COND_SIGNED(wchar_t)</font></div><div><font size="2"   >__SDT_COND_SIGNED(volatile char)</font></div><div><font size="2"   >__SDT_COND_SIGNED(volatile wchar_t)</font></div><div><font size="2"   >__SDT_COND_SIGNED(const char)</font></div><div><font size="2"   >__SDT_COND_SIGNED(const wchar_t)</font></div><div><font size="2"   >__SDT_COND_SIGNED(const volatile char)</font></div><div><font size="2"   >__SDT_COND_SIGNED(const volatile wchar_t)</font></div><div><font size="2"   >#if defined (__GNUC__) &amp;&amp; (__GNUC__ &gt; 4 || (__GNUC__ == 4 &amp;&amp; __GNUC_MINOR__ &gt;= 4))</font></div><div><font size="2"   >/* __SDT_COND_SIGNED(char16_t) */</font></div><div><font size="2"   >/* __SDT_COND_SIGNED(char32_t) */</font></div><div><font size="2"   >#endif</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >template&lt;typename __sdt_E&gt;</font></div><div><font size="2"   >struct __sdt_type&lt;__sdt_E[]&gt; : public __sdt_type&lt;__sdt_E *&gt; {};</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >template&lt;typename __sdt_E, size_t __sdt_N&gt;</font></div><div><font size="2"   >struct __sdt_type&lt;__sdt_E[__sdt_N]&gt; : public __sdt_type&lt;__sdt_E *&gt; {};</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#elif !defined(__ASSEMBLER__)</font></div><div><font size="2"   >__extension__ extern unsigned long long __sdt_unsp;</font></div><div><font size="2"   ># define _SDT_ARGINTTYPE(x) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; __typeof (__builtin_choose_expr (((__builtin_classify_type (x) &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+ 3) &amp; -4) == 4, (x), 0U))</font></div><div><font size="2"   ># define _SDT_ARGSIGNED(x) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; (!__extension__ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; &nbsp;(__builtin_constant_p ((((unsigned long long) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (_SDT_ARGINTTYPE (x)) __sdt_unsp) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp; ((unsigned long long)1 &lt;&lt; (sizeof (unsigned long long) &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* __CHAR_BIT__ - 1))) == 0) &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; &nbsp; || (_SDT_ARGINTTYPE (x)) -1 &gt; (_SDT_ARGINTTYPE (x)) 0))</font></div><div><font size="2"   ># define _SDT_ARGSIZE(x) &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; (_SDT_ARGARRAY (x) ? sizeof (void *) : sizeof (x))</font></div><div><font size="2"   ># define _SDT_ARGVAL(x) &nbsp; &nbsp; &nbsp; &nbsp; (x)</font></div><div><font size="2"   >#endif</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#if defined __powerpc__ || defined __powerpc64__</font></div><div><font size="2"   ># define _SDT_ARGTMPL(id) &nbsp; &nbsp; &nbsp; %I[id]%[id]</font></div><div><font size="2"   >#else</font></div><div><font size="2"   ># define _SDT_ARGTMPL(id) &nbsp; &nbsp; &nbsp; %[id]</font></div><div><font size="2"   >#endif</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#ifdef __LP64__</font></div><div><font size="2"   ># define _SDT_ASM_ADDR &nbsp;.8byte</font></div><div><font size="2"   >#else</font></div><div><font size="2"   ># define _SDT_ASM_ADDR &nbsp;.4byte</font></div><div><font size="2"   >#endif</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* The ia64 and s390 nop instructions take an argument. */</font></div><div><font size="2"   >#if defined(__ia64__) || defined(__s390__) || defined(__s390x__)</font></div><div><font size="2"   >#define _SDT_NOP &nbsp; &nbsp; &nbsp; &nbsp;nop 0</font></div><div><font size="2"   >#else</font></div><div><font size="2"   >#define _SDT_NOP &nbsp; &nbsp; &nbsp; &nbsp;nop</font></div><div><font size="2"   >#endif</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#define _SDT_NOTE_NAME &nbsp;"stapsdt"</font></div><div><font size="2"   >#define _SDT_NOTE_TYPE &nbsp;3</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* If the assembler supports the necessary feature, then we can play</font></div><div><font size="2"   >&nbsp; &nbsp;nice with code in COMDAT sections, which comes up in C++ code.</font></div><div><font size="2"   >&nbsp; &nbsp;Without that assembler support, some combinations of probe placements</font></div><div><font size="2"   >&nbsp; &nbsp;in certain kinds of C++ code may produce link-time errors. &nbsp;*/</font></div><div><font size="2"   >#include "sdt-config.h"</font></div><div><font size="2"   >#if _SDT_ASM_SECTION_AUTOGROUP_SUPPORT</font></div><div><font size="2"   ># define _SDT_ASM_AUTOGROUP "?"</font></div><div><font size="2"   >#else</font></div><div><font size="2"   ># define _SDT_ASM_AUTOGROUP ""</font></div><div><font size="2"   >#endif</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#define _SDT_ASM_BODY(provider, name, pack_args, args) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1(990: &nbsp; &nbsp; &nbsp; _SDT_NOP) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_3( &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .pushsection .note.stapsdt,_SDT_ASM_AUTOGROUP,"note") \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1( &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .balign 4) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; _SDT_ASM_3( &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .4byte 992f-991f, 994f-993f, _SDT_NOTE_TYPE) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1(991: &nbsp; &nbsp; &nbsp; .asciz _SDT_NOTE_NAME) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1(992: &nbsp; &nbsp; &nbsp; .balign 4) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1(993: &nbsp; &nbsp; &nbsp; _SDT_ASM_ADDR 990b) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1( &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_ADDR _.stapsdt.base) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; _SDT_SEMAPHORE(provider,name) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_STRING(provider) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_STRING(name) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; pack_args args &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1(994: &nbsp; &nbsp; &nbsp; .balign 4) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1( &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .popsection)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#define _SDT_ASM_BASE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1(.ifndef _.stapsdt.base) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; _SDT_ASM_5( &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .pushsection .stapsdt.base,"aG","progbits", &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .stapsdt.base,comdat) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1( &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .weak _.stapsdt.base) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1( &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .hidden _.stapsdt.base) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1( &nbsp; _.stapsdt.base: .space 1) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_2( &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .size _.stapsdt.base, 1) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1( &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .popsection) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; _SDT_ASM_1(.endif)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#if defined _SDT_HAS_SEMAPHORES</font></div><div><font size="2"   >#define _SDT_SEMAPHORE(p,n) _SDT_ASM_1( &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_ADDR p##_##n##_semaphore)</font></div><div><font size="2"   >#else</font></div><div><font size="2"   >#define _SDT_SEMAPHORE(p,n) _SDT_ASM_1( &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_ADDR 0)</font></div><div><font size="2"   >#endif</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* no arguments */</font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ARGFMT(1)</font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_TEMPLATE_1 _SDT_ARGFMT(2)</font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_TEMPLATE_2 _SDT_ARGFMT(3)</font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_TEMPLATE_3 _SDT_ARGFMT(4)</font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_TEMPLATE_4 _SDT_ARGFMT(5)</font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_TEMPLATE_5 _SDT_ARGFMT(6)</font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_7 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_TEMPLATE_6 _SDT_ARGFMT(7)</font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_TEMPLATE_7 _SDT_ARGFMT(8)</font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SDT_ASM_TEMPLATE_8 _SDT_ARGFMT(9)</font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_SDT_ASM_TEMPLATE_9 _SDT_ARGFMT(10)</font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_11 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_SDT_ASM_TEMPLATE_10 _SDT_ARGFMT(11)</font></div><div><font size="2"   >#define _SDT_ASM_TEMPLATE_12 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_SDT_ASM_TEMPLATE_11 _SDT_ARGFMT(12)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_0() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [__sdt_dummy] "g" (0)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_1(arg1) &nbsp; &nbsp; &nbsp; _SDT_ARG(1, arg1)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_2(arg1, arg2) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_OPERANDS_1(arg1), _SDT_ARG(2, arg2)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_3(arg1, arg2, arg3) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_OPERANDS_2(arg1, arg2), _SDT_ARG(3, arg3)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_4(arg1, arg2, arg3, arg4) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_OPERANDS_3(arg1, arg2, arg3), _SDT_ARG(4, arg4)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_5(arg1, arg2, arg3, arg4, arg5) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_OPERANDS_4(arg1, arg2, arg3, arg4), _SDT_ARG(5, arg5)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_6(arg1, arg2, arg3, arg4, arg5, arg6) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_OPERANDS_5(arg1, arg2, arg3, arg4, arg5), _SDT_ARG(6, arg6)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_7(arg1, arg2, arg3, arg4, arg5, arg6, arg7) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_OPERANDS_6(arg1, arg2, arg3, arg4, arg5, arg6), _SDT_ARG(7, arg7)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_8(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_OPERANDS_7(arg1, arg2, arg3, arg4, arg5, arg6, arg7), \</font></div><div><font size="2"   >&nbsp; &nbsp; _SDT_ARG(8, arg8)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_9(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_OPERANDS_8(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8), \</font></div><div><font size="2"   >&nbsp; &nbsp; _SDT_ARG(9, arg9)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_10(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_OPERANDS_9(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9), \</font></div><div><font size="2"   >&nbsp; &nbsp; _SDT_ARG(10, arg10)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_11(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10,arg11) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_OPERANDS_10(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10), \</font></div><div><font size="2"   >&nbsp; &nbsp; _SDT_ARG(11, arg11)</font></div><div><font size="2"   >#define _SDT_ASM_OPERANDS_12(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10,arg11,arg12) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_OPERANDS_11(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10, arg11), \</font></div><div><font size="2"   >&nbsp; &nbsp; _SDT_ARG(12, arg12)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* These macros can be used in C, C++, or assembly code.</font></div><div><font size="2"   >&nbsp; &nbsp;In assembly code the arguments should use normal assembly operand syntax. &nbsp;*/</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#define STAP_PROBE(provider, name) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 0, ())</font></div><div><font size="2"   >#define STAP_PROBE1(provider, name, arg1) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 1, (arg1))</font></div><div><font size="2"   >#define STAP_PROBE2(provider, name, arg1, arg2) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 2, (arg1, arg2))</font></div><div><font size="2"   >#define STAP_PROBE3(provider, name, arg1, arg2, arg3) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 3, (arg1, arg2, arg3))</font></div><div><font size="2"   >#define STAP_PROBE4(provider, name, arg1, arg2, arg3, arg4) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 4, (arg1, arg2, arg3, arg4))</font></div><div><font size="2"   >#define STAP_PROBE5(provider, name, arg1, arg2, arg3, arg4, arg5) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 5, (arg1, arg2, arg3, arg4, arg5))</font></div><div><font size="2"   >#define STAP_PROBE6(provider, name, arg1, arg2, arg3, arg4, arg5, arg6) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 6, (arg1, arg2, arg3, arg4, arg5, arg6))</font></div><div><font size="2"   >#define STAP_PROBE7(provider, name, arg1, arg2, arg3, arg4, arg5, arg6, arg7) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 7, (arg1, arg2, arg3, arg4, arg5, arg6, arg7))</font></div><div><font size="2"   >#define STAP_PROBE8(provider,name,arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 8, (arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8))</font></div><div><font size="2"   >#define STAP_PROBE9(provider,name,arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9)\</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 9, (arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9))</font></div><div><font size="2"   >#define STAP_PROBE10(provider,name,arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 10, \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10))</font></div><div><font size="2"   >#define STAP_PROBE11(provider,name,arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10,arg11) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 11, \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10,arg11))</font></div><div><font size="2"   >#define STAP_PROBE12(provider,name,arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10,arg11,arg12) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, 12, \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10,arg11,arg12))</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* This STAP_PROBEV macro can be used in variadic scenarios, where the</font></div><div><font size="2"   >&nbsp; &nbsp;number of probe arguments is not known until compile time. &nbsp;Since</font></div><div><font size="2"   >&nbsp; &nbsp;variadic macro support may vary with compiler options, you must</font></div><div><font size="2"   >&nbsp; &nbsp;pre-#define SDT_USE_VARIADIC to enable this type of probe.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;The trick to count __VA_ARGS__ was inspired by this post by</font></div><div><font size="2"   >&nbsp; &nbsp;Laurent Deniau &lt;laurent.deniau@cern.ch&gt;:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;http://groups.google.com/group/comp.std.c/msg/346fc464319b1ee5</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;Note that our _SDT_NARG is called with an extra 0 arg that's not</font></div><div><font size="2"   >&nbsp; &nbsp;counted, so we don't have to worry about the behavior of macros</font></div><div><font size="2"   >&nbsp; &nbsp;called without any arguments. &nbsp;*/</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#ifdef SDT_USE_VARIADIC</font></div><div><font size="2"   >#define _SDT_NARG(...) __SDT_NARG(__VA_ARGS__, 12,11,10,9,8,7,6,5,4,3,2,1,0)</font></div><div><font size="2"   >#define __SDT_NARG(_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_10,_11,_12, N, ...) N</font></div><div><font size="2"   >#define _SDT_PROBE_N(provider, name, N, ...) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE(provider, name, N, (__VA_ARGS__))</font></div><div><font size="2"   >#define STAP_PROBEV(provider, name, ...) \</font></div><div><font size="2"   >&nbsp; _SDT_PROBE_N(provider, name, _SDT_NARG(0, ##__VA_ARGS__), ##__VA_ARGS__)</font></div><div><font size="2"   >#endif</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* These macros are for use in asm statements. &nbsp;You must compile</font></div><div><font size="2"   >&nbsp; &nbsp;with -std=gnu99 or -std=c99 to use the STAP_PROBE_ASM macro.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;The STAP_PROBE_ASM macro generates a quoted string to be used in the</font></div><div><font size="2"   >&nbsp; &nbsp;template portion of the asm statement, concatenated with strings that</font></div><div><font size="2"   >&nbsp; &nbsp;contain the actual assembly code around the probe site.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;For example:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; asm ("before\n"</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STAP_PROBE_ASM(provider, fooprobe, %eax 4(%esi))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"after");</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;emits the assembly code for "before\nafter", with a probe in between.</font></div><div><font size="2"   >&nbsp; &nbsp;The probe arguments are the %eax register, and the value of the memory</font></div><div><font size="2"   >&nbsp; &nbsp;word located 4 bytes past the address in the %esi register. &nbsp;Note that</font></div><div><font size="2"   >&nbsp; &nbsp;because this is a simple asm, not a GNU C extended asm statement, these</font></div><div><font size="2"   >&nbsp; &nbsp;% characters do not need to be doubled to generate literal %reg names.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp;In a GNU C extended asm statement, the probe arguments can be specified</font></div><div><font size="2"   >&nbsp; &nbsp;using the macro STAP_PROBE_ASM_TEMPLATE(n) for n arguments. &nbsp;The paired</font></div><div><font size="2"   >&nbsp; &nbsp;macro STAP_PROBE_ASM_OPERANDS gives the C values of these probe arguments,</font></div><div><font size="2"   >&nbsp; &nbsp;and appears in the input operand list of the asm statement. &nbsp;For example:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; asm ("someinsn %0,%1\n" // %0 is output operand, %1 is input operand</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STAP_PROBE_ASM(provider, fooprobe, STAP_PROBE_ASM_TEMPLATE(3))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"otherinsn %[namedarg]"</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: "r" (outvar)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: "g" (some_value), [namedarg] "i" (1234),</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STAP_PROBE_ASM_OPERANDS(3, some_value, some_ptr-&gt;field, 1234));</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; This is just like writing:</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; STAP_PROBE3(provider, fooprobe, some_value, some_ptr-&gt;field, 1234));</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; but the probe site is right between "someinsn" and "otherinsn".</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; The probe arguments in STAP_PROBE_ASM can be given as assembly</font></div><div><font size="2"   >&nbsp; &nbsp; operands instead, even inside a GNU C extended asm statement.</font></div><div><font size="2"   >&nbsp; &nbsp; Note that these can use operand templates like %0 or %[name],</font></div><div><font size="2"   >&nbsp; &nbsp; and likewise they must write %%reg for a literal operand of %reg. &nbsp;*/</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#if __STDC_VERSION__ &gt;= 199901L</font></div><div><font size="2"   ># define STAP_PROBE_ASM(provider, name, ...) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; _SDT_ASM_BODY(provider, name, _SDT_ASM_STRING, (__VA_ARGS__)) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_BASE</font></div><div><font size="2"   ># define STAP_PROBE_ASM_OPERANDS(n, ...) _SDT_ASM_OPERANDS_##n(__VA_ARGS__)</font></div><div><font size="2"   >#else</font></div><div><font size="2"   ># define STAP_PROBE_ASM(provider, name, args) &nbsp; \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_BODY(provider, name, _SDT_ASM_STRING, (args)) \</font></div><div><font size="2"   >&nbsp; _SDT_ASM_BASE</font></div><div><font size="2"   >#endif</font></div><div><font size="2"   >#define STAP_PROBE_ASM_TEMPLATE(n) &nbsp; &nbsp; &nbsp;_SDT_ASM_TEMPLATE_##n</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* DTrace compatible macro names. &nbsp;*/</font></div><div><font size="2"   >#define DTRACE_PROBE(provider,probe) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\</font></div><div><font size="2"   >&nbsp; STAP_PROBE(provider,probe)</font></div><div><font size="2"   >#define DTRACE_PROBE1(provider,probe,parm1) &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; STAP_PROBE1(provider,probe,parm1)</font></div><div><font size="2"   >#define DTRACE_PROBE2(provider,probe,parm1,parm2) &nbsp; &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; STAP_PROBE2(provider,probe,parm1,parm2)</font></div><div><font size="2"   >#define DTRACE_PROBE3(provider,probe,parm1,parm2,parm3) \</font></div><div><font size="2"   >&nbsp; STAP_PROBE3(provider,probe,parm1,parm2,parm3)</font></div><div><font size="2"   >#define DTRACE_PROBE4(provider,probe,parm1,parm2,parm3,parm4) &nbsp; \</font></div><div><font size="2"   >&nbsp; STAP_PROBE4(provider,probe,parm1,parm2,parm3,parm4)</font></div><div><font size="2"   >#define DTRACE_PROBE5(provider,probe,parm1,parm2,parm3,parm4,parm5) &nbsp; &nbsp; \</font></div><div><font size="2"   >&nbsp; STAP_PROBE5(provider,probe,parm1,parm2,parm3,parm4,parm5)</font></div><div><font size="2"   >#define DTRACE_PROBE6(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6) \</font></div><div><font size="2"   >&nbsp; STAP_PROBE6(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6)</font></div><div><font size="2"   >#define DTRACE_PROBE7(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6,parm7) \</font></div><div><font size="2"   >&nbsp; STAP_PROBE7(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6,parm7)</font></div><div><font size="2"   >#define DTRACE_PROBE8(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6,parm7,parm8) \</font></div><div><font size="2"   >&nbsp; STAP_PROBE8(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6,parm7,parm8)</font></div><div><font size="2"   >#define DTRACE_PROBE9(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6,parm7,parm8,parm9) \</font></div><div><font size="2"   >&nbsp; STAP_PROBE9(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6,parm7,parm8,parm9)</font></div><div><font size="2"   >#define DTRACE_PROBE10(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6,parm7,parm8,parm9,parm10) \</font></div><div><font size="2"   >&nbsp; STAP_PROBE10(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6,parm7,parm8,parm9,parm10)</font></div><div><font size="2"   >#define DTRACE_PROBE11(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6,parm7,parm8,parm9,parm10,parm11) \</font></div><div><font size="2"   >&nbsp; STAP_PROBE11(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6,parm7,parm8,parm9,parm10,parm11)</font></div><div><font size="2"   >#define DTRACE_PROBE12(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6,parm7,parm8,parm9,parm10,parm11,parm12) \</font></div><div><font size="2"   >&nbsp; STAP_PROBE12(provider,probe,parm1,parm2,parm3,parm4,parm5,parm6,parm7,parm8,parm9,parm10,parm11,parm12)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#endif /* sys/sdt.h */</font></div><p></p></pre></div></div>
	</div>
</div>
</body>
</html>