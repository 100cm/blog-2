<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL a create dblink error case</h2>
	<h5 id="">2012-04-26 21:36:18&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201232692431920/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;">一位老同事遇到的创建DBLINK的麻烦, 报错如下 :&nbsp;<div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >kenyon=# create extension dblink;</font></div><div><font size="2"  >ERROR: could not load library "/home/postgres/lib/dblink.so": /home/postgres/lib/dblink.so: undefined symbol: PQconnectionUsedPassword</font></div><p></p></pre></div><div>版本是PostgreSQL 9.1.2.</div><div>使用strace &nbsp;跟踪执行create extension dblink时的输出.</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >[root@eyar1 postgres]# strace -p 6229</font></div><div><font size="2"  >Process 6229 attached - interrupt to quit</font></div><div><font size="2"  >recv(7, "Q\0\0\0\35create extension dblink;\0", 8192, 0) = 30</font></div><div><font size="2"  >gettimeofday({1335439618, 727243}, NULL) = 0</font></div><div><font size="2"  >open("/home/postgres/share/extension/dblink.control", O_RDONLY|O_LARGEFILE) = 8</font></div><div><font size="2"  >fstat64(8, {st_mode=S_IFREG|0644, st_size=170, ...}) = 0</font></div><div><font size="2"  >mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7fb0000</font></div><div><font size="2"  >read(8, "# dblink extension\ncomment = 'co"..., 8192) = 170</font></div><div><font size="2"  >read(8, "", 4096) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >read(8, "", 8192) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >close(8) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >munmap(0xb7fb0000, 4096) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >open("/home/postgres/share/extension/dblink--1.0.control", O_RDONLY|O_LARGEFILE) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >mmap2(NULL, 266240, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb5070000</font></div><div><font size="2"  >open("base/12698/12626_fsm", O_RDWR|O_LARGEFILE) = 8</font></div><div><font size="2"  >_llseek(8, 0, [24576], SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >open("base/12698/12566_fsm", O_RDWR|O_LARGEFILE) = 9</font></div><div><font size="2"  >_llseek(9, 0, [24576], SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >open("base/12698/12542_fsm", O_RDWR|O_LARGEFILE) = 10</font></div><div><font size="2"  >_llseek(10, 0, [24576], SEEK_END) &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >stat64("/home/postgres/share/extension/dblink--1.0.sql", {st_mode=S_IFREG|0644, st_size=5569, ...}) = 0</font></div><div><font size="2"  >open("/home/postgres/share/extension/dblink--1.0.sql", O_RDONLY|O_LARGEFILE) = 11</font></div><div><font size="2"  >fstat64(11, {st_mode=S_IFREG|0644, st_size=5569, ...}) = 0</font></div><div><font size="2"  >mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7fb0000</font></div><div><font size="2"  >_llseek(11, 0, [0], SEEK_SET) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >read(11, "/* contrib/dblink/dblink--1.0.sq"..., 4096) = 4096</font></div><div><font size="2"  >read(11, "_build_sql_update (text, int2vec"..., 4096) = 1473</font></div><div><font size="2"  >close(11) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >munmap(0xb7fb0000, 4096) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >brk(0x9fe8000) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0x9fe8000</font></div><div><font size="2"  >open("base/12698/12457_fsm", O_RDWR|O_LARGEFILE) = 11</font></div><div><font size="2"  >_llseek(11, 0, [24576], SEEK_END) &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >open("base/12698/12457", O_RDWR|O_LARGEFILE) = 12</font></div><div><font size="2"  >_llseek(12, 0, [475136], SEEK_END) &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >stat64("/home/postgres/lib/dblink", 0xbfa55d54) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat64("/home/postgres/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=42286, ...}) = 0</font></div><div><font size="2"  >stat64("/home/postgres/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=42286, ...}) = 0</font></div><div><font size="2"  >open("/home/postgres/lib/dblink.so", O_RDONLY) = 13</font></div><div><font size="2"  >read(13, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0000\"\0\0004\0\0\0"..., 512) = 512</font></div><div><font size="2"  >fstat64(13, {st_mode=S_IFREG|0755, st_size=42286, ...}) = 0</font></div><div><font size="2"  >mmap2(NULL, 36500, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 13, 0) = 0x164000</font></div><div><font size="2"  >mmap2(0x16c000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 13, 0x7) = 0x16c000</font></div><div><font size="2"  >close(13) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >open("/home/postgres/lib/libpq.so.4", O_RDONLY) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >open("/home/postgres/lib/libpq.so.4", O_RDONLY) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >open("/etc/ld.so.cache", O_RDONLY) &nbsp; &nbsp; &nbsp;= 13</font></div><div><font size="2"  >fstat64(13, {st_mode=S_IFREG|0644, st_size=44694, ...}) = 0</font></div><div><font size="2"  >mmap2(NULL, 44694, PROT_READ, MAP_PRIVATE, 13, 0) = 0xb7fa6000</font></div><div><font size="2"  >close(13) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >open("/usr/lib/libpq.so.4", O_RDONLY) &nbsp; = 13</font></div><div><font size="2"  >read(13, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\200)P\0004\0\0\0"..., 512) = 512</font></div><div><font size="2"  >fstat64(13, {st_mode=S_IFREG|0755, st_size=133996, ...}) = 0</font></div><div><font size="2"  >mmap2(0x4fd000, 134932, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 13, 0) = 0x4fd000</font></div><div><font size="2"  >mmap2(0x51d000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 13, 0x1f) = 0x51d000</font></div><div><font size="2"  >close(13) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >open("/home/postgres/lib/libnsl.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >open("/lib/libnsl.so.1", O_RDONLY) &nbsp; &nbsp; &nbsp;= 13</font></div><div><font size="2"  >read(13, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0@\1\221\0004\0\0\0"..., 512) = 512</font></div><div><font size="2"  >fstat64(13, {st_mode=S_IFREG|0755, st_size=109740, ...}) = 0</font></div><div><font size="2"  >mmap2(0x90d000, 100296, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 13, 0) = 0x90d000</font></div><div><font size="2"  >mmap2(0x922000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 13, 0x14) = 0x922000</font></div><div><font size="2"  >mmap2(0x924000, 6088, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x924000</font></div><div><font size="2"  >close(13) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >open("/home/postgres/lib/libpthread.so.0", O_RDONLY) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >open("/lib/libpthread.so.0", O_RDONLY) &nbsp;= 13</font></div><div><font size="2"  >read(13, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0pxv\0004\0\0\0"..., 512) = 512</font></div><div><font size="2"  >fstat64(13, {st_mode=S_IFREG|0755, st_size=137944, ...}) = 0</font></div><div><font size="2"  >mmap2(0x763000, 102884, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 13, 0) = 0x16d000</font></div><div><font size="2"  >mprotect(0x182000, 4096, PROT_NONE) &nbsp; &nbsp; = 0</font></div><div><font size="2"  >mmap2(0x183000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 13, 0x15) = 0x183000</font></div><div><font size="2"  >mmap2(0x185000, 4580, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x185000</font></div><div><font size="2"  >close(13) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >mprotect(0x183000, 4096, PROT_READ) &nbsp; &nbsp; = 0</font></div><div><font size="2"  >mprotect(0x922000, 4096, PROT_READ) &nbsp; &nbsp; = 0</font></div><div><font size="2"  >munmap(0xb7fa6000, 44694) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >munmap(0x164000, 36500) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >munmap(0x4fd000, 134932) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >munmap(0x90d000, 100296) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0</font></div><div><font size="2"  >write(2, "ERROR: &nbsp;could not load library \""..., 173) = 173</font></div><div><font size="2"  >send(7, "E\0\0\0\271SERROR\0C58P01\0Mcould not lo"..., 186, 0) = 186</font></div><div><font size="2"  >gettimeofday({1335439618, 737869}, NULL) = 0</font></div><div><font size="2"  >send(6, "\2\0\0\0\234\3\0\0\2321\0\0\t\0\0\0\0\0\0\0\1\0\0\0\353\4\0\0\0\0\0\0"..., 924, 0) = 924</font></div><div><font size="2"  >send(6, "\2\0\0\0\234\3\0\0\2321\0\0\t\0\0\0\0\0\0\0\0\0\0\0+\n\0\0\0\0\0\0"..., 924, 0) = 924</font></div><div><font size="2"  >send(6, "\2\0\0\0\234\3\0\0\2321\0\0\t\0\0\0\0\0\0\0\0\0\0\0q\n\0\0\0\0\0\0"..., 924, 0) = 924</font></div><div><font size="2"  >send(6, "\2\0\0\0D\1\0\0\2321\0\0\3\0\0\0\0\0\0\0\0\0\0\0\203\n\0\0\1\0\0\0"..., 324, 0) = 324</font></div><div><font size="2"  >send(6, "\2\0\0\0\340\0\0\0\0\0\0\0\2\0\0\0\0\0\0\0\0\0\0\0\276\4\0\0\0\0\0\0"..., 224, 0) = 224</font></div><div><font size="2"  >send(7, "Z\0\0\0\5I", 6, 0) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 6</font></div><div><font size="2"  >recv(7,&nbsp;</font></div><p></p></pre></div><div><br></div><div><br></div><div>一个正常的执行create extension dblink的输出:</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >recvfrom(7, "Q\0\0\0\35create extension dblink;\0", 8192, 0, NULL, NULL) = 30</font></div><div><font size="2"  >write(2, "\0\0\300\0\30m\0\0T2012-04-26 19:25:02.199"..., 201) = 201</font></div><div><font size="2"  >open("/opt/pgsql/share/extension/dblink.control", O_RDONLY) = 16</font></div><div><font size="2"  >fstat(16, {st_mode=S_IFREG|0644, st_size=170, ...}) = 0</font></div><div><font size="2"  >mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2af1c7f4b000</font></div><div><font size="2"  >read(16, "# dblink extension\ncomment = 'co"..., 8192) = 170</font></div><div><font size="2"  >read(16, "", 4096) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >read(16, "", 8192) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >close(16) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >munmap(0x2af1c7f4b000, 4096) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >open("/opt/pgsql/share/extension/dblink--1.0.control", O_RDONLY) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >open("base/12699/12627_fsm", O_RDWR) &nbsp; &nbsp;= 16</font></div><div><font size="2"  >lseek(16, 0, SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 24576</font></div><div><font size="2"  >open("base/12699/12567_fsm", O_RDWR) &nbsp; &nbsp;= 17</font></div><div><font size="2"  >lseek(17, 0, SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 24576</font></div><div><font size="2"  >open("base/12699/12567", O_RDWR) &nbsp; &nbsp; &nbsp; &nbsp;= 18</font></div><div><font size="2"  >lseek(18, 0, SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 393216</font></div><div><font size="2"  >open("base/12699/12543_fsm", O_RDWR) &nbsp; &nbsp;= 19</font></div><div><font size="2"  >lseek(19, 0, SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 24576</font></div><div><font size="2"  >stat("/opt/pgsql/share/extension/dblink--1.0.sql", {st_mode=S_IFREG|0644, st_size=5569, ...}) = 0</font></div><div><font size="2"  >open("/opt/pgsql/share/extension/dblink--1.0.sql", O_RDONLY) = 20</font></div><div><font size="2"  >fstat(20, {st_mode=S_IFREG|0644, st_size=5569, ...}) = 0</font></div><div><font size="2"  >mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2af1c7f4b000</font></div><div><font size="2"  >lseek(20, 0, SEEK_SET) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >read(20, "/* contrib/dblink/dblink--1.0.sq"..., 4096) = 4096</font></div><div><font size="2"  >read(20, "_build_sql_update (text, int2vec"..., 4096) = 1473</font></div><div><font size="2"  >close(20) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >munmap(0x2af1c7f4b000, 4096) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0</font></div><div><font size="2"  >open("base/12699/12458_fsm", O_RDWR) &nbsp; &nbsp;= 20</font></div><div><font size="2"  >lseek(20, 0, SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 24576</font></div><div><font size="2"  >lseek(8, 0, SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 491520</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >open("/opt/pgsql/lib/dblink.so", O_RDONLY) = 21</font></div><div><font size="2"  >read(21, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0p/\0\0\0\0\0\0"..., 832) = 832</font></div><div><font size="2"  >fstat(21, {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >mmap(NULL, 2133656, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 21, 0) = 0x2af1c7f4b000</font></div><div><font size="2"  >mprotect(0x2af1c7f54000, 2093056, PROT_NONE) = 0</font></div><div><font size="2"  >mmap(0x2af1c8153000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 21, 0x8000) = 0x2af1c8153000</font></div><div><font size="2"  >close(21) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >open("/opt/pgsql/lib/libpq.so.5", O_RDONLY) = 21</font></div><div><font size="2"  >read(21, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\340\203\0\0\0\0\0\0"..., 832) = 832</font></div><div><font size="2"  >fstat(21, {st_mode=S_IFREG|0755, st_size=183796, ...}) = 0</font></div><div><font size="2"  >mmap(NULL, 2254744, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 21, 0) = 0x2af1c8154000</font></div><div><font size="2"  >mprotect(0x2af1c8178000, 2097152, PROT_NONE) = 0</font></div><div><font size="2"  >mmap(0x2af1c8378000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 21, 0x24000) = 0x2af1c8378000</font></div><div><font size="2"  >close(21) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >open("/opt/pgsql/lib/libpthread.so.0", O_RDONLY) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >open("/lib64/libpthread.so.0", O_RDONLY) = 21</font></div><div><font size="2"  >read(21, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\240W `4\0\0\0"..., 832) = 832</font></div><div><font size="2"  >fstat(21, {st_mode=S_IFREG|0755, st_size=145824, ...}) = 0</font></div><div><font size="2"  >mmap(0x3460200000, 2204528, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 21, 0) = 0x3460200000</font></div><div><font size="2"  >mprotect(0x3460216000, 2093056, PROT_NONE) = 0</font></div><div><font size="2"  >mmap(0x3460415000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 21, 0x15000) = 0x3460415000</font></div><div><font size="2"  >mmap(0x3460417000, 13168, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x3460417000</font></div><div><font size="2"  >close(21) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</font></div><div><font size="2"  >mprotect(0x3460415000, 4096, PROT_READ) = 0</font></div><div><font size="2"  >set_tid_address(0x2aec144bf550) &nbsp; &nbsp; &nbsp; &nbsp; = 27928</font></div><div><font size="2"  >set_robust_list(0x2aec144bf560, 0x18) &nbsp; = 0</font></div><div><font size="2"  >futex(0x7fffa39b9d8c, FUTEX_WAKE_PRIVATE, 1) = 0</font></div><div><font size="2"  >rt_sigaction(SIGRTMIN, {0x3460205380, [], SA_RESTORER|SA_SIGINFO, 0x346020eb70}, NULL, 8) = 0</font></div><div><font size="2"  >rt_sigaction(SIGRT_1, {0x34602052b0, [], SA_RESTORER|SA_RESTART|SA_SIGINFO, 0x346020eb70}, NULL, 8) = 0</font></div><div><font size="2"  >rt_sigprocmask(SIG_UNBLOCK, [RTMIN RT_1], NULL, 8) = 0</font></div><div><font size="2"  >getrlimit(RLIMIT_STACK, {rlim_cur=10240*1024, rlim_max=RLIM_INFINITY}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >brk(0x16522000) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0x16522000</font></div><div><font size="2"  >brk(0x16521000) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0x16521000</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >open("base/12699/3952629", O_RDONLY) &nbsp; &nbsp;= -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >open("base/12699/12442_fsm", O_RDWR) &nbsp; &nbsp;= 21</font></div><div><font size="2"  >lseek(21, 0, SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 24576</font></div><div><font size="2"  >open("base/12699/12442", O_RDWR) &nbsp; &nbsp; &nbsp; &nbsp;= 22</font></div><div><font size="2"  >lseek(22, 0, SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 73728</font></div><div><font size="2"  >open("base/12699/12465_fsm", O_RDWR) &nbsp; &nbsp;= 23</font></div><div><font size="2"  >lseek(23, 0, SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 24576</font></div><div><font size="2"  >open("base/12699/12465_vm", O_RDWR) &nbsp; &nbsp; = 24</font></div><div><font size="2"  >lseek(24, 0, SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 8192</font></div><div><font size="2"  >open("base/12699/12446_fsm", O_RDWR) &nbsp; &nbsp;= 25</font></div><div><font size="2"  >lseek(25, 0, SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 24576</font></div><div><font size="2"  >open("base/12699/12446", O_RDWR) &nbsp; &nbsp; &nbsp; &nbsp;= 26</font></div><div><font size="2"  >lseek(26, 0, SEEK_END) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 532480</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink", 0x7fffa39ba290) = -1 ENOENT (No such file or directory)</font></div><div><font size="2"  >stat("/opt/pgsql/lib/dblink.so", {st_mode=S_IFREG|0755, st_size=49174, ...}) = 0</font></div><div><font size="2"  >brk(0x1651b000) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0x1651b000</font></div><div><font size="2"  >brk(0x16501000) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0x16501000</font></div><div><font size="2"  >sendto(6, "\2\0\0\0\300\3\0\0\2331\0\0\t\0\0\0\1\0\0\0\0\0\0\0\7\f\0\0\0\0\0\0"..., 960, 0, NULL, 0) = 960</font></div><div><font size="2"  >sendto(6, "\2\0\0\0\300\3\0\0\2331\0\0\t\0\0\0\0\0\0\0\0\0\0\0\341\4\0\0\0\0\0\0"..., 960, 0, NULL, 0) = 960</font></div><div><font size="2"  >sendto(6, "\2\0\0\0\300\3\0\0\2331\0\0\t\0\0\0\0\0\0\0\0\0\0\0y\n\0\0\0\0\0\0"..., 960, 0, NULL, 0) = 960</font></div><div><font size="2"  >sendto(6, "\2\0\0\0\200\0\0\0\2331\0\0\1\0\0\0\0\0\0\0\0\0\0\0b\n\0\0\0\0\0\0"..., 128, 0, NULL, 0) = 128</font></div><div><font size="2"  >sendto(6, "\2\0\0\0\350\0\0\0\0\0\0\0\2\0\0\0\0\0\0\0\0\0\0\0\276\4\0\0\0\0\0\0"..., 232, 0, NULL, 0) = 232</font></div><div><font size="2"  >sendto(7, "C\0\0\0\25CREATE EXTENSION\0Z\0\0\0\5I", 28, 0, NULL, 0) = 28</font></div><div><font size="2"  >recvfrom(7,&nbsp;</font></div><p></p></pre></div><div><br></div><div>排错过程 :&nbsp;</div><div>1. 检查LD_LIBRARY_PATH中是否包含了$PGHOME/lib</div><div>2. 检查ldconfig是否包含了dblink.so, 没有则加上.</div><div>&nbsp; &nbsp; 但是貌似我在正常的PG系统中ldconfig不包含dblink.so也可行.</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >vi /etc/ld.so.conf</font></div><div><font size="2"  >加入</font></div><div><font size="2"  >/opt/pgsql/lib</font></div><div><font size="2"  >[root@db-172-16-3-150 ~]# ldconfig -f /etc/ld.so.conf<br>[root@db-172-16-3-150 ~]# ldconfig -p|grep libpq<br>        libpqwalreceiver.so (libc6,x86-64) =&gt; /opt/pgsql/lib/libpqwalreceiver.so<br>        libpq.so.5 (libc6,x86-64) =&gt; /opt/pgsql/lib/libpq.so.5<br>        libpq.so.4 (libc6,x86-64) =&gt; /usr/lib64/libpq.so.4<br>        libpq.so.4 (libc6) =&gt; /usr/lib/libpq.so.4<br>        libpq.so (libc6,x86-64) =&gt; /opt/pgsql/lib/libpq.so<br>[root@db-172-16-3-150 ~]# ldconfig -p|grep dblink</font></div><div><font size="2"  >不能加载dblink.so</font></div><p></p></pre></div><div>3. 检查dblink.so的依赖.</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >[root@db-172-16-3-150 lib]# ldd /opt/pgsql/lib/dblink.so</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; linux-vdso.so.1 =&gt; &nbsp;(0x00007fffb1dfd000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libpq.so.5 =&gt; /opt/pgsql/lib/libpq.so.5 (0x00002ac8adb0a000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libc.so.6 =&gt; /lib64/libc.so.6 (0x00002ac8add4a000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libssl.so.6 =&gt; /lib64/libssl.so.6 (0x00002ac8ae0a2000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libcrypto.so.6 =&gt; /lib64/libcrypto.so.6 (0x00002ac8ae2ee000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libcrypt.so.1 =&gt; /lib64/libcrypt.so.1 (0x00002ac8ae640000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00002ac8ae878000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; /lib64/ld-linux-x86-64.so.2 (0x000000345f600000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libgssapi_krb5.so.2 =&gt; /usr/lib64/libgssapi_krb5.so.2 (0x00002ac8aea93000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libkrb5.so.3 =&gt; /usr/lib64/libkrb5.so.3 (0x00002ac8aecc2000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libcom_err.so.2 =&gt; /lib64/libcom_err.so.2 (0x00002ac8aef57000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libk5crypto.so.3 =&gt; /usr/lib64/libk5crypto.so.3 (0x00002ac8af159000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libdl.so.2 =&gt; /lib64/libdl.so.2 (0x00002ac8af37f000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libz.so.1 =&gt; /lib64/libz.so.1 (0x00002ac8af583000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libkrb5support.so.0 =&gt; /usr/lib64/libkrb5support.so.0 (0x00002ac8af797000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libkeyutils.so.1 =&gt; /lib64/libkeyutils.so.1 (0x00002ac8af9a0000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libresolv.so.2 =&gt; /lib64/libresolv.so.2 (0x00002ac8afba2000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libselinux.so.1 =&gt; /lib64/libselinux.so.1 (0x00002ac8afdb8000)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; libsepol.so.1 =&gt; /lib64/libsepol.so.1 (0x00002ac8affd0000)</font></div><p></p></pre></div><div>它依赖了libpq.so.5这个so文件.</div><div>所以我在想会不会是这个文件的问题,</div><div>以下是我在PostgreSQL 9.2devel中使用PostgreSQL 9.1.3的libpq.so.5.4替换9.2中的libpq.so.5.5</div><div>替换后我在PostgreSQL 9.2中创建dblink extension 则报类似错误如下 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >pg92@db-172-16-3-150-&gt; psql -h 127.0.0.1 postgres pg92</font></div><div><font size="2"  >psql (9.2devel)</font></div><div><font size="2"  >Type "help" for help.</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >postgres=# create extension dblink;</font></div><div><font size="2"  >ERROR: &nbsp;could not load library "/opt/pgsql92/lib/dblink.so": /opt/pgsql92/lib/dblink.so: undefined symbol: PQskipResult</font></div><p></p></pre></div><div><br></div><div>然后我用PostgreSQL 9.2 devel中的libpq.so.5.5 替换PostgreSQL 9.1.3中的libpq.so.5.4</div><div>连到PostgreSQL 9.1.3去创建dblink extension则正常.</div><div><br></div><div>貌似高版本的libpq.so文件向下兼容, 而高版本的PostgreSQL在使用低版本的libpq.so时则有些问题.</div><div><br></div><div>从上面的测试可用推测<span style="line-height: 22px;"  >undefined symbol: PQconnectionUsedPassword可能是由于libpq.so的版本不匹配造成的.</span></div><div><span style="line-height: 22px;"  >至于为什么不匹配可能和他们的安装有莫大关系, 据说源码文件编译后又换过目录, 还修改过文件, 不知道有没有替换过什么文件, 找这种错误.</span></div><div><br></div><br><wbr></div></div>
	</div>
</div>
</body>
</html>