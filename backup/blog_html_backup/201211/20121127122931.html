<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">OCZ pci-e revodrive3 240GB & DELL SSD 2.5 SATA 200GB & SAS 2.5 146GB 10K</h2>
	<h5 id="">2012-11-27 12:29:31&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201210279569426/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>本文主要目的是测试三种硬盘的PostgreSQL的select, update, insert性能, 反映这三种硬盘的IOPS能力.</div><div>这三种硬盘分别是 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >1. OCZ RevoDrive3&nbsp;<span style="line-height: 22px;"  >PCI-E</span><span style="line-height: 22px;"  >&nbsp;</span>240GB</font></div><div><font size="2"  >2. DELL SSD 2.5寸 SATA 200GB</font></div><div><font size="2"  >3. DELL 10K转 2.5寸 SAS 146GB</font></div><p></p></pre></div><div>同插在一台DELL R610的服务器上.</div><div>OCZ硬盘使用请参见 :&nbsp;</div><div><a target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402012102613815282/"  >http://blog.163.com/digoal@126/blog/static/1638770402012102613815282/</a></div><div><br></div><div>测试环境 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >CentOS 5.7 x64</font></div><div><font size="2"  >PostgreSQL 9.2.1</font></div><p></p></pre></div><div>编译参数 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >./configure --prefix=/home/ocz/pgsql9.2.1 --with-pgport=9201 --with-perl --with-python --with-tcl --with-openssl --with-pam --without-ldap --with-libxml --with-libxslt --enable-thread-safety --with-wal-blocksize=16 --enable-debug --with-ossp-uuid --with-libs=/opt/uuid-1.6.2/lib</font></div><div></div><p></p></pre></div><div>配置文件 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >ocz@db-172-16-3-150-&gt; cat postgresql.conf|grep -i "^\ *[a-z]"</font></div><div><font size="2"  >listen_addresses = '0.0.0.0' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# what IP address(es) to listen on;</font></div><div><font size="2"  >port = 9201 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # (change requires restart)</font></div><div><font size="2"  >max_connections = 1000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# (change requires restart)</font></div><div><font size="2"  >superuser_reserved_connections = 13 &nbsp; &nbsp; # (change requires restart)</font></div><div><font size="2"  >unix_socket_directory = '.' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # (change requires restart)</font></div><div><font size="2"  >unix_socket_permissions = 0700 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# begin with 0 to use octal notation</font></div><div><font size="2"  >tcp_keepalives_idle = 60 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# TCP_KEEPIDLE, in seconds;</font></div><div><font size="2"  >tcp_keepalives_interval = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# TCP_KEEPINTVL, in seconds;</font></div><div><font size="2"  >tcp_keepalives_count = 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # TCP_KEEPCNT;</font></div><div><font size="2"  >shared_buffers = 1024MB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # min 128kB</font></div><div><font size="2"  >maintenance_work_mem = 512MB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# min 1MB</font></div><div><font size="2"  >max_stack_depth = 8MB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # min 100kB</font></div><div><font size="2"  >shared_preload_libraries = 'pg_stat_statements' &nbsp; &nbsp; &nbsp; &nbsp; # (change requires restart)</font></div><div><font size="2"  >bgwriter_delay = 10ms &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 10-10000ms between rounds</font></div><div><font size="2"  >wal_level = hot_standby &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # minimal, archive, or hot_standby</font></div><div><font size="2"  >fsync = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# turns forced synchronization on or off</font></div><div><font size="2"  >synchronous_commit = on &nbsp; &nbsp; &nbsp; &nbsp; # synchronization level;</font></div><div><font size="2"  >wal_sync_method = open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # the default is the first option</font></div><div><font size="2"  >full_page_writes = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # recover from partial page writes</font></div><div><font size="2"  >wal_buffers = 16384kB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # min 32kB, -1 sets based on shared_buffers</font></div><div><font size="2"  >checkpoint_segments = 128 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # in logfile segments, min 1, 16MB each</font></div><div><font size="2"  >archive_mode = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # allows archiving to be done</font></div><div><font size="2"  >archive_command = '/bin/date' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # command to use to archive a logfile segment</font></div><div><font size="2"  >max_wal_senders = 32 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# max number of walsender processes</font></div><div><font size="2"  >wal_keep_segments = 256 &nbsp; &nbsp; &nbsp; &nbsp; # in logfile segments, 16MB each; 0 disables</font></div><div><font size="2"  >hot_standby = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# "on" allows queries during recovery</font></div><div><font size="2"  >wal_receiver_status_interval = 1s &nbsp; &nbsp; &nbsp; # send replies at least this often</font></div><div><font size="2"  >hot_standby_feedback = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # send info from standby to prevent</font></div><div><font size="2"  >random_page_cost = 1.0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# same scale as above</font></div><div><font size="2"  >effective_cache_size = 90000MB</font></div><div><font size="2"  >log_destination = 'csvlog' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Valid values are combinations of</font></div><div><font size="2"  >logging_collector = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Enable capturing of stderr and csvlog</font></div><div><font size="2"  >log_directory = 'pg_log' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# directory where log files are written,</font></div><div><font size="2"  >log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log' # log file name pattern,</font></div><div><font size="2"  >log_file_mode = 0600 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# creation mode for log files,</font></div><div><font size="2"  >log_truncate_on_rotation = on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # If on, an existing log file with the</font></div><div><font size="2"  >log_rotation_age = 1d &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Automatic rotation of logfiles will</font></div><div><font size="2"  >log_rotation_size = 10MB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Automatic rotation of logfiles will</font></div><div><font size="2"  >log_checkpoints = on</font></div><div><font size="2"  >log_error_verbosity = verbose &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # terse, default, or verbose messages</font></div><div><font size="2"  >log_timezone = 'PRC'</font></div><div><font size="2"  >datestyle = 'iso, mdy'</font></div><div><font size="2"  >timezone = 'PRC'</font></div><div><font size="2"  >lc_messages = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # locale for system error message</font></div><div><font size="2"  >lc_monetary = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # locale for monetary formatting</font></div><div><font size="2"  >lc_numeric = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# locale for number formatting</font></div><div><font size="2"  >lc_time = 'C' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # locale for time formatting</font></div><div><font size="2"  >default_text_search_config = 'pg_catalog.english'</font></div><div><font size="2"  >pg_stat_statements.max = 1000</font></div><div><font size="2"  >pg_stat_statements.track = all</font></div><p></p></pre></div><div><br></div>测试表 :&nbsp;<div><pre class="prettyprint"  ><p><font size="2"  >digoal=&gt; create table ocz_test(id int, info text, crt_time timestamp without time zone);</font></p></pre><div><br><div>测试数据 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >digoal=&gt; insert into ocz_test select generate_series(1,10000000),repeat(clock_timestamp()::text, 10),clock_timestamp();</font></div><div><font size="2"  >digoal=&gt; alter table ocz_test add constraint ocz_test_pkey primary key (id);</font></div><p></p></pre></div><div><br></div><div>测试函数 :&nbsp;</div><div>测试读取,写入,更新.</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >digoal=&gt; create or replace function f_ocz_test (i_id int) returns void as $BODY$</font></div><div><font size="2"  >declare</font></div><div><font size="2"  >begin</font></div><div><font size="2"  >perform 1 from ocz_test where id=i_id;</font></div><div><font size="2"  >if not found then</font></div><div><font size="2"  >&nbsp; insert into ocz_test (id, info, crt_time) values (i_id, repeat(clock_timestamp()::text, 10), clock_timestamp());</font></div><div><font size="2"  >else</font></div><div><font size="2"  >&nbsp; update ocz_test set info=repeat(clock_timestamp()::text, 10), crt_time=clock_timestamp() where id=i_id;</font></div><div><font size="2"  >end if;</font></div><div><font size="2"  >return;</font></div><div><font size="2"  >exception</font></div><div><font size="2"  >&nbsp; when others then</font></div><div><font size="2"  >&nbsp; &nbsp; return;</font></div><div><font size="2"  >end;</font></div><div><font size="2"  >$BODY$ language plpgsql;</font></div><p></p></pre></div><div><br></div><div>测试脚本 :&nbsp;</div><div>随即取数1到1亿, 超过基础数据, 所以有1/10的机会update, 9/10的机会insert, 100%的机会select.</div><div><pre class="prettyprint"  ><p></p><div><div><font size="2"  >ocz@db-172-16-3-150-&gt; cat ocz_test.sql&nbsp;</font></div><div><font size="2"  >\setrandom id 1 100000000</font></div><div><font size="2"  >select f_ocz_test(:id);</font></div></div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pgbench -M prepared -n -f ./ocz_test.sql -r -c 8 -j 8 -T 60 -U digoal digoal</font></div><p></p></pre></div><div><br></div><div>测试方法 :&nbsp;</div><div>关闭RAID write cache, 关闭OCZ write cache. 开启同步提交. 确保测试得出的数据真实的反映硬盘的IO能力.</div><div>关闭DELL 服务器上带的raid卡的写cache, 使用 write through :&nbsp;</div><div><div><img title="OCZ pci-e revodrive3 240GB  DELL SSD 2.5 sata-2 200GB  SAS 2.5 146GB 10K - 德哥@Digoal - The Heart,The World."  alt="OCZ pci-e revodrive3 240GB  DELL SSD 2.5 sata-2 200GB  SAS 2.5 146GB 10K - 德哥@Digoal - The Heart,The World."  style="margin:0 10px 0 0;"  src="http://img7.ph.126.net/ip8XuGN3khcm66ic2Q1qyg==/6597898798423956277.jpg"  ></div>&nbsp;</div><div>关闭OCZ 硬盘的写cache.</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >[root@db-172-16-3-150 ~]# hdparm -W 0 /dev/mapper/mpath1</font></div><div><font size="2"  >/dev/mapper/mpath1:</font></div><div><font size="2"  >&nbsp;setting drive write-caching to 0 (off)</font></div><p></p></pre></div><div>OCZ SSD测试结果 :&nbsp;</div><div>1.&nbsp;<span style="line-height: 22px;"  >fdatasync</span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >wal_sync_method :&nbsp;</font></div><div><font size="2"  >wal_level = hot_standby</font></div><div><font size="2"  >fsync = on</font></div><div><font size="2"  >synchronous_commit = on</font></div><div><font size="2"  >wal_sync_method = fdatasync</font></div><div><font size="2"  ><br></font></div><div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl stop -m fast</font></div><div><font size="2"  >waiting for server to shut down..... done</font></div><div><font size="2"  >server stopped</font></div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl start</font></div><div><font size="2"  >server starting</font></div><div><font size="2"  >ocz@db-172-16-3-150-&gt; LOG: &nbsp;00000: loaded library "pg_stat_statements"</font></div><div><font size="2"  >LOCATION: &nbsp;load_libraries, miscinit.c:1249</font></div></div><div><font size="2"  ><br></font></div><div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pgbench -M prepared -n -f ./ocz_test.sql -r -c 8 -j 8 -T 60 -U digoal digoal</font></div><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 8</font></div><div><font size="2"  >number of threads: 8</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 867098</font></div><div><font size="2"  >tps = 14450.950285 (including connections establishing)</font></div><div><font size="2"  >tps = 14452.524843 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.002270 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom id 1 100000000</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.548933 &nbsp; &nbsp; &nbsp; &nbsp;select f_ocz_test(:id);</font></div></div><p></p></pre></div><div>2. fsync</div><div><div style="line-height: 22px;"  ><pre class="prettyprint"  ><p></p><div><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method :&nbsp;</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_level = hot_standby</font></div><div style="line-height: 22px;"  ><font size="2"  >fsync = on</font></div><div style="line-height: 22px;"  ><font size="2"  >synchronous_commit = on</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method = fsync</font></div></div><div style="line-height: 22px;"  ><font size="2"  ><br></font></div><div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl stop -m fast</font></div><div><font size="2"  >waiting for server to shut down..... done</font></div><div><font size="2"  >server stopped</font></div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl start</font></div><div><font size="2"  >server starting</font></div><div><font size="2"  >ocz@db-172-16-3-150-&gt; LOG: &nbsp;00000: loaded library "pg_stat_statements"</font></div><div><font size="2"  >LOCATION: &nbsp;load_libraries, miscinit.c:1249</font></div></div><div style="line-height: 22px;"  ><font size="2"  ><br></font></div><div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pgbench -M prepared -n -f ./ocz_test.sql -r -c 8 -j 8 -T 60 -U digoal digoal</font></div><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 8</font></div><div><font size="2"  >number of threads: 8</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 63334</font></div><div><font size="2"  >tps = 1055.390434 (including connections establishing)</font></div><div><font size="2"  >tps = 1055.525152 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.003106 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom id 1 100000000</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 7.572679 &nbsp; &nbsp; &nbsp; &nbsp;select f_ocz_test(:id);</font></div></div><p></p></pre></div></div><div>3. open_sync</div><div><div style="line-height: 22px;"  ><pre class="prettyprint"  ><p></p><div><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method :&nbsp;</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_level = hot_standby</font></div><div style="line-height: 22px;"  ><font size="2"  >fsync = on</font></div><div style="line-height: 22px;"  ><font size="2"  >synchronous_commit = on</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method = open_sync</font></div></div><div style="line-height: 22px;"  ><font size="2"  ><br></font></div><div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl stop -m fast</font></div><div><font size="2"  >waiting for server to shut down..... done</font></div><div><font size="2"  >server stopped</font></div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl start</font></div><div><font size="2"  >server starting</font></div><div><font size="2"  >ocz@db-172-16-3-150-&gt; LOG: &nbsp;00000: loaded library "pg_stat_statements"</font></div><div><font size="2"  >LOCATION: &nbsp;load_libraries, miscinit.c:1249</font></div></div><div><font size="2"  ><br></font></div><div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pgbench -M prepared -n -f ./ocz_test.sql -r -c 8 -j 8 -T 60 -U digoal digoal</font></div><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 8</font></div><div><font size="2"  >number of threads: 8</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 864942</font></div><div><font size="2"  >tps = 14410.387611 (including connections establishing)</font></div><div><font size="2"  >tps = 14412.032858 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.002245 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom id 1 100000000</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.550355 &nbsp; &nbsp; &nbsp; &nbsp;select f_ocz_test(:id);</font></div></div><p></p></pre></div></div><div>DELL SSD 2.5寸 SATA接口 200GB硬盘 :&nbsp;</div><div>数据目录和表空间目录移到DELL SSD硬盘后测试 :&nbsp;</div><div>1. fdatasync</div><div><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><pre class="prettyprint"  ><p></p><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method :&nbsp;</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_level = hot_standby</font></div><div style="line-height: 22px;"  ><font size="2"  >fsync = on</font></div><div style="line-height: 22px;"  ><font size="2"  >synchronous_commit = on</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method = fdatasync</font></div></div><div style="line-height: 22px;"  ><font size="2"  ><br style="line-height: 22px;"  ></font></div><div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl stop -m fast</font></div><div style="line-height: 22px;"  ><font size="2"  >waiting for server to shut down..... done</font></div><div style="line-height: 22px;"  ><font size="2"  >server stopped</font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl start</font></div><div style="line-height: 22px;"  ><font size="2"  >server starting</font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; LOG: &nbsp;00000: loaded library "pg_stat_statements"</font></div><div style="line-height: 22px;"  ><font size="2"  >LOCATION: &nbsp;load_libraries, miscinit.c:1249</font></div><div style="line-height: 22px;"  ><font size="2"  ><br></font></div><div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pgbench -M prepared -n -f ./ocz_test.sql -r -c 8 -j 8 -T 60 -U digoal digoal</font></div><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 8</font></div><div><font size="2"  >number of threads: 8</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 41067</font></div><div><font size="2"  >tps = 684.307504 (including connections establishing)</font></div><div><font size="2"  >tps = 684.386309 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.003403 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom id 1 100000000</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 11.681978 &nbsp; &nbsp; &nbsp; select f_ocz_test(:id);</font></div></div></div><p></p></pre></div></div><div><div style="line-height: 22px;"  >2. fsync</div></div></div><div><div style="line-height: 22px;"  ><pre class="prettyprint"  ><p></p><div><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method :&nbsp;</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_level = hot_standby</font></div><div style="line-height: 22px;"  ><font size="2"  >fsync = on</font></div><div style="line-height: 22px;"  ><font size="2"  >synchronous_commit = on</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method = fsync</font></div></div><div style="line-height: 22px;"  ><font size="2"  ><br></font></div><div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl stop -m fast</font></div><div style="line-height: 22px;"  ><font size="2"  >waiting for server to shut down..... done</font></div><div style="line-height: 22px;"  ><font size="2"  >server stopped</font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl start</font></div><div style="line-height: 22px;"  ><font size="2"  >server starting</font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; LOG: &nbsp;00000: loaded library "pg_stat_statements"</font></div><div style="line-height: 22px;"  ><font size="2"  >LOCATION: &nbsp;load_libraries, miscinit.c:1249</font></div><div style="line-height: 22px;"  ><font size="2"  ><br></font></div><div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pgbench -M prepared -n -f ./ocz_test.sql -r -c 8 -j 8 -T 60 -U digoal digoal</font></div><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 8</font></div><div><font size="2"  >number of threads: 8</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 40289</font></div><div><font size="2"  >tps = 671.344007 (including connections establishing)</font></div><div><font size="2"  >tps = 671.420270 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.003300 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom id 1 100000000</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 11.907794 &nbsp; &nbsp; &nbsp; select f_ocz_test(:id);</font></div></div></div><p></p></pre></div></div><div>3. open_sync</div><div><div style="line-height: 22px;"  ><pre class="prettyprint"  ><p></p><div><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method :&nbsp;</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_level = hot_standby</font></div><div style="line-height: 22px;"  ><font size="2"  >fsync = on</font></div><div style="line-height: 22px;"  ><font size="2"  >synchronous_commit = on</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method = open_sync</font></div></div><div style="line-height: 22px;"  ><font size="2"  ><br></font></div><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl stop -m fast</font></div><div style="line-height: 22px;"  ><font size="2"  >waiting for server to shut down..... done</font></div><div style="line-height: 22px;"  ><font size="2"  >server stopped</font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl start</font></div><div style="line-height: 22px;"  ><font size="2"  >server starting</font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; LOG: &nbsp;00000: loaded library "pg_stat_statements"</font></div><div style="line-height: 22px;"  ><font size="2"  >LOCATION: &nbsp;load_libraries, miscinit.c:1249</font></div></div><div style="line-height: 22px;"  ><font size="2"  ><br></font></div><div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pgbench -M prepared -n -f ./ocz_test.sql -r -c 8 -j 8 -T 60 -U digoal digoal</font></div><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 8</font></div><div><font size="2"  >number of threads: 8</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 41235</font></div><div><font size="2"  >tps = 687.096892 (including connections establishing)</font></div><div><font size="2"  >tps = 687.180406 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.003390 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom id 1 100000000</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 11.634480 &nbsp; &nbsp; &nbsp; select f_ocz_test(:id);</font></div></div><p></p></pre></div></div><div><span style="line-height: 22px;"  >DELL SAS 2.5寸 SAS接口 146GB 10K转速 机械硬盘 :&nbsp;</span></div></div></div><div><div style="line-height: 22px;"  >数据目录和表空间目录移到DELL 机械硬盘后测试 :&nbsp;</div></div><div style="line-height: 22px;"  >1.fdatasync</div><div><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><pre class="prettyprint"  ><p></p><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method :&nbsp;</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_level = hot_standby</font></div><div style="line-height: 22px;"  ><font size="2"  >fsync = on</font></div><div style="line-height: 22px;"  ><font size="2"  >synchronous_commit = on</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method = fdatasync</font></div></div><div style="line-height: 22px;"  ><font size="2"  ><br style="line-height: 22px;"  ></font></div><div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl stop -m fast</font></div><div style="line-height: 22px;"  ><font size="2"  >waiting for server to shut down..... done</font></div><div style="line-height: 22px;"  ><font size="2"  >server stopped</font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl start</font></div><div style="line-height: 22px;"  ><font size="2"  >server starting</font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; LOG: &nbsp;00000: loaded library "pg_stat_statements"</font></div><div style="line-height: 22px;"  ><font size="2"  >LOCATION: &nbsp;load_libraries, miscinit.c:1249</font></div><div style="line-height: 22px;"  ><font size="2"  ><br></font></div><div><div><font size="2"  >ocz@db-172-16-3-150-&gt; pgbench -M prepared -n -f ./ocz_test.sql -r -c 8 -j 8 -T 60 -U digoal digoal</font></div><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 8</font></div><div><font size="2"  >number of threads: 8</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 37679</font></div><div><font size="2"  >tps = 627.889642 (including connections establishing)</font></div><div><font size="2"  >tps = 627.951509 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.003394 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom id 1 100000000</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 12.732292 &nbsp; &nbsp; &nbsp; select f_ocz_test(:id);</font></div></div></div><p></p></pre></div></div><div><div style="line-height: 22px;"  >2. fsync</div></div></div><div><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><pre class="prettyprint"  ><p></p><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method :&nbsp;</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_level = hot_standby</font></div><div style="line-height: 22px;"  ><font size="2"  >fsync = on</font></div><div style="line-height: 22px;"  ><font size="2"  >synchronous_commit = on</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method = fsync</font></div></div><div style="line-height: 22px;"  ><font size="2"  ><br style="line-height: 22px;"  ></font></div><div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl stop -m fast</font></div><div style="line-height: 22px;"  ><font size="2"  >waiting for server to shut down..... done</font></div><div style="line-height: 22px;"  ><font size="2"  >server stopped</font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl start</font></div><div style="line-height: 22px;"  ><font size="2"  >server starting</font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; LOG: &nbsp;00000: loaded library "pg_stat_statements"</font></div><div style="line-height: 22px;"  ><font size="2"  >LOCATION: &nbsp;load_libraries, miscinit.c:1249</font></div><div style="line-height: 22px;"  ><font size="2"  ><br></font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pgbench -M prepared -n -f ./ocz_test.sql -r -c 8 -j 8 -T 60 -U digoal digoal</font></div><div><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 8</font></div><div><font size="2"  >number of threads: 8</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 9831</font></div><div><font size="2"  >tps = 163.736413 (including connections establishing)</font></div><div><font size="2"  >tps = 163.759836 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.003614 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom id 1 100000000</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 48.832661 &nbsp; &nbsp; &nbsp; select f_ocz_test(:id);</font></div></div></div><p></p></pre></div></div><div><div style="line-height: 22px;"  >3. open_sync</div><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><pre class="prettyprint"  ><p></p><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method :&nbsp;</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_level = hot_standby</font></div><div style="line-height: 22px;"  ><font size="2"  >fsync = on</font></div><div style="line-height: 22px;"  ><font size="2"  >synchronous_commit = on</font></div><div style="line-height: 22px;"  ><font size="2"  >wal_sync_method = open_sync</font></div></div><div style="line-height: 22px;"  ><font size="2"  ><br style="line-height: 22px;"  ></font></div><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl stop -m fast</font></div><div style="line-height: 22px;"  ><font size="2"  >waiting for server to shut down..... done</font></div><div style="line-height: 22px;"  ><font size="2"  >server stopped</font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pg_ctl start</font></div><div style="line-height: 22px;"  ><font size="2"  >server starting</font></div><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; LOG: &nbsp;00000: loaded library "pg_stat_statements"</font></div><div style="line-height: 22px;"  ><font size="2"  >LOCATION: &nbsp;load_libraries, miscinit.c:1249</font></div><div style="line-height: 22px;"  ><font size="2"  ><br></font></div><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><font size="2"  >ocz@db-172-16-3-150-&gt; pgbench -M prepared -n -f ./ocz_test.sql -r -c 8 -j 8 -T 60 -U digoal digoal</font></div><div style="line-height: 22px;"  ><font size="2"  >transaction type: Custom query</font></div><div style="line-height: 22px;"  ><font size="2"  >scaling factor: 1</font></div><div style="line-height: 22px;"  ><font size="2"  >query mode: prepared</font></div><div style="line-height: 22px;"  ><font size="2"  >number of clients: 8</font></div><div style="line-height: 22px;"  ><font size="2"  >number of threads: 8</font></div><div style="line-height: 22px;"  ><font size="2"  >duration: 60 s</font></div><div style="line-height: 22px;"  ><font size="2"  >number of transactions actually processed: 37707</font></div><div style="line-height: 22px;"  ><font size="2"  >tps = 628.375098 (including connections establishing)</font></div><div style="line-height: 22px;"  ><font size="2"  >tps = 628.435232 (excluding connections establishing)</font></div><div style="line-height: 22px;"  ><font size="2"  >statement latencies in milliseconds:</font></div><div style="line-height: 22px;"  ><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.003443 &nbsp; &nbsp; &nbsp; &nbsp;\setrandom id 1 100000000</font></div><div style="line-height: 22px;"  ><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 12.722869 &nbsp; &nbsp; &nbsp; select f_ocz_test(:id);</font></div></div></div><p></p></pre></div></div><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><br></div><div style="line-height: 22px;"  >【测试结果对比】</div><div style="line-height: 22px;"  ><div><img title="OCZ pci-e revodrive3 240GB  DELL SSD 2.5 sata-2 200GB  SAS 2.5 146GB 10K - 德哥@Digoal - The Heart,The World."  alt="OCZ pci-e revodrive3 240GB  DELL SSD 2.5 sata-2 200GB  SAS 2.5 146GB 10K - 德哥@Digoal - The Heart,The World."  style="margin:0 10px 0 0;"  src="http://img1.ph.126.net/vQ8I0cnnMoVJ_HN0lB4CrA==/6597715179982108911.jpg"  ></div><br></div><div style="line-height: 22px;"  >【参考】</div><div style="line-height: 22px;"  >1.&nbsp;<a style="line-height: 22px;" target="_blank" rel="nofollow" href="http://www.amazon.com/Seagate-Pulsar-2-2-5-Inch-Internal-ST100FM0002/dp/tech-data/B0089V4XQO/ref=de_a_smtd"  >http://www.amazon.com/Seagate-Pulsar-2-2-5-Inch-Internal-ST100FM0002/dp/tech-data/B0089V4XQO/ref=de_a_smtd</a></div><div style="line-height: 22px;"  >2.&nbsp;<a style="line-height: 22px;" target="_blank" rel="nofollow" href="http://www.amazon.com/OCZ-RevoDrive-Express-Solid-State/dp/B005F30JBM/ref=sr_1_2?ie=UTF8&amp;qid=1353997791&amp;sr=8-2&amp;keywords=revodrive"  >http://www.amazon.com/OCZ-RevoDrive-Express-Solid-State/dp/B005F30JBM/ref=sr_1_2?ie=UTF8&amp;qid=1353997791&amp;sr=8-2&amp;keywords=revodrive</a></div><div style="line-height: 22px;"  >3.&nbsp;<a style="line-height: 22px;" target="_blank" rel="nofollow" href="http://www.seagate.com/internal-hard-drives/solid-state-hybrid/pulsar-solid-state-drives/specs/#"  >http://www.seagate.com/internal-hard-drives/solid-state-hybrid/pulsar-solid-state-drives/specs/#</a></div></div></div></div></div></div>
	</div>
	<h3>评论</h3>
	<div class="" id="" style="padding:0 20px;">
			<div id="">
				<h5 id="">francs - 2012-11-30 14:09:08</h5>
				<div>&nbsp;<SPAN class="tcnt" >OCZ SSD 快了不止一个数量级啊。</SPAN></div>
			</div>
	</div>
</div>
</body>
</html>