<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Ruby Study 14 : Modules - Digging Deeper</h2>
	<h5 id="">2012-03-30 0:11:00&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201222811347906/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >先列举一个module中变量和常量的例子.</span></font></font></div><div><font size="2"  ><font color="#333333"  ><pre class="prettyprint"  ><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >module M1</font></div><span style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >  $globalvar = 0</span><br><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >  Constant = 1</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >&nbsp; local_var = 2</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >&nbsp; @insvar = 3</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >&nbsp; @@classvar = 4</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >&nbsp; def method1(sym)</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >&nbsp; &nbsp; return eval(sym.id2name)</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >&nbsp; end</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >&nbsp; class Myclass1</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >&nbsp; end</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >&nbsp; p Constant.object_id</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >&nbsp; p local_var.object_id</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >&nbsp; p @insvar.object_id</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >&nbsp; p @@classvar.object_id</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >end</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ><br></font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ># Module中常量和class可以通过::直接引用. 其他的不行</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >p M1::Constant #=&gt; &nbsp;1</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >p M1::Myclass1 #=&gt; &nbsp;M1::Myclass1</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ><br></font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ># include M1后, 看一下哪些会带入, 哪些不会带入.</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >include M1</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >p $globalvar  #=&gt; 0 , 全局变量被带入到当前scope</font></div><div><span style="font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  >p Constant #=&gt; 1 , 常量被带入到当前scope</span></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ><span style="line-height: 20px;"  >p @@classvar  #=&gt; 4 , class variable直接带入到当前scope.</span></font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ><span style="line-height: 20px;"  ><br></span></font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >p @insvar  #=&gt; nil , 说明instance variable 没有被带入当前scope.</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ><br></font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >p method1(:@insvar) &nbsp;#=&gt; nil,   能调用method1 说明M1的instance method被带入到当前scope. 返回nil说明M1的instance method访问的是当前scope的instance variable. 而不是M1的instance variable.</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >@insvar = 30</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >p method1(:@insvar) &nbsp;#=&gt; 30 &nbsp;, 虽然不会带入, 但是module带入的方法访问instance variable时可以访问当前环境的instance variable.</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >p method1(:@@classvar) &nbsp;#=&gt; 4 &nbsp;, 再次说明include 模块会把模块的class variable带入当前环境.</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >@@classvar = 40</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >p method1(:@@classvar) &nbsp;#=&gt; 40 , class variable本身就是共用的, 所以不能说明什么.<br><br><span style="line-height: 20px;"  >obj1 = Myclass1.new<br>p obj1  # =&gt;   #&lt;M1::Myclass1:0x13f7bf8&gt; , 说明M1的class被带入到当前scope.</span></font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ><span style="line-height: 20px;"  ><br></span></font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ><span style="line-height: 20px;"  ># M1的本地变量不会带入到当前环境, </span></font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ><span style="line-height: 20px;"  ><br></span></font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ><span style="line-height: 20px;"  >p local_var</span>  # 报错, 说明M1的本地变量不会带入到当前scope</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >C:/Users/digoal/Desktop/new.rb:22:in `&lt;main&gt;': undefined local variable or method `local_var' for main:Object (NameError)</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ><br></font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ># 如果使用方法去输出本地变量, 那么这个本地变量必须在方法内定义才会有结果, 否则都是报错, 本地变量生效在什么范围可以翻看以前的文章</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >  def method1(sym)<br>    local_var = 100<br>    return eval(sym.id2name)<br>  end</font></div><br><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >p method1(:local_var)  #=&gt; 100</font></div></pre></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >也就是说, "全局变量, 常量, class variable, instance method, class" 都被带入到当前scope.</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >local variable, instance variable没有被带入到当前scope.</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  ><br></span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >接下来开始讲解书上提到的一些知识点,</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >1. Modules and Classes</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >首先, Module, Class都是Class类的对象.</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >自定义的module是Module的对象.</span></font></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 23px;"  >自定义的class是Class的对象.</span></font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >p Module.class</font></div><div><font size="2"  >p Class.class</font></div><div><font size="2"  >module M1</font></div><div><font size="2"  >end</font></div><div><font size="2"  >class C1</font></div><div><font size="2"  >end</font></div><div><font size="2"  >p M1.class</font></div><div><font size="2"  >p C1.class</font></div><div><font size="2"  >输出</font></div><div><div><font size="2"  >Class</font></div><div><font size="2"  >Class</font></div><div><font size="2"  >Module</font></div><div><font size="2"  >Class</font></div></div><p></p></pre></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >其次, Class的superclass是Module, Module的superclass是Object.</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >自定义的module没有superclass, 自定义的class的superclass是Object.</span></font></font></div><div><font size="2"  ><font color="#333333"  ><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  ><pre class="prettyprint"  ><p></p><div>p Module.superclass</div><div>p Class.superclass</div><div>module M1</div><div>end</div><div>class C1</div><div>end</div><div>p C1.superclass</div><div># p M1.superclass</div><div>输出</div><div><div>Object</div><div>Module</div><div>Object</div></div><p></p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >如果把上面的注释去掉报错, 因为module无法继承.</div><div><pre class="prettyprint"  ><p></p><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >p M1.superclass</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >报错</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >C:/Users/digoal/Desktop/new.rb:5:in `&lt;main&gt;': undefined method `superclass' for M1:Module (NoMethodError)</font></div><p></p></pre></div></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >因为module没有继承, 不能实例化.</span></font></font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >module M1</font></div><div><font size="2"  >end</font></div><div><font size="2"  >module M2 &lt; M1 &nbsp;# 这里报错</font></div><div><font size="2"  >end</font></div><div><font size="2"  >报错</font></div><div><div><font size="2"  >C:/Users/digoal/Desktop/new.rb:3: syntax error, unexpected '&lt;'</font></div><div><font size="2"  >module M2 &lt; M1</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;^</font></div></div><p></p></pre></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >实例化也是报错的</span></font></font></div><div><font size="2"  ><font color="#333333"  ><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  ><pre class="prettyprint"  ><p></p><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >module M1</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >end</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >m1 = M1.new</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >报错</div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >C:/Users/digoal/Desktop/new.rb:3:in `&lt;main&gt;': undefined method `new' for M1:Module (NoMethodError)</font></div><p></p></pre></div></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >但是class可以继承Module class, 注意不是继承自定义的module.</span></font></font></div><div><pre class="prettyprint"  ><p></p><div><span style="line-height: 23px;"  ><font size="2"  >class Myclass1 &lt; Module</font></span></div><div><font size="2"  >end</font></div><p></p></pre></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >以下则报错</span></font></font></div><div><font size="2"  ><font color="#333333"  ><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  ><pre class="prettyprint"  ><p></p><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >module M1</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >&nbsp; def method1(var)</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >&nbsp; &nbsp; return var</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >&nbsp; end</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >end</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >class Myclass1 &lt; M1</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >end</div><div style="font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >报错</div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >C:/Users/digoal/Desktop/new.rb:6:in `&lt;main&gt;': wrong argument type Module (expected Class) (TypeError)</font></div><p></p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  ><br></div></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >2. Predefined Modules</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >Ruby自带的Module</span></font></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >Comparable, Enumerable, FileTest, GC, Kernel, Math, ObjectSpace, Process, Signal</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >2.1 Comparable</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >&nbsp; 以前接触过, 它用于Class的objects之间可以用来比较的需求. 定义class时必须把Comparable mixin. 并且需要定义&lt;=&gt;方法.</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >返回-1,0,1.&nbsp;</span></font>returning -1, 0, or +1 depending on whether the receiver is less than, equal to,  or greater than the other object.</div><div>If the other object is not comparable then the <tt>&lt;=&gt;</tt> operator  should return nil</div><div><tt>Comparable</tt> uses <tt>&lt;=&gt;</tt> to implement the conventional  comparison operators (<tt>&lt;</tt>, <tt>&lt;=</tt>, <tt>==</tt>,  <tt>&gt;=</tt>, and <tt>&gt;</tt>) and the method <tt>between?</tt></div><div><div style="line-height: 22px;"  >示例 :&nbsp;</div><div style="line-height: 22px;"  ><pre class="prettyprint"  style="line-height: 22px;"  ><p style="line-height: 22px;"  ></p><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp;class SizeMatters</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp; &nbsp;include Comparable</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp; &nbsp;attr_accessor :str</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp; &nbsp;def &lt;=&gt; (anOther)</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp; &nbsp; &nbsp;str.size &lt;=&gt; anOther.str.size</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp; &nbsp;end</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp; &nbsp;def initialize(str)</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp; &nbsp; &nbsp;@str = str</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp; &nbsp;end</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp;end</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  ><br style="line-height: 19px;"  ></font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp;s1 = SizeMatters.new("Z")</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp;s2 = SizeMatters.new("YY")</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp;s3 = SizeMatters.new("XXX")</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp;s4 = SizeMatters.new("WWWW")</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp;s5 = SizeMatters.new("VVVVV")</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  ><br style="line-height: 19px;"  ></font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp;p s1 &lt; s2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #=&gt; true</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp;p s4.between?(s1, s3) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #=&gt; false</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp;p s4.between?(s3, s5) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #=&gt; true</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >&nbsp; &nbsp;p [ s3, s2, s5, s4, s1 ].sort &nbsp; #=&gt; [Z, YY, XXX, WWWW, VVVVV]</font></div></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >输出 : </font></div><div style="line-height: 22px;"  ><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >true</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >false</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >true</font></div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 19px;"  >[#&lt;SizeMatters:0x1efc258 @str="Z"&gt;, #&lt;SizeMatters:0x1efc228 @str="YY"&gt;, #&lt;SizeMatters:0x1efc1f8 @str="XXX"&gt;, #&lt;SizeMatters:0x1efc1c8 @str="WWWW"&gt;, #&lt;SizeMatters:0x1efc198 @str="VVVVV"&gt;]</font></div></div><p style="line-height: 22px;"  ></p></pre></div><br></div><div><font face="monospace"  >2.2 Enumerable</font></div><div>&nbsp; The <tt>Enumerable</tt> mixin provides collection classes with several traversal  and searching methods, and with the ability to sort. The class must provide a  method <tt>each</tt>, which yields successive members of the collection. If  <tt>Enumerable# max</tt>, <tt>min</tt>, or <tt>sort</tt> is used, the objects in the  collection must also implement a meaningful <tt>&lt;=&gt;</tt> operator, as  these methods rely on an ordering between members of the collection.</div><div><div style="line-height: 22px;"  ><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >例子参考,</span></font></font></div><div style="line-height: 22px;"  ><a style="line-height: 22px; " href="http://blog.163.com/digoal@126/blog/static/1638770402012115347486/"  >http://blog.163.com/digoal@126/blog/static/1638770402012115347486/</a></div></div><div style="line-height: 22px;"  ><span style="line-height: 22px;"  >If&nbsp;</span><tt style="line-height: 22px;"  >Enumerable# max</tt><span style="line-height: 22px;"  >,&nbsp;</span><tt style="line-height: 22px;"  >min</tt><span style="line-height: 22px;"  >, or&nbsp;</span><tt style="line-height: 22px;"  >sort</tt><span style="line-height: 22px;"  >&nbsp;is used,&nbsp;</span><span style="line-height: 22px;"  >the objects in the collection must also implement a meaningful&nbsp;</span><tt style="line-height: 22px;"  >&lt;=&gt;</tt><span style="line-height: 22px;"  >&nbsp;operator 指的是collection里面的元素必须有&lt;=&gt;方法, 否则无法比较.</span></div><div style="line-height: 22px;"  ><span style="line-height: 22px;"  >例如 ['a','b','c'] 是可比较的. 因为'a' 可以和'b'比.String class 有&lt;=&gt;方法.</span></div><div><pre class="prettyprint"  ><p></p><div><div><font size="2"  >p "a" &gt; "b"</font></div><div><font size="2"  >p "a".class</font></div><div><font size="2"  >p String.method_defined?(:&lt;=&gt;)</font></div></div><div><font size="2"  >输出</font></div><div><div><font size="2"  >false</font></div><div><font size="2"  >String</font></div><div><font size="2"  >true</font></div></div><p></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >2.3 &nbsp;</span></font><tt>FileTest</tt> implements file test operations similar to those used in  <tt>File::Stat</tt>. It exists as a standalone module, and its methods are also  insinuated into the <tt>File</tt> class. (Note that this is not done by  inclusion: the interpreter cheats).</div><div><br></div><div>2.4 &nbsp;The GC module provides an interface to Ruby’s mark and sweep garbage collection mechanism. Some of the underlying methods are also available via the ObjectSpace module.&nbsp;</div><div>You may obtain information about the operation of the GC through GC::Profiler</div><div><br></div><div>2.5 Kernel is a module included by the Object class; it defines Ruby’s “builtin” methods.</div><div>Object mixin了Kernel 模块, 因此我们创建的class, 可以使用Kernel模块带的public instance method. 例如puts, print, gets, require等.</div><div><br></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >2.6&nbsp;</span></font>The <tt>Math</tt> module contains module functions for basic trigonometric and  transcendental functions. See class <tt>Float</tt> for a list of constants that  define Ruby’s floating point accuracy.</div><div>例如</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >puts( Math.sqrt(144) ) &nbsp;#=&gt; 12.0</font></div><div><font size="2"  >puts( Math::PI ) &nbsp; &nbsp; &nbsp; &nbsp;#=&gt; 3.141592653589793</font></div><p></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><br></span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >2.7 &nbsp;</span></font>The <tt>ObjectSpace</tt> module contains a number of routines that interact  with the garbage collection facility and allow you to traverse all living  objects with an iterator.</div><div><tt>ObjectSpace</tt> also provides support for object finalizers, procs that  will be called when a specific object is about to be destroyed by garbage  collection.</div><div><br></div><div>2.8 &nbsp;&nbsp;The <tt>Process</tt> module is a collection of methods used to manipulate  processes.</div><div><br></div><div>2.9 &nbsp;Signal is the module for handling signals sent to running processes. The list of available signal names and their interpretation is system dependent.</div><div><span style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; font-size: small; line-height: 23px;"  ><br></span></div><div><span style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; font-size: small;"  >3. Scope Resolution</span></div><div><span style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; font-size: small;"  >class, module, constant都有他们的范围(scope). 使用:: 可以来指定你要访问的class, module, constant的范围.</span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 23px;"  >如 :&nbsp;</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><div style="line-height: 23px;"  ><pre class="prettyprint"  ><p></p><div style="line-height: 23px;"  >module OuterMod</div><div style="line-height: 23px;"  >&nbsp; &nbsp; moduleInnerMod</div><div style="line-height: 23px;"  >&nbsp; &nbsp; &nbsp; &nbsp; class Class1</div><div style="line-height: 23px;"  >&nbsp; &nbsp; &nbsp; &nbsp; end</div><div style="line-height: 23px;"  >&nbsp; &nbsp; end</div><div style="line-height: 23px;"  >end</div><div>OuterMod::InnerMod::Class1</div><p></p></pre></div></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 23px;"  >用法是Scope1::Scope2::Scope3 &nbsp; &nbsp; &nbsp; &nbsp;#...etc</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 23px;"  ><br></span></font></div><div><span style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; font-size: small;"  >::在最前面表示 top-level 的常量</span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >ACONST = "hello" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# This is a top-level constant</font></div><div><font size="2"  >module OuterMod</font></div><div><font size="2"  >&nbsp; &nbsp;module InnerMod</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; ACONST=10 &nbsp; &nbsp;# OuterMod::InnerMod::ACONST</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; class Class1</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;class Class2</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; module XYZ</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;class ABC</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACONST=100 # Deeply nested ACONST</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; def xyz</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;puts( ::ACONST ) # &lt;= This refers to top-level ACONST</font></div><div><font size="2"  >                     p ::OuterClass<br>                     p ::OuterMod</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;end</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;end</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; end</font></div><div><font size="2"  >&nbsp; &nbsp;end</font></div><div><font size="2"  >end</font></div><div><font size="2"  >puts(OuterMod::InnerMod::ACONST)                             #=&gt; 10<br>puts(OuterMod::InnerMod::Class1::Class2::XYZ::ABC::ACONST)   #=&gt; 100<br>ob = OuterMod::InnerMod::Class1::Class2::XYZ::ABC.new<br>ob.xyz                                                      &nbsp;</font></div><div><font size="2"  >输出</font></div><div><font size="2"  >10<br>100<br>hello<br>OuterClass<br>OuterMod</font></div><p></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><br></span></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >4. Module Funcitons</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >前面已经讲过,Module singleton method可以通过module_name.method_name来调用. 但是module的instance method需要把module mixin到class后, 通过这个class的object来调用.</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >现在有一个Module class的private instance method叫做module_function可以通过instance method创建Module singleton method.</span></font></font></div><div><div jquery="123"  ><span>module_function(symbol, ...) → self</span> <span>click to toggle source</span> </div> <div jquery="59"  > <p>Creates module functions for the named methods. These functions may be called  with the module as a receiver, and also become available as instance methods to  classes that mix in the module. <a rel="nofollow" href=""  >Module</a> functions are  copies of the original, and so may be changed independently. The instance-method  versions are made private. If used with no arguments, subsequently defined  methods become module functions.</p><p>也就是说使用module_function带参数时, 将复制原来这个module中定义的instance method, 作为module singleton method. 并且被复制的instance method可以override 而不会影响已经复制的module singleton method.</p><p>如果module_function不带参数, 则表示这后面创建的都是module singleton method.</p><p></p><p></p><pre class="prettyprint"  ><p></p><p><font size="2"  >module Mod</font></p><p><font size="2"  >&nbsp; def one</font></p><p><font size="2"  >&nbsp; &nbsp; "This is one"</font></p><p><font size="2"  >&nbsp; end</font></p><p><font size="2"  >&nbsp; module_function :one  # 带一个参数:one, 表示复制one这个instance method为module singleton method</font></p><p><font size="2"  >end</font></p><p><font size="2"  ><br></font></p><p><font size="2"  >class Cls</font></p><p><font size="2"  >&nbsp; include Mod</font></p><p><font size="2"  >&nbsp; def call_one</font></p><p><font size="2"  >&nbsp; &nbsp; one</font></p><p><font size="2"  >&nbsp; end</font></p><p><font size="2"  >end</font></p><p><font size="2"  ><br></font></p><p><font size="2"  >p Mod.one &nbsp; &nbsp; #=&gt; "This is one"</font></p><p><font size="2"  >c = Cls.new</font></p><p><font size="2"  >p c.call_one &nbsp;#=&gt; "This is one"</font></p><p><font size="2"  ><br></font></p><p><font size="2"  >module Mod</font></p><p><font size="2"  >&nbsp; def one</font></p><p><font size="2"  >&nbsp; &nbsp; "This is the new one"</font></p><p><font size="2"  >&nbsp; end</font></p><p><font size="2"  >end</font></p><p><font size="2"  ><br></font></p><p><font size="2"  >p Mod.one &nbsp; &nbsp; #=&gt; "This is one"</font></p><p><font size="2"  >p c.call_one &nbsp;#=&gt; "This is the new one"</font></p><p></p></pre></div></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >例子2 :&nbsp;</span></font></font></div><div><pre class="prettyprint"  ><br></pre><pre class="prettyprint"  ><p></p><div><font size="2"  >module Mod</font></div><div><font size="2"  >&nbsp; def one</font></div><div><font size="2"  >&nbsp; &nbsp; "This is one"</font></div><div><font size="2"  >&nbsp; end</font></div><div><font size="2"  >&nbsp; module_function</font></div><div><font size="2"  >&nbsp; def two</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp;return "This is two"</font></div><div><font size="2"  >&nbsp; end</font></div><div><font size="2"  >&nbsp; def three</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp;return "This is three"</font></div><div><font size="2"  >&nbsp; end</font></div><div><font size="2"  >end</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >class Myclass</font></div><div><font size="2"  >&nbsp; &nbsp;include Mod</font></div><div><font size="2"  >end</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >ob = Myclass.new</font></div><div><font size="2"  >p ob.one  #=&gt;  <span style="line-height: 19px;"  >"This is one"</span></font></div><div><font size="2"  >p Mod.two  #=&gt;  <span style="line-height: 19px;"  >"This is two"</span></font></div><div><font size="2"  >p Mod.three  #=&gt;  <span style="line-height: 19px;"  >"This is three"</span></font></div><div><font size="2"  ><span style="line-height: 19px;"  ><br></span></font></div><div><font size="2"  >p ob.two  # 报错, 因为module_function没带参数的话, 后面定义的method就是module singleton method</font></div><div><font size="2"  >C:/Users/digoal/Desktop/new.rb:20:in `&lt;main&gt;': private method `two' called for #&lt;Myclass:0x208a940&gt; (NoMethodError)</font></div><p></p></pre></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  ><br></span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >5. Extending Objects</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >我们前面讲的Module mixin都是把module mixin到class或module里面. 其实也可以把module的instance method扩展到object. 就好似object的singleton method.</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >通过Object的public instance method: extend来达到这个目的.</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >来看个例子.</span></font></font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >module Mod</font></div><div><font size="2"  >&nbsp; def hello</font></div><div><font size="2"  >&nbsp; &nbsp; "Hello from Mod.\n"</font></div><div><font size="2"  >&nbsp; end</font></div><div><font size="2"  >end</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >class Klass</font></div><div><font size="2"  >&nbsp; def hello</font></div><div><font size="2"  >&nbsp; &nbsp; "Hello from Klass.\n"</font></div><div><font size="2"  >&nbsp; end</font></div><div><font size="2"  >end</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >k = Klass.new</font></div><div><font size="2"  >p k.hello &nbsp; &nbsp; &nbsp; &nbsp; #=&gt; "Hello from Klass.\n"</font></div><div><font size="2"  >k.extend(Mod) &nbsp; #=&gt; #&lt;Klass:0x401b3bc8&gt; , Mod的hello方法将覆盖掉k对象的hello方法.</font></div><div><font size="2"  >p k.hello &nbsp; &nbsp; &nbsp; &nbsp; #=&gt; "Hello from Mod.\n"</font></div><div><font size="2"  >n = Klass.new<br>p n.hello  #=&gt; "Hello from Klass.\n"  # 其他对象不会受到影响</font></div><div><font size="2"  >结果</font></div><div><div><font size="2"  >"Hello from Klass.\n"</font></div><div><font size="2"  >"Hello from Mod.\n"</font></div></div><div><span style="line-height: 19px; font-size: small;"  >"Hello from Klass.\n"</span><br></div><p></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 23px;"  >如果想给object扩展多个Module. 可以给extend中传入多个参数. 或者分多次调用extend方法. 不过这两种方式有些不同. 如果一次传入多个Module, 如果Module之间有重复的instance method, 那么以参数靠前的method为最终扩展的method.</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 23px;"  >如果是分多次调用extend的方式, 则以最后一次调用extend时传入的Module中的method为扩展的method.</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 23px;"  >例如 :&nbsp;</span></font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >module A</font></div><div><font size="2"  >&nbsp; &nbsp; def method_y</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; puts( 'hello from method_y of module A' )</font></div><div><font size="2"  >&nbsp; &nbsp; end</font></div><div><font size="2"  >end</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >module B</font></div><div><font size="2"  >&nbsp; &nbsp; def method_x</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; puts( 'hello from method_x of module B' )</font></div><div><font size="2"  >&nbsp; &nbsp; end</font></div><div><font size="2"  >end</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >module C</font></div><div><font size="2"  >&nbsp; &nbsp; def method_x</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; puts( 'hello from method_x of module C' )</font></div><div><font size="2"  >&nbsp; &nbsp; end</font></div><div><font size="2"  >end</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >class Myclass</font></div><div><font size="2"  >&nbsp; &nbsp; def method_y</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; puts( 'hello from method_y of class Myclass' )</font></div><div><font size="2"  >&nbsp; &nbsp; end</font></div><div><font size="2"  >end</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >ob = Myclass.new</font></div><div><font size="2"  >ob.extend(A)</font></div><div><font size="2"  >ob.method_y &nbsp; &nbsp; &nbsp; #=&gt; hello from method_y of module A</font></div><div><font size="2"  >ob.extend(B)</font></div><div><font size="2"  >ob.method_y &nbsp; &nbsp; &nbsp; #=&gt; hello from method_y of module A</font></div><div><font size="2"  >ob.method_x &nbsp; &nbsp; &nbsp; #=&gt; hello from method_x of module B</font></div><div><font size="2"  >ob.extend(C)</font></div><div><font size="2"  >ob.method_y &nbsp; &nbsp; &nbsp; #=&gt; hello from method_y of module A</font></div><div><font size="2"  >ob.method_x &nbsp; &nbsp; &nbsp; #=&gt; hello from method_x of module C</font></div><p></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 23px;"  >一次传多个模块 :&nbsp;</span></font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >ob = Myclass.new</font></div><div><font size="2"  >ob.extend(A,B,C)</font></div><div><font size="2"  >ob.method_y &nbsp; &nbsp; &nbsp; #=&gt; hello from method_y of module A</font></div><div><font size="2"  >ob.method_x &nbsp; &nbsp; &nbsp; #=&gt; hello from method_x of module B  , 注意这里是扩展的B模块的method_x方法, 而不是C里面的.</font></div><p></p></pre></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  ><br></span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >6. Freezing Objects</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >freeze object的目的是防止未来对对象的修改, 注意这个过程是不可逆的, 也就是不能unfreeze一个freeze的对象.</span></font></font></div><div><font size="2"  style="line-height: 23px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font color="#333333"  style="line-height: 23px;"  ><span style="line-height: 23px;"  >Object class有一个freeze方法, Module复写了这个方法. 我们接下来讲的是Object class的freeze方法.</span></font></font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >freeze → obj click to toggle source&nbsp;</font></div><div><font size="2"  >Prevents further modifications to obj. A RuntimeError will be raised if modification is attempted. There is no way to unfreeze a frozen object. See also Object#frozen?.&nbsp;</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >This method returns self.&nbsp;</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >&nbsp; &nbsp;a = [ "a", "b", "c" ]</font></div><div><font size="2"  >&nbsp; &nbsp;a.freeze</font></div><div><font size="2"  >&nbsp; &nbsp;a &lt;&lt; "z"</font></div><div><font size="2"  >produces:&nbsp;</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >&nbsp; &nbsp;prog.rb:3:in `&lt;&lt;': can't modify frozen array (RuntimeError)</font></div><div><font size="2"  >&nbsp; &nbsp; from prog.rb:3</font></div><p></p></pre></div><font size="2"  ><font color="#333333"  ><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><span style="line-height: 23px;"  >被freeze的对象当然也不能给它extend 模块.&nbsp;</span></div><div><pre class="prettyprint"  ><p></p><div>ob = Myclass.new</div><div>ob.freeze</div><div>ob.extend(A,B,C)</div><div>报错</div><div><div>C:/Users/digoal/Desktop/new.rb:27:in `extend_object': can't modify frozen object (RuntimeError)</div><div><span> </span>from C:/Users/digoal/Desktop/new.rb:27:in `extend'</div><div><span> </span>from C:/Users/digoal/Desktop/new.rb:27:in `&lt;main&gt;'</div></div><p></p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  ><span style="line-height: 23px;"  >也不能给freeze的对象创建singleton method.</span> </div><div><pre class="prettyprint"  ><p></p><div>ob = Myclass.new</div><div>ob.freeze</div><div>def ob.newmethod</div><div>&nbsp; &nbsp;puts("this is a new ob's singleton method")</div><div>end</div><div>报错</div><div>C:/Users/digoal/Desktop/new.rb:27:in `&lt;main&gt;': can't modify frozen Myclass (RuntimeError)</div><p></p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >判断一个对象是否被freeze, 使用Object class的frozen?方法.</div><div><pre class="prettyprint"  ><p></p><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >ob = Myclass.new</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >p ob.frozen? &nbsp;#=&gt; false</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >ob.freeze</font></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  >p ob.frozen? &nbsp;#=&gt; true</font></div><p></p></pre></div><div><font face="Arial, Helvetica, simsun, u5b8bu4f53"  ><br></font></div><span style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 23px;"  >【参考】</span></font></font><div style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 23px;"  >The Book Of Ruby</font></div><div style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 23px;"  >Ruby 1.9.3 API</font></div><wbr></div>
	</div>
</div>
</body>
</html>