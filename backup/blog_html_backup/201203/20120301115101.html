<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Ruby Study 5 : Hash, Martix, Vector and Set class</h2>
	<h5 id="">2012-03-01 11:51:01&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201212954059555/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >Hash class</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >1. introduce</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >前面一篇讲了一下Array, 其实Hash 和Array还是比较类似的, 只不过Hash的每个元素是由key和value组成的.</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >我们来看看创建Hash的几种方法.</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >h1 = {1=&gt;'d', 2=&gt;'c', 3=&gt;'b', 4=&gt;'a'}</font></div><div><font size="2"  >h2 = Hash.new()</font></div><div><font size="2"  >h3 = Hash.new("default value")</font></div><p></p></pre></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >这里分别创建了3个Hash对象, h1 有4个元素. h2和h3都没有元素, 只不过h3设置了value的默认值.</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >例如 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >p(h2["this is a key"])  # h2由于没有默认值, 所以对应这个key的value值是nil.</font></div><div><font size="2"  >p(h3["this is a key"])  # h3则返回默认值.</font></div><p></p></pre></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >输出 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >nil</font></div><div><font size="2"  >"default value"</font></div><p></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >Hash和Array的另一个不同之处是, Hash的key是唯一的, 而Array中允许重复元素.&nbsp;</span></font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >例如 :&nbsp;</span></font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >a1 = [1,1,1,1,1]</font></div><div><font size="2"  >h1 = {1=&gt;'d', 2=&gt;'c', 3=&gt;'b', 4=&gt;'a'}</font></div><div><font size="2"  >h1[1] = 'f'  # 这个操作是修改key=1的value. 而不是增加一个1=&gt;'f'的元素, 因为Hash不允许重复KEY出现</font></div><div><font size="2"  >p(a1)</font></div><div><font size="2"  >p(h1)</font></div><p></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div>[1, 1, 1, 1, 1]</div><div>{1=&gt;"f", 2=&gt;"c", 3=&gt;"b", 4=&gt;"a"}</div><p></p></pre></div></span></font></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >添加Hash元素 :&nbsp;</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><div style="line-height: 20px;"  ><pre class="prettyprint"  ><p></p><div style="line-height: 20px;"  >h1 = Hash.new()</div><div style="line-height: 20px;"  >h1[1] = 'd'</div><div style="line-height: 20px;"  >h1[2] = 'c'</div><div style="line-height: 20px;"  >h1[3] = 'b'</div><div style="line-height: 20px;"  >h1[4] = 'a'</div><div style="line-height: 20px;"  >p h1</div><p></p></pre></div><div style="line-height: 20px;"  >执行结果</div><div><pre class="prettyprint"  ><p>{1=&gt;"d", 2=&gt;"c", 3=&gt;"b", 4=&gt;"a"}</p></pre></div></font></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >Hash的key和value允许使用任意类型的数据, 如Symbol, String, Fixnum, 包括自定义类的对象以及nil.</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >h1 = Hash.new()</font></div><div><font size="2"  >class Myclass</font></div><div><font size="2"  >end</font></div><div><font size="2"  >m1 = Myclass.new()</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >h1[m1] = nil</font></div><div><font size="2"  >h1[1] = 'a'</font></div><div><font size="2"  >h1['a'] = :thisasymbol</font></div><div><font size="2"  >p h1</font></div><p></p></pre></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >执行结果 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p><font size="2"  >{#&lt;Myclass:0x1dc1108&gt;=&gt;nil, 1=&gt;"a", "a"=&gt;:thisasymbol}</font></p></pre></div><div style="line-height: 22px;"  ><span style="line-height: 20px; font-size: small; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><br></span></div><div style="line-height: 22px;"  ><span style="line-height: 20px; font-size: small; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  >2. Create Hash object</span></div><div style="line-height: 22px;"  ><span style="line-height: 20px; font-size: small; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  >这个上面已经讲过了.</span></div><div style="line-height: 22px;"  ><span style="line-height: 20px; font-size: small; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><br></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >3. Indexing into a Hash</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >这个上面也讲过了, 需要提醒的是, 使用了默认值的Hash, 当查找一个不存在的key时返回的是默认值, 默认值可以通过default=方法修改.</font></span></div><div><font size="2"  ><div><pre class="prettyprint"  ><p></p><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >h1 = Hash.new('default value 1')</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >p h1[1]</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >h1.default = 'new default value'</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >p h1[1]</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >p h1.default</font></div><p></p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >"default value 1"</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >"new default value"</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >"new default value"</font></div><p></p></pre></div></font></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  ><br></font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >4. Copy a Hash</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >拷贝一个Hash 和拷贝Array, String等类型一样, 需要注意如果通过赋值的话实际上只是拷贝了值的reference. 而不是新建一个对象.</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >例如 :&nbsp;</font></span></div><div><font size="2"  ><div><pre class="prettyprint"  ><p></p><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >h1 = {1=&gt;'digoal',2=&gt;'francs'}</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >h2 = h1  # 这是个reference的拷贝</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >h3 = h1.clone  # 使用clone方法才是创建一个新的对象</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >h2[3] = 'hank'</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >h3[4] = 'david'</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >p h1.object_id</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >p h2.object_id</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >p h3.object_id</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >p h1</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >p h2</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >p h3</font></div><p></p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >15861696</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >15861696</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >15861684</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >{1=&gt;"digoal", 2=&gt;"francs", 3=&gt;"hank"}</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >{1=&gt;"digoal", 2=&gt;"francs", 3=&gt;"hank"}</font></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  >{1=&gt;"digoal", 2=&gt;"francs", 4=&gt;"david"}</font></div><p></p></pre></div></font></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  ><br></font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >5. Hash Order</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >注意在1.8 和 1.9的版本中有一定的区别, 1.8中Hash对象的顺序是按照key排序来存储的.</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >1.9则是插入的顺序. 所以1.9在插入速度上应该是快于1.8的. 包括存储的效率也应该比1.8高.</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >来看个例子 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >h1 = Hash.new()</font></div><div><font size="2"  >h1[4] = 'a'</font></div><div><font size="2"  >h1[3] = 'b'</font></div><div><font size="2"  >h1[2] = 'c'</font></div><div><font size="2"  >h1[1] = 'd'</font></div><div><font size="2"  >p h1</font></div><p></p></pre></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >1.9的执行结果 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p><font size="2"  >{4=&gt;"a", 3=&gt;"b", 2=&gt;"c", 1=&gt;"d"}</font></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >1.8的执行结果 :&nbsp;</span></font></div><div><pre class="prettyprint"  ><p><font size="2"  >{1=&gt;"d", 2=&gt;"c", 3=&gt;"b", 4=&gt;"a"}</font></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><br></span></font></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >6. Sorting a Hash</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >给Hash排序, 实际上是先把Hash转换成2维的Array再排序, 就像这样的[[key1,value1], [key2,value2], [key3,value3]...]</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >因为转换后key在前, value在后, &nbsp;所以排序是按照key来排的.</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >所以我们可以通过给 sort 方法传递一个块进去, 选择按照key或者value来排序.</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >例如 :&nbsp;</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><div><pre class="prettyprint"  ><p></p><div>h1 = {1=&gt;'d', 2=&gt;'c', 3=&gt;'b', 4=&gt;'a'}</div><div>p( h1.sort ) &nbsp;# 这种排序方法和接下来的一致.</div><div>p( h1.sort {</div><div>&nbsp; |x,y|</div><div>&nbsp; x[0].to_s &lt;=&gt; y[0].to_s</div><div>} )</div><div>p( h1.sort { # 这种排序则是按value来排的.</div><div>&nbsp; |x,y|</div><div>&nbsp; x[1] &lt;=&gt; y[1]</div><div>} )</div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p></p><div>[[1, "d"], [2, "c"], [3, "b"], [4, "a"]]</div><div>[[1, "d"], [2, "c"], [3, "b"], [4, "a"]]</div><div>[[4, "a"], [3, "b"], [2, "c"], [1, "d"]]</div><p></p></pre></div></span></font></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  ># 注意到sort后返回的是Array类型, 也就是前面所讲.</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >如果你觉得每次要这样写不爽, 我们可以定义一个给Hash排序的方法 .</font></span></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >def hash_sort_byvalue (ahash)</font></div><div><font size="2"  >&nbsp; return ahash.sort {</font></div><div><font size="2"  >&nbsp; &nbsp; |x,y|</font></div><div><font size="2"  >&nbsp; &nbsp; x[1].to_s &lt;=&gt; y[1].to_s</font></div><div><font size="2"  >&nbsp; }</font></div><div><font size="2"  >end</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >h1 = {1=&gt;'d', 2=&gt;'c', 3=&gt;'b', 4=&gt;'a'}</font></div><div><font size="2"  >p( hash_sort_byvalue(h1) )</font></div><p></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >执行结果 :&nbsp;</span></font></div><div><pre class="prettyprint"  ><p><font size="2"  >[[4, "a"], [3, "b"], [2, "c"], [1, "d"]]</font></p></pre></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><br></span></font></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >7. Hash Methods</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  >来看看Hash对象有多少方法好调用?</span></font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >h1 = Hash.new()</font></div><div><font size="2"  >print(h1.methods.sort)</font></div><p></p></pre></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >执行结果 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p><font size="2"  >[:!, :!=, :!~, :&lt;=&gt;, :==, :===, :=~, :[], :[]=, :__id__, :__send__, :all?, :any?, :assoc, :chunk, :class, :clear, :clone, :collect, :collect_concat, :compare_by_identity, :compare_by_identity?, :count, :cycle, :default, :default=, :default_proc, :default_proc=, :define_singleton_method, :delete, :delete_if, :detect, :display, :drop, :drop_while, :dup, :each, :each_cons, :each_entry, :each_key, :each_pair, :each_slice, :each_value, :each_with_index, :each_with_object, :empty?, :entries, :enum_for, :eql?, :equal?, :extend, :fetch, :find, :find_all, :find_index, :first, :flat_map, :flatten, :freeze, :frozen?, :grep, :group_by, :has_key?, :has_value?, :hash, :include?, :index, :initialize_clone, :initialize_dup, :inject, :inspect, :instance_eval, :instance_exec, :instance_of?, :instance_variable_defined?, :instance_variable_get, :instance_variable_set, :instance_variables, :invert, :is_a?, :keep_if, :key, :key?, :keys, :kind_of?, :length, :map, :max, :max_by, :member?, :merge, :merge!, :method, :methods, :min, :min_by, :minmax, :minmax_by, :nil?, :none?, :object_id, :one?, :partition, :private_methods, :protected_methods, :public_method, :public_methods, :public_send, :rassoc, :reduce, :rehash, :reject, :reject!, :replace, :respond_to?, :respond_to_missing?, :reverse_each, :select, :select!, :send, :shift, :singleton_class, :singleton_methods, :size, :slice_before, :sort, :sort_by, :store, :taint, :tainted?, :take, :take_while, :tap, :to_a, :to_enum, :to_hash, :to_s, :trust, :untaint, :untrust, :untrusted?, :update, :value?, :values, :values_at, :zip]</font></p></pre></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >估计已经看到很多熟悉的了吧 . 下面来测试几个 :&nbsp;</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><div><pre class="prettyprint"  ><p></p><div>h1 = {</div><div>&nbsp; &nbsp; 'room1'=&gt;'The Treasure Room',</div><div>&nbsp; &nbsp; 'room2'=&gt;'The Throne Room',</div><div>&nbsp; &nbsp; 'loc1'=&gt;'A Forest Glade',</div><div>&nbsp; &nbsp; 'loc2'=&gt;'A Mountain Stream'&nbsp;</div><div>&nbsp; &nbsp; }</div><div>&nbsp; &nbsp;&nbsp;</div><div>h2 = {1=&gt;'one', 2=&gt;'two', 3=&gt; 'three'}</div><div>h1['room1'] = 'You have wandered into a dark room'</div><div>h1.delete('loc2')</div><div>p(h1)</div><div>#=&gt; {"room1"=&gt;"You have wandered into a dark room",</div><div>#=&gt; "room2"=&gt;"The Throne Room",&nbsp;</div><div>#=&gt; "loc1"=&gt;"A Forest Glade"}</div><div>p(h1.has_key?('loc2')) #=&gt; false</div><div>p(h2.has_value?("two")) #=&gt;true</div><div>p(h2.invert) &nbsp; &nbsp; &nbsp; &nbsp; #=&gt; {"one"=&gt;1, "two"=&gt;2, "three"=&gt;3}</div><div>p(h2.keys) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#=&gt;[1, 2, 3]</div><div>p(h2.values) &nbsp; &nbsp; &nbsp; &nbsp;#=&gt;["one", "two", "three"]</div><p></p></pre></div><div>执行结果 &nbsp;:&nbsp;</div><div><pre class="prettyprint"  ><p></p><div>{"room1"=&gt;"You have wandered into a dark room", "room2"=&gt;"The Throne Room", "loc1"=&gt;"A Forest Glade"}</div><div>false</div><div>true</div><div>{"one"=&gt;1, "two"=&gt;2, "three"=&gt;3}</div><div>[1, 2, 3]</div><div>["one", "two", "three"]</div><p></p></pre></div></span></font></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >其他的用法可以参考API.</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  ><br></font></span></div><div style="line-height: 22px;"  ><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  style="line-height: 20px;"  >8. Convert Hash to Array</font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >h1 = {</font></div><div><font size="2"  >&nbsp; &nbsp; 'room1'=&gt;'The Treasure Room',</font></div><div><font size="2"  >&nbsp; &nbsp; 'room2'=&gt;'The Throne Room',</font></div><div><font size="2"  >&nbsp; &nbsp; 'loc1'=&gt;'A Forest Glade',</font></div><div><font size="2"  >&nbsp; &nbsp; 'loc2'=&gt;'A Mountain Stream'&nbsp;</font></div><div><font size="2"  >&nbsp; &nbsp; }</font></div><div><font size="2"  >p h1.to_a</font></div><div><font size="2"  >p h1.keys</font></div><div><font size="2"  >p h1.values</font></div><p></p></pre></div><div style="line-height: 22px;"  ><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  style="line-height: 20px;"  >输出结果 :&nbsp;</font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >[["room1", "The Treasure Room"], ["room2", "The Throne Room"], ["loc1", "A Forest Glade"], ["loc2", "A Mountain Stream"]]</font></div><div><font size="2"  >["room1", "room2", "loc1", "loc2"]</font></div><div><font size="2"  >["The Treasure Room", "The Throne Room", "A Forest Glade", "A Mountain Stream"]</font></div><p></p></pre></div><div style="line-height: 22px;"  ><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  style="line-height: 20px;"  >其他例子 :&nbsp;</font></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >h1 = {'key1'=&gt;'val1', 'key2'=&gt;'val2', 'key3'=&gt;'val3', 'key4'=&gt;'val4'}</font></div><div><font size="2"  >h2 = {'key1'=&gt;'val1', 'KEY_TWO'=&gt;'val2', 'key3'=&gt;'VALUE_3', 'key4'=&gt;'val4'}</font></div><div><font size="2"  >p( h1.keys &amp; h2.keys ) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # set intersection (keys)</font></div><div><font size="2"  >#=&gt; ["key1", "key3", "key4"]</font></div><div><font size="2"  >p( h1.values &amp; h2.values ) &nbsp; &nbsp; &nbsp; &nbsp;# set intersection (values)</font></div><div><font size="2"  >#=&gt; ["val1", "val2", "val4"] &nbsp; &nbsp;</font></div><div><font size="2"  >p( h1.keys+h2.keys ) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# concatenation</font></div><div><font size="2"  >#=&gt; [ "key1", "key2", "key3", "key4", "key1", "key3", "key4", "KEY_TWO"]</font></div><div><font size="2"  >p( h1.values-h2.values ) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# difference</font></div><div><font size="2"  >#=&gt; ["val3"]</font></div><div><font size="2"  >p( (h1.keys &lt;&lt; h2.keys) &nbsp;) # append</font></div><div><font size="2"  >#=&gt; ["key1", "key2", "key3", "key4", ["key1", "key3", "key4", "KEY_TWO"]]</font></div><div><font size="2"  >p( (h1.keys &lt;&lt; h2.keys).flatten.reverse &nbsp;) # 'un-nest' arrays and reverse</font></div><div><font size="2"  >#=&gt; ["KEY_TWO", "key4", "key3", "key1", "key4", "key3", "key2", "key1"]</font></div><p></p></pre></div><div style="line-height: 22px;"  ><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  style="line-height: 20px;"  ><br></font></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >Matrix and Vector class</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >1. introduce</font></span></div><div style="line-height: 22px;"  ><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  style="line-height: 20px;"  ><span style="line-height: 25px;"  >Matrix和Vector一般用于数学运算, 下面是一个例子 :&nbsp;</span></font></div><div style="line-height: 22px;"  ><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  style="line-height: 20px;"  ><span style="line-height: 25px;"  >使用Vector和Matrix类时需要包含Matrix模块.</span></font></div><div><pre class="prettyprint"  ><div><font size="2"  >require "Matrix" &nbsp; &nbsp;# This is essential!</font></div><div><font size="2"  >m1 = Matrix[ [1,2,3,4],</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [5,6,7,8],</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [9,10,11,12],</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [13,14,15,16] &nbsp;]</font></div><div><font size="2"  >m2 = Matrix[ [10,20,30,40],</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [50,60,70,80],</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [90,100,110,120],</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [130,140,150,160] &nbsp;]</font></div><div><font size="2"  >m3 = m1+m2</font></div><div><font size="2"  >p(m3)</font></div><p></p></pre></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >执行结果 :&nbsp;</font></span></div><div><pre class="prettyprint"  ><p><font size="2"  >Matrix[[11, 22, 33, 44], [55, 66, 77, 88], [99, 110, 121, 132], [143, 154, 165, 176]]</font></p></pre></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >如果把Matrix理解为一个阵列, Vector可以理解为整列里的行.</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >下面看看如何把Vector类型转换成Matrix类型 :&nbsp;</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><div>require "Matrix"</div><div><pre class="prettyprint"  ><p></p><div>v1 = Vector[1,2,3,4,5]</div><div>v2 = Vector[6,7,8,9,10]</div><div>m1 = Matrix.columns([v1,v2]) # 按列组织成Matrix</div><div>p( m1 )</div><div>m2 = Matrix.rows([v1,v2])  # 按行组装成Matrix</div><div>p( m2 )</div><p></p></pre></div></span></font></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >执行结果 :&nbsp;</font></span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  size="2"  ><span style="line-height: 20px;"  ><div><pre class="prettyprint"  ><p></p><div>Matrix[[1, 6], [2, 7], [3, 8], [4, 9], [5, 10]]</div><div>Matrix[[1, 2, 3, 4, 5], [6, 7, 8, 9, 10]]</div><p></p></pre></div><div><br></div></span></font></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >Set class</font></span></div><div style="line-height: 22px;"  ><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >1. introduce</font></span></div><font size="2"  ><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  ><span style="line-height: 25px;"  >Set存储的是无序的无重复值的数组. 与Array不同之处就是它存储的值没有重复的.</span></div><div><font color="#333333"  face="Arial, Helvetica, simsun, u5b8bu4f53"  ><div><pre class="prettyprint"  ><p></p><div>require "Set"</div><div>s1 = Set.new([nil,nil,1,1,2,2,3,4,5,0,0])</div><div>p s1</div><p></p></pre></div><div>执行结果 :&nbsp;</div><div><pre class="prettyprint"  ><p>#&lt;Set: {nil, 1, 2, 3, 4, 5, 0}&gt;</p></pre></div></font></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  >它的方法和Array类似, 如下 :&nbsp;</div><div><pre class="prettyprint"  ><p>[:!, :!=, :!~, :&amp;, :+, :-, :&lt;&lt;, :&lt;=&gt;, :==, :===, :=~, :^, :__id__, :__send__, :add, :add?, :all?, :any?, :chunk, :class, :classify, :clear, :clone, :collect, :collect!, :collect_concat, :count, :cycle, :define_singleton_method, :delete, :delete?, :delete_if, :detect, :difference, :display, :divide, :drop, :drop_while, :dup, :each, :each_cons, :each_entry, :each_slice, :each_with_index, :each_with_object, :empty?, :entries, :enum_for, :eql?, :equal?, :extend, :find, :find_all, :find_index, :first, :flat_map, :flatten, :flatten!, :flatten_merge, :freeze, :frozen?, :grep, :group_by, :hash, :include?, :initialize_clone, :initialize_dup, :inject, :inspect, :instance_eval, :instance_exec, :instance_of?, :instance_variable_defined?, :instance_variable_get, :instance_variable_set, :instance_variables, :intersection, :is_a?, :keep_if, :kind_of?, :length, :map, :map!, :max, :max_by, :member?, :merge, :method, :methods, :min, :min_by, :minmax, :minmax_by, :nil?, :none?, :object_id, :one?, :partition, :pretty_print, :pretty_print_cycle, :private_methods, :proper_subset?, :proper_superset?, :protected_methods, :public_method, :public_methods, :public_send, :reduce, :reject, :reject!, :replace, :respond_to?, :respond_to_missing?, :reverse_each, :select, :select!, :send, :singleton_class, :singleton_methods, :size, :slice_before, :sort, :sort_by, :subset?, :subtract, :superset?, :taint, :tainted?, :take, :take_while, :tap, :to_a, :to_enum, :to_s, :to_set, :trust, :union, :untaint, :untrust, :untrusted?, :zip, :|]</p></pre></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  ><br></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  ><br></div><div style="color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53; line-height: 20px;"  ><br></div></font><span style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >【参考】</font></span><div style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >The Book Of Ruby</font></div><div style="line-height: 25px; color: rgb(51, 51, 51); font-family: Arial, Helvetica, simsun, u5b8bu4f53;"  ><font size="2"  style="line-height: 20px;"  >Ruby 1.9.3 API</font></div><wbr></div>
	</div>
</div>
</body>
</html>