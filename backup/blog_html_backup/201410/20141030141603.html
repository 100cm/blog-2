<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Docker usage basics</h2>
	<h5 id="">2014-10-30 14:16:03&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402014930101521709/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>使用docker的一些基本操作</div><div>1. 安装docker,&nbsp;<span style="line-height: 28px;"   >启动docker 服务</span></div><div>2. 检查版本信息</div><div>3.&nbsp;<span style="line-height: 28px;"   >从docker hub搜索, 下载镜像</span></div><div>4. 启动container</div><div>5. container交互模式</div><div>6. 改变docker后台进程的监听端口</div><div>7. 连接到非默认端口或远程docker后台进程</div><div>8. 启动后台container</div><div>9. 查看运行或未运行的container</div><div>10. 控制container(停止,重启,删除等)</div><wbr><div><span style="line-height: 28px;"   >11. container net</span></div><div><span style="line-height: 28px;"   >12. container 端口映射</span></div><div>13. 保存container状态, (打包image)</div><div>14. 上传image到docker hub</div><div><br></div><div><div style="line-height: 28px;"   >1. 安装docker, 启动docker 服务</div><div><pre class="prettyprint"   ><p style="line-height: 28px;"   ></p><div style="line-height: 28px;"   ><font size="2"   >centos 6.x x64&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >  首先要导入epel</font></div><div style="line-height: 28px;"   ><font size="2"   >  <a target="_blank" rel="nofollow" href="https://fedoraproject.org/wiki/EPEL#How_can_I_use_these_extra_packages.3F"   >https://fedoraproject.org/wiki/EPEL#How_can_I_use_these_extra_packages.3F</a></font></div><div style="line-height: 28px;"   ><font size="2"   >  yum install -y docker-io</font></div><div style="line-height: 28px;"   ><font size="2"   ><br></font></div><div style="line-height: 28px;"   ><font size="2"   >centos 7.x x64</font></div><div style="line-height: 28px;"   ><font size="2"   >  直接安装</font></div><div style="line-height: 28px;"   ><font size="2"   >  yum install -y docker</font></div><div style="line-height: 28px;"   ><font size="2"   ><br></font></div><div><font size="2"   >[root@db-172-16-3-221 ~]# service docker start</font></div><p style="line-height: 28px;"   ></p></pre></div><div style="line-height: 28px;"   >2. 检查版本信息</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker info</font></div><div style="line-height: 28px;"   ><font size="2"   >Containers: 5</font></div><div style="line-height: 28px;"   ><font size="2"   >Images: 104</font></div><div style="line-height: 28px;"   ><font size="2"   >Storage Driver: devicemapper</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;Pool Name: docker-8:49-17826869-pool</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;Data file: /var/lib/docker/devicemapper/devicemapper/data</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;Metadata file: /var/lib/docker/devicemapper/devicemapper/metadata</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;Data Space Used: 2531.7 Mb</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;Data Space Total: 102400.0 Mb</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;Metadata Space Used: 4.1 Mb</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp;Metadata Space Total: 2048.0 Mb</font></div><div style="line-height: 28px;"   ><font size="2"   >Execution Driver: native-0.2</font></div><div style="line-height: 28px;"   ><font size="2"   >Kernel Version: 2.6.32-431.el6.x86_64</font></div><div style="line-height: 28px;"   ><font size="2"   >Username: digoal</font></div><div style="line-height: 28px;"   ><font size="2"   >Registry: [https://index.docker.io/v1/]</font></div><p></p></pre></div></div><div style="line-height: 28px;"   >3. 从docker hub搜索, 下载镜像</div><div style="line-height: 28px;"   >下载镜像不需要注册docker hub账号. 可以下载public images.</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker search centos</font></div><div><font size="2"   >NAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DESCRIPTION &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STARS &nbsp; &nbsp; OFFICIAL &nbsp; AUTOMATED</font></div><div><font size="2"   >centos &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The official build of CentOS. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 556 &nbsp; &nbsp; &nbsp; [OK] &nbsp;&nbsp;</font></div></div><div><font size="2"   >........</font></div><div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker pull centos</font></div><div><font size="2"   >Pulling repository centos</font></div><div><font size="2"   >68edf809afe7: Download complete&nbsp;</font></div><div><font size="2"   >504a65221a38: Download complete&nbsp;</font></div><div><font size="2"   >87e5b6b3ccc1: Download complete&nbsp;</font></div><div><font size="2"   >511136ea3c5a: Download complete&nbsp;</font></div><div><font size="2"   >5b12ef8fd570: Download complete&nbsp;</font></div></div><p></p></pre></div><div style="line-height: 28px;"   >4. 启动container</div><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >查看本地镜像, 如果不在本地, 会自动从docker hub下载到本地,&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >镜像是只读的, 可以基于镜像启动container</font></div><div><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker images</font></div><div style="line-height: 28px;"   ><font size="2"   >REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VIRTUAL SIZE</font></div><div style="line-height: 28px;"   ><font size="2"   >digoal/postgres &nbsp; &nbsp; 9.3.5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a7ef5455170d &nbsp; &nbsp; &nbsp; &nbsp;21 hours ago &nbsp; &nbsp; &nbsp; &nbsp;212.9 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9.4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 68b6ddf9ca08 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;213.6 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9.4-beta3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 68b6ddf9ca08 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;213.6 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9.3.5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 935836384c52 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;212.9 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;935836384c52 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;212.9 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9.3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 935836384c52 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;212.9 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 935836384c52 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;212.9 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9.2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2a9ab0b9fa56 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;212.7 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9.2.9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2a9ab0b9fa56 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;212.7 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9.1.14 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ee60947f6805 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;212.1 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9.1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ee60947f6805 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;212.1 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9.0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f29be88283f6 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;211.5 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9.0.18 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;f29be88283f6 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;211.5 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c57c14beb696 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;211 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8.4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c57c14beb696 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;211 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8.4.22 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c57c14beb696 &nbsp; &nbsp; &nbsp; &nbsp;8 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;211 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >postgres &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9.4-beta2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bf872395e1d4 &nbsp; &nbsp; &nbsp; &nbsp;3 weeks ago &nbsp; &nbsp; &nbsp; &nbsp; 213.6 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >centos &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;centos5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 504a65221a38 &nbsp; &nbsp; &nbsp; &nbsp;4 weeks ago &nbsp; &nbsp; &nbsp; &nbsp; 467.1 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >centos &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;centos6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 68edf809afe7 &nbsp; &nbsp; &nbsp; &nbsp;4 weeks ago &nbsp; &nbsp; &nbsp; &nbsp; 212.7 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >centos &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;centos7 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 87e5b6b3ccc1 &nbsp; &nbsp; &nbsp; &nbsp;4 weeks ago &nbsp; &nbsp; &nbsp; &nbsp; 224 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >centos &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;87e5b6b3ccc1 &nbsp; &nbsp; &nbsp; &nbsp;4 weeks ago &nbsp; &nbsp; &nbsp; &nbsp; 224 MB</font></div><div style="line-height: 28px;"   ><font size="2"   >启动container</font></div><div style="line-height: 28px;"   ><font size="2"   >用法 :&nbsp;</font></div><div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker help run</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Usage: docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Run a command in a new container</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; -a, --attach=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Attach to stdin, stdout or stderr.</font></div><div><font size="2"   >&nbsp; -c, --cpu-shares=0 &nbsp; &nbsp; &nbsp; &nbsp; CPU shares (relative weight)</font></div><div><font size="2"   >&nbsp; --cidfile="" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write the container ID to the file</font></div><div><font size="2"   >&nbsp; --cpuset="" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CPUs in which to allow execution (0-3, 0,1)</font></div><div><font size="2"   >&nbsp; -d, --detach=false &nbsp; &nbsp; &nbsp; &nbsp; Detached mode: Run container in the background, print new container id</font></div><div><font size="2"   >&nbsp; --dns=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set custom dns servers</font></div><div><font size="2"   >&nbsp; --dns-search=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Set custom dns search domains</font></div><div><font size="2"   >&nbsp; -e, --env=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set environment variables</font></div><div><font size="2"   >&nbsp; --entrypoint="" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Overwrite the default entrypoint of the image</font></div><div><font size="2"   >&nbsp; --env-file=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Read in a line delimited file of ENV variables</font></div><div><font size="2"   >&nbsp; --expose=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Expose a port from the container without publishing it to your host</font></div><div><font size="2"   >&nbsp; -h, --hostname="" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Container host name</font></div><div><font size="2"   >&nbsp; -i, --interactive=false &nbsp; &nbsp;Keep stdin open even if not attached</font></div><div><font size="2"   >&nbsp; --link=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Add link to another container (name:alias)</font></div><div><font size="2"   >&nbsp; --lxc-conf=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(lxc exec-driver only) Add custom lxc options --lxc-conf="lxc.cgroup.cpuset.cpus = 0,1"</font></div><div><font size="2"   >&nbsp; -m, --memory="" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Memory limit (format: &lt;number&gt;&lt;optional unit&gt;, where unit = b, k, m or g)</font></div><div><font size="2"   >&nbsp; --name="" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Assign a name to the container</font></div><div><font size="2"   >&nbsp; --net="bridge" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set the Network mode for the container</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'bridge': creates a new network stack for the container on the docker bridge</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'none': no networking for this container</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'container:&lt;name|id&gt;': reuses another container network stack</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'host': use the host network stack inside the container. &nbsp;Note: the host mode gives the container full access to local system services such as D-bus and is therefore considered insecure.</font></div><div><font size="2"   >&nbsp; -P, --publish-all=false &nbsp; &nbsp;Publish all exposed ports to the host interfaces</font></div><div><font size="2"   >&nbsp; -p, --publish=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Publish a container's port to the host</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;format: ip:hostPort:containerPort | ip::containerPort | hostPort:containerPort</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(use 'docker port' to see the actual mapping)</font></div><div><font size="2"   >&nbsp; --privileged=false &nbsp; &nbsp; &nbsp; &nbsp; Give extended privileges to this container</font></div><div><font size="2"   >&nbsp; --rm=false &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Automatically remove the container when it exits (incompatible with -d)</font></div><div><font size="2"   >&nbsp; --sig-proxy=true &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Proxify received signals to the process (even in non-tty mode). SIGCHLD is not proxied.</font></div><div><font size="2"   >&nbsp; -t, --tty=false &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allocate a pseudo-tty</font></div><div><font size="2"   >&nbsp; -u, --user="" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Username or UID</font></div><div><font size="2"   >&nbsp; -v, --volume=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Bind mount a volume (e.g., from the host: -v /host:/container, from docker: -v /container)</font></div><div><font size="2"   >&nbsp; --volumes-from=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Mount volumes from the specified container(s)</font></div><div><font size="2"   >&nbsp; -w, --workdir="" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Working directory inside the container</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker run -d --name hello postgres:9.3.5</font></div><div><font size="2"   >358c3b256ed3eb2465b4bcdf95ffef6ab8449452d9b68dc26d22649965e22105</font></div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker ps</font></div><div><font size="2"   >CONTAINER ID &nbsp; &nbsp; &nbsp; &nbsp;IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</font></div><div><font size="2"   >358c3b256ed3 &nbsp; &nbsp; &nbsp; &nbsp;postgres:9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/docker-entrypoint.s &nbsp; 4 seconds ago &nbsp; &nbsp; &nbsp; Up 3 seconds &nbsp; &nbsp; &nbsp; &nbsp;5432/tcp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hello</font></div></div></div><p></p></pre></div><div><br></div><div style="line-height: 28px;"   >5. 启动container交互模式</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker run -t -i --name hello123 postgres:9.3.5 /bin/bash</font></div><div style="line-height: 28px;"   ><font size="2"   >root@fc2bb8e60b49:/#</font></div><p></p></pre></div><div style="line-height: 28px;"   ><br></div></div><div style="line-height: 28px;"   >6. 改变docker后台进程的监听端口</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# service docker stop</font></div><div style="line-height: 28px;"   ><font size="2"   >Stopping docker: [ &nbsp;OK &nbsp;]</font></div><div style="line-height: 28px;"   ><font size="2"   >使用docker -d启动后台服务.</font></div></div><div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker -d</font></div><div><font size="2"   >2014/10/30 13:39:21 WARNING: You are running linux kernel version 2.6.32-431.el6.x86_64, which might be unstable running docker. Please upgrade your kernel to 3.8.0.</font></div><div><font size="2"   >2014/10/30 13:39:21 docker daemon: 1.1.2 d84a070/1.1.2; execdriver: native; graphdriver:&nbsp;</font></div><div><font size="2"   >[ce9e52b6] +job serveapi(unix:///var/run/docker.sock)</font></div><div><font size="2"   >[ce9e52b6] +job initserver()</font></div><div><font size="2"   >[ce9e52b6.initserver()] Creating server</font></div><div><font size="2"   >2014/10/30 13:39:21 Listening for HTTP on unix (/var/run/docker.sock)</font></div><div><font size="2"   >[ce9e52b6] +job init_networkdriver()</font></div><div><font size="2"   >[ce9e52b6] -job init_networkdriver() = OK (0)</font></div><div><font size="2"   >Loading containers: ..........[error] driver.go:140 Warning: error unmounting device ca64905e843ab439926406d19378d4c5c7419bb584a4379a39890efea63ce23e: UnmountDevice: device not-mounted id ca64905e843ab439926406d19378d4c5c7419bb584a4379a39890efea63ce23e</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >..[error] driver.go:140 Warning: error unmounting device 8238bc46c1dad147536006be4f08561b87ad014b59d928b8521263cd5b96cb4d: UnmountDevice: device not-mounted id 8238bc46c1dad147536006be4f08561b87ad014b59d928b8521263cd5b96cb4d</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >.[error] driver.go:140 Warning: error unmounting device aab6a732ddbc43e2cab846aede454c7a39342412852691982231d0e000eb5d0a: UnmountDevice: device not-mounted id aab6a732ddbc43e2cab846aede454c7a39342412852691982231d0e000eb5d0a</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >.[error] driver.go:140 Warning: error unmounting device 358c3b256ed3eb2465b4bcdf95ffef6ab8449452d9b68dc26d22649965e22105: UnmountDevice: device not-mounted id 358c3b256ed3eb2465b4bcdf95ffef6ab8449452d9b68dc26d22649965e22105</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >..[error] driver.go:140 Warning: error unmounting device 7c99c4f4a01f0640dd1f236d3f597269a22f922d5292119cddd23ace1f082fc0: UnmountDevice: device not-mounted id 7c99c4f4a01f0640dd1f236d3f597269a22f922d5292119cddd23ace1f082fc0</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >..[error] driver.go:140 Warning: error unmounting device edae35acc741902a34b26e66e567bc7a3639981dd38967620b08ccbb37f0223c: UnmountDevice: device not-mounted id edae35acc741902a34b26e66e567bc7a3639981dd38967620b08ccbb37f0223c</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >[ce9e52b6] +job release_interface(358c3b256ed3eb2465b4bcdf95ffef6ab8449452d9b68dc26d22649965e22105)</font></div><div><font size="2"   >No network information to release for 358c3b256ed3eb2465b4bcdf95ffef6ab8449452d9b68dc26d22649965e22105</font></div><div><font size="2"   >[ce9e52b6] -job release_interface(358c3b256ed3eb2465b4bcdf95ffef6ab8449452d9b68dc26d22649965e22105) = ERR (1)</font></div><div><font size="2"   >[error] driver.go:140 Warning: error unmounting device 358c3b256ed3eb2465b4bcdf95ffef6ab8449452d9b68dc26d22649965e22105: UnmountDevice: device not-mounted id 358c3b256ed3eb2465b4bcdf95ffef6ab8449452d9b68dc26d22649965e22105</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >: done.</font></div><div><font size="2"   >[ce9e52b6.initserver()] Creating pidfile</font></div><div><font size="2"   >[ce9e52b6.initserver()] Setting up signal traps</font></div><div><font size="2"   >[ce9e52b6] -job initserver() = OK (0)</font></div><div><font size="2"   >[ce9e52b6] +job acceptconnections()</font></div><div><font size="2"   >[ce9e52b6] -job acceptconnections() = OK (0)</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >删除一个container 可以看到 docker 控制台的输出 :&nbsp;</font></div><div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker rm b3e755c4b710</font></div><div><font size="2"   >b3e755c4b710</font></div></div><div><font size="2"   >控制台输出</font></div><div><div><font size="2"   >2014/10/30 13:41:10 DELETE /v1.13/containers/b3e755c4b710</font></div><div><font size="2"   >[ce9e52b6] +job container_delete(b3e755c4b710)</font></div><div><font size="2"   >[ce9e52b6] -job container_delete(b3e755c4b710) = OK (0)</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >启动docker server时改变docker监听 :&nbsp;</font></div><div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;-H, --host=[unix:///var/run/docker.sock]: tcp://[host:port] to bind or unix://[/path/to/socket] &nbsp;to &nbsp;use. &nbsp; The</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;socket(s) to bind to in daemon mode specified using one or more tcp://host:port, unix:///path/to/socket, fd://*</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;or fd://socketfd.</font></div></div><div><font size="2"   >例如</font></div><div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker -d -H tcp://0.0.0.0:9999 -H unix:///tmp/.docker.9999.sock</font></div><div><font size="2"   >2014/10/30 13:51:30 WARNING: You are running linux kernel version 2.6.32-431.el6.x86_64, which might be unstable running docker. Please upgrade your kernel to 3.8.0.</font></div><div><font size="2"   >2014/10/30 13:51:30 docker daemon: 1.1.2 d84a070/1.1.2; execdriver: native; graphdriver:&nbsp;</font></div><div><font size="2"   >[bb265d31] +job serveapi(tcp://0.0.0.0:9999, unix:///tmp/.docker.9999.sock)</font></div><div><font size="2"   >[bb265d31] +job initserver()</font></div><div><font size="2"   >[bb265d31.initserver()] Creating server</font></div><div><font size="2"   >2014/10/30 13:51:30 Listening for HTTP on tcp (0.0.0.0:9999)</font></div><div><font size="2"   >2014/10/30 13:51:30 /!\ DON'T BIND ON ANOTHER IP ADDRESS THAN 127.0.0.1 IF YOU DON'T KNOW WHAT YOU'RE DOING /!\</font></div><div><font size="2"   >2014/10/30 13:51:30 Listening for HTTP on unix (/tmp/.docker.9999.sock)</font></div><div><font size="2"   >[bb265d31] +job init_networkdriver()</font></div><div><font size="2"   >[bb265d31] -job init_networkdriver() = OK (0)</font></div><div><font size="2"   >Loading containers: ......: done.</font></div><div><font size="2"   >[bb265d31.initserver()] Creating pidfile</font></div><div><font size="2"   >[bb265d31.initserver()] Setting up signal traps</font></div><div><font size="2"   >[bb265d31] -job initserver() = OK (0)</font></div><div><font size="2"   >[bb265d31] +job acceptconnections()</font></div><div><font size="2"   >[bb265d31] -job acceptconnections() = OK (0)</font></div></div><p></p></pre></div></div><div><br></div><div style="line-height: 28px;"   >7. 连接到非默认端口或远程docker后台进程</div><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >例如, 连接到监听为9999端口的docker server :&nbsp;</font></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker -H 127.0.0.1:9999 ps</font></div><div style="line-height: 28px;"   ><font size="2"   >CONTAINER ID &nbsp; &nbsp; &nbsp; &nbsp;IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</font></div></div><p></p></pre></div><div style="line-height: 28px;"   ><br></div><div style="line-height: 28px;"   >8. 启动后台container</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker help run</font></div><div><font size="2"   >Usage: docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</font></div><div><font size="2"   >Run a command in a new container</font></div><div><font size="2"   >&nbsp; -d, --detach=false &nbsp; &nbsp; &nbsp; &nbsp; Detached mode: Run container in the background, print new container id</font></div></div><div style="line-height: 28px;"   ><font size="2"   >例如 :&nbsp;</font></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker -H 127.0.0.1:9999 run -d postgres:9.3.5</font></div><div style="line-height: 28px;"   ><font size="2"   >611a769c1c468d11178a341959109dc0ee3ae581edb2103cf8e1379e8cc077c8</font></div></div><p></p></pre></div><div style="line-height: 28px;"   ><br></div><div style="line-height: 28px;"   >9. 查看运行或未运行的container</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker -H 127.0.0.1:9999 ps -a</font></div><div style="line-height: 28px;"   ><font size="2"   >CONTAINER ID &nbsp; &nbsp; &nbsp; &nbsp;IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</font></div><div style="line-height: 28px;"   ><font size="2"   >611a769c1c46 &nbsp; &nbsp; &nbsp; &nbsp;postgres:9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/docker-entrypoint.s &nbsp; 17 seconds ago &nbsp; &nbsp; &nbsp;Up 16 seconds &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5432/tcp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mad_ritchie &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >358c3b256ed3 &nbsp; &nbsp; &nbsp; &nbsp;postgres:9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/docker-entrypoint.s &nbsp; 18 minutes ago &nbsp; &nbsp; &nbsp;Exited (0) 15 minutes ago &nbsp; 5432/tcp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;elegant_brattain &nbsp; &nbsp; &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >ca64905e843a &nbsp; &nbsp; &nbsp; &nbsp;postgres:9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/docker-entrypoint.s &nbsp; 27 hours ago &nbsp; &nbsp; &nbsp; &nbsp;Exited (0) 15 minutes ago &nbsp; 5432/tcp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;determined_rosalind &nbsp;&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >aab6a732ddbc &nbsp; &nbsp; &nbsp; &nbsp;postgres:9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/docker-entrypoint.s &nbsp; 44 hours ago &nbsp; &nbsp; &nbsp; &nbsp;Exited (0) 15 minutes ago &nbsp; 5432/tcp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;jolly_fermi &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >edae35acc741 &nbsp; &nbsp; &nbsp; &nbsp;postgres:9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/docker-entrypoint.s &nbsp; 44 hours ago &nbsp; &nbsp; &nbsp; &nbsp;Exited (0) 15 minutes ago &nbsp; 5432/tcp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;kickass_poincare &nbsp; &nbsp; &nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >7c99c4f4a01f &nbsp; &nbsp; &nbsp; &nbsp;postgres:9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/docker-entrypoint.s &nbsp; 44 hours ago &nbsp; &nbsp; &nbsp; &nbsp;Exited (0) 15 minutes ago &nbsp; 5432/tcp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hopeful_tesla &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >8238bc46c1da &nbsp; &nbsp; &nbsp; &nbsp;postgres:9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/docker-entrypoint.s &nbsp; 44 hours ago &nbsp; &nbsp; &nbsp; &nbsp;Exited (0) 15 minutes ago &nbsp; 5432/tcp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;prickly_bohr &nbsp; &nbsp;</font></div><p></p></pre></div></div><div style="line-height: 28px;"   ><br></div><div style="line-height: 28px;"   >10. 控制container(停止,重启,删除等)</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker stop be885c1251cc</font></div><div style="line-height: 28px;"   ><font size="2"   >be885c1251cc</font></div><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker restart be885c1251cc</font></div><div style="line-height: 28px;"   ><font size="2"   >be885c1251cc</font></div><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker stop be885c1251cc</font></div><div style="line-height: 28px;"   ><font size="2"   >be885c1251cc</font></div><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker kill be885c1251cc</font></div><div style="line-height: 28px;"   ><font size="2"   >be885c1251cc</font></div><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker rm be885c1251cc</font></div><div style="line-height: 28px;"   ><font size="2"   >be885c1251cc</font></div><p></p></pre></div></div></div></div><div style="line-height: 28px;"   ><br></div><wbr style="line-height: 28px;"   ><div style="line-height: 28px;"   ><span style="line-height: 28px;"   >11. container net</span></div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker help run</font></div><div><font size="2"   >Usage: docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</font></div><div><font size="2"   >Run a command in a new container</font></div></div><div><div><font size="2"   >&nbsp; --dns=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set custom dns servers</font></div><div><font size="2"   >&nbsp; --dns-search=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Set custom dns search domains</font></div></div><div><div><font size="2"   >&nbsp; --net="bridge" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set the Network mode for the container</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'bridge': creates a new network stack for the container on the docker bridge</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'none': no networking for this container</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'container:&lt;name|id&gt;': reuses another container network stack</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'host': use the host network stack inside the container. &nbsp;Note: the host mode gives the container full access to local system services such as D-bus and is therefore considered insecure.</font></div></div><div><font size="2"   >启动container时指定即可.</font></div><div><font size="2"   >如果要让DOCKER服务端自动改写iptables运行container访问外网, 可以使用--net="host"</font></div><div style="line-height: 28px;"   ><span style="line-height: 28px;"   ><font size="2"   >例如 :&nbsp;</font></span></div><div style="line-height: 28px;"   ><span style="line-height: 28px;"   ><font size="2"   ><div style="line-height: 28px;"   >[root@db-172-16-3-221 ~]# docker run -t -i --rm --net="host" centos:centos7 /bin/bash</div><div style="line-height: 28px;"   >bash-4.2# ping www.baidu.com</div><div style="line-height: 28px;"   >PING www.a.shifen.com (115.239.210.27) 56(84) bytes of data.</div><div style="line-height: 28px;"   >64 bytes from 115.239.210.27: icmp_seq=1 ttl=56 time=2.44 ms</div><div style="line-height: 28px;"   >64 bytes from 115.239.210.27: icmp_seq=2 ttl=56 time=2.40 ms</div></font></span></div><div style="line-height: 28px;"   ><span style="line-height: 28px;"   ><font size="2"   ><br></font></span></div><div style="line-height: 28px;"   ><span style="line-height: 28px;"   ><font size="2"   >12. container 端口映射</font></span></div><div style="line-height: 28px;"   ><span style="line-height: 28px;"   ><font size="2"   >docker help run</font></span></div><div style="line-height: 28px;"   ><span style="line-height: 28px;"   ><font size="2"   ><div style="line-height: 28px;"   >&nbsp; -P, --publish-all=false &nbsp; &nbsp;Publish all exposed ports to the host interfaces</div><div style="line-height: 28px;"   >&nbsp; -p, --publish=[] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Publish a container's port to the host</div><div style="line-height: 28px;"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;format: ip:hostPort:containerPort | ip::containerPort | hostPort:containerPort</div><div style="line-height: 28px;"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(use 'docker port' to see the actual mapping)</div><div style="line-height: 28px;"   ><br></div></font></span></div><div style="line-height: 28px;"   ><span style="line-height: 28px;"   ><font size="2"   >动态映射</font></span></div><div style="line-height: 28px;"   ><span style="line-height: 28px;"   ><font size="2"   ><div style="line-height: 28px;"   >[root@db-172-16-3-221 ~]# docker run -d -P postgres:9.3.5</div><div style="line-height: 28px;"   >d76f1559ca83a649895a841ddc2366169d958ff14fb65efc6d276bdeeeb9f1b0</div><div style="line-height: 28px;"   >[root@db-172-16-3-221 ~]# docker ps</div><div style="line-height: 28px;"   >CONTAINER ID &nbsp; &nbsp; &nbsp; &nbsp;IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</div><div style="line-height: 28px;"   >d76f1559ca83 &nbsp; &nbsp; &nbsp; &nbsp;postgres:9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/docker-entrypoint.s &nbsp; 3 seconds ago &nbsp; &nbsp; &nbsp; Up 1 seconds &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:49153-&gt;5432/tcp &nbsp; kickass_wilson</div><div style="line-height: 28px;"   >指定本地端口</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   >[root@db-172-16-3-221 ~]# docker run -d -p 0.0.0.0:9999:5432/tcp postgres:9.3.5</div><div style="line-height: 28px;"   >4cc03cffa249aee4992287228273c88521e41699b4295afa73ace5716ff844bc</div><div style="line-height: 28px;"   >[root@db-172-16-3-221 ~]# docker ps</div><div style="line-height: 28px;"   >CONTAINER ID &nbsp; &nbsp; &nbsp; &nbsp;IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</div><div style="line-height: 28px;"   >4cc03cffa249 &nbsp; &nbsp; &nbsp; &nbsp;postgres:9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/docker-entrypoint.s &nbsp; 4 seconds ago &nbsp; &nbsp; &nbsp; &nbsp;Up 2 seconds &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:9999-&gt;5432/tcp &nbsp; &nbsp;stupefied_euclid&nbsp;</div></div></font></span></div><p></p></pre></div><div style="line-height: 28px;"   ><span style="line-height: 28px;"   ><br></span></div><div style="line-height: 28px;"   >13. 保存container状态, (打包image)</div></div><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >如果对container做了一些修改, 例如安装了一些包, 并且想在下次运行container时不需要重复安装这个动作, 那么可以把当前的container保存为image, 下次启动时启动保存的image即可.</font></div><div style="line-height: 28px;"   ><font size="2"   >例如 :&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >首先启动一个container, 命名为digoal123</font></div><div><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker run --net="host" -t -i --name="digoal123" centos:centos7 /bin/bash</font></div><div style="line-height: 28px;"   ><font size="2"   >bash-4.2# yum install -y vim</font></div><div style="line-height: 28px;"   ><font size="2"   >打包帮助</font></div><div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker help commit</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Usage: docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Create a new image from a container's changes</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; -a, --author="" &nbsp; &nbsp; Author (e.g., "John Hannibal Smith &lt;hannibal@a-team.com&gt;")</font></div><div><font size="2"   >&nbsp; -m, --message="" &nbsp; &nbsp;Commit message</font></div><div><font size="2"   >&nbsp; -p, --pause=true &nbsp; &nbsp;Pause container during commit</font></div></div></div><div><font size="2"   >打包, 放到本地 digoal/postgres:digoal123_vim</font></div><div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker commit -a "digoal" -m "install vim" -p digoal123 digoal/postgres:digoal123_vim</font></div><div><font size="2"   >1ac234066815825d8a79931d11d45624a242d67a29ad3d3789b56b577fa51a91</font></div></div><div style="line-height: 28px;"   ><font size="2"   >接下来可以允许该image, 可以看到vim已经安装好了</font></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 ~]# docker run -t -i --rm digoal/postgres:digoal123_vim /bin/bash</font></div><div style="line-height: 28px;"   ><font size="2"   >bash-4.2# which vim</font></div><div style="line-height: 28px;"   ><font size="2"   >/usr/bin/vim</font></div></div><p></p></pre></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><br></div></div><div><span style="line-height: 28px;"   >14. 上传image到docker hub</span></div><div><pre class="prettyprint"   ><p></p><div><span style="line-height: 28px;"   ><font size="2"   >这个首先要注册docker hub账号, 然后login.</font></span></div><div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker login</font></div><div><font size="2"   >Username: digoal</font></div><div><font size="2"   >Password:&nbsp;</font></div><div><font size="2"   >Email: xxx@xx.xx</font></div><div><font size="2"   >Login Succeeded</font></div></div><div><span style="line-height: 28px;"   ><font size="2"   >最后就是上传</font></span></div><div><font size="2"   >[root@db-172-16-3-221 ~]# docker push digoal/postgres:digoal123_vim</font></div><p></p></pre></div><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="https://docs.docker.com/articles/basics/"   >https://docs.docker.com/articles/basics/</a></div><div><br></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="Docker usage basics - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>