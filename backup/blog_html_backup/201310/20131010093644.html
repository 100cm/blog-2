<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Systemtap Formatted output</h2>
	<h5 id="">2013-10-10 9:36:44&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020139107556275/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><div>本文要讲的是Systemtap中的格式话输出函数 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >print, println, printf, printd, printdln, sprint, sprintf.&nbsp;</font></div><div></div><p></p></pre></div><div><br></div><div>9.1 print</div><div><span style="line-height: 28px;"   >print函数可用于打印输出任何类型,&nbsp;</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >General syntax:</font></div><div><font size="2"   >print ()</font></div><div><font size="2"   >This function prints a single value of <u>any type</u>.</font></div><p></p></pre></div></div><div>例如 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe kernel.function("icmp_echo") {print($skb$$); exit()}'</font></div><div><font size="2"   >{.next=0x0, .prev=0x0, .sk=0x0, .tstamp={.off_sec=1381363468, .off_usec=801990}, .dev=0xffffffff80352b80, .input_dev=0xffffffff80352b80, .h={.th=0xffff810119cbd624, .uh=0xffff810119cbd624, .icmph=0xffff810119cbd624, .igmph=0xffff810119cbd624, .ipiph=0xffff810119cbd624, .ipv6h=0xffff810119cbd624, .raw="}, .nh={.iph=0xffff810119cbd610, .ipv6h=0xffff810119cbd610, .arph=0xffff810119cbd610, .raw="E"}, .mac={.raw=""}, .dst=0xffff8101e76eae40, .sp=0x0, .cb="", .len=56, .data_len=0, .mac_len=14, .csum=1265218710</font></div></div><div><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'global s; probe begin {for(i=0;i&lt;100;i++) s &lt;&lt;&lt; i; print(@hist_log(s)); exit()}'</font></div><div><font size="2"   >value |-------------------------------------------------- count</font></div><div><font size="2"   >&nbsp; &nbsp; 0 |@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1</font></div><div><font size="2"   >&nbsp; &nbsp; 1 |@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1</font></div><div><font size="2"   >&nbsp; &nbsp; 2 |@@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2</font></div><div><font size="2"   >&nbsp; &nbsp; 4 |@@@@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4</font></div><div><font size="2"   >&nbsp; &nbsp; 8 |@@@@@@@@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8</font></div><div><font size="2"   >&nbsp; &nbsp;16 |@@@@@@@@@@@@@@@@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16</font></div><div><font size="2"   >&nbsp; &nbsp;32 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 32</font></div><div><font size="2"   >&nbsp; &nbsp;64 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 36</font></div><div><font size="2"   >&nbsp; 128 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font></div><div><font size="2"   >&nbsp; 256 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font></div></div><p></p></pre></div><div>这里的@hist_log使用printf的%s格式无法输出, 只有使用print才可以正常输出. 或者使用sprint进行转换(sprint后面会讲到)</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'global s; probe begin {for(i=0;i&lt;100;i++) s &lt;&lt;&lt; i; printf("%s", @hist_log(s)); exit()}'</font></div><div><font size="2"   >parse error: base histogram operator where expression expected</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; at: identifier '@hist_log' at &lt;input&gt;:1:65</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;source: global s; probe begin {for(i=0;i&lt;100;i++) s &lt;&lt;&lt; i; printf("%s", @hist_log(s)); exit()}</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;^</font></div><div><font size="2"   >1 parse error.</font></div><div><font size="2"   >Pass 1: parse failed. &nbsp;Try again with another '--vp 1' option.</font></div><p></p></pre></div><div>使用sprint将@hist_log的结果转换为字符串后, 可以使用printf的%s格式进行输出.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'global s1; probe begin {for(i=0;i&lt;100;i++) s1 &lt;&lt;&lt; i; var=sprint(@hist_log(s1)); printf("%s\n", var); exit()}'</font></div><div><font size="2"   >value |-------------------------------------------------- count</font></div><div><font size="2"   >&nbsp; &nbsp; 0 |@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1</font></div><div><font size="2"   >&nbsp; &nbsp; 1 |@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1</font></div><div><font size="2"   >&nbsp; &nbsp; 2 |@@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2</font></div><div><font size="2"   >&nbsp; &nbsp; 4 |@@@@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4</font></div><div><font size="2"   >&nbsp; &nbsp; 8 |@@@@@@@@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8</font></div><div><font size="2"   >&nbsp; &nbsp;16 |@@@@@@@@@@@@@@@@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16</font></div><div><font size="2"   >&nbsp; &nbsp;32 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 32</font></div><div><font size="2"   >&nbsp; &nbsp;64 |@@@@@@@@@@@@@</font></div><p></p></pre></div><div><br></div><div><div>9.2 printf</div><div>printf函数用于格式化输出. &nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >General syntax:</font></div><div><font size="2"   >printf (fmt:string, ...)</font></div><div><font size="2"   >The printf function takes a <u>formatting string</u> as an argument, and a number of values of corresponding&nbsp;<span style="line-height: 28px;"   >types, and prints them all.&nbsp;</span></font></div><div><font size="2"   >The format must be a literal string constant.&nbsp;</font></div><div><font size="2"   >The printf formatting directives&nbsp;<span style="line-height: 28px;"   >are similar to those of C, except that they are fully checked for type by the translator.</span></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >格式语法 : </font></div><div><font size="2"   >The formatting string can contain tags that are de?ned as follows:</font></div><div><font size="2"   ><u>%[flags][width][.precision]specifier</u></font></div><div><font size="2"   >Where specifier is required and de?nes the type and the interpretation of the value of the corresponding&nbsp;<span style="line-height: 28px;"   >argument.&nbsp;</span></font></div><div><span style="line-height: 28px;"   ><font size="2"   >The following table shows the details of the speci?er parameter:</font></span></div><p></p></pre></div><div>格式包含有符号整型, 八进制, 字符串, 无符号整型, 无符号十六进制, 指针类型, 转码值(%b), %符号等.</div><div><img title="Systemtap Formatted output - 德哥@Digoal - PostgreSQL"   alt="Systemtap Formatted output - 德哥@Digoal - PostgreSQL"   src="http://img2.ph.126.net/MDn7f-SjrrGcciFj7ZZfDQ==/6597172021240082645.png"   style="line-height: 28px; margin: 0px 10px 0px 0px;"   ></div><div><br></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >The tag can also contain flags, width, .precision and modifiers sub-speci?ers,&nbsp;</font></div><div><font size="2"   >which are optional and&nbsp;<span style="line-height: 28px;"   >follow these speci?cations:</span></font></div><p></p></pre></div></div><div><div><div>flags包括格式左对齐, 右对齐, (%o,%x,%X的头0, 0x, 0X), 0代替空格等.</div><div>width表示输出宽度. 不够长度的话以空格补齐. 如果输出长度超过指定的宽度, 不会进行截断.</div><div><div><pre class="prettyprint"   ><p style="line-height: 28px;"   ></p><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {printf("%-10.d\n", 123); exit()}'</font></div><div style="line-height: 28px;"   ><font size="2"   >123 &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {printf("%10.d\n", 123); exit()}'</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;123</font></div></div><div style="line-height: 28px;"   ><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {printf("%1.d\n", 123); exit()}'</font></div><div><font size="2"   >123</font></div></div><div style="line-height: 28px;"   ><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {printf("%-1.d\n", 123); exit()}'</font></div><div><font size="2"   >123</font></div></div><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {printf("%#10.x\n", 123); exit()}'<br>      0x7b</font></div><p style="line-height: 28px;"   ></p></pre></div></div><div>精度(注意有数字和字符串格式之分) :&nbsp;</div><div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >For integer specifiers (d, i, o, u, x, X):&nbsp;</font></div><div><font size="2"   >precision specifies the minimum number of digits to be written.&nbsp;</font></div><div><font size="2"   >If the value to be written is shorter than this number, the result is padded with leading zeros.&nbsp;</font></div><div><font size="2"   >The value is not truncated even if the result is longer.&nbsp;</font></div><div><font size="2"   >A precision of 0 means that no character is written for the value 0.&nbsp;</font></div><p></p></pre></div><div>数字长度超出指定的精度时, 不会截断.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {printf("%.10d\n", 99999999); exit()}'</font></div><div><font size="2"   >0099999999</font></div><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {printf("%.3d\n", 99999999); exit()}'</font></div><div><font size="2"   >99999999</font></div><p></p></pre></div><div><pre class="prettyprint"   ><p></p><div><span style="line-height: 28px;"   ><font size="2"   >For s:&nbsp;</font></span></div><div><font size="2"   >this is the maximum number of characters to be printed.&nbsp;</font></div><div><font size="2"   >By default all characters are printed until the ending null character is encountered.&nbsp;</font></div><div><font size="2"   >When no precision is specified, the default is 1.&nbsp;</font></div><div><font size="2"   >If the period is specified without an explicit value for precision, 0 is assumed.&nbsp;</font></div><p></p></pre></div><div>字符串长度超出指定的精度时, 会截断.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {printf("%.1s\n", "hello world"); exit()}'</font></div><div><font size="2"   >h</font></div><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {printf("%.10s\n", "hello world"); exit()}'</font></div><div><font size="2"   >hello worl</font></div><p></p></pre></div></div><div><img title="Systemtap Formatted output - 德哥@Digoal - PostgreSQL"   alt="Systemtap Formatted output - 德哥@Digoal - PostgreSQL"   src="http://img0.ph.126.net/7kI3eMgfio93P75D9rGBYw==/2269532737318079154.png"   style="line-height: 28px; margin: 0px 10px 0px 0px;"   ></div><div><img title="Systemtap Formatted output - 德哥@Digoal - PostgreSQL"   alt="Systemtap Formatted output - 德哥@Digoal - PostgreSQL"   style="margin:0 10px 0 0;"   src="http://img2.ph.126.net/7fxSRMeTMAmM2WgUHf7-9Q==/6597284171425322306.png"   ></div><div><img title="Systemtap Formatted output - 德哥@Digoal - PostgreSQL"   alt="Systemtap Formatted output - 德哥@Digoal - PostgreSQL"   style="margin:0 10px 0 0;"   src="http://img0.ph.126.net/6bbEhIQYuGvNuz6J2eyjxg==/1940769964520162970.png"   ></div><br></div><div><span style="line-height: 28px;"   >Binary Write Examples :&nbsp;</span></div><div>The following is an example of using the binary write functions:</div><div>%b可以用于输出ascii值.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {</font></div><div><font size="2"   >&gt; for (i = 97; i &lt; 110; i++)</font></div><div><font size="2"   >&gt; printf("%3d: %1b%1b%1b\n", i, i, i-32, i-64)</font></div><div><font size="2"   >&gt; exit()</font></div><div><font size="2"   >&gt; }'</font></div><div><font size="2"   >&nbsp;97: aA!</font></div><div><font size="2"   >&nbsp;98: bB"</font></div><div><font size="2"   >&nbsp;99: cC#</font></div><div><font size="2"   >100: dD$</font></div><div><font size="2"   >101: eE%</font></div><div><font size="2"   >102: fF&amp;</font></div><div><font size="2"   >103: gG'</font></div><div><font size="2"   >104: hH(</font></div><div><font size="2"   >105: iI)</font></div><div><font size="2"   >106: jJ*</font></div><div><font size="2"   >107: kK+</font></div><div><font size="2"   >108: lL,</font></div><div><font size="2"   >109: mM-</font></div><p></p></pre></div></div><div><span style="line-height: 28px;"   >Another example:</span></div><div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin{printf("%b%b", 0xc0dedbad, <span style="line-height: 28px;"   >0x12345678);exit()}'| hexdump -C</span></font></div><div><font size="2"   >00000000 &nbsp;ad db de c0 00 00 00 00 &nbsp;78 56 34 12 00 00 00 00 &nbsp;|........xV4.....|</font></div><div><font size="2"   >00000010</font></div><p></p></pre></div><div><span style="line-height: 28px;"   >Another example:</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin{</font></div><div><font size="2"   >&gt; printf("%1b%1b%1blo %1b%1brld\n", 72,101,108,87,111)</font></div><div><font size="2"   >&gt; exit()</font></div><div><font size="2"   >&gt; }'</font></div><div><font size="2"   >Hello World</font></div><p></p></pre></div><div><br></div><div>9.3 printd</div><div>用于输出带分隔符的字符串.</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >General syntax:</font></div><div><font size="2"   >printd (delimiter:string, ...)</font></div><div><font size="2"   >This function takes a string delimiter and two or more values of any type, then prints the values with the&nbsp;<span style="line-height: 28px;"   >delimiter interposed.&nbsp;</span></font></div><div><font size="2"   >The delimiter must be a literal string constant.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >For example:</font></div></div><div><div><font size="2"   >printd("/", "one", "two", "three", 4, 5, 6)</font></div><div><font size="2"   >prints:</font></div><div><font size="2"   >one/two/three/4/5/6</font></div></div><p></p></pre></div></div><div><div><br></div><div>9.4 printdln</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >General syntax:</font></div><div><font size="2"   >printdln (delimiter:string, ...)</font></div><div><font size="2"   >This function operates like printd, but also appends a newline.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >与printd类似, 只是末尾自动添加一个换行.</font></div><div><font size="2"   ><div>[root@db-172-16-3-39 ~]# stap -e 'probe begin {printdln("/", "one", "two", "three", 4, 5, 6); exit()}'</div><div>one/two/three/4/5/6</div><div>[root@db-172-16-3-39 ~]#&nbsp;</div></font></div><p></p></pre></div><div><br></div><div>9.5 println</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >General syntax:</font></div><div><font size="2"   >println ()</font></div><div><font size="2"   >This function prints a single value like print, but also appends a newline.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >println(), 就是带换行的print()</font></div><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {print("hello"); exit()}'<br>hello[root@db-172-16-3-39 ~]# stap -e 'probe begin {println("hello"); exit()}'<br>hello</font></div><p></p></pre></div><div><br></div><div>9.6 sprint</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >General syntax:</font></div><div><font size="2"   >sprint:string ()</font></div><div><font size="2"   >This function operates like print, but returns the string rather than printing it.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >sprint和print类似, 但是sprint不是将字符串输出到标准输出, 而是返回字符串.</font></div><div><font size="2"   >sprint不能单独执行, 需要赋值给变量.</font></div><div><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {sprint("hello"); exit()}'</font></div><div><font size="2"   >WARNING: Eliding side-effect-free expression : identifier 'sprint' at &lt;input&gt;:1:14</font></div><div><font size="2"   >&nbsp;source: probe begin {sprint("hello"); exit()}</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ^</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >[root@db-172-16-3-39 ~]# stap -e 'probe begin {var=sprint("hello"); println(var); exit()}'</font></div><div><font size="2"   >hello</font></div></div><p></p></pre></div><div>需要把特殊的标准输出转换为字符串是可以考虑使用sprint, 例如本文中的@hist_log例子</div><div><br></div><div>9.7 sprintf</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >General syntax:</font></div><div><font size="2"   >sprintf:string (fmt:string, ...)</font></div><div><font size="2"   >This function operates like printf, but returns the formatted string rather than printing it.</font></div></div><div><span style="line-height: 28px;"   ><font size="2"   >sprint和printf类似, 但是sprintf不是将字符串输出到标准输出, 而是返回字符串.</font></span></div><p></p></pre></div></div><div><span style="line-height: 28px;"   ><br></span></div><div><span style="line-height: 28px;"   >[参考]</span></div><wbr><div>1.&nbsp;<a style="line-height: 28px;" rel="nofollow" href="https://sourceware.org/systemtap/langref.pdf"   >https://sourceware.org/systemtap/langref.pdf</a></div></div>
	</div>
</div>
</body>
</html>