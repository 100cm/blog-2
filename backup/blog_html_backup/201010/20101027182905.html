<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">batch insert in PostgreSQL</h2>
	<h5 id="">2010-10-27 18:29:05&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020109276295217/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><p>&nbsp;今天在互联网上看到有人发表了这样的感慨，其中“INSERT INTO my_table SELECT 1, 'a' UNION SELECT 2, 'b' UNION SELECT 3, 'c' UNION ...<br>”这句可能是笔误，应该改成"INSERT INTO my_table SELECT 1, 'a' UNION ALL SELECT 2, 'b' UNION ALL SELECT 3, 'c' UNION ALL...<br>"其他的都蛮对的。</p> <p></p><pre class="prettyprint"  ><p><font size="2"  >You can use the INSERT INTO tbl &lt;query&gt; syntax to accelerate the speed of inserts by batching them together. For example...<br>INSERT INTO my_table SELECT 1, 'a' UNION SELECT 2, 'b' UNION SELECT 3, 'c' UNION ...<br>If you batch up many sets of values per INSERT statement and batch up multiple INSERT statements per transaction, you can achieve significantly faster insertion performance. I managed to achieve almost 8x faster inserts on a PostgreSQL 8.1 / Win2K installation by batching up 100 (small) using this technique.<br>If anyone knows a faster/more elegant way to construct the row set than using SELECT..UNION then please let me know!</font></p></pre> <p>下面来用例子分析一下:</p> <p>首先要介绍几个PostgreSQL的系统列(就不翻译了,还是原味比较好):</p> <p></p><pre class="prettyprint"  ><p><font size="2"  >tableoid<br>The OID of the table containing this row. This column is particularly handy for queries that select from inheritance hierarchies, since without it, it's difficult to tell which individual table a row came from. The tableoid can be joined against the oid column of pg_class to obtain the table name. <br>xmin<br>The identity (transaction ID) of the inserting transaction for this row version. (A row version is an individual state of a row; each update of a row creates a new row version for the same logical row.) <br>cmin<br>The command identifier (starting at zero) within the inserting transaction. <br>xmax<br>The identity (transaction ID) of the deleting transaction, or zero for an undeleted row version. It is possible for this column to be nonzero in a visible row version. That usually indicates that the deleting transaction hasn't committed yet, or that an attempted deletion was rolled back. <br>cmax<br>The command identifier within the deleting transaction, or zero. <br>ctid<br>The physical location of the row version within its table. Note that although the ctid can be used to locate the row version very quickly, a row's ctid will change if it is updated or moved by VACUUM FULL. Therefore ctid is useless as a long-term row identifier. The OID, or even better a user-defined serial number, should be used to identify logical rows.</font></p></pre> <p>例一:</p> <p></p><pre class="prettyprint"  ><p></p><p><font size="2"  >test=&gt; \d tbl_test<br>&nbsp;&nbsp;&nbsp; Table "test.tbl_test"<br>&nbsp;Column |&nbsp; Type&nbsp; | Modifiers <br>--------+--------+-----------<br>&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp; | bigint | not null<br>Indexes:<br>&nbsp;&nbsp;&nbsp; "tbl_test_pkey" PRIMARY KEY, btree (id)</font></p> <p><font size="2"  >test=&gt; insert into tbl_Test (id) values (1),(2),(3),(4);<br>INSERT 0 4<br>test=&gt; select ctid,cmin,cmax,xmin,xmax,* from tbl_test;<br>&nbsp;ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>-------+------+------+------+------+----<br>&nbsp;(0,1) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;(0,2) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;(0,3) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;(0,4) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>(4 rows)</font></p><p></p></pre> <p>从结果上看四条记录都是同一个事务,同一个CMIN，CMAX值。</p> <p>例二：</p> <p></p><pre class="prettyprint"  ><p><font size="2"  >test=&gt; begin;<br>BEGIN<br>test=&gt; insert into tbl_Test (id) values (5);<br>INSERT 0 1<br>test=&gt; insert into tbl_Test (id) values (6);<br>INSERT 0 1<br>test=&gt; insert into tbl_Test (id) values (7);<br>INSERT 0 1<br>test=&gt; insert into tbl_Test (id) values (8);<br>INSERT 0 1<br>test=&gt; commit;<br>COMMIT<br>test=&gt; select ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp;ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>-------+------+------+------+------+----<br>&nbsp;(0,1) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;(0,2) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;(0,3) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;(0,4) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;(0,5) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;(0,6) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;(0,7) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;(0,8) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>(8 rows)</font></p></pre> <p>从结果上看四条记录都是同一个事务,但是每一次插入操作占用了一个CMIN，CMAX值。</p> <p>例三：</p> <p></p><pre class="prettyprint"  ><p><font size="2"  >test=&gt; insert into tbl_Test (id) select 9 union all select 10 union all select 11 union all select 12;<br>INSERT 0 4<br>test=&gt; select ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp; ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>--------+------+------+------+------+----<br>&nbsp;(0,1)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;(0,2)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;(0,3)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;(0,4)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;(0,5)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;(0,6)&nbsp; |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;(0,7)&nbsp; |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;(0,8)&nbsp; |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>&nbsp;(0,9)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 9<br>&nbsp;(0,10) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 10<br>&nbsp;(0,11) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 11<br>&nbsp;(0,12) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 12<br>(12 rows)</font></p></pre> <p>从结果上看四条记录都是同一个事务,同一个CMIN，CMAX值。</p> <p>例四：</p> <p></p><pre class="prettyprint"  ><p><font size="2"  >test=&gt; insert into tbl_test (id) select generate_series(13,16);<br>INSERT 0 4<br>test=&gt; select ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp; ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>--------+------+------+------+------+----<br>&nbsp;(0,1)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;(0,2)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;(0,3)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;(0,4)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;(0,5)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;(0,6)&nbsp; |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;(0,7)&nbsp; |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;(0,8)&nbsp; |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>&nbsp;(0,9)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 9<br>&nbsp;(0,10) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 10<br>&nbsp;(0,11) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 11<br>&nbsp;(0,12) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 12<br>&nbsp;(0,13) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 13<br>&nbsp;(0,14) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 14<br>&nbsp;(0,15) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 15<br>&nbsp;(0,16) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 16<br>(16 rows)</font></p></pre> <p>从结果上看四条记录都是同一个事务,同一个CMIN，CMAX值。</p> <p>例五：</p> <p></p><pre class="prettyprint"  ><p></p><p><font size="2"  >test=&gt; prepare t_test(int8) as insert into tbl_test (id) values ($1);<br>PREPARE</font></p> <p><font size="2"  >test=&gt; begin;execute t_test(17);<br>BEGIN<br>INSERT 0 1<br>test=&gt; execute t_test(18);<br>INSERT 0 1<br>test=&gt; execute t_test(19);<br>INSERT 0 1<br>test=&gt; execute t_test(20);<br>INSERT 0 1<br>test=&gt; commit;<br>COMMIT<br>test=&gt; select tableoid,ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp;tableoid |&nbsp; ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>----------+--------+------+------+------+------+----<br>&nbsp;&nbsp;&nbsp; 16388 | (0,1)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;&nbsp;&nbsp; 16388 | (0,2)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;&nbsp;&nbsp; 16388 | (0,3)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;&nbsp;&nbsp; 16388 | (0,4)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;&nbsp;&nbsp; 16388 | (0,5)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;&nbsp;&nbsp; 16388 | (0,6)&nbsp; |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;&nbsp;&nbsp; 16388 | (0,7)&nbsp; |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;&nbsp;&nbsp; 16388 | (0,8)&nbsp; |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>&nbsp;&nbsp;&nbsp; 16388 | (0,9)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 9<br>&nbsp;&nbsp;&nbsp; 16388 | (0,10) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 10<br>&nbsp;&nbsp;&nbsp; 16388 | (0,11) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 11<br>&nbsp;&nbsp;&nbsp; 16388 | (0,12) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 12<br>&nbsp;&nbsp;&nbsp; 16388 | (0,13) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 13<br>&nbsp;&nbsp;&nbsp; 16388 | (0,14) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 14<br>&nbsp;&nbsp;&nbsp; 16388 | (0,15) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 15<br>&nbsp;&nbsp;&nbsp; 16388 | (0,16) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 16<br>&nbsp;&nbsp;&nbsp; 16388 | (0,17) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 17<br>&nbsp;&nbsp;&nbsp; 16388 | (0,18) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 18<br>&nbsp;&nbsp;&nbsp; 16388 | (0,19) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 19<br>&nbsp;&nbsp;&nbsp; 16388 | (0,20) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 20<br>(20 rows)</font></p><p></p></pre> <p>从结果上看四条记录都是同一个事务,但是每一次插入操作占用了一个CMIN，CMAX值。</p> <p>例六：</p> <p></p><pre class="prettyprint"  ><p></p><p><font size="2"  >test=&gt; prepare t_test1(int8,int8,int8,int8) as insert into tbl_test (id) values ($1),($2),($3),($4);<br>PREPARE</font></p> <p><font size="2"  >test=&gt; begin;<br>BEGIN<br>test=&gt; execute t_test1(21,22,23,24);<br>INSERT 0 4<br>test=&gt; commit;<br>COMMIT<br>test=&gt; select tableoid,ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp;tableoid |&nbsp; ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>----------+--------+------+------+------+------+----<br>&nbsp;&nbsp;&nbsp; 16388 | (0,1)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;&nbsp;&nbsp; 16388 | (0,2)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;&nbsp;&nbsp; 16388 | (0,3)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;&nbsp;&nbsp; 16388 | (0,4)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;&nbsp;&nbsp; 16388 | (0,5)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;&nbsp;&nbsp; 16388 | (0,6)&nbsp; |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;&nbsp;&nbsp; 16388 | (0,7)&nbsp; |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;&nbsp;&nbsp; 16388 | (0,8)&nbsp; |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>&nbsp;&nbsp;&nbsp; 16388 | (0,9)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 9<br>&nbsp;&nbsp;&nbsp; 16388 | (0,10) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 10<br>&nbsp;&nbsp;&nbsp; 16388 | (0,11) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 11<br>&nbsp;&nbsp;&nbsp; 16388 | (0,12) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 12<br>&nbsp;&nbsp;&nbsp; 16388 | (0,13) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 13<br>&nbsp;&nbsp;&nbsp; 16388 | (0,14) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 14<br>&nbsp;&nbsp;&nbsp; 16388 | (0,15) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 15<br>&nbsp;&nbsp;&nbsp; 16388 | (0,16) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 16<br>&nbsp;&nbsp;&nbsp; 16388 | (0,17) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 17<br>&nbsp;&nbsp;&nbsp; 16388 | (0,18) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 18<br>&nbsp;&nbsp;&nbsp; 16388 | (0,19) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 19<br>&nbsp;&nbsp;&nbsp; 16388 | (0,20) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 20<br>&nbsp;&nbsp;&nbsp; 16388 | (0,21) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 21<br>&nbsp;&nbsp;&nbsp; 16388 | (0,22) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 22<br>&nbsp;&nbsp;&nbsp; 16388 | (0,23) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 23<br>&nbsp;&nbsp;&nbsp; 16388 | (0,24) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 24<br>(24 rows)</font></p><p></p></pre> <p>从结果上看四条记录都是同一个事务,同一个CMIN，CMAX值。</p> <p>例七：</p> <p></p><pre class="prettyprint"  ><p></p><p><font size="2"  >test=&gt; begin;<br>BEGIN<br>test=&gt; insert into tbl_Test (id) values (25);<br>INSERT 0 1<br>test=&gt; select tableoid,ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp;tableoid |&nbsp; ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>----------+--------+------+------+------+------+----<br>&nbsp;&nbsp;&nbsp; 16388 | (0,1)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;&nbsp;&nbsp; 16388 | (0,2)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;&nbsp;&nbsp; 16388 | (0,3)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;&nbsp;&nbsp; 16388 | (0,4)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;&nbsp;&nbsp; 16388 | (0,5)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;&nbsp;&nbsp; 16388 | (0,6)&nbsp; |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;&nbsp;&nbsp; 16388 | (0,7)&nbsp; |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;&nbsp;&nbsp; 16388 | (0,8)&nbsp; |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>&nbsp;&nbsp;&nbsp; 16388 | (0,9)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 9<br>&nbsp;&nbsp;&nbsp; 16388 | (0,10) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 10<br>&nbsp;&nbsp;&nbsp; 16388 | (0,11) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 11<br>&nbsp;&nbsp;&nbsp; 16388 | (0,12) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 12<br>&nbsp;&nbsp;&nbsp; 16388 | (0,13) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 13<br>&nbsp;&nbsp;&nbsp; 16388 | (0,14) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 14<br>&nbsp;&nbsp;&nbsp; 16388 | (0,15) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 15<br>&nbsp;&nbsp;&nbsp; 16388 | (0,16) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 16<br>&nbsp;&nbsp;&nbsp; 16388 | (0,17) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 17<br>&nbsp;&nbsp;&nbsp; 16388 | (0,18) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 18<br>&nbsp;&nbsp;&nbsp; 16388 | (0,19) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 19<br>&nbsp;&nbsp;&nbsp; 16388 | (0,20) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 20<br>&nbsp;&nbsp;&nbsp; 16388 | (0,21) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 21<br>&nbsp;&nbsp;&nbsp; 16388 | (0,22) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 22<br>&nbsp;&nbsp;&nbsp; 16388 | (0,23) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 23<br>&nbsp;&nbsp;&nbsp; 16388 | (0,24) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 24<br>&nbsp;&nbsp;&nbsp; 16388 | (0,27) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 25<br>(25 rows)</font></p> <p><font size="2"  >test=&gt; insert into tbl_Test (id) values (26);<br>INSERT 0 1<br>test=&gt; savepoint one;<br>SAVEPOINT<br>test=&gt; insert into tbl_Test (id) values (27);<br>INSERT 0 1<br>test=&gt; insert into tbl_Test (id) values (28);<br>INSERT 0 1<br>test=&gt; select tableoid,ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp;tableoid |&nbsp; ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>----------+--------+------+------+------+------+----<br>&nbsp;&nbsp;&nbsp; 16388 | (0,1)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;&nbsp;&nbsp; 16388 | (0,2)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;&nbsp;&nbsp; 16388 | (0,3)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;&nbsp;&nbsp; 16388 | (0,4)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;&nbsp;&nbsp; 16388 | (0,5)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;&nbsp;&nbsp; 16388 | (0,6)&nbsp; |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;&nbsp;&nbsp; 16388 | (0,7)&nbsp; |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;&nbsp;&nbsp; 16388 | (0,8)&nbsp; |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>&nbsp;&nbsp;&nbsp; 16388 | (0,9)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 9<br>&nbsp;&nbsp;&nbsp; 16388 | (0,10) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 10<br>&nbsp;&nbsp;&nbsp; 16388 | (0,11) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 11<br>&nbsp;&nbsp;&nbsp; 16388 | (0,12) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 12<br>&nbsp;&nbsp;&nbsp; 16388 | (0,13) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 13<br>&nbsp;&nbsp;&nbsp; 16388 | (0,14) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 14<br>&nbsp;&nbsp;&nbsp; 16388 | (0,15) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 15<br>&nbsp;&nbsp;&nbsp; 16388 | (0,16) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 16<br>&nbsp;&nbsp;&nbsp; 16388 | (0,17) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 17<br>&nbsp;&nbsp;&nbsp; 16388 | (0,18) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 18<br>&nbsp;&nbsp;&nbsp; 16388 | (0,19) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 19<br>&nbsp;&nbsp;&nbsp; 16388 | (0,20) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 20<br>&nbsp;&nbsp;&nbsp; 16388 | (0,21) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 21<br>&nbsp;&nbsp;&nbsp; 16388 | (0,22) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 22<br>&nbsp;&nbsp;&nbsp; 16388 | (0,23) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 23<br>&nbsp;&nbsp;&nbsp; 16388 | (0,24) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 24<br>&nbsp;&nbsp;&nbsp; 16388 | (0,27) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 25<br>&nbsp;&nbsp;&nbsp; 16388 | (0,28) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 26<br>&nbsp;&nbsp;&nbsp; 16388 | (0,29) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 676 |&nbsp;&nbsp;&nbsp; 0 | 27<br>&nbsp;&nbsp;&nbsp; 16388 | (0,30) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 676 |&nbsp;&nbsp;&nbsp; 0 | 28<br>(28 rows)</font></p> <p><font size="2"  >test=&gt; rollback to one;<br>ROLLBACK<br>test=&gt; select tableoid,ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp;tableoid |&nbsp; ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>----------+--------+------+------+------+------+----<br>&nbsp;&nbsp;&nbsp; 16388 | (0,1)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;&nbsp;&nbsp; 16388 | (0,2)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;&nbsp;&nbsp; 16388 | (0,3)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;&nbsp;&nbsp; 16388 | (0,4)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;&nbsp;&nbsp; 16388 | (0,5)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;&nbsp;&nbsp; 16388 | (0,6)&nbsp; |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;&nbsp;&nbsp; 16388 | (0,7)&nbsp; |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;&nbsp;&nbsp; 16388 | (0,8)&nbsp; |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>&nbsp;&nbsp;&nbsp; 16388 | (0,9)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 9<br>&nbsp;&nbsp;&nbsp; 16388 | (0,10) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 10<br>&nbsp;&nbsp;&nbsp; 16388 | (0,11) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 11<br>&nbsp;&nbsp;&nbsp; 16388 | (0,12) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 12<br>&nbsp;&nbsp;&nbsp; 16388 | (0,13) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 13<br>&nbsp;&nbsp;&nbsp; 16388 | (0,14) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 14<br>&nbsp;&nbsp;&nbsp; 16388 | (0,15) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 15<br>&nbsp;&nbsp;&nbsp; 16388 | (0,16) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 16<br>&nbsp;&nbsp;&nbsp; 16388 | (0,17) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 17<br>&nbsp;&nbsp;&nbsp; 16388 | (0,18) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 18<br>&nbsp;&nbsp;&nbsp; 16388 | (0,19) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 19<br>&nbsp;&nbsp;&nbsp; 16388 | (0,20) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 20<br>&nbsp;&nbsp;&nbsp; 16388 | (0,21) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 21<br>&nbsp;&nbsp;&nbsp; 16388 | (0,22) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 22<br>&nbsp;&nbsp;&nbsp; 16388 | (0,23) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 23<br>&nbsp;&nbsp;&nbsp; 16388 | (0,24) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 24<br>&nbsp;&nbsp;&nbsp; 16388 | (0,27) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 25<br>&nbsp;&nbsp;&nbsp; 16388 | (0,28) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 26<br>(26 rows)</font></p> <p><font size="2"  >test=&gt; insert into tbl_Test (id) values (27);<br>INSERT 0 1<br>test=&gt; insert into tbl_Test (id) values (28);<br>INSERT 0 1<br>test=&gt; select tableoid,ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp;tableoid |&nbsp; ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>----------+--------+------+------+------+------+----<br>&nbsp;&nbsp;&nbsp; 16388 | (0,1)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;&nbsp;&nbsp; 16388 | (0,2)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;&nbsp;&nbsp; 16388 | (0,3)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;&nbsp;&nbsp; 16388 | (0,4)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;&nbsp;&nbsp; 16388 | (0,5)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;&nbsp;&nbsp; 16388 | (0,6)&nbsp; |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;&nbsp;&nbsp; 16388 | (0,7)&nbsp; |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;&nbsp;&nbsp; 16388 | (0,8)&nbsp; |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>&nbsp;&nbsp;&nbsp; 16388 | (0,9)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 9<br>&nbsp;&nbsp;&nbsp; 16388 | (0,10) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 10<br>&nbsp;&nbsp;&nbsp; 16388 | (0,11) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 11<br>&nbsp;&nbsp;&nbsp; 16388 | (0,12) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 12<br>&nbsp;&nbsp;&nbsp; 16388 | (0,13) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 13<br>&nbsp;&nbsp;&nbsp; 16388 | (0,14) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 14<br>&nbsp;&nbsp;&nbsp; 16388 | (0,15) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 15<br>&nbsp;&nbsp;&nbsp; 16388 | (0,16) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 16<br>&nbsp;&nbsp;&nbsp; 16388 | (0,17) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 17<br>&nbsp;&nbsp;&nbsp; 16388 | (0,18) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 18<br>&nbsp;&nbsp;&nbsp; 16388 | (0,19) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 19<br>&nbsp;&nbsp;&nbsp; 16388 | (0,20) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 20<br>&nbsp;&nbsp;&nbsp; 16388 | (0,21) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 21<br>&nbsp;&nbsp;&nbsp; 16388 | (0,22) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 22<br>&nbsp;&nbsp;&nbsp; 16388 | (0,23) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 23<br>&nbsp;&nbsp;&nbsp; 16388 | (0,24) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 24<br>&nbsp;&nbsp;&nbsp; 16388 | (0,27) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 25<br>&nbsp;&nbsp;&nbsp; 16388 | (0,28) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 26<br>&nbsp;&nbsp;&nbsp; 16388 | (0,31) |&nbsp;&nbsp;&nbsp; 4 |&nbsp;&nbsp;&nbsp; 4 |&nbsp; 677 |&nbsp;&nbsp;&nbsp; 0 | 27<br>&nbsp;&nbsp;&nbsp; 16388 | (0,32) |&nbsp;&nbsp;&nbsp; 5 |&nbsp;&nbsp;&nbsp; 5 |&nbsp; 677 |&nbsp;&nbsp;&nbsp; 0 | 28<br>(28 rows)</font></p> <p><font size="2"  >test=&gt; commit;<br>COMMIT</font></p><p></p></pre> <p>从结果上看每一个SAVEPOINT会产生一个新的事物号，但是CMIN , CMAX值是连续的，不会在新事物重置。回滚到SAVEPOINT后，CMIN,CMAX值的产生和序列差不多，不能回滚，继续往前。</p> <p>例八：</p> <p></p><pre class="prettyprint"  ><p></p><p><font size="2"  >test=&gt; begin;<br>BEGIN<br>test=&gt; execute t_test1(41,42,43,44);<br>INSERT 0 4<br>test=&gt; savepoint one;<br>SAVEPOINT<br>test=&gt; execute t_test1(45,46,47,48);<br>INSERT 0 4<br>test=&gt; select tableoid,ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp;tableoid |&nbsp; ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>----------+--------+------+------+------+------+----<br>&nbsp;&nbsp;&nbsp; 16388 | (0,1)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;&nbsp;&nbsp; 16388 | (0,2)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;&nbsp;&nbsp; 16388 | (0,3)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;&nbsp;&nbsp; 16388 | (0,4)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;&nbsp;&nbsp; 16388 | (0,5)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;&nbsp;&nbsp; 16388 | (0,6)&nbsp; |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;&nbsp;&nbsp; 16388 | (0,7)&nbsp; |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;&nbsp;&nbsp; 16388 | (0,8)&nbsp; |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>&nbsp;&nbsp;&nbsp; 16388 | (0,9)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 9<br>&nbsp;&nbsp;&nbsp; 16388 | (0,10) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 10<br>&nbsp;&nbsp;&nbsp; 16388 | (0,11) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 11<br>&nbsp;&nbsp;&nbsp; 16388 | (0,12) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 12<br>&nbsp;&nbsp;&nbsp; 16388 | (0,13) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 13<br>&nbsp;&nbsp;&nbsp; 16388 | (0,14) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 14<br>&nbsp;&nbsp;&nbsp; 16388 | (0,15) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 15<br>&nbsp;&nbsp;&nbsp; 16388 | (0,16) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 16<br>&nbsp;&nbsp;&nbsp; 16388 | (0,17) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 17<br>&nbsp;&nbsp;&nbsp; 16388 | (0,18) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 18<br>&nbsp;&nbsp;&nbsp; 16388 | (0,19) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 19<br>&nbsp;&nbsp;&nbsp; 16388 | (0,20) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 20<br>&nbsp;&nbsp;&nbsp; 16388 | (0,21) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 21<br>&nbsp;&nbsp;&nbsp; 16388 | (0,22) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 22<br>&nbsp;&nbsp;&nbsp; 16388 | (0,23) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 23<br>&nbsp;&nbsp;&nbsp; 16388 | (0,24) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 24<br>&nbsp;&nbsp;&nbsp; 16388 | (0,27) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 25<br>&nbsp;&nbsp;&nbsp; 16388 | (0,28) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 26<br>&nbsp;&nbsp;&nbsp; 16388 | (0,31) |&nbsp;&nbsp;&nbsp; 4 |&nbsp;&nbsp;&nbsp; 4 |&nbsp; 677 |&nbsp;&nbsp;&nbsp; 0 | 27<br>&nbsp;&nbsp;&nbsp; 16388 | (0,32) |&nbsp;&nbsp;&nbsp; 5 |&nbsp;&nbsp;&nbsp; 5 |&nbsp; 677 |&nbsp;&nbsp;&nbsp; 0 | 28<br>&nbsp;&nbsp;&nbsp; 16388 | (0,33) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 678 |&nbsp;&nbsp;&nbsp; 0 | 29<br>&nbsp;&nbsp;&nbsp; 16388 | (0,34) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 678 |&nbsp;&nbsp;&nbsp; 0 | 30<br>&nbsp;&nbsp;&nbsp; 16388 | (0,25) |&nbsp;&nbsp;&nbsp; 4 |&nbsp;&nbsp;&nbsp; 4 |&nbsp; 680 |&nbsp;&nbsp;&nbsp; 0 | 31<br>&nbsp;&nbsp;&nbsp; 16388 | (0,26) |&nbsp;&nbsp;&nbsp; 5 |&nbsp;&nbsp;&nbsp; 5 |&nbsp; 680 |&nbsp;&nbsp;&nbsp; 0 | 32<br>&nbsp;&nbsp;&nbsp; 16388 | (0,29) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 33<br>&nbsp;&nbsp;&nbsp; 16388 | (0,30) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 34<br>&nbsp;&nbsp;&nbsp; 16388 | (0,35) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 35<br>&nbsp;&nbsp;&nbsp; 16388 | (0,36) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 36<br>&nbsp;&nbsp;&nbsp; 16388 | (0,37) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 37<br>&nbsp;&nbsp;&nbsp; 16388 | (0,38) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 38<br>&nbsp;&nbsp;&nbsp; 16388 | (0,39) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 39<br>&nbsp;&nbsp;&nbsp; 16388 | (0,40) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 40<br>&nbsp;&nbsp;&nbsp; 16388 | (0,41) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 682 |&nbsp;&nbsp;&nbsp; 0 | 41<br>&nbsp;&nbsp;&nbsp; 16388 | (0,42) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 682 |&nbsp;&nbsp;&nbsp; 0 | 42<br>&nbsp;&nbsp;&nbsp; 16388 | (0,43) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 682 |&nbsp;&nbsp;&nbsp; 0 | 43<br>&nbsp;&nbsp;&nbsp; 16388 | (0,44) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 682 |&nbsp;&nbsp;&nbsp; 0 | 44<br>&nbsp;&nbsp;&nbsp; 16388 | (0,45) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 683 |&nbsp;&nbsp;&nbsp; 0 | 45<br>&nbsp;&nbsp;&nbsp; 16388 | (0,46) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 683 |&nbsp;&nbsp;&nbsp; 0 | 46<br>&nbsp;&nbsp;&nbsp; 16388 | (0,47) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 683 |&nbsp;&nbsp;&nbsp; 0 | 47<br>&nbsp;&nbsp;&nbsp; 16388 | (0,48) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 683 |&nbsp;&nbsp;&nbsp; 0 | 48<br>(48 rows)</font></p> <p><font size="2"  >test=&gt; rollback to one;<br>ROLLBACK</font></p><p></p></pre> <p>在第二个SESSION执行:</p> <p></p><pre class="prettyprint"  ><p><font size="2"  >test=&gt; vacuum tbl_test;<br>VACUUM</font></p></pre> <p>回到第一个SESSION执行:<br></p><pre class="prettyprint"  ><p><font size="2"  >test=&gt; commit;<br>COMMIT<br>test=&gt; select tableoid,ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp;tableoid |&nbsp; ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>----------+--------+------+------+------+------+----<br>&nbsp;&nbsp;&nbsp; 16388 | (0,1)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;&nbsp;&nbsp; 16388 | (0,2)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;&nbsp;&nbsp; 16388 | (0,3)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;&nbsp;&nbsp; 16388 | (0,4)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;&nbsp;&nbsp; 16388 | (0,5)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;&nbsp;&nbsp; 16388 | (0,6)&nbsp; |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;&nbsp;&nbsp; 16388 | (0,7)&nbsp; |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;&nbsp;&nbsp; 16388 | (0,8)&nbsp; |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>&nbsp;&nbsp;&nbsp; 16388 | (0,9)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 9<br>&nbsp;&nbsp;&nbsp; 16388 | (0,10) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 10<br>&nbsp;&nbsp;&nbsp; 16388 | (0,11) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 11<br>&nbsp;&nbsp;&nbsp; 16388 | (0,12) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 12<br>&nbsp;&nbsp;&nbsp; 16388 | (0,13) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 13<br>&nbsp;&nbsp;&nbsp; 16388 | (0,14) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 14<br>&nbsp;&nbsp;&nbsp; 16388 | (0,15) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 15<br>&nbsp;&nbsp;&nbsp; 16388 | (0,16) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 16<br>&nbsp;&nbsp;&nbsp; 16388 | (0,17) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 17<br>&nbsp;&nbsp;&nbsp; 16388 | (0,18) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 18<br>&nbsp;&nbsp;&nbsp; 16388 | (0,19) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 19<br>&nbsp;&nbsp;&nbsp; 16388 | (0,20) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 20<br>&nbsp;&nbsp;&nbsp; 16388 | (0,21) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 21<br>&nbsp;&nbsp;&nbsp; 16388 | (0,22) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 22<br>&nbsp;&nbsp;&nbsp; 16388 | (0,23) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 23<br>&nbsp;&nbsp;&nbsp; 16388 | (0,24) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 24<br>&nbsp;&nbsp;&nbsp; 16388 | (0,27) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 25<br>&nbsp;&nbsp;&nbsp; 16388 | (0,28) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 26<br>&nbsp;&nbsp;&nbsp; 16388 | (0,31) |&nbsp;&nbsp;&nbsp; 4 |&nbsp;&nbsp;&nbsp; 4 |&nbsp; 677 |&nbsp;&nbsp;&nbsp; 0 | 27<br>&nbsp;&nbsp;&nbsp; 16388 | (0,32) |&nbsp;&nbsp;&nbsp; 5 |&nbsp;&nbsp;&nbsp; 5 |&nbsp; 677 |&nbsp;&nbsp;&nbsp; 0 | 28<br>&nbsp;&nbsp;&nbsp; 16388 | (0,33) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 678 |&nbsp;&nbsp;&nbsp; 0 | 29<br>&nbsp;&nbsp;&nbsp; 16388 | (0,34) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 678 |&nbsp;&nbsp;&nbsp; 0 | 30<br>&nbsp;&nbsp;&nbsp; 16388 | (0,25) |&nbsp;&nbsp;&nbsp; 4 |&nbsp;&nbsp;&nbsp; 4 |&nbsp; 680 |&nbsp;&nbsp;&nbsp; 0 | 31<br>&nbsp;&nbsp;&nbsp; 16388 | (0,26) |&nbsp;&nbsp;&nbsp; 5 |&nbsp;&nbsp;&nbsp; 5 |&nbsp; 680 |&nbsp;&nbsp;&nbsp; 0 | 32<br>&nbsp;&nbsp;&nbsp; 16388 | (0,29) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 33<br>&nbsp;&nbsp;&nbsp; 16388 | (0,30) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 34<br>&nbsp;&nbsp;&nbsp; 16388 | (0,35) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 35<br>&nbsp;&nbsp;&nbsp; 16388 | (0,36) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 36<br>&nbsp;&nbsp;&nbsp; 16388 | (0,37) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 37<br>&nbsp;&nbsp;&nbsp; 16388 | (0,38) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 38<br>&nbsp;&nbsp;&nbsp; 16388 | (0,39) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 39<br>&nbsp;&nbsp;&nbsp; 16388 | (0,40) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 681 |&nbsp;&nbsp;&nbsp; 0 | 40<br>&nbsp;&nbsp;&nbsp; 16388 | (0,41) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 682 |&nbsp;&nbsp;&nbsp; 0 | 41<br>&nbsp;&nbsp;&nbsp; 16388 | (0,42) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 682 |&nbsp;&nbsp;&nbsp; 0 | 42<br>&nbsp;&nbsp;&nbsp; 16388 | (0,43) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 682 |&nbsp;&nbsp;&nbsp; 0 | 43<br>&nbsp;&nbsp;&nbsp; 16388 | (0,44) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 682 |&nbsp;&nbsp;&nbsp; 0 | 44<br>(44 rows)</font></p></pre> <p>从结果上看，只要是CMIN,CMAX值一样的都被回滚掉了.VACUUM并不会影响一个事务中的CMIN CMAX值。</p> <p>例九：</p> <p></p><pre class="prettyprint"  ><p></p><p><font size="2"  >test=&gt; begin;<br>BEGIN<br>test=&gt; insert into tbl_Test (id) values (29);<br>INSERT 0 1<br>test=&gt; insert into tbl_Test (id) values (30);<br>INSERT 0 1<br>test=&gt; savepoint one;<br>SAVEPOINT<br>test=&gt; insert into tbl_Test (id) values (31);<br>INSERT 0 1<br>test=&gt; insert into tbl_Test (id) values (32);<br>INSERT 0 1<br>test=&gt; select tableoid,ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp;tableoid |&nbsp; ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>----------+--------+------+------+------+------+----<br>&nbsp;&nbsp;&nbsp; 16388 | (0,1)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;&nbsp;&nbsp; 16388 | (0,2)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;&nbsp;&nbsp; 16388 | (0,3)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;&nbsp;&nbsp; 16388 | (0,4)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;&nbsp;&nbsp; 16388 | (0,5)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;&nbsp;&nbsp; 16388 | (0,6)&nbsp; |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;&nbsp;&nbsp; 16388 | (0,7)&nbsp; |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;&nbsp;&nbsp; 16388 | (0,8)&nbsp; |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>&nbsp;&nbsp;&nbsp; 16388 | (0,9)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 9<br>&nbsp;&nbsp;&nbsp; 16388 | (0,10) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 10<br>&nbsp;&nbsp;&nbsp; 16388 | (0,11) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 11<br>&nbsp;&nbsp;&nbsp; 16388 | (0,12) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 12<br>&nbsp;&nbsp;&nbsp; 16388 | (0,13) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 13<br>&nbsp;&nbsp;&nbsp; 16388 | (0,14) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 14<br>&nbsp;&nbsp;&nbsp; 16388 | (0,15) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 15<br>&nbsp;&nbsp;&nbsp; 16388 | (0,16) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 16<br>&nbsp;&nbsp;&nbsp; 16388 | (0,17) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 17<br>&nbsp;&nbsp;&nbsp; 16388 | (0,18) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 18<br>&nbsp;&nbsp;&nbsp; 16388 | (0,19) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 19<br>&nbsp;&nbsp;&nbsp; 16388 | (0,20) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 20<br>&nbsp;&nbsp;&nbsp; 16388 | (0,21) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 21<br>&nbsp;&nbsp;&nbsp; 16388 | (0,22) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 22<br>&nbsp;&nbsp;&nbsp; 16388 | (0,23) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 23<br>&nbsp;&nbsp;&nbsp; 16388 | (0,24) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 24<br>&nbsp;&nbsp;&nbsp; 16388 | (0,27) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 25<br>&nbsp;&nbsp;&nbsp; 16388 | (0,28) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 26<br>&nbsp;&nbsp;&nbsp; 16388 | (0,31) |&nbsp;&nbsp;&nbsp; 4 |&nbsp;&nbsp;&nbsp; 4 |&nbsp; 677 |&nbsp;&nbsp;&nbsp; 0 | 27<br>&nbsp;&nbsp;&nbsp; 16388 | (0,32) |&nbsp;&nbsp;&nbsp; 5 |&nbsp;&nbsp;&nbsp; 5 |&nbsp; 677 |&nbsp;&nbsp;&nbsp; 0 | 28<br>&nbsp;&nbsp;&nbsp; 16388 | (0,33) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 678 |&nbsp;&nbsp;&nbsp; 0 | 29<br>&nbsp;&nbsp;&nbsp; 16388 | (0,34) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 678 |&nbsp;&nbsp;&nbsp; 0 | 30<br>&nbsp;&nbsp;&nbsp; 16388 | (0,35) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 679 |&nbsp;&nbsp;&nbsp; 0 | 31<br>&nbsp;&nbsp;&nbsp; 16388 | (0,36) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 679 |&nbsp;&nbsp;&nbsp; 0 | 32<br>(32 rows)</font></p> <p><font size="2"  >test=&gt; rollback to one;<br>ROLLBACK</font></p><p></p></pre> <p>打开第二个SESSION执行：</p> <p></p><pre class="prettyprint"  ><p><font size="2"  >test=&gt; vacuum tbl_test;<br>VACUUM</font></p></pre> <p>回到第一个SESSION执行：<br></p><pre class="prettyprint"  ><p></p><p><font size="2"  >test=&gt; insert into tbl_Test (id) values (31);<br>INSERT 0 1<br>test=&gt; insert into tbl_Test (id) values (32);<br>INSERT 0 1<br>test=&gt; select tableoid,ctid,cmin,cmax,xmin,xmax,* from tbl_test order by id;<br>&nbsp;tableoid |&nbsp; ctid&nbsp; | cmin | cmax | xmin | xmax | id <br>----------+--------+------+------+------+------+----<br>&nbsp;&nbsp;&nbsp; 16388 | (0,1)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 1<br>&nbsp;&nbsp;&nbsp; 16388 | (0,2)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 2<br>&nbsp;&nbsp;&nbsp; 16388 | (0,3)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 3<br>&nbsp;&nbsp;&nbsp; 16388 | (0,4)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 668 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 4<br>&nbsp;&nbsp;&nbsp; 16388 | (0,5)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 5<br>&nbsp;&nbsp;&nbsp; 16388 | (0,6)&nbsp; |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 6<br>&nbsp;&nbsp;&nbsp; 16388 | (0,7)&nbsp; |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 7<br>&nbsp;&nbsp;&nbsp; 16388 | (0,8)&nbsp; |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 669 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 8<br>&nbsp;&nbsp;&nbsp; 16388 | (0,9)&nbsp; |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 9<br>&nbsp;&nbsp;&nbsp; 16388 | (0,10) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 10<br>&nbsp;&nbsp;&nbsp; 16388 | (0,11) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 11<br>&nbsp;&nbsp;&nbsp; 16388 | (0,12) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 670 |&nbsp;&nbsp;&nbsp; 0 | 12<br>&nbsp;&nbsp;&nbsp; 16388 | (0,13) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 13<br>&nbsp;&nbsp;&nbsp; 16388 | (0,14) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 14<br>&nbsp;&nbsp;&nbsp; 16388 | (0,15) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 15<br>&nbsp;&nbsp;&nbsp; 16388 | (0,16) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 671 |&nbsp;&nbsp;&nbsp; 0 | 16<br>&nbsp;&nbsp;&nbsp; 16388 | (0,17) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 17<br>&nbsp;&nbsp;&nbsp; 16388 | (0,18) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 18<br>&nbsp;&nbsp;&nbsp; 16388 | (0,19) |&nbsp;&nbsp;&nbsp; 2 |&nbsp;&nbsp;&nbsp; 2 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 19<br>&nbsp;&nbsp;&nbsp; 16388 | (0,20) |&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp;&nbsp; 3 |&nbsp; 672 |&nbsp;&nbsp;&nbsp; 0 | 20<br>&nbsp;&nbsp;&nbsp; 16388 | (0,21) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 21<br>&nbsp;&nbsp;&nbsp; 16388 | (0,22) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 22<br>&nbsp;&nbsp;&nbsp; 16388 | (0,23) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 23<br>&nbsp;&nbsp;&nbsp; 16388 | (0,24) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 673 |&nbsp;&nbsp;&nbsp; 0 | 24<br>&nbsp;&nbsp;&nbsp; 16388 | (0,27) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 25<br>&nbsp;&nbsp;&nbsp; 16388 | (0,28) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 675 |&nbsp;&nbsp;&nbsp; 0 | 26<br>&nbsp;&nbsp;&nbsp; 16388 | (0,31) |&nbsp;&nbsp;&nbsp; 4 |&nbsp;&nbsp;&nbsp; 4 |&nbsp; 677 |&nbsp;&nbsp;&nbsp; 0 | 27<br>&nbsp;&nbsp;&nbsp; 16388 | (0,32) |&nbsp;&nbsp;&nbsp; 5 |&nbsp;&nbsp;&nbsp; 5 |&nbsp; 677 |&nbsp;&nbsp;&nbsp; 0 | 28<br>&nbsp;&nbsp;&nbsp; 16388 | (0,33) |&nbsp;&nbsp;&nbsp; 0 |&nbsp;&nbsp;&nbsp; 0 |&nbsp; 678 |&nbsp;&nbsp;&nbsp; 0 | 29<br>&nbsp;&nbsp;&nbsp; 16388 | (0,34) |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp; 1 |&nbsp; 678 |&nbsp;&nbsp;&nbsp; 0 | 30<br>&nbsp;&nbsp;&nbsp; 16388 | (0,25) |&nbsp;&nbsp;&nbsp; 4 |&nbsp;&nbsp;&nbsp; 4 |&nbsp; 680 |&nbsp;&nbsp;&nbsp; 0 | 31<br>&nbsp;&nbsp;&nbsp; 16388 | (0,26) |&nbsp;&nbsp;&nbsp; 5 |&nbsp;&nbsp;&nbsp; 5 |&nbsp; 680 |&nbsp;&nbsp;&nbsp; 0 | 32<br>(32 rows)</font></p> <p><font size="2"  >test=&gt; commit;</font></p><p></p></pre> <p>从结果上看，只要是CMIN,CMAX值一样的都被回滚掉了.VACUUM并不会影响一个事务中的CMIN CMAX值,VACUUM只是更新了FSM信息,所以VACUUM后插入的记录CTID使用25，26的PAGE位置存储。</p> <p>【小结】</p> <p>BATCH模式可以通过如下手段实施:</p> <p></p><pre class="prettyprint"  ><p></p><p><font size="2"  >insert into tbl_test (id) values (v_1),(v_2),(v_3),.....................(v_n);</font></p> <p><font size="2"  >insert into tbl_test (id) select v from other_table;</font></p> <p><font size="2"  >insert into tbl_test (id) select v_1 union all select v_2 union all select v_3 union all ..............;</font></p> <p><font size="2"  >prepare t_test1(int8,int8,int8,int8,...................) as insert into tbl_test (id) values ($1),($2),($3),($4),.........................;</font></p> <p><font size="2"  >execute t_test1(v_1,v_2,v_3,v_4,......................);</font></p><p></p></pre></div>
	</div>
	<h3>评论</h3>
	<div class="" id="" style="padding:0 20px;">
			<div id="">
				<h5 id="">肖涛 - 2010-11-01 9:16:03</h5>
				<div>德哥移地方了？</div>
			</div>
			<div style="padding-left:40px;">
				<h5 id="">德哥@Digoal 回复 肖涛 - 2010-11-01 9:16:03</h5>
				<div style="width:600px;">没有啊,公司博客太拘束了.这里自由点.</div>
			</div>
	</div>
</div>
</body>
</html>