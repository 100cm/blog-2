<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">PostgreSQL 支持的SQL最长有多长? ISO/IEC 9075-3:2008</h2>
	<h5 id="">2012-05-17 14:11:03&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201241715748862/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>今天一位开发的同事聊起PostgreSQL支持的SQL最长有多长?</div><div><br></div><div>查了一下，PostgreSQL没有对SQL长度做限制, 只是在查询时列的数量不能超过1664.</div><div>如下:</div><div><span style="line-height: 22px;"   >ISO/IEC 9075-3:2008 这本白皮书要购买, 所以无法提供与此相应的内容给大家.</span></div><div>下面是PostgreSQL代码中的一部分.</div><div><br></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >-- Note: Sizing items are defined in ISO/IEC 9075-3:2008, clause 9.2.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >CREATE TABLE sql_sizing (</font></div><div><font size="2"   >&nbsp; &nbsp; sizing_id &nbsp; &nbsp; &nbsp; cardinal_number,</font></div><div><font size="2"   >&nbsp; &nbsp; sizing_name &nbsp; &nbsp; character_data,</font></div><div><font size="2"   >&nbsp; &nbsp; supported_value cardinal_number,</font></div><div><font size="2"   >&nbsp; &nbsp; comments &nbsp; &nbsp; &nbsp; &nbsp;character_data</font></div><div><font size="2"   >) WITHOUT OIDS;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (34, &nbsp; &nbsp;'MAXIMUM CATALOG NAME LENGTH', 63, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (30, &nbsp; &nbsp;'MAXIMUM COLUMN NAME LENGTH', 63, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (97, &nbsp; &nbsp;'MAXIMUM COLUMNS IN GROUP BY', 0, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (99, &nbsp; &nbsp;'MAXIMUM COLUMNS IN ORDER BY', 0, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (100, &nbsp; 'MAXIMUM COLUMNS IN SELECT', 1664, NULL); -- match MaxTupleAttributeNumber</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (101, &nbsp; 'MAXIMUM COLUMNS IN TABLE', 1600, NULL); -- match MaxHeapAttributeNumber</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (1, &nbsp; &nbsp; 'MAXIMUM CONCURRENT ACTIVITIES', 0, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (31, &nbsp; &nbsp;'MAXIMUM CURSOR NAME LENGTH', 63, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (0, &nbsp; &nbsp; 'MAXIMUM DRIVER CONNECTIONS', NULL, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (10005, 'MAXIMUM IDENTIFIER LENGTH', 63, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (32, &nbsp; &nbsp;'MAXIMUM SCHEMA NAME LENGTH', 63, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (20000, 'MAXIMUM STATEMENT OCTETS', 0, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (20001, 'MAXIMUM STATEMENT OCTETS DATA', 0, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (20002, 'MAXIMUM STATEMENT OCTETS SCHEMA', 0, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (35, &nbsp; &nbsp;'MAXIMUM TABLE NAME LENGTH', 63, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (106, &nbsp; 'MAXIMUM TABLES IN SELECT', 0, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (107, &nbsp; 'MAXIMUM USER NAME LENGTH', 63, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (25000, 'MAXIMUM CURRENT DEFAULT TRANSFORM GROUP LENGTH', NULL, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (25001, 'MAXIMUM CURRENT TRANSFORM GROUP LENGTH', NULL, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (25002, 'MAXIMUM CURRENT PATH LENGTH', 0, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (25003, 'MAXIMUM CURRENT ROLE LENGTH', NULL, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (25004, 'MAXIMUM SESSION USER LENGTH', 63, NULL);</font></div><div><font size="2"   >INSERT INTO sql_sizing VALUES (25005, 'MAXIMUM SYSTEM USER LENGTH', 63, NULL);</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >UPDATE sql_sizing</font></div><div><font size="2"   >&nbsp; &nbsp; SET supported_value = (SELECT typlen-1 FROM pg_catalog.pg_type WHERE typname = 'name'),</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; comments = 'Might be less, depending on character set.'</font></div><div><font size="2"   >&nbsp; &nbsp; WHERE supported_value = 63;</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >GRANT SELECT ON sql_sizing TO PUBLIC;</font></div><p></p></pre></div><div><br></div><div>-- 使用array_agg可以方便的产生一个逗号隔开的数字串如.</div><div><pre class="prettyprint"   ><p><font size="2"   >select array_agg(val) from (select generate_series(1,1664) as val) as t;</font></p></pre></div><div><br></div><div>-- 尝试一个SQL中查询1665个列时报错 &nbsp;:&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >select 1,2,3,....,1665;</font></div><div><font size="2"   >ERROR: &nbsp;target lists can have at most 1664 entries</font></div><p></p></pre></div><div>注意到限制里面的</div><div><span style="font-family: monospace; line-height: 19px; white-space: pre; font-size: small;"   >MAXIMUM STATEMENT OCTETS</span> </div><div><span style="font-family: monospace; line-height: 19px; white-space: pre; font-size: small;"   >MAXIMUM STATEMENT OCTETS DATA</span> </div><div><span style="font-family: monospace; line-height: 19px; white-space: pre; font-size: small;"   >MAXIMUM STATEMENT OCTETS SCHEMA</span> </div><div><span style="font-family: monospace; line-height: 19px; white-space: pre; font-size: small;"   >介绍:</span></div><div><pre class="prettyprint"   ><p></p><div><font face="monospace"   size="2"   ><span style="line-height: 19px;"   >20000 SQL_MAXIMUM_STMT_OCTETS ― SMALLINT &lt;&lt; XXX the number is wrong, 20000 is SQL_GETPARAMDATA_EXTENSIONS &gt;&gt; The return is the maximum number of octets that can exist in any SQL statement, or zero if there's no fixed limit. This is the maximum size of the string parameter in an SQLPrepare or SQLExecDirect function call. In ODBC, this code does not exist; the ODBC code SQL_MAXIMUM_STATEMENT_LENGTH is a different value.</span></font></div><div><font face="monospace"   size="2"   ><span style="line-height: 19px;"   > 20001 SQL_MAXIMUM_STMT_OCTETS_DATA ― SMALLINT The return is the maximum number of octets that can exist in an SQL-data statement (such as INSERT), or zero if there's no fixed limit.</span></font></div><div><font face="monospace"   size="2"   ><span style="line-height: 19px;"   > 20002 SQL_MAXIMUM_STMT_OCTETS_SCHEMA ― SMALLINT The return is the maximum number of octets that can exist in an SQL-Schema statement (such as CREATE SCHEMA), or zero if there's no fixed limit.</span></font></div><p></p></pre></div><div>另外我们知道一个变长字段如text允许的最大长度是1GBytes, 所以至少SQL的长度会超过1GBytes.</div><div><br></div>【参考】<div>src/backend/catalog/information_schema.sql</div><div><br><br><wbr></div></div>
	</div>
</div>
</body>
</html>