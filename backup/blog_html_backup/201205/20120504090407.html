<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">compare tps performance between 8k 16k 64k wal_blocksize</h2>
	<h5 id="">2012-05-04 9:04:07&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402012449234965/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>-- 以下是我的一台服务器的fsync测试结果, 后面分别针对open_sync和fdatasync测试不同大小的wal块, 性能差别有多少.</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >pg_test_fsync&nbsp;</font></div><div><font size="2"  >2000 operations per test</font></div><div><font size="2"  >O_DIRECT supported on this platform for open_datasync and open_sync.</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >Compare file sync methods using one 8kB write:</font></div><div><font size="2"  >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"  >is Linux's default)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n/a</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3777.334 ops/sec</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3502.161 ops/sec</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3753.183 ops/sec</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >Compare file sync methods using two 8kB writes:</font></div><div><font size="2"  >(in wal_sync_method preference order, except fdatasync</font></div><div><font size="2"  >is Linux's default)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; open_datasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n/a</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; fdatasync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2957.193 ops/sec</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2732.009 ops/sec</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; fsync_writethrough &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n/a</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; open_sync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;85.246 ops/sec</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >Compare open_sync with different write sizes:</font></div><div><font size="2"  >(This is designed to compare the cost of writing 16kB</font></div><div><font size="2"  >in different write open_sync sizes.)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 16kB open_sync write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3213.868 ops/sec</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;82.948 ops/sec</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;75.057 ops/sec</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;76.292 ops/sec</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1kB open_sync writes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;66.495 ops/sec</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >Test if fsync on non-write file descriptor is honored:</font></div><div><font size="2"  >(If the times are similar, fsync() can sync data written</font></div><div><font size="2"  >on a different descriptor.)</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; write, fsync, close &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3330.303 ops/sec</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; write, close, fsync &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3580.559 ops/sec</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >Non-Sync'ed 8kB writes:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 242630.110 ops/sec</font></div><p></p></pre></div><div><br></div><div><br></div><div>-- 测试表</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >create table test(id serial primary key,crt_time timestamp);</font></div><div><font size="2"  >create index idx_crt_time on test(crt_time);</font></div><p></p></pre></div><div><br></div><div><br></div><div>一、open_sync 同步写方法测试:</div><div><br></div><div>--with-wal-blocksize=8测试</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >useradd k8</font></div><div><font size="2"  >su - k8</font></div><div><font size="2"  >vi .bash_profile</font></div><div><font size="2"  ># add</font></div><div><font size="2"  >export PS1="$USER@`/bin/hostname -s`-&gt; "</font></div><div><font size="2"  >export PGPORT=5432</font></div><div><font size="2"  >export PGDATA=/home/k8/pg_root</font></div><div><font size="2"  >export LANG=en_US.utf8</font></div><div><font size="2"  >export PGHOME=/opt/pgsqlk8</font></div><div><font size="2"  >export LD_LIBRARY_PATH=$PGHOME/lib:/lib64:/usr/lib64:/usr/local/lib64:/lib:/usr/lib:/usr/local/lib</font></div><div><font size="2"  >export DATE=`date +"%Y%m%d%H%M"`</font></div><div><font size="2"  >export PATH=$PGHOME/bin:$PATH:.</font></div><div><font size="2"  >export MANPATH=$PGHOME/share/man:$MANPATH</font></div><div><font size="2"  >alias rm='rm -i'</font></div><div><font size="2"  >alias ll='ls -lh'</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >cd $PG_SOURCE</font></div><div><font size="2"  >./configure --prefix=/opt/pgsqlk8 --with-pgport=5432 --with-perl --with-python --with-openssl --with-pam --without-ldap --with-libxml --with-libxslt --enable-thread-safety --with-wal-blocksize=8 &amp;&amp; gmake world</font></div><div><font size="2"  >su - root</font></div><div><font size="2"  >cd $PG_SOURCE</font></div><div><font size="2"  >gmake install-world</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >su - k8</font></div><div><font size="2"  >initdb -D $PGDATA -E UTF8 --locale=C -U postgres -W</font></div><div><font size="2"  >vi $PGDATA/postgresql.conf</font></div><div><font size="2"  >wal_sync_method = open_sync</font></div><div><font size="2"  >checkpoint_segments = 32</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >pg_ctl start</font></div><div><font size="2"  >psql postgres postgres</font></div><div><font size="2"  >create table test(id serial primary key,crt_time timestamp);</font></div><div><font size="2"  >create index idx_crt_time on test(crt_time);</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >vi test8k.sql</font></div><div><font size="2"  >insert into test (crt_time) values (now());</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >pgbench -M prepared -c 1 -f ./test8k.sql -n -j 1 -r -T 60 -U postgres postgres</font></div><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 1</font></div><div><font size="2"  >number of threads: 1</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 66378</font></div><div><font size="2"  >tps = 1106.273191 (including connections establishing)</font></div><div><font size="2"  >tps = 1106.312299 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.902769 &nbsp; &nbsp; &nbsp; &nbsp;insert into test (crt_time) values (now());</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >iostat -x 1</font></div><div><font size="2"  >Device: &nbsp; &nbsp; &nbsp; &nbsp; rrqm/s &nbsp; wrqm/s &nbsp; r/s &nbsp; w/s &nbsp; rsec/s &nbsp; wsec/s avgrq-sz avgqu-sz &nbsp; await &nbsp;svctm &nbsp;%util</font></div><div><font size="2"  >cciss/c0d0 &nbsp; &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 0.00 &nbsp;0.00 1124.00 &nbsp; &nbsp; 0.00 18640.00 &nbsp; &nbsp;16.58 &nbsp; &nbsp; 0.88 &nbsp; &nbsp;0.78 &nbsp; 0.78 &nbsp;88.00</font></div><div><font size="2"  >cciss/c0d0p1 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 0.00 &nbsp;0.00 1124.00 &nbsp; &nbsp; 0.00 18640.00 &nbsp; &nbsp;16.58 &nbsp; &nbsp; 0.88 &nbsp; &nbsp;0.78 &nbsp; 0.78 &nbsp;88.00</font></div><p></p></pre></div><div><br></div><div>--with-wal-blocksize=16测试</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >useradd k16</font></div><div><font size="2"  >su - k16</font></div><div><font size="2"  >./configure --prefix=/opt/pgsqlk16 --with-pgport=5433 --with-perl --with-python --with-openssl --with-pam --without-ldap --with-libxml --with-libxslt --enable-thread-safety --with-wal-blocksize=16 &amp;&amp; gmake world</font></div><div><font size="2"  >su - root</font></div><div><font size="2"  >gmake install-world</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >initdb -D $PGDATA -E UTF8 --locale=C -U postgres -W</font></div><div><font size="2"  >vi postgresql.conf</font></div><div><font size="2"  >wal_sync_method = open_sync</font></div><div><font size="2"  >checkpoint_segments = 32</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >vi test16k.sql</font></div><div><font size="2"  >insert into test (crt_time) values (now());</font></div><div><font size="2"  ><br></font></div><div><font size="2"  ><br></font></div><div><font size="2"  >pgbench -M prepared -c 1 -f ./test16k.sql -n -j 1 -r -T 60 -U postgres postgres</font></div><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 1</font></div><div><font size="2"  >number of threads: 1</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 85610</font></div><div><font size="2"  >tps = 1426.806010 (including connections establishing)</font></div><div><font size="2"  >tps = 1426.871169 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.699351 &nbsp; &nbsp; &nbsp; &nbsp;insert into test (crt_time) values (now());</font></div><div><font size="2"  ><br></font></div><div><font size="2"  ><br></font></div><div><font size="2"  >iostat -x 1</font></div><div><font size="2"  >Device: &nbsp; &nbsp; &nbsp; &nbsp; rrqm/s &nbsp; wrqm/s &nbsp; r/s &nbsp; w/s &nbsp; rsec/s &nbsp; wsec/s avgrq-sz avgqu-sz &nbsp; await &nbsp;svctm &nbsp;%util</font></div><div><font size="2"  >cciss/c0d0 &nbsp; &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 0.00 &nbsp;0.00 1508.00 &nbsp; &nbsp; 0.00 49152.00 &nbsp; &nbsp;32.59 &nbsp; &nbsp; 0.89 &nbsp; &nbsp;0.59 &nbsp; 0.59 &nbsp;88.60</font></div><div><font size="2"  >cciss/c0d0p1 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp; 0.00 &nbsp;0.00 1508.00 &nbsp; &nbsp; 0.00 49152.00 &nbsp; &nbsp;32.59 &nbsp; &nbsp; 0.89 &nbsp; &nbsp;0.59 &nbsp; 0.59 &nbsp;88.60</font></div><p></p></pre></div><div><br></div><div><br></div><div>--with-wal-blocksize=64测试</div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >useradd k64</font></div><div><font size="2"  >su - k64</font></div><div><font size="2"  >./configure --prefix=/opt/pgsqlk64 --with-pgport=5434 --with-perl --with-python --with-openssl --with-pam --without-ldap --with-libxml --with-libxslt --enable-thread-safety --with-wal-blocksize=64 &amp;&amp; gmake world</font></div><div><font size="2"  >su - root</font></div><div><font size="2"  >gmake install-world</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >initdb -D $PGDATA -E UTF8 --locale=C -U postgres -W</font></div><div><font size="2"  >vi postgresql.conf</font></div><div><font size="2"  >wal_sync_method = open_sync</font></div><div><font size="2"  >checkpoint_segments = 32</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >vi test64k.sql</font></div><div><font size="2"  >insert into test (crt_time) values (now());</font></div><div><font size="2"  ><br></font></div><div><font size="2"  ><br></font></div><div><font size="2"  >pgbench -M prepared -c 1 -f ./test64k.sql -n -j 1 -r -T 60 -U postgres postgres</font></div><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 1</font></div><div><font size="2"  >number of threads: 1</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 65781</font></div><div><font size="2"  >tps = 1096.315667 (including connections establishing)</font></div><div><font size="2"  >tps = 1096.349050 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.910967 &nbsp; &nbsp; &nbsp; &nbsp;insert into test (crt_time) values (now());</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >iostat -x 1</font></div><div><font size="2"  >Device: &nbsp; &nbsp; &nbsp; &nbsp; rrqm/s &nbsp; wrqm/s &nbsp; r/s &nbsp; w/s &nbsp; rsec/s &nbsp; wsec/s avgrq-sz avgqu-sz &nbsp; await &nbsp;svctm &nbsp;%util</font></div><div><font size="2"  >cciss/c0d0 &nbsp; &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp;49.33 &nbsp;0.00 1311.67 &nbsp; &nbsp; 0.00 168728.00 &nbsp; 128.64 &nbsp; &nbsp; 0.88 &nbsp; &nbsp;0.67 &nbsp; 0.65 &nbsp;84.70</font></div><div><font size="2"  >cciss/c0d0p1 &nbsp; &nbsp; &nbsp;0.00 &nbsp; &nbsp;49.33 &nbsp;0.00 1311.67 &nbsp; &nbsp; 0.00 168728.00 &nbsp; 128.64 &nbsp; &nbsp; 0.88 &nbsp; &nbsp;0.67 &nbsp; 0.65 &nbsp;84.70</font></div><p></p></pre></div><div><br></div><div><br></div><div>二、fdatasync 同步写方法测试:</div><div>-- 使用k8, k16, k64用户测试, 只是把参数修改一下. 重启数据库</div><div><pre class="prettyprint"  ><p><font size="2"  >wal_sync_method = fdatasync</font></p></pre></div><div><br></div><div><br></div><div>-- 8k</div><div><br></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 1</font></div><div><font size="2"  >number of threads: 1</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 68638</font></div><div><font size="2"  >tps = 1143.953797 (including connections establishing)</font></div><div><font size="2"  >tps = 1143.991930 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.872975 &nbsp; &nbsp; &nbsp; &nbsp;insert into test (crt_time) values (now());</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >Device: &nbsp; &nbsp; &nbsp; &nbsp; rrqm/s &nbsp; wrqm/s &nbsp; r/s &nbsp; w/s &nbsp; rsec/s &nbsp; wsec/s avgrq-sz avgqu-sz &nbsp; await &nbsp;svctm &nbsp;%util</font></div><div><font size="2"  >cciss/c0d0 &nbsp; &nbsp; &nbsp; &nbsp;0.00 &nbsp;1242.00 &nbsp;0.00 1126.67 &nbsp; &nbsp; 0.00 18949.33 &nbsp; &nbsp;16.82 &nbsp; &nbsp; 1.38 &nbsp; &nbsp;1.23 &nbsp; 0.79 &nbsp;89.27</font></div><div><font size="2"  >cciss/c0d0p1 &nbsp; &nbsp; &nbsp;0.00 &nbsp;1242.00 &nbsp;0.00 1126.67 &nbsp; &nbsp; 0.00 18949.33 &nbsp; &nbsp;16.82 &nbsp; &nbsp; 1.38 &nbsp; &nbsp;1.23 &nbsp; 0.79 &nbsp;89.27</font></div><p></p></pre></div><div><br></div><div>-- 16k</div><div><br></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 1</font></div><div><font size="2"  >number of threads: 1</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 93292</font></div><div><font size="2"  >tps = 1554.835518 (including connections establishing)</font></div><div><font size="2"  >tps = 1554.887554 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.641965 &nbsp; &nbsp; &nbsp; &nbsp;insert into test (crt_time) values (now());</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >Device: &nbsp; &nbsp; &nbsp; &nbsp; rrqm/s &nbsp; wrqm/s &nbsp; r/s &nbsp; w/s &nbsp; rsec/s &nbsp; wsec/s avgrq-sz avgqu-sz &nbsp; await &nbsp;svctm &nbsp;%util</font></div><div><font size="2"  >cciss/c0d0 &nbsp; &nbsp; &nbsp; &nbsp;0.00 &nbsp;4898.67 &nbsp;0.00 1596.00 &nbsp; &nbsp; 0.00 51957.33 &nbsp; &nbsp;32.55 &nbsp; &nbsp; 0.82 &nbsp; &nbsp;0.51 &nbsp; 0.51 &nbsp;82.10</font></div><div><font size="2"  >cciss/c0d0p1 &nbsp; &nbsp; &nbsp;0.00 &nbsp;4898.67 &nbsp;0.00 1596.00 &nbsp; &nbsp; 0.00 51957.33 &nbsp; &nbsp;32.55 &nbsp; &nbsp; 0.82 &nbsp; &nbsp;0.51 &nbsp; 0.51 &nbsp;82.10</font></div><p></p></pre></div><div><br></div><div><br></div><div>-- 64k</div><div><br></div><div><pre class="prettyprint"  ><p></p><div><font size="2"  >transaction type: Custom query</font></div><div><font size="2"  >scaling factor: 1</font></div><div><font size="2"  >query mode: prepared</font></div><div><font size="2"  >number of clients: 1</font></div><div><font size="2"  >number of threads: 1</font></div><div><font size="2"  >duration: 60 s</font></div><div><font size="2"  >number of transactions actually processed: 72556</font></div><div><font size="2"  >tps = 1209.230128 (including connections establishing)</font></div><div><font size="2"  >tps = 1209.271786 (excluding connections establishing)</font></div><div><font size="2"  >statement latencies in milliseconds:</font></div><div><font size="2"  >&nbsp; &nbsp; &nbsp; &nbsp; 0.825657 &nbsp; &nbsp; &nbsp; &nbsp;insert into test (crt_time) values (now());</font></div><div><font size="2"  ><br></font></div><div><font size="2"  >Device: &nbsp; &nbsp; &nbsp; &nbsp; rrqm/s &nbsp; wrqm/s &nbsp; r/s &nbsp; w/s &nbsp; rsec/s &nbsp; wsec/s avgrq-sz avgqu-sz &nbsp; await &nbsp;svctm &nbsp;%util</font></div><div><font size="2"  >cciss/c0d0 &nbsp; &nbsp; &nbsp; &nbsp;0.00 18166.00 &nbsp;0.00 1204.67 &nbsp; &nbsp; 0.00 154968.00 &nbsp; 128.64 &nbsp; &nbsp; 0.82 &nbsp; &nbsp;0.68 &nbsp; 0.67 &nbsp;80.20</font></div><div><font size="2"  >cciss/c0d0p1 &nbsp; &nbsp; &nbsp;0.00 18166.00 &nbsp;0.00 1204.67 &nbsp; &nbsp; 0.00 154925.33 &nbsp; 128.60 &nbsp; &nbsp; 0.82 &nbsp; &nbsp;0.68 &nbsp; 0.67 &nbsp;80.20</font></div><p></p></pre></div><div><font size="2"  >【小结】</font></div><div><font size="2"  >1. 在linux 下面使用fdatasync比open_sync性能略有提升.</font></div><div><font size="2"  >2. 测试中16k的wal block size性能最佳. 这个可能和我插入的每条记录的SIZE有关系, 如果每条记录的SIZE都非常大的话, 可能大一点的wal block size会更适合.</font></div><div><font size="2"  ><span style="line-height: 20px;"  ><br></span></font></div><wbr></div>
	</div>
</div>
</body>
</html>