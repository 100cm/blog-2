<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">C compilation behind the scenes</h2>
	<h5 id="">2012-08-07 14:07:04&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201277274811/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>1. Preprocessing: fix the source.</div><div>The first thing the compiler needs to do is fix the source. It needs to add in&nbsp;</div><div>any extra header files it’s been told about using the #include directive.&nbsp;</div><div>It might also need to expand or skip over some sections of the program.&nbsp;</div><div>Once it’s done, the source code will be ready for the actual compilation.</div><div><br></div><div>2. Compilation: translate into assembly.</div><div>The C programming language probably seems pretty low level, but&nbsp;</div><div>the truth is it’s not low level enough for the computer to understand. The&nbsp;</div><div>computer only really understands very low-level machine code&nbsp;</div><div>instructions, and the first step to generate machine code is to convert&nbsp;</div><div>the C source code into assembly language symbols like this:&nbsp;</div><div><br></div><div>movq &nbsp;-24(%rbp), %rax</div><div>movzbl &nbsp;(%rax), %eax</div><div>movl &nbsp;%eax, %edx</div><div><br></div><div>Looks pretty obscure? Assembly language describes the individual&nbsp;</div><div>instructions the central processor will have to follow when running the&nbsp;</div><div>program. The C compiler has a whole set of recipes for each of the&nbsp;</div><div>different parts of the C language. These recipes will tell the compiler how&nbsp;</div><div>to convert an if statement or a function call into a sequence of assembly&nbsp;</div><div>language instructions. But even assembly isn’t low level enough for the&nbsp;</div><div>computer. That’s why it needs…</div><div><br></div><div><br></div><div>3. Assembly: generate the object code.</div><div>The compiler will need to assemble the symbol codes into machine or&nbsp;</div><div>object code. This is the actual binary code that will be executed by&nbsp;</div><div>the circuits inside the CPU.&nbsp;</div><div><br></div><div>10010101 00100101 11010101 01011100</div><div><br></div><div>So are you all done? After all, you’ve taken the original C source code&nbsp;</div><div>and converted it into the 1s and 0s that the computer’s circuits need.&nbsp;</div><div>But no, there’s still one more step. If you give the computer several files&nbsp;</div><div>to compile for a program, the compiler will generate a piece of object&nbsp;</div><div>code for each source file. But in order for these separate object files to&nbsp;</div><div>form a single executable program, one more thing has to occur…</div><div><br></div><div>4. Linking: put it all together.</div><div>Once you have all of the separate pieces of object code, you need to&nbsp;</div><div>fit them together like jigsaw pieces to form the executable program.&nbsp;</div><div>The compiler will connect the code in one piece of object code that&nbsp;</div><div>calls a function in another piece of object code. Linking will also make&nbsp;</div><div>sure that the program is able to call library code properly. Finally, the&nbsp;</div><div>program will be written out into the executable program file using&nbsp;</div><div>a format that is supported by the operating system. The file format&nbsp;</div><div>is important, because it will allow the operating system to load the&nbsp;</div><div>program into memory and make it run.</div><div><br></div><wbr>图例 :&nbsp;<div><div><img title="C compilation behind the scenes - 德哥@Digoal - The Heart,The World."  alt="C compilation behind the scenes - 德哥@Digoal - The Heart,The World."  style="margin:0 10px 0 0;"  src="http://img4.ph.126.net/UYZ4ZVw8Lkxz9MQw1hZ5HQ==/6597164324656893744.jpg"  ></div>&nbsp;<div><img title="C compilation behind the scenes - 德哥@Digoal - The Heart,The World."  alt="C compilation behind the scenes - 德哥@Digoal - The Heart,The World."  style="margin:0 10px 0 0;"  src="http://img7.ph.126.net/zN2DLCoKvvaLZJRQwwBY3Q==/6597371032842779507.jpg"  ></div>&nbsp;</div></div>
	</div>
</div>
</body>
</html>