<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">ganglia gweb Custom Composite Graphs</h2>
	<h5 id="">2014-09-15 16:29:26&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201481535636763/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><div>在讲gweb 自定义view时, 我们看到json文件里面对items主机配置时, 可以选择查看主机的graph还是metric,</div><div><br></div><div><pre class="prettyprint"   ><p></p><div><div><div><font size="2"   ># pwd</font></div><div><font size="2"   >/data01/web/ganglia-web/conf</font></div></div><div><font size="2"   >view_jira.json</font></div><div><font size="2"   >{</font></div><div><font size="2"   >&nbsp; "view_name":"jira", &nbsp; # 视图名称</font></div><div><font size="2"   >&nbsp; "items":[ &nbsp; &nbsp;# 视图里包含的东西, 配置为列表形式, 如下</font></div><div><font size="2"   >&nbsp; &nbsp; { "hostname":"web01.domain.com","graph":"cpu_report"}, &nbsp; &nbsp; # 图表1, 单台主机的单个graph. 在graph.d目录中定义具体内容</font></div></div><div><font size="2"   >&nbsp; &nbsp; { "hostname":"web03.domain.com","metric":"cpu_aidle"}, &nbsp; &nbsp;# 图表3, 单台主机的单个metric</font></div><div><font size="2"   >...</font></div><p></p></pre></div></div><div><span style="line-height: 28px;"   >metric很好理解, 使用gmond -m就能查看所有module支持的metric.</span></div><div><div style="line-height: 28px;"   >graph则是一些metric的组合, 在graph.d目录中配置.</div></div><div style="line-height: 28px;"   >例如 :&nbsp;</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 graph.d]# pwd</font></div><div style="line-height: 28px;"   ><font size="2"   >/data01/web/ganglia-web/graph.d</font></div><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 graph.d]# ll</font></div><div style="line-height: 28px;"   ><font size="2"   >total 80</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;578 Jan &nbsp;6 &nbsp;2014 apache_report.json</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;186 Jan &nbsp;6 &nbsp;2014 apache_response_report.json</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;426 Jan &nbsp;6 &nbsp;2014 cpu_report.json</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 9065 Jan &nbsp;6 &nbsp;2014 cpu_report.php</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;476 Jan &nbsp;6 &nbsp;2014 load_all_report.json</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;590 Jan &nbsp;6 &nbsp;2014 load_report.json</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;680 Jan &nbsp;6 &nbsp;2014 mem_report.json</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 8324 Aug &nbsp;4 03:04 mem_report.php</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 4973 Jan &nbsp;6 &nbsp;2014 metric.php</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;355 Jan &nbsp;6 &nbsp;2014 network_report.json</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 1616 Jan &nbsp;6 &nbsp;2014 nfs_v3_client_report.json</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 &nbsp;358 Jan &nbsp;6 &nbsp;2014 packet_report.json</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 6392 Jan &nbsp;6 &nbsp;2014 sample_report.php</font></div><div style="line-height: 28px;"   ><font size="2"   >-rw-r--r-- 1 nobody 1000 3543 Jan &nbsp;6 &nbsp;2014 varnish_report.php</font></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 graph.d]# cat cpu_report.json&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >{</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp;"report_name" : "cpu_report",</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp;"report_type" : "template",</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp;"title" : "CPU Report",</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp;"graphite" &nbsp;: "target=alias(HOST_CLUSTER.cpu_user.sum,'User')&amp;target=alias(HOST_CLUSTER.cpu_nice.sum%2C'Nice')&amp;target=alias(HOST_CLUSTER.cpu_system.sum,'System')&amp;target=alias(HOST_CLUSTER.cpu_wio.sum,'Wait')&amp;target=alias(HOST_CLUSTER.cpu_idle.sum%2C'Idle')&amp;areaMode=stacked&amp;max=100&amp;colorList=3333bb,ffea00,dd0000,ff8a60,e2e2f2"</font></div><div style="line-height: 28px;"   ><font size="2"   >}</font></div></div><p></p></pre></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><br></div><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 graph.d]# cat load_all_report.json&nbsp;</font></div><div style="line-height: 28px;"   ><font size="2"   >{</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp;"report_name" : "load_all_report",</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp;"report_type" : "standard",</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp;"title" : "Load All Report",</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp;"vertical_label" : "load",</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp;"series" : [</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp; &nbsp; { "metric": "load_one", "color": "3333bb", "label": "Load 1", "line_width": "2", "type": "line" },</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp; &nbsp; { "metric": "load_five", "color": "ffea00", "label": "Load 5", "line_width": "2", "type": "line" },</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp; &nbsp; { "metric": "load_fifteen", "color": "dd0000", "label": "Load 15", "line_width": "2", "type": "line" }</font></div><div style="line-height: 28px;"   ><font size="2"   >&nbsp; &nbsp;]</font></div><div style="line-height: 28px;"   ><font size="2"   >}</font></div><p></p></pre></div></div></div></div><wbr><div>graph的命名规则 :&nbsp;</div><div>?_report.json</div><div>内容解释 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >Graph configuration</font></div><div><font size="2"   >Key: Value</font></div><div><font size="2"   >report_name: Name of the report that web UI uses.</font></div><div><font size="2"   >title: Title of the report to show on a graph.</font></div><div><font size="2"   >vertical_label: Y-axis description (optional).</font></div><div><font size="2"   >series: An array of metrics to use to compose a graph.&nbsp;</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >Series options</font></div><div><font size="2"   >Key: Value</font></div><div><font size="2"   >metric: Name of a metric, such as load_one and cpu_system. If the metric doesn’t exist it&nbsp;<span style="line-height: 28px;"   >will be skipped.</span></font></div><div><font size="2"   >color: A 6 hex-decimal color code, such as 000000 for black.</font></div><div><font size="2"   >label: Metric label, such as Load 1.</font></div><div><font size="2"   >type: Item type. It can be either line or stack.</font></div><div><font size="2"   >line_width: If type is set to line, this value will be used as a line width. If this value is not specified,&nbsp;<span style="line-height: 28px;"   >it defaults to 2. If type is stack, it's ignored even if set.</span></font></div></div><p></p></pre></div><div>通过配置?_report.json, 我们可以简化view的json配置.</div><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402014815105622529/"   >http://blog.163.com/digoal@126/blog/static/1638770402014815105622529/</a></div><div><br></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="ganglia gweb Custom Composite Graphs - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>