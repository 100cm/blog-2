<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Docker image Introduce</h2>
	<h5 id="">2014-09-30 17:33:04&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020148305235269/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>Docker 的image是运行的基本.</div><div>例如我们build一个image时, 在Dockerfile每条指令会产生一个可读写的image, 下一条指令使用上一条指令产生的image为基础, 继续产生image(然后删除上一个image), 如果指令没有对image有修改的动作, 那么可以使用image cache. 所有的指令执行完, 生成最终的image.</div><div>然后我们就可以使用image来创建并运行container了.</div><wbr><div><br></div><div>例如我当前本地有一个images, centos, TAG是centos5, 我需要使用它作为base image, 来创建我自己的image.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@150 docker]# docker images</font></div><div><font size="2"   >REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VIRTUAL SIZE</font></div><div><span style="line-height: 28px;"   ><font size="2"   >centos &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;centos5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d5844d902074 &nbsp; &nbsp; &nbsp; &nbsp;2 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;467.1 MB</font></span></div><p></p></pre></div><div><br></div><div>创建一个空目录, 并在这个空目录中写一个简单的Dockerfile内容如下 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   ># vi Dockerfile&nbsp;</font></div><div><font size="2"   >FROM centos:centos5</font></div><div><font size="2"   >CMD ["-l"]</font></div><div><font size="2"   >ENTRYPOINT ["ls"]</font></div><p></p></pre></div><div><br></div><div>使用docker build .来创建image.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@150 docker]# docker build .</font></div><div><font size="2"   >Sending build context to Docker daemon &nbsp;2.56 kB</font></div><div><font size="2"   >Sending build context to Docker daemon&nbsp;</font></div><div><font size="2"   >Step 0 : FROM centos:centos5</font></div><div><font size="2"   >&nbsp;---&gt; d5844d902074 &nbsp; # 这个ID是centos:centos5的<span style="line-height: 28px;"   >IMAGE id</span></font></div><div><font size="2"   >Step 1 : CMD ["-l"]</font></div><div><font size="2"   >&nbsp;---&gt; Running in 9fd2f16fcf97 &nbsp;&nbsp;<span style="line-height: 28px;"   ># 这个ID是执行第一条指令CMD ["-l]时产生的中间过程</span><span style="line-height: 28px;"   >IMAGE ID</span></font></div><div><font size="2"   >&nbsp;---&gt; e253cb9b0ea4 &nbsp;&nbsp;<span style="line-height: 28px;"   ># 这个ID是执行第一条指令CMD ["-l]后产生的</span><span style="line-height: 28px;"   >IMAGE ID</span></font></div><div><font size="2"   >Removing intermediate container 9fd2f16fcf97 &nbsp; # &nbsp;移除中间image</font></div><div><font size="2"   >Step 2 : ENTRYPOINT ["ls"]</font></div><div><font size="2"   >&nbsp;---&gt; Running in 52c06c9fae1b &nbsp;</font></div><div><font size="2"   >&nbsp;---&gt; a18fae31b310</font></div><div><font size="2"   >Removing intermediate container 52c06c9fae1b</font></div><div><font size="2"   >Successfully built a18fae31b310 &nbsp; &nbsp;# 最终的ID, 可以使用docker images看到这个ID</font></div><p></p></pre></div><div><br></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@150 docker]# docker images</font></div><div><font size="2"   >REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VIRTUAL SIZE</font></div><div><font size="2"   >&lt;none&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;none&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;a18fae31b310 &nbsp; &nbsp; &nbsp; &nbsp;14 minutes ago &nbsp; &nbsp; &nbsp;467.1 MB</font></div><div><font size="2"   >centos &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;centos5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d5844d902074 &nbsp; &nbsp; &nbsp; &nbsp;2 days ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;467.1 MB</font></div><p></p></pre></div><div><br></div><div>使用这个image运行</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@150 docker]# docker run a18fae31b310</font></div><div><font size="2"   >total 64</font></div><div><font size="2"   >drwxr-xr-x &nbsp; 2 root root 4096 Sep 26 12:21 bin</font></div><div><font size="2"   >drwxr-xr-x &nbsp; 4 root root &nbsp;340 Sep 30 10:29 dev</font></div><div><font size="2"   >drwxr-xr-x &nbsp;39 root root 4096 Sep 30 10:29 etc</font></div><div><font size="2"   >drwxr-xr-x &nbsp; 2 root root 4096 May 11 &nbsp;2011 home</font></div><div><font size="2"   >drwxr-xr-x &nbsp; 6 root root 4096 Sep 26 12:20 lib</font></div><div><font size="2"   >drwxr-xr-x &nbsp; 7 root root 4096 Sep 26 12:20 lib64</font></div><div><font size="2"   >drwx------ &nbsp; 2 root root 4096 Sep 26 12:19 lost+found</font></div><div><font size="2"   >drwxr-xr-x &nbsp; 2 root root 4096 May 11 &nbsp;2011 media</font></div><div><font size="2"   >drwxr-xr-x &nbsp; 2 root root 4096 May 11 &nbsp;2011 mnt</font></div><div><font size="2"   >drwxr-xr-x &nbsp; 2 root root 4096 May 11 &nbsp;2011 opt</font></div><div><font size="2"   >dr-xr-xr-x 372 root root &nbsp; &nbsp;0 Sep 30 10:29 proc</font></div><div><font size="2"   >drwxr-x--- &nbsp; 2 root root 4096 May 11 &nbsp;2011 root</font></div><div><font size="2"   >drwxr-xr-x &nbsp; 2 root root 4096 Sep 26 12:21 sbin</font></div><div><font size="2"   >drwxr-xr-x &nbsp; 3 root root 4096 Sep 26 12:21 selinux</font></div><div><font size="2"   >drwxr-xr-x &nbsp; 2 root root 4096 May 11 &nbsp;2011 srv</font></div><div><font size="2"   >drwxr-xr-x &nbsp;13 root root &nbsp; &nbsp;0 Sep 30 &nbsp;2014 sys</font></div><div><font size="2"   >drwxrwxrwt &nbsp; 2 root root 4096 Sep 26 12:21 tmp</font></div><div><font size="2"   >drwxr-xr-x &nbsp;14 root root 4096 Sep 26 12:20 usr</font></div><div><font size="2"   >drwxr-xr-x &nbsp;17 root root 4096 Sep 26 12:19 var</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >[root@150 docker]# docker ps -a</font></div><div><font size="2"   >CONTAINER ID &nbsp; &nbsp; &nbsp; &nbsp;IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</font></div><div><font size="2"   >ae77e79c4f58 &nbsp; &nbsp; &nbsp; &nbsp;a18fae31b310 &nbsp; &nbsp; &nbsp; &nbsp;ls -l &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 29 seconds ago &nbsp; &nbsp; &nbsp;Exited (0) 28 seconds ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;desperate_lovelace&nbsp;</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >[root@150 docker]# docker rm ae77e79c4f58</font></div><div><font size="2"   >ae77e79c4f58</font></div><div><font size="2"   >[root@150 docker]# docker ps -a</font></div><div><font size="2"   >CONTAINER ID &nbsp; &nbsp; &nbsp; &nbsp;IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</font></div></div><p></p></pre></div><div><br></div><div>image的介绍 :&nbsp;</div><div><h2 id="introduction"   style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-weight: 400; line-height: 1.7; color: rgb(57, 77, 84); text-rendering: optimizelegibility; font-size: 21px; margin: 10px 0px 4px;"   >Introduction</h2><div><img title="Docker image Introduce - 德哥@Digoal - PostgreSQL research"   alt="Docker image Introduce - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img0.ph.126.net/32d-Hf7jY2nyV6-pvIIyqQ==/6608606942166942102.png"   ></div><p style="margin-top: 0px; margin-bottom: 1em; font-size: 14px; color: rgb(57, 77, 84); line-height: 23.7999992370605px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;"   >&nbsp;</p><p style="margin-top: 0px; margin-bottom: 1em; font-size: 14px; color: rgb(57, 77, 84); line-height: 23.7999992370605px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;"   >In Docker terminology, a read-only&nbsp;<a style="color: rgb(36, 184, 235); line-height: 1.7;" rel="nofollow" href="http://docs.docker.com/terms/layer/#layer-def"   ><em style="line-height: 1.7;"   >Layer</em></a>&nbsp;is called an&nbsp;<strong style="line-height: 1.7;"   >image</strong>. An image never changes.</p><p style="margin-top: 0px; margin-bottom: 1em; font-size: 14px; color: rgb(57, 77, 84); line-height: 23.7999992370605px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;"   >Since Docker uses a&nbsp;<a style="color: rgb(36, 184, 235); line-height: 1.7;" rel="nofollow" href="http://docs.docker.com/terms/layer/#ufs-def"   ><em style="line-height: 1.7;"   >Union File System</em></a>, the processes think the whole file system is mounted read-write. But all the changes go to the top-most writeable layer, and underneath, the original file in the read-only image is unchanged. Since images don't change, images do not have state.</p><div><img title="Docker image Introduce - 德哥@Digoal - PostgreSQL research"   alt="Docker image Introduce - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img2.ph.126.net/Ni-7RMJaarkyw9uUQKVwHQ==/6619335976630418306.png"   ></div><p style="margin-top: 0px; margin-bottom: 1em; font-size: 14px; color: rgb(57, 77, 84); line-height: 23.7999992370605px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;"   >&nbsp;</p><h2 id="parent-image"   style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-weight: 400; line-height: 1.7; color: rgb(57, 77, 84); text-rendering: optimizelegibility; font-size: 21px; margin: 10px 0px 4px;"   >Parent Image</h2><div><img title="Docker image Introduce - 德哥@Digoal - PostgreSQL research"   alt="Docker image Introduce - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img0.ph.126.net/gf2xkAFmL5XkFKheBTiwbg==/6619334877118790514.png"   ></div><p style="margin-top: 0px; margin-bottom: 1em; font-size: 14px; color: rgb(57, 77, 84); line-height: 23.7999992370605px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;"   ><span style="line-height: 23.7999992370605px;"   >Each image may depend on one more image which forms the layer beneath it. We sometimes say that the lower image is the</span><span style="line-height: 23.7999992370605px;"   >&nbsp;</span><strong style="line-height: 1.7;"   >parent</strong><span style="line-height: 23.7999992370605px;"   >&nbsp;</span><span style="line-height: 23.7999992370605px;"   >of the upper image.</span></p><h2 id="base-image"   style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-weight: 400; line-height: 1.7; color: rgb(57, 77, 84); text-rendering: optimizelegibility; font-size: 21px; margin: 10px 0px 4px;"   >Base Image</h2><p style="margin-top: 0px; margin-bottom: 1em; font-size: 14px; color: rgb(57, 77, 84); line-height: 23.7999992370605px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;"   >An image that has no parent is a&nbsp;<strong style="line-height: 1.7;"   >base image</strong>.</p><h2 id="image-ids"   style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-weight: 400; line-height: 1.7; color: rgb(57, 77, 84); text-rendering: optimizelegibility; font-size: 21px; margin: 10px 0px 4px;"   >Image IDs</h2><p style="margin-top: 0px; margin-bottom: 1em; font-size: 14px; color: rgb(57, 77, 84); line-height: 23.7999992370605px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;"   >All images are identified by a 64 hexadecimal digit string (internally a 256bit value). To simplify their use, a short ID of the first 12 characters can be used on the command line. There is a small possibility of short id collisions, so the docker server will always return the long ID.</p></div><div><br></div>[参考]<div>1.&nbsp;<a target="_blank" rel="nofollow" href="http://docs.docker.com/terms/image/"   >http://docs.docker.com/terms/image/</a><br><div><br></div><div><a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="Docker image Introduce - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a><br></div></div></div>
	</div>
</div>
</body>
</html>