<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">gmond configure</h2>
	<h5 id="">2014-09-10 15:01:18&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/1638770402014810227936/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>ganglia的安装已经帮助请参考</div><div><div style="line-height: 28px;"   >1.&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402014899439839/"   >http://blog.163.com/digoal@126/blog/static/1638770402014899439839/</a></div><div style="line-height: 28px;"   >2.&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201489111654684/"   >http://blog.163.com/digoal@126/blog/static/163877040201489111654684/</a></div></div><div style="line-height: 28px;"   ><br></div><div style="line-height: 28px;"   >首先回忆一下gmond的架构, gmond实际上是使用metric module收集信息, 通过通道发送, 另一方面, 监听并接收和聚合来自网络的gmond节点发送过来的metric信息.</div><div style="line-height: 28px;"   >下面这张图是多播场景.</div><div style="line-height: 28px;"   ><div><img title="gmond configure - 德哥@Digoal - PostgreSQL research"   alt="gmond configure - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img2.ph.126.net/qYhD3QV6WEP9tP7Phx6m0w==/6619515197025649769.png"   ></div><div style="line-height: 28px;"   ><br></div>下面这张图也是多播场景, 只是配置了mute或者deaf, deaf只发不收, mute只收不发.<br><div><img title="gmond configure - 德哥@Digoal - PostgreSQL research"   alt="gmond configure - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img0.ph.126.net/mVXx67bdjzixXnqwWhz-yg==/6608635529469168510.png"   ></div><div style="line-height: 28px;"   ><br></div>下面这个图是单播场景.<br><div><img title="gmond configure - 德哥@Digoal - PostgreSQL research"   alt="gmond configure - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/fKmCOynONQxFp-3UvsEHpw==/6608720191864506220.png"   ></div></div><div style="line-height: 28px;"   ><br></div><div style="line-height: 28px;"   >本文讲一下gmond的配置, 详细的请参考man gmond.conf</div><div style="line-height: 28px;"   >首先我们看看gmond的命令帮助.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-221 man]# gmond -h</font></div><div><font size="2"   >gmond 3.6.0</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >The Ganglia Monitoring Daemon (gmond) listens to the cluster</font></div><div><font size="2"   >message channel, stores the data in-memory and when requested</font></div><div><font size="2"   >will output an XML description of the state of the cluster</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >Usage: gmond [OPTIONS]...</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; -h, --help &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Print help and exit</font></div><div><font size="2"   >&nbsp; -V, --version &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Print version and exit</font></div><div><font size="2"   >&nbsp; -c, --conf=STRING &nbsp; &nbsp; &nbsp;Location of gmond configuration file &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(default=`/opt/ganglia-core-3.6.0/etc/gmond.conf')</font></div><div><font size="2"   >&nbsp; -l, --location=STRING &nbsp;Location of this host in the cluster&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'rack,rank,plane'. &nbsp;(default=`0,0,0')</font></div><div><font size="2"   >&nbsp; -d, --debug=INT &nbsp; &nbsp; &nbsp; &nbsp;Debug level. If greater than zero, daemon will stay in&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;foreground. &nbsp;(default=`0')</font></div><div><font size="2"   >&nbsp; -f, --foreground &nbsp; &nbsp; &nbsp; Run in foreground (don't daemonize) &nbsp;(default=off)</font></div><div><font size="2"   >&nbsp; -t, --default_config &nbsp; Print the default configuration to stdout and exit &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(default=off)</font></div><div><font size="2"   >&nbsp; -m, --metrics &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Print the list of metrics this gmond supports &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(default=off)</font></div><div><font size="2"   >&nbsp; -b, --bandwidth &nbsp; &nbsp; &nbsp; &nbsp;Calculate minimum bandwidth use for configuration &nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(default=off)</font></div><div><font size="2"   >&nbsp; -r, --convert=STRING &nbsp; Convert a 2.5.x configuration file to the new 3.x&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;format</font></div><div><font size="2"   >&nbsp; -p, --pid-file=STRING &nbsp;Write process-id to file</font></div><p></p></pre></div><div><br></div><div>注意几项 :&nbsp;</div><div>产生一个默认的配置文件</div><div><div style="line-height: 28px;"   >&nbsp; -t, --default_config &nbsp; Print the default configuration to stdout and exit &nbsp;</div><div style="line-height: 28px;"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(default=off)</div></div><div>查看当前gmond core支持的metric</div><div><div style="line-height: 28px;"   >&nbsp; -m, --metrics &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Print the list of metrics this gmond supports &nbsp;</div><div style="line-height: 28px;"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(default=off)</div></div><div>评估当前gmond配置下的带宽需求</div><div><div style="line-height: 28px;"   >&nbsp; -b, --bandwidth &nbsp; &nbsp; &nbsp; &nbsp;Calculate minimum bandwidth use for configuration &nbsp;</div><div style="line-height: 28px;"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(default=off)</div></div><div style="line-height: 28px;"   ><br></div><div style="line-height: 28px;"   >我们看一下3.6.0支持的metric, 配置文件不存在, 因此只输出了core支持的metric, 如果有配置文件的话, 会输出包含自定义module在内的所有metric.</div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><pre class="prettyprint"   ><p></p><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >[root@db-172-16-3-221 man]# gmond -m</font></div><div style="line-height: 28px;"   ><font size="2"   >Configuration file '/opt/ganglia-core-3.6.0/etc/gmond.conf' not found.</font></div></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><font size="2"   >cpu_steal &nbsp; &nbsp; &nbsp; cpu_steal (module cpu_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >load_one &nbsp; &nbsp; &nbsp; &nbsp;One minute load average (module load_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >mem_sreclaimable &nbsp; &nbsp; &nbsp; &nbsp;Amount of reclaimable slab memory (module mem_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >os_release &nbsp; &nbsp; &nbsp;Operating system release date (module sys_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >mem_total &nbsp; &nbsp; &nbsp; Total amount of memory displayed in KBs (module mem_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >cpu_intr &nbsp; &nbsp; &nbsp; &nbsp;cpu_intr (module cpu_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >proc_run &nbsp; &nbsp; &nbsp; &nbsp;Total number of running processes (module proc_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >load_five &nbsp; &nbsp; &nbsp; Five minute load average (module load_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >disk_free &nbsp; &nbsp; &nbsp; Total free disk space (module disk_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >gexec &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gexec available (module core_metrics)</font></div><div style="line-height: 28px;"   ><font size="2"   >mem_cached &nbsp; &nbsp; &nbsp;Amount of cached memory (module mem_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >mtu &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Network maximum transmission unit (module sys_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >cpu_sintr &nbsp; &nbsp; &nbsp; cpu_sintr (module cpu_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >pkts_in &nbsp; &nbsp; &nbsp; &nbsp; Packets in per second (module net_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >location &nbsp; &nbsp; &nbsp; &nbsp;Location of the machine (module core_metrics)</font></div><div style="line-height: 28px;"   ><font size="2"   >bytes_in &nbsp; &nbsp; &nbsp; &nbsp;Number of bytes in per second (module net_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >swap_total &nbsp; &nbsp; &nbsp;Total amount of swap space displayed in KBs (module mem_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >bytes_out &nbsp; &nbsp; &nbsp; Number of bytes out per second (module net_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >load_fifteen &nbsp; &nbsp;Fifteen minute load average (module load_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >mem_free &nbsp; &nbsp; &nbsp; &nbsp;Amount of available memory (module mem_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >os_name &nbsp; &nbsp; &nbsp; &nbsp; Operating system name (module sys_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >boottime &nbsp; &nbsp; &nbsp; &nbsp;The last time that the system was started (module sys_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >cpu_idle &nbsp; &nbsp; &nbsp; &nbsp;Percentage of time that the CPU or CPUs were idle and the system did not have an outstanding disk I/O request (module cpu_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >cpu_nice &nbsp; &nbsp; &nbsp; &nbsp;Percentage of CPU utilization that occurred while executing at the user level with nice priority (module cpu_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >cpu_user &nbsp; &nbsp; &nbsp; &nbsp;Percentage of CPU utilization that occurred while executing at the user level (module cpu_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >cpu_aidle &nbsp; &nbsp; &nbsp; Percent of time since boot idle CPU (module cpu_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >sys_clock &nbsp; &nbsp; &nbsp; Time as reported by the system clock (module sys_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >mem_buffers &nbsp; &nbsp; Amount of buffered memory (module mem_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >cpu_system &nbsp; &nbsp; &nbsp;Percentage of CPU utilization that occurred while executing at the system level (module cpu_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >part_max_used &nbsp; Maximum percent used for all partitions (module disk_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >disk_total &nbsp; &nbsp; &nbsp;Total available disk space (module disk_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >heartbeat &nbsp; &nbsp; &nbsp; Last heartbeat (module core_metrics)</font></div><div style="line-height: 28px;"   ><font size="2"   >mem_shared &nbsp; &nbsp; &nbsp;Amount of shared memory (module mem_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >machine_type &nbsp; &nbsp;System architecture (module sys_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >cpu_wio &nbsp; &nbsp; &nbsp; &nbsp; Percentage of time that the CPU or CPUs were idle during which the system had an outstanding disk I/O request (module cpu_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >cpu_num &nbsp; &nbsp; &nbsp; &nbsp; Total number of CPUs (module cpu_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >proc_total &nbsp; &nbsp; &nbsp;Total number of processes (module proc_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >cpu_speed &nbsp; &nbsp; &nbsp; CPU Speed in terms of MHz (module cpu_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >pkts_out &nbsp; &nbsp; &nbsp; &nbsp;Packets out per second (module net_module)</font></div><div style="line-height: 28px;"   ><font size="2"   >swap_free &nbsp; &nbsp; &nbsp; Amount of available swap memory (module mem_module)</font></div></div><p></p></pre></div></div><div style="line-height: 28px;"   ><div style="line-height: 28px;"   ><br></div><div style="line-height: 28px;"   >因为当前没有配置文件, 需要创建一个配置文件,&nbsp;<span style="line-height: 28px;"   >使用gmond -t</span></div></div><div># gmond -t &gt; /opt/ganglia-core-3.6.0/etc/gmond.conf</div><div>这样输出的配置文件可能不能完全覆盖目前所有的module, 例如 :&nbsp;</div><div>mem_sreclaimable &nbsp; &nbsp; &nbsp; &nbsp;Amount of reclaimable slab memory (module mem_module)</div><div>mtu &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Network maximum transmission unit (module sys_module)</div><div>sys_clock &nbsp; &nbsp; &nbsp; Time as reported by the system clock (module sys_module)</div><div>这几个就没有覆盖到.</div><div><br></div><div>简单的讲一下配置文件的含义 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >[root@db-172-16-3-221 man]# less /opt/ganglia-core-3.6.0/etc/gmond.conf&nbsp;</font></div><div><font size="2"   >/* This configuration is as close to 2.5.x default behavior as possible</font></div><div><font size="2"   >&nbsp; &nbsp;The values closely match ./gmond/metric.h definitions in 2.5.x */</font></div><div><font size="2"   >globals { &nbsp; &nbsp;# 全局配置</font></div><div><font size="2"   >&nbsp; daemonize = yes &nbsp; # 后台运行</font></div><div><font size="2"   >&nbsp; setuid = yes &nbsp; &nbsp;# 启动gmond时, 设置gmond的运行uid</font></div><div><font size="2"   >&nbsp; user = nobody &nbsp; &nbsp;# 以 nobody运行</font></div><div><font size="2"   >&nbsp; debug_level = 0 &nbsp; # &nbsp;DEBUG级别</font></div><div><font size="2"   >&nbsp; max_udp_msg_len = 1472 &nbsp; &nbsp;# UDP包的长度, 注意, 如果UDP包要跨广域网传播或者VPN传播的话, 可能会导致封装后的大小超过MTU, 导致包丢失, 那么可以减小这个包的大小.</font></div><div><font size="2"   >&nbsp; mute = no &nbsp; # 是否为哑巴, 只接收来自其他gmond的监控信息</font></div><div><font size="2"   >&nbsp; deaf = no &nbsp; &nbsp;# 是否为聋子, 只发送监控信息</font></div><div><font size="2"   >&nbsp; allow_extra_data = yes &nbsp; # 允许发送XML的EXTRA_DATA和EXTRA_ELEMENT部分信息, 如果完全自定义METRIC的话, 可以设置为FALSE, 那么将不发送<span style="line-height: 28px;"   >XML的EXTRA_DATA和EXTRA_ELEMENT部分信息</span></font></div><div><font size="2"   >&nbsp; host_dmax = 86400 &nbsp; /*secs. Expires (removes from web interface) hosts in 1 day */ &nbsp;# 在指定时间内没有收到主机的任何报告时, 删除主机的metadata.&nbsp;</font></div><div><font size="2"   >&nbsp; host_tmax = 20 /*secs */ &nbsp;# 在指定时间*4内没收到主机的任何报告, 超时.</font></div><div><font size="2"   >&nbsp; cleanup_threshold = 300 /*secs */ &nbsp; &nbsp;#　清除主机前, 等待的时间.</font></div><div><font size="2"   >&nbsp; gexec = no &nbsp; # &nbsp;是否宣告开启了gexecd的主机调用gexec.</font></div><div><font size="2"   >&nbsp; # By default gmond will use reverse DNS resolution when displaying your hostname</font></div><div><font size="2"   >&nbsp; # Uncommeting following value will override that value.</font></div><div><font size="2"   >&nbsp; # override_hostname = "mywebserver.domain.com"</font></div><div><font size="2"   >&nbsp; # If you are not using multicast this value should be set to something other than 0.</font></div><div><font size="2"   >&nbsp; # Otherwise if you restart aggregator gmond you will get empty graphs. 60 seconds is reasonable</font></div><div><font size="2"   >&nbsp; send_metadata_interval = 0 /*secs */ &nbsp; &nbsp; &nbsp; # 发送主机metadata给其他主机的时间间隔, 默认情况下只在第一个gmond包或有其他gmond在网络中被发现时发送.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >}</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >/*</font></div><div><font size="2"   >&nbsp;* The cluster attributes specified will be used as part of the &lt;CLUSTER&gt;</font></div><div><font size="2"   >&nbsp;* tag that will wrap all hosts collected by this instance.</font></div><div><font size="2"   >&nbsp;*/</font></div><div><font size="2"   >cluster { &nbsp;# 集群配置</font></div><div><font size="2"   >&nbsp; name = "unspecified" &nbsp; &nbsp; # 集群名,&nbsp;</font></div><div><font size="2"   >&nbsp; owner = "unspecified" &nbsp; &nbsp;# 所有者</font></div><div><font size="2"   >&nbsp; latlong = "unspecified" &nbsp; &nbsp;# 地理位置</font></div><div><font size="2"   >&nbsp; url = "unspecified" &nbsp; # URL</font></div><div><font size="2"   >}</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >#例如 :&nbsp;</font></div><div><div><font size="2"   ># &nbsp; &nbsp; &nbsp; &nbsp; cluster {</font></div><div><font size="2"   ># &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; name = "Millennium Cluster"</font></div><div><font size="2"   ># &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; owner = "UC Berkeley CS Dept."</font></div><div><font size="2"   ># &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latlong = "N37.37 W122.23"</font></div><div><font size="2"   ># &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; url = "http://www.millennium.berkeley.edu/"</font></div><div><font size="2"   ># &nbsp; &nbsp; &nbsp; &nbsp; }</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >/* The host section describes attributes of the host, like the location */</font></div><div><font size="2"   >host {</font></div><div><font size="2"   >&nbsp; location = "unspecified" &nbsp; # 主机在机房中的位置例如1,2,3,&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;The numbers represent Rack, Rank and Plane respectively.</font></div><div><font size="2"   >}</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >/* Feel free to specify as many udp_send_channels as you like. &nbsp;Gmond</font></div><div><font size="2"   >&nbsp; &nbsp;used to only support having a single channel */</font></div><div><font size="2"   >udp_send_channel { &nbsp; &nbsp;# 发送信息的通道, 可以配多个<span style="line-height: 28px;"   >udp_send_channel group</span><span style="line-height: 28px;"   >, 但是要么使用单播, 要么使用多播.</span></font></div><div><font size="2"   >&nbsp; # bind_hostname = yes &nbsp;# Highly recommended, soon to be default.  建议使用YES, 那么将使用源地址解析HOSTNAME, 这个HOSTNAME会被用到XML里面.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# This option tells gmond to use a source address  # 例如 解析出来的 <span style="line-height: 21px;"   >HOST NAME="db-172-16-3-221.localdomain" </span></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# that resolves to the machine's hostname. &nbsp;Without</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# this, the metrics may appear to come from any</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# interface and the DNS names associated with</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# those IPs will be used to create the RRDs.  </font></div><div><font size="2"   >&nbsp; mcast_join = 239.2.11.71 &nbsp; &nbsp;# 多播地址</font></div><div><font size="2"   >  bind = 172.16.3.221   # 绑定地址, <span style="line-height: 21px;"   >You can use the bind attribute to bind to a particular local address to be used as the source for the multicast</span></font></div><font size="2"   ><span style="line-height: 21px;"   >                        # packets sent or let gmond resolve the default hostname if bind_hostname = yes.</span></font><div><font size="2"   >&nbsp; port = 8649 &nbsp; # 端口</font></div><div><font size="2"   >&nbsp; ttl = 1 &nbsp; # 生存时间, 如果要跨路由器的话, 需要配置大的ttl, 否则会不可达.</font></div><div><font size="2"   >&nbsp;&nbsp;# buffer = 10485760 &nbsp; /*&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;If you have a large system with lots of metrics, you might experience UDP drops.&nbsp;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;This happens when gmond is not&nbsp;<span style="line-height: 28px;"   >able to process the UDP fast enough from the network.&nbsp;</span></font></div><div><font size="2"   ><span style="line-height: 28px;"   >&nbsp; &nbsp; &nbsp; &nbsp;In this case you might consider changing your setup into&nbsp;</span><span style="line-height: 28px;"   >a more distributed setup using aggregator gmond hosts.</span></font></div><div><font size="2"   ><span style="line-height: 28px;"   >&nbsp; &nbsp; &nbsp; Alternatively you can choose to create a bigger receive&nbsp;</span><span style="line-height: 28px;"   >buffer: */  同时需要配置系统内核</span># sysctl -w net.core.rmem_max=10485760</font></div><div><font size="2"   >}</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* You can specify as many udp_recv_channels as you like as well. */<br>udp_recv_channel {<br>  mcast_join = 239.2.11.71<br>  port = 8649<br>  bind = 239.2.11.71<br>  retry_bind = true<br>  # Size of the UDP buffer. If you are handling lots of metrics you really<br>  # should bump it up to e.g. 10MB or even higher.<br>  # buffer = 10485760<br>}</font></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >/* You can specify as many tcp_accept_channels as you like to share</font></div><div><font size="2"   >&nbsp; &nbsp;an xml description of the state of the cluster */</font></div><div><font size="2"   >tcp_accept_channel { &nbsp; &nbsp;</font></div><div><font size="2"   >&nbsp; port = 8649</font></div><div><font size="2"   >&nbsp; # If you want to gzip XML output</font></div><div><font size="2"   >&nbsp; gzip_output = no</font></div><div><font size="2"   >}</font></div></div><div><font size="2"   ><br></font></div><div><font size="2"   >#模块</font></div><div><div><font size="2"   >/* Each metrics module that is referenced by gmond must be specified and</font></div><div><font size="2"   >&nbsp; &nbsp;loaded. If the module has been statically linked with gmond, it does</font></div><div><font size="2"   >&nbsp; &nbsp;not require a load path. However all dynamically loadable modules must</font></div><div><font size="2"   >&nbsp; &nbsp;include a load path. */</font></div><div><font size="2"   >modules {</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "core_metrics"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "modcpu.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "disk_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "moddisk.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "load_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "modload.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "modmem.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "net_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "modnet.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "proc_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "modproc.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "sys_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "modsys.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >/* This collection group will cause a heartbeat (or beacon) to be sent every</font></div><div><font size="2"   >&nbsp; &nbsp;20 seconds. &nbsp;In the heartbeat is the GMOND_STARTED data which expresses</font></div><div><font size="2"   >&nbsp; &nbsp;the age of the running gmond. */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_once = yes &nbsp; &nbsp; # 表示只在gmond启动时采集一次, 表示这是一个稳定性指标, 一次采集就可以了</font></div><div><font size="2"   >&nbsp; time_threshold = 20 &nbsp; # 间隔20秒发送一次</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "heartbeat" &nbsp; # 填写gmond -m输出的metric name.</font></div><div><font size="2"   >&nbsp; &nbsp; title = "HeartBeat" &nbsp; # 可以不写</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >/* This collection group will send general info about this host every</font></div><div><font size="2"   >&nbsp; &nbsp;1200 secs.</font></div><div><font size="2"   >&nbsp; &nbsp;This information doesn't change between reboots and is only collected</font></div><div><font size="2"   >&nbsp; &nbsp;once. */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_once = yes &nbsp; &nbsp;# 同样只采集一次, 因为这些都是稳定指标</font></div><div><font size="2"   >&nbsp; time_threshold = 1200 &nbsp;# 1200秒发送一次</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_num"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU Count"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_speed"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU Speed"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_total"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Memory Total"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; /* Should this be here? Swap can be added/removed between reboots. */</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "swap_total"</font></div></div><div><div><font size="2"   >&nbsp; &nbsp; title = "Swap Space Total"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "boottime"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Last Boot Time"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "machine_type"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Machine Type"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "os_name"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Operating System"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "os_release"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Operating System Release"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "location"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Location"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >/* This collection group will send the status of gexecd for this host</font></div><div><font size="2"   >&nbsp; &nbsp;every 300 secs.*/</font></div><div><font size="2"   >/* Unlike 2.5.x the default behavior is to report gexecd OFF. */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_once = yes</font></div><div><font size="2"   >&nbsp; time_threshold = 300</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "gexec"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Gexec Status"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* This collection group will collect the CPU status info every 20 secs.</font></div><div><font size="2"   >&nbsp; &nbsp;The time threshold is set to 90 seconds. &nbsp;In honesty, this</font></div><div><font size="2"   >&nbsp; &nbsp;time_threshold could be set significantly higher to reduce</font></div><div><font size="2"   >&nbsp; &nbsp;unneccessary &nbsp;network chatter. */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 20</font></div><div><font size="2"   >&nbsp; time_threshold = 90</font></div><div><font size="2"   >&nbsp; /* CPU status */</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_user"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0" &nbsp; # 上次采集的数据和当前数据如果相差超过1.0, 则将当前的整个collection group发送.</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU User" &nbsp; &nbsp;#&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;It’s important to note that all metrics in a collection group are sent even when only a single &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # &nbsp; &nbsp; &nbsp; &nbsp;value_threshold&nbsp;<span style="line-height: 28px;"   >is surpassed.</span></font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_system"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU System"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_idle"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "5.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU Idle"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_nice"</font></div></div><div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU Nice"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_aidle"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "5.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU aidle"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_wio"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU wio"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_steal"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU steal"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; /* The next two metrics are optional if you want more detail...</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;... since they are accounted for in cpu_system.</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_intr"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU intr"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_sintr"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU sintr"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; */</font></div><div><font size="2"   >}</font></div></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 20</font></div><div><font size="2"   >&nbsp; time_threshold = 90</font></div><div><font size="2"   >&nbsp; /* Load Averages */</font></div><div><font size="2"   >&nbsp; metric {</font></div></div><div><div><font size="2"   >&nbsp; &nbsp; name = "load_one"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "One Minute Load Average"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "load_five"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Five Minute Load Average"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "load_fifteen"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Fifteen Minute Load Average"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* This group collects the number of running and total processes */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 80</font></div><div><font size="2"   >&nbsp; time_threshold = 950</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "proc_run"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Total Running Processes"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "proc_total"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Total Processes"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* This collection group grabs the volatile memory metrics every 40 secs and</font></div><div><font size="2"   >&nbsp; &nbsp;sends them at least every 180 secs. &nbsp;This time_threshold can be increased</font></div><div><font size="2"   >&nbsp; &nbsp;significantly to reduce unneeded network traffic. */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 40</font></div><div><font size="2"   >&nbsp; time_threshold = 180</font></div></div><div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_free"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1024.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Free Memory"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_shared"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1024.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Shared Memory"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_buffers"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1024.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Memory Buffers"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_cached"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1024.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Cached Memory"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "swap_free"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1024.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Free Swap Space"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 40</font></div><div><font size="2"   >&nbsp; time_threshold = 300</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "bytes_out"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 4096</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Bytes Sent"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "bytes_in"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 4096</font></div></div><div><div><font size="2"   >&nbsp; &nbsp; title = "Bytes Received"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "pkts_in"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 256</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Packets Received"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "pkts_out"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 256</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Packets Sent"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* Different than 2.5.x default since the old config made no sense */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 1800</font></div><div><font size="2"   >&nbsp; time_threshold = 3600</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "disk_total"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 1.0</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Total Disk Space"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 40</font></div><div><font size="2"   >&nbsp; time_threshold = 180</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "disk_free"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 1.0</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Disk Space Available"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "part_max_used"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 1.0</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Maximum Disk Space Used"</font></div><div><font size="2"   >&nbsp; }</font></div></div><div><div><font size="2"   >}</font></div><div><font size="2"   ># 可以包含其他配置文件</font></div><div><font size="2"   >include ("/opt/ganglia-core-3.6.0/etc/conf.d/*.conf")</font></div></div><p></p></pre></div><div>其他配置, 用于udp_recv_channel and tcp_accept_channel的访问控制 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><div><font size="2"   >ACCESS CONTROL</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;The udp_recv_channel and tcp_accept_channel directives can contain an Access Control List (ACL). &nbsp;This ACL</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;allows you to specify exactly which hosts gmond process data from.</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp;An example of an acl entry looks like</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;acl {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = "deny"</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;access {</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ip = 192.168.0.4</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mask = 32</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;action = "allow"</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</font></div></div><p></p></pre></div><div><br></div><div>因为gmond一次传输的DATA可能包含大量的数据, 所以为了防止UDP一个包放不下, 如果要加大udp buffer. 同时需要配置内核 :&nbsp;</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   ># sysctl -w net.core.rmem_max=10485760</font></div><div><font size="2"   ># vi /etc/sysctl.conf</font></div><div><span style="line-height: 28px;"   ><font size="2"   >net.core.rmem_max=10485760</font></span></div><p></p></pre></div><div><span style="line-height: 28px;"   ><br></span></div><div><span style="line-height: 28px;"   >启动gmond :&nbsp;</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   ># gmond -c /opt/ganglia-core-3.6.0/etc/gmond.conf&nbsp;</font></div><div><font size="2"   ><br></font></div><div><div><font size="2"   >[root@db-172-16-3-221 man]# netstat -anp|grep gmond</font></div><div><font size="2"   >tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:8649 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;4462/gmond &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 239.2.11.71:8649 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4462/gmond &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font size="2"   >udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 172.16.3.221:28390 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;239.2.11.71:8649 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ESTABLISHED 4462/gmond&nbsp;</font></div></div><p></p></pre></div><div><br></div><div>启动后, 直接telnet 8649端口, 可以看到XML组织的监控数据和metadata.</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-221 man]# telnet 127.0.0.1 8649</font></div><div><font size="2"   >Trying 127.0.0.1...</font></div><div><font size="2"   >Connected to 127.0.0.1.</font></div><div><font size="2"   >Escape character is '^]'.</font></div><div><font size="2"   >&lt;?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?&gt;</font></div><div><font size="2"   >&lt;!DOCTYPE GANGLIA_XML [</font></div><div><font size="2"   >&nbsp; &nbsp;&lt;!ELEMENT GANGLIA_XML (GRID|CLUSTER|HOST)*&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST GANGLIA_XML VERSION CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST GANGLIA_XML SOURCE CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;&lt;!ELEMENT GRID (CLUSTER | GRID | HOSTS | METRICS)*&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST GRID NAME CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST GRID AUTHORITY CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST GRID LOCALTIME CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;&lt;!ELEMENT CLUSTER (HOST | HOSTS | METRICS)*&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST CLUSTER NAME CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST CLUSTER OWNER CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST CLUSTER LATLONG CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST CLUSTER URL CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST CLUSTER LOCALTIME CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;&lt;!ELEMENT HOST (METRIC)*&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST HOST NAME CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST HOST IP CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST HOST LOCATION CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST HOST TAGS CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST HOST REPORTED CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST HOST TN CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST HOST TMAX CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST HOST DMAX CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST HOST GMOND_STARTED CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;&lt;!ELEMENT METRIC (EXTRA_DATA*)&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRIC NAME CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRIC VAL CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRIC TYPE (string | int8 | uint8 | int16 | uint16 | int32 | uint32 | float | double | timestamp) #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRIC UNITS CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRIC TN CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRIC TMAX CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRIC DMAX CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRIC SLOPE (zero | positive | negative | both | unspecified) #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRIC SOURCE (gmond) 'gmond'&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;&lt;!ELEMENT EXTRA_DATA (EXTRA_ELEMENT*)&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;&lt;!ELEMENT EXTRA_ELEMENT EMPTY&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST EXTRA_ELEMENT NAME CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST EXTRA_ELEMENT VAL CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;&lt;!ELEMENT HOSTS EMPTY&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST HOSTS UP CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST HOSTS DOWN CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST HOSTS SOURCE (gmond | gmetad) #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp;&lt;!ELEMENT METRICS (EXTRA_DATA*)&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRICS NAME CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRICS SUM CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRICS NUM CDATA #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRICS TYPE (string | int8 | uint8 | int16 | uint16 | int32 | uint32 | float | double | timestamp) #REQUIRED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRICS UNITS CDATA #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRICS SLOPE (zero | positive | negative | both | unspecified) #IMPLIED&gt;</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &lt;!ATTLIST METRICS SOURCE (gmond) 'gmond'&gt;</font></div><div><font size="2"   >]&gt;</font></div><div><font size="2"   >&lt;GANGLIA_XML VERSION="3.6.0" SOURCE="gmond"&gt;</font></div><div><font size="2"   >&lt;CLUSTER NAME="test" LOCALTIME="1410332382" OWNER="digoal" LATLONG="111 122" URL="http://dba.sky-mobi.com"&gt;</font></div><div><font size="2"   >&lt;HOST NAME="db-172-16-3-221.localdomain" IP="172.16.3.221" TAGS="" REPORTED="1410332366" TN="15" TMAX="20" DMAX="86400" LOCATION="1,2,3" GMOND_STARTED="1410332246"&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="mem_shared" VAL="0" TYPE="float" UNITS="KB" TN="15" TMAX="180" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="memory"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Amount of shared memory"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Shared Memory"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="cpu_wio" VAL="0.0" TYPE="float" UNITS="%" TN="45" TMAX="90" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="cpu"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Percentage of time that the CPU or CPUs were idle during which the system had an outstanding disk I/O request"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="CPU wio"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="machine_type" VAL="x86_64" TYPE="string" UNITS="" TN="135" TMAX="1200" DMAX="0" SLOPE="zero"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="system"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="System architecture"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Machine Type"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="proc_total" VAL="1011" TYPE="uint32" UNITS=" " TN="55" TMAX="950" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="process"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Total number of processes"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Total Processes"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="cpu_num" VAL="48" TYPE="uint16" UNITS="CPUs" TN="135" TMAX="1200" DMAX="0" SLOPE="zero"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="cpu"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Total number of CPUs"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="CPU Count"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="cpu_speed" VAL="1995" TYPE="uint32" UNITS="MHz" TN="135" TMAX="1200" DMAX="0" SLOPE="zero"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="cpu"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="CPU Speed in terms of MHz"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="CPU Speed"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="pkts_out" VAL="0.00" TYPE="float" UNITS="packets/sec" TN="135" TMAX="300" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="network"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Packets out per second"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Packets Sent"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="swap_free" VAL="1048568" TYPE="float" UNITS="KB" TN="15" TMAX="180" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="memory"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Amount of available swap memory"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Free Swap Space"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="cpu_steal" VAL="0.0" TYPE="float" UNITS="%" TN="45" TMAX="90" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="cpu"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="cpu_steal"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="CPU steal"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="load_one" VAL="0.00" TYPE="float" UNITS=" " TN="45" TMAX="70" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="load"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="One minute load average"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="One Minute Load Average"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="mem_total" VAL="99045568" TYPE="float" UNITS="KB" TN="135" TMAX="1200" DMAX="0" SLOPE="zero"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="memory"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Total amount of memory displayed in KBs"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Memory Total"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="os_release" VAL="2.6.32-431.el6.x86_64" TYPE="string" UNITS="" TN="135" TMAX="1200" DMAX="0" SLOPE="zero"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="system"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Operating system release date"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Operating System Release"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="proc_run" VAL="0" TYPE="uint32" UNITS=" " TN="55" TMAX="950" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="process"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Total number of running processes"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Total Running Processes"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="load_five" VAL="0.00" TYPE="float" UNITS=" " TN="45" TMAX="325" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="load"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Five minute load average"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Five Minute Load Average"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="gexec" VAL="OFF" TYPE="string" UNITS="" TN="135" TMAX="300" DMAX="0" SLOPE="zero"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="core"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="gexec available"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Gexec Status"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="disk_free" VAL="3209.367" TYPE="double" UNITS="GB" TN="135" TMAX="180" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="disk"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Total free disk space"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Disk Space Available"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="mem_cached" VAL="112696" TYPE="float" UNITS="KB" TN="15" TMAX="180" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="memory"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Amount of cached memory"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Cached Memory"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="pkts_in" VAL="0.00" TYPE="float" UNITS="packets/sec" TN="135" TMAX="300" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="network"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Packets in per second"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Packets Received"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="bytes_in" VAL="0.00" TYPE="float" UNITS="bytes/sec" TN="135" TMAX="300" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="network"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Number of bytes in per second"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Bytes Received"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="bytes_out" VAL="0.00" TYPE="float" UNITS="bytes/sec" TN="135" TMAX="300" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="network"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Number of bytes out per second"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Bytes Sent"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="swap_total" VAL="1048568" TYPE="float" UNITS="KB" TN="135" TMAX="1200" DMAX="0" SLOPE="zero"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="memory"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Total amount of swap space displayed in KBs"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Swap Space Total"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="mem_free" VAL="97487952" TYPE="float" UNITS="KB" TN="15" TMAX="180" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="memory"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Amount of available memory"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Free Memory"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="load_fifteen" VAL="0.00" TYPE="float" UNITS=" " TN="45" TMAX="950" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="load"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Fifteen minute load average"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Fifteen Minute Load Average"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="os_name" VAL="Linux" TYPE="string" UNITS="" TN="135" TMAX="1200" DMAX="0" SLOPE="zero"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="system"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Operating system name"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Operating System"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="boottime" VAL="1410314161" TYPE="uint32" UNITS="s" TN="135" TMAX="1200" DMAX="0" SLOPE="zero"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="system"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="The last time that the system was started"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Last Boot Time"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="cpu_idle" VAL="100.0" TYPE="float" UNITS="%" TN="45" TMAX="90" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="cpu"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Percentage of time that the CPU or CPUs were idle and the system did not have an outstanding disk I/O request"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="CPU Idle"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="cpu_user" VAL="0.0" TYPE="float" UNITS="%" TN="45" TMAX="90" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="cpu"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Percentage of CPU utilization that occurred while executing at the user level"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="CPU User"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="cpu_nice" VAL="0.0" TYPE="float" UNITS="%" TN="45" TMAX="90" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="cpu"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Percentage of CPU utilization that occurred while executing at the user level with nice priority"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="CPU Nice"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="cpu_aidle" VAL="0.0" TYPE="float" UNITS="%" TN="45" TMAX="3800" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="cpu"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Percent of time since boot idle CPU"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="CPU aidle"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="mem_buffers" VAL="15628" TYPE="float" UNITS="KB" TN="15" TMAX="180" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="memory"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Amount of buffered memory"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Memory Buffers"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="cpu_system" VAL="0.0" TYPE="float" UNITS="%" TN="45" TMAX="90" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="cpu"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Percentage of CPU utilization that occurred while executing at the system level"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="CPU System"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="part_max_used" VAL="30.6" TYPE="float" UNITS="%" TN="135" TMAX="180" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="disk"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Maximum percent used for all partitions"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Maximum Disk Space Used"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;METRIC NAME="disk_total" VAL="3862.720" TYPE="double" UNITS="GB" TN="135" TMAX="1200" DMAX="0" SLOPE="both"&gt;</font></div><div><font size="2"   >&lt;EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="GROUP" VAL="disk"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="DESC" VAL="Total available disk space"/&gt;</font></div><div><font size="2"   >&lt;EXTRA_ELEMENT NAME="TITLE" VAL="Total Disk Space"/&gt;</font></div><div><font size="2"   >&lt;/EXTRA_DATA&gt;</font></div><div><font size="2"   >&lt;/METRIC&gt;</font></div><div><font size="2"   >&lt;/HOST&gt;</font></div><div><font size="2"   >&lt;/CLUSTER&gt;</font></div><div><font size="2"   >&lt;/GANGLIA_XML&gt;</font></div><div><font size="2"   >Connection closed by foreign host.</font></div><p></p></pre></div><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/1638770402014899439839/"   >http://blog.163.com/digoal@126/blog/static/1638770402014899439839/</a></div><div>2.&nbsp;<a style="line-height: 28px;" target="_blank" href="http://blog.163.com/digoal@126/blog/static/163877040201489111654684/"   >http://blog.163.com/digoal@126/blog/static/163877040201489111654684/</a></div><div>3. man gmond.conf</div><div>4. 最终的gmond.conf配置</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >[root@db-172-16-3-221 etc]# cat gmond.conf</font></div><div><font size="2"   >/* This configuration is as close to 2.5.x default behavior as possible</font></div><div><font size="2"   >&nbsp; &nbsp;The values closely match ./gmond/metric.h definitions in 2.5.x */</font></div><div><font size="2"   >globals {</font></div><div><font size="2"   >&nbsp; daemonize = yes</font></div><div><font size="2"   >&nbsp; setuid = yes</font></div><div><font size="2"   >&nbsp; user = nobody</font></div><div><font size="2"   >&nbsp; debug_level = 0</font></div><div><font size="2"   >&nbsp; max_udp_msg_len = 1472</font></div><div><font size="2"   >&nbsp; mute = no</font></div><div><font size="2"   >&nbsp; deaf = no</font></div><div><font size="2"   >&nbsp; allow_extra_data = yes</font></div><div><font size="2"   >&nbsp; host_dmax = 86400 /*secs. Expires (removes from web interface) hosts in 1 day */</font></div><div><font size="2"   >&nbsp; host_tmax = 20 /*secs */</font></div><div><font size="2"   >&nbsp; cleanup_threshold = 300 /*secs */</font></div><div><font size="2"   >&nbsp; gexec = no</font></div><div><font size="2"   >&nbsp; # By default gmond will use reverse DNS resolution when displaying your hostname</font></div><div><font size="2"   >&nbsp; # Uncommeting following value will override that value.</font></div><div><font size="2"   >&nbsp; # override_hostname = "mywebserver.domain.com"</font></div><div><font size="2"   >&nbsp; # If you are not using multicast this value should be set to something other than 0.</font></div><div><font size="2"   >&nbsp; # Otherwise if you restart aggregator gmond you will get empty graphs. 60 seconds is reasonable</font></div><div><font size="2"   >&nbsp; send_metadata_interval = 0 /*secs */</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/*</font></div><div><font size="2"   >&nbsp;* The cluster attributes specified will be used as part of the &lt;CLUSTER&gt;</font></div><div><font size="2"   >&nbsp;* tag that will wrap all hosts collected by this instance.</font></div><div><font size="2"   >&nbsp;*/</font></div><div><font size="2"   >cluster {</font></div><div><font size="2"   >&nbsp; name = "test"</font></div><div><font size="2"   >&nbsp; owner = "digoal"</font></div><div><font size="2"   >&nbsp; latlong = "111 122"</font></div><div><font size="2"   >&nbsp; url = "http://dba.sky-mobi.com"</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* The host section describes attributes of the host, like the location */</font></div><div><font size="2"   >host {</font></div><div><font size="2"   >&nbsp; location = "1,2,3"</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* Feel free to specify as many udp_send_channels as you like. &nbsp;Gmond</font></div><div><font size="2"   >&nbsp; &nbsp;used to only support having a single channel */</font></div><div><font size="2"   >udp_send_channel {</font></div><div><font size="2"   >&nbsp; #bind_hostname = yes # Highly recommended, soon to be default.</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# This option tells gmond to use a source address</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# that resolves to the machine's hostname. &nbsp;Without</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# this, the metrics may appear to come from any</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# interface and the DNS names associated with</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# those IPs will be used to create the RRDs.</font></div><div><font size="2"   >&nbsp; mcast_join = 239.2.11.71</font></div><div><font size="2"   >&nbsp; port = 8649</font></div><div><font size="2"   >&nbsp; ttl = 10</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* You can specify as many udp_recv_channels as you like as well. */</font></div><div><font size="2"   >udp_recv_channel {</font></div><div><font size="2"   >&nbsp; mcast_join = 239.2.11.71</font></div><div><font size="2"   >&nbsp; port = 8649</font></div><div><font size="2"   >&nbsp; bind = 239.2.11.71</font></div><div><font size="2"   >&nbsp; retry_bind = true</font></div><div><font size="2"   >&nbsp; # Size of the UDP buffer. If you are handling lots of metrics you really</font></div><div><font size="2"   >&nbsp; # should bump it up to e.g. 10MB or even higher.</font></div><div><font size="2"   >&nbsp; buffer = 10485760</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* You can specify as many tcp_accept_channels as you like to share</font></div><div><font size="2"   >&nbsp; &nbsp;an xml description of the state of the cluster */</font></div><div><font size="2"   >tcp_accept_channel {</font></div><div><font size="2"   >&nbsp; port = 8649</font></div><div><font size="2"   >&nbsp; # If you want to gzip XML output</font></div><div><font size="2"   >&nbsp; gzip_output = no</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* Channel to receive sFlow datagrams */</font></div><div><font size="2"   >#udp_recv_channel {</font></div><div><font size="2"   ># &nbsp;port = 6343</font></div><div><font size="2"   >#}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* Optional sFlow settings */</font></div><div><font size="2"   >#sflow {</font></div><div><font size="2"   ># udp_port = 6343</font></div><div><font size="2"   ># accept_vm_metrics = yes</font></div><div><font size="2"   ># accept_jvm_metrics = yes</font></div><div><font size="2"   ># multiple_jvm_instances = no</font></div><div><font size="2"   ># accept_http_metrics = yes</font></div><div><font size="2"   ># multiple_http_instances = no</font></div><div><font size="2"   ># accept_memcache_metrics = yes</font></div><div><font size="2"   ># multiple_memcache_instances = no</font></div><div><font size="2"   >#}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* Each metrics module that is referenced by gmond must be specified and</font></div><div><font size="2"   >&nbsp; &nbsp;loaded. If the module has been statically linked with gmond, it does</font></div><div><font size="2"   >&nbsp; &nbsp;not require a load path. However all dynamically loadable modules must</font></div><div><font size="2"   >&nbsp; &nbsp;include a load path. */</font></div><div><font size="2"   >modules {</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "core_metrics"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "modcpu.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "disk_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "moddisk.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "load_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "modload.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "modmem.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "net_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "modnet.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "proc_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "modproc.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; module {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "sys_module"</font></div><div><font size="2"   >&nbsp; &nbsp; path = "modsys.so"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* The old internal 2.5.x metric array has been replaced by the following</font></div><div><font size="2"   >&nbsp; &nbsp;collection_group directives. &nbsp;What follows is the default behavior for</font></div><div><font size="2"   >&nbsp; &nbsp;collecting and sending metrics that is as close to 2.5.x behavior as</font></div><div><font size="2"   >&nbsp; &nbsp;possible. */</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* This collection group will cause a heartbeat (or beacon) to be sent every</font></div><div><font size="2"   >&nbsp; &nbsp;20 seconds. &nbsp;In the heartbeat is the GMOND_STARTED data which expresses</font></div><div><font size="2"   >&nbsp; &nbsp;the age of the running gmond. */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_once = yes</font></div><div><font size="2"   >&nbsp; time_threshold = 20</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "heartbeat"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* This collection group will send general info about this host every</font></div><div><font size="2"   >&nbsp; &nbsp;1200 secs.</font></div><div><font size="2"   >&nbsp; &nbsp;This information doesn't change between reboots and is only collected</font></div><div><font size="2"   >&nbsp; &nbsp;once. */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_once = yes</font></div><div><font size="2"   >&nbsp; time_threshold = 1200</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mtu"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "MTU"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_num"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU Count"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_speed"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU Speed"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_total"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Memory Total"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; /* Should this be here? Swap can be added/removed between reboots. */</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "swap_total"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Swap Space Total"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "boottime"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Last Boot Time"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "machine_type"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Machine Type"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "os_name"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Operating System"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "os_release"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Operating System Release"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "location"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Location"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* This collection group will send the status of gexecd for this host</font></div><div><font size="2"   >&nbsp; &nbsp;every 300 secs.*/</font></div><div><font size="2"   >/* Unlike 2.5.x the default behavior is to report gexecd OFF. */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_once = yes</font></div><div><font size="2"   >&nbsp; time_threshold = 300</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "gexec"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Gexec Status"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* This collection group will collect the CPU status info every 20 secs.</font></div><div><font size="2"   >&nbsp; &nbsp;The time threshold is set to 90 seconds. &nbsp;In honesty, this</font></div><div><font size="2"   >&nbsp; &nbsp;time_threshold could be set significantly higher to reduce</font></div><div><font size="2"   >&nbsp; &nbsp;unneccessary &nbsp;network chatter. */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 20</font></div><div><font size="2"   >&nbsp; time_threshold = 90</font></div><div><font size="2"   >&nbsp; /* sys clock */</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "sys_clock"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "System clock"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_sreclaimable"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Reclaimable slab memory"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; /* CPU status */</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_user"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU User"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_system"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU System"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_idle"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "5.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU Idle"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_nice"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU Nice"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_aidle"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "5.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU aidle"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_wio"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU wio"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_steal"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU steal"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; /* The next two metrics are optional if you want more detail...</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;... since they are accounted for in cpu_system.</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_intr"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU intr"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "cpu_sintr"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "CPU sintr"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; */</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 20</font></div><div><font size="2"   >&nbsp; time_threshold = 90</font></div><div><font size="2"   >&nbsp; /* Load Averages */</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "load_one"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "One Minute Load Average"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "load_five"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Five Minute Load Average"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "load_fifteen"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Fifteen Minute Load Average"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* This group collects the number of running and total processes */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 80</font></div><div><font size="2"   >&nbsp; time_threshold = 950</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "proc_run"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Total Running Processes"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "proc_total"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Total Processes"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* This collection group grabs the volatile memory metrics every 40 secs and</font></div><div><font size="2"   >&nbsp; &nbsp;sends them at least every 180 secs. &nbsp;This time_threshold can be increased</font></div><div><font size="2"   >&nbsp; &nbsp;significantly to reduce unneeded network traffic. */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 40</font></div><div><font size="2"   >&nbsp; time_threshold = 180</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_free"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1024.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Free Memory"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_shared"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1024.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Shared Memory"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_buffers"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1024.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Memory Buffers"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "mem_cached"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1024.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Cached Memory"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "swap_free"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = "1024.0"</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Free Swap Space"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 40</font></div><div><font size="2"   >&nbsp; time_threshold = 300</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "bytes_out"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 4096</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Bytes Sent"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "bytes_in"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 4096</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Bytes Received"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "pkts_in"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 256</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Packets Received"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "pkts_out"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 256</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Packets Sent"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >/* Different than 2.5.x default since the old config made no sense */</font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 1800</font></div><div><font size="2"   >&nbsp; time_threshold = 3600</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "disk_total"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 1.0</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Total Disk Space"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >collection_group {</font></div><div><font size="2"   >&nbsp; collect_every = 40</font></div><div><font size="2"   >&nbsp; time_threshold = 180</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "disk_free"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 1.0</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Disk Space Available"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >&nbsp; metric {</font></div><div><font size="2"   >&nbsp; &nbsp; name = "part_max_used"</font></div><div><font size="2"   >&nbsp; &nbsp; value_threshold = 1.0</font></div><div><font size="2"   >&nbsp; &nbsp; title = "Maximum Disk Space Used"</font></div><div><font size="2"   >&nbsp; }</font></div><div><font size="2"   >}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >include ("/opt/ganglia-core-3.6.0/etc/conf.d/*.conf")</font></div><p></p></pre></div><div><br></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="gmond configure - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>